From MAILER-DAEMON Thu Dec 01 18:09:22 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RWFko-0005jg-0B
	for mharc-guile-devel@gnu.org; Thu, 01 Dec 2011 18:09:22 -0500
Received: from eggs.gnu.org ([140.186.70.92]:53100)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RWFkl-0005jX-FW
	for guile-devel@gnu.org; Thu, 01 Dec 2011 18:09:20 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RWFkk-0005gD-9V
	for guile-devel@gnu.org; Thu, 01 Dec 2011 18:09:19 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:53795
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RWFkj-0005fo-O9
	for guile-devel@gnu.org; Thu, 01 Dec 2011 18:09:18 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 0350D8C7B
	for <guile-devel@gnu.org>; Thu,  1 Dec 2011 18:09:17 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to
	:subject:date:message-id:mime-version:content-type; s=sasl; bh=l
	ef31oRYfacEL9PiA3pUg6vE1Xw=; b=AhyOiSrJyxdtGKDjiop8IGD5gVKVu3KQr
	mLGJxAEFHhcabEyBWII3x3QA+xNDMk2MlG9w9SVMy1RWgAIpP3exvTw+h5gUZmYi
	Gufv06WuGrxeORzgrSgg2Io1xDdQht9U+rst+3iv23Lho73yFmjer+WjUYLKBi+/
	3S2+qzwOIo=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:subject
	:date:message-id:mime-version:content-type; q=dns; s=sasl; b=DuV
	zlWYEaoxANJZbvLhpw+Ibc+mnEskd2UbY2yEF1aGVQ+F7zGFH7baUlMc/6FS81PT
	N42YItSYL7aYy2OknQu8wdn8dkJKbl4YqaJJvundtoSTcmsNSn2k1K4VzYKbUFip
	33/gQcBefSIV9bfZfaQrd62YUnkFCCRQ7w6npve8=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id EFC738C7A
	for <guile-devel@gnu.org>; Thu,  1 Dec 2011 18:09:16 -0500 (EST)
Received: from badger (unknown [91.117.99.191]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 69E928C79 for
	<guile-devel@gnu.org>; Thu,  1 Dec 2011 18:09:16 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: guile-devel <guile-devel@gnu.org>
Subject: impressions on gc
Date: Fri, 02 Dec 2011 00:09:12 +0100
Message-ID: <87d3c799ev.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 7DD27510-1C71-11E1-94FF-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 01 Dec 2011 23:09:20 -0000

Hi,

I recently poked some GC-related things in stable-2.0 and master.

One change was to make GC run more often when a process is growing, in
terms of resident memory size.  This seems to be a good idea in general.

The other was to add a function that users can call to note
non-gc-managed allocations -- allocations that may be freed when GC is
run, but which the GC doesn't know about.  That is
scm_gc_register_allocation.  This routine runs GC after allocated bytes
exceed some limit, currently the GC-managed heap size, reset after every
GC.  This is to catch steady-state mallocation.

We cannot deal well with steady-state mallocation, unknown to the GC.
If the ratio between unknown and known allocation is small enough, the
process image size won't grow too badly.  But if it is large, your
process will grow quite large.  You have to let the GC know about
allocation -- at least, about allocation that can be freed by GC.
Otherwise it can't do its job.

Those are my conclusions.  It is midnight.  Goodnight! ;-)

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Thu Dec 01 21:09:11 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RWIYp-0005Mg-3z
	for mharc-guile-devel@gnu.org; Thu, 01 Dec 2011 21:09:11 -0500
Received: from eggs.gnu.org ([140.186.70.92]:42864)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RWIYm-0005JN-2a
	for guile-devel@gnu.org; Thu, 01 Dec 2011 21:09:08 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RWIYk-0006a2-PR
	for guile-devel@gnu.org; Thu, 01 Dec 2011 21:09:08 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:50065)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RWIYk-0006ZD-LU
	for guile-devel@gnu.org; Thu, 01 Dec 2011 21:09:06 -0500
Received: by iapp10 with SMTP id p10so757273iap.0
	for <guile-devel@gnu.org>; Thu, 01 Dec 2011 18:09:05 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:sender:in-reply-to:references:date
	:x-google-sender-auth:message-id:subject:from:to:cc:content-type
	:content-transfer-encoding;
	bh=NE6kiAACktGogqoqVbXt1+p2hFO6V9Rdot+ZNzsv6Q8=;
	b=VbS1XzSeapD5Ur3wfgZtGclyKfG3j+s7Jre1qpCqlh7Q77xDCDNY1mZSjelo/5ZcqO
	jzB/66ygIrBwjIvsGtvT3lXkV+Xippchhug0IdyQuLSwrU+grL2Et9JdBJek0sbZK2ah
	2aT/plMht7aLi0ZMgLpy+GdunbUJXVxkhtBwk=
MIME-Version: 1.0
Received: by 10.42.161.10 with SMTP id r10mr11375461icx.22.1322791745404; Thu,
	01 Dec 2011 18:09:05 -0800 (PST)
Sender: noah549@gmail.com
Received: by 10.42.217.6 with HTTP; Thu, 1 Dec 2011 18:09:05 -0800 (PST)
In-Reply-To: <CACrbFVeFJybsPz3NZ+zgeTbWuvwS_TNNWi_A=PFUCxumuVW41Q@mail.gmail.com>
References: <CACrbFVeFJybsPz3NZ+zgeTbWuvwS_TNNWi_A=PFUCxumuVW41Q@mail.gmail.com>
Date: Thu, 1 Dec 2011 21:09:05 -0500
X-Google-Sender-Auth: ZU44m1kyg1MLQmdXCspT211HTOw
Message-ID: <CA+U71=PJce-uyxq-YOnS=8R+-wt_C26dpx+1R9TQqDYwR+-c2A@mail.gmail.com>
Subject: Re: Guildhall
From: Noah Lavine <noah.b.lavine@gmail.com>
To: simon.haines@con-amalgamate.net
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 02 Dec 2011 02:09:08 -0000

Hello,

I am certainly not an authoritative source, but it's been a while, so
here is what I know. As far as I can tell, these questions haven't
been decided yet. All we know is that we want a guildhall.

However, having your packages in it would be great, so please do
package them up and contribute them when it is ready. Thanks a lot for
being willing to contribute.

Noah

On Tue, Nov 15, 2011 at 5:52 PM, Simon Haines
<simon.haines@con-amalgamate.net> wrote:
> I'd like to start looking into getting some of my libraries ready for the
> guildhall, and have a few quick questions.
>
> How are library namespaces going to be determined? I can see a couple of
> approaches:
> a) authoritative (contributors=A0apply to a central authority for a names=
pace
> upon library contribution), or
> b) federated (contributors have a namespace, perhaps based on a login nam=
e,
> under which all their libraries live)
> I guess it's a matter of taste: (import (guildhall db nosql mongodb (1)))=
 vs
> (import (guildhall simonhaines mongodb (1))). Perhaps this is mere
> bikeshedding and the best approach is 'anything goes'.
>
> What's the contribution process going to look like? I assume a 'contribut=
e'
> form on a web page somewhere, similar to PLaneT or CPAN. Some infrastruct=
ure
> may be required to support this: repository hosting and an announce maili=
ng
> list. On the latter points, the last I heard guildhall.gnu.org was being
> sought for hosting, and I guess guile-user would be a good announce list.
>
> I think the guildhall would be a fantastic development for guile, and I'd
> like to do all I can to get the ball rolling, from paper-chasing to helpi=
ng
> out with the dorodango integration. Just let me know how I can help.
> Simon.
>
>


From MAILER-DAEMON Fri Dec 02 06:11:08 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RWR1I-0000OE-Ga
	for mharc-guile-devel@gnu.org; Fri, 02 Dec 2011 06:11:08 -0500
Received: from eggs.gnu.org ([140.186.70.92]:42867)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RWR1F-0000Hz-3z
	for guile-devel@gnu.org; Fri, 02 Dec 2011 06:11:06 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RWR1A-0007gD-Ps
	for guile-devel@gnu.org; Fri, 02 Dec 2011 06:11:05 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:42412
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RWR1A-0007ff-MN; Fri, 02 Dec 2011 06:11:00 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id D43786044;
	Fri,  2 Dec 2011 06:10:59 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; s=sasl; bh=BdMQfxNbNRVX
	TBfC+dJ91iZJHZI=; b=t/mrD1jtxZKY3aR64ojmO6/yE6K3Vx/7cMhrTV3Ko/TD
	r9ZELGstLeLNQr+eS58S0cC6IQhr3t425M5ebi5e+sDrfF7w4BDGe40PKeqJvN6O
	aqSBEph1lQFw+e/xg7aFXSOiBReJyZpIW1UmYTsZMWV9fQLu54c2w4pbcZHE8y8=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; q=dns; s=sasl; b=nHuh6R
	0vd0fY3EJQfBN4VsZR6G4c6Ps+Wjcw4J+93pwmKtJpriizFfJXBWwlS8SaC4C+8A
	peN8BSCvSWr+Px5dzsVnDtJgTg+uAdyb1iI7WRKk8CDkD7kr1jc5JEI1Rre8DO8p
	GX4lwtnCcMXiiFrCN+m1675JbuBzBjILfgims=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id CD8C46043;
	Fri,  2 Dec 2011 06:10:59 -0500 (EST)
Received: from badger (unknown [91.117.99.155]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 510006042;
	Fri,  2 Dec 2011 06:10:59 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: ludo@gnu.org (Ludovic =?utf-8?Q?Court=C3=A8s?=), guile-developer@gnu.org
Subject: Re: [PATCH] Configure GMP to use GC allocation functions, remove
	bignum finalizers
References: <87tycaodlk.fsf@netris.org> <87k4d6edvr.fsf@gnu.org>
	<8739jue9wk.fsf@neil-laptop.ossau.uklinux.net>
	<m362oqne59.fsf@unquote.localdomain> <87zkfh9x8r.fsf@pobox.com>
	<8762i5mf4x.fsf@gnu.org>
Date: Fri, 02 Dec 2011 12:10:55 +0100
In-Reply-To: <8762i5mf4x.fsf@gnu.org> ("Ludovic =?utf-8?Q?Court=C3=A8s=22'?=
	=?utf-8?Q?s?= message of "Sun, 27 Nov 2011 22:25:50 +0100")
Message-ID: <874nxj8c00.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Pobox-Relay-ID: 505C5E24-1CD6-11E1-B1FD-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org, Neil Jerram <neil@ossau.uklinux.net>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 02 Dec 2011 11:11:06 -0000

On Sun 27 Nov 2011 22:25, ludo@gnu.org (Ludovic Court=C3=A8s) writes:

> A longer term option may be to augment libgc with something akin to our
> old scm_gc_register_collectable_memory.

This is also necessary, as it turns out.  I added
scm_gc_register_allocation, which will simply run a GC every so often.

Currently the heuristic is that when GC runs, a counter is reset to be
equal to the current GC heap size.  scm_gc_register_allocation(size_t)
decrements this counter.  When it wraps around, we run GC.

I made scm_realloc call scm_gc_register_allocation.  I also installed
custom gmp allocators that call scm_malloc and friends -- so the same
allocators, but instrumented.  (Because we hard-coded `free' already in
the printer, we know that this shouldn't break anything.)

That makes the `(factorial 100000)' test take twice as long to run (6
seconds vs 3 seconds), because GC ran 1000 times instead of 15 times,
but it kept the memory image size to 18 MB instead of 1800 MB.

Andy
--=20
http://wingolog.org/


From MAILER-DAEMON Fri Dec 02 12:02:16 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RWWV5-0005B0-W1
	for mharc-guile-devel@gnu.org; Fri, 02 Dec 2011 12:02:15 -0500
Received: from eggs.gnu.org ([140.186.70.92]:47596)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RWWV2-00057X-GI
	for guile-devel@gnu.org; Fri, 02 Dec 2011 12:02:13 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RWWUz-0006bX-Iz
	for guile-devel@gnu.org; Fri, 02 Dec 2011 12:02:12 -0500
Received: from mail4-relais-sop.national.inria.fr ([192.134.164.105]:56112)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <ludo@gnu.org>)
	id 1RWWUz-0006bG-BK
	for guile-devel@gnu.org; Fri, 02 Dec 2011 12:02:09 -0500
X-IronPort-AV: E=Sophos;i="4.71,284,1320620400"; d="scan'208";a="121855000"
Received: from unknown (HELO pluto) ([193.50.110.208])
	by mail4-relais-sop.national.inria.fr with ESMTP/TLS/DHE-RSA-AES128-SHA;
	02 Dec 2011 18:02:07 +0100
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
To: Andy Wingo <wingo@pobox.com>
Subject: Re: [PATCH] Configure GMP to use GC allocation functions,
	remove bignum finalizers
References: <87tycaodlk.fsf@netris.org> <87k4d6edvr.fsf@gnu.org>
	<8739jue9wk.fsf@neil-laptop.ossau.uklinux.net>
	<m362oqne59.fsf@unquote.localdomain> <87zkfh9x8r.fsf@pobox.com>
	<8762i5mf4x.fsf@gnu.org> <874nxj8c00.fsf@pobox.com>
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 12 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
Date: Fri, 02 Dec 2011 18:02:07 +0100
In-Reply-To: <874nxj8c00.fsf@pobox.com> (Andy Wingo's message of "Fri, 02 Dec
	2011 12:10:55 +0100")
Message-ID: <877h2enbzk.fsf@gnu.org>
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 192.134.164.105
Cc: guile-devel@gnu.org, Neil Jerram <neil@ossau.uklinux.net>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 02 Dec 2011 17:02:13 -0000

Hello!

Andy Wingo <wingo@pobox.com> skribis:

> On Sun 27 Nov 2011 22:25, ludo@gnu.org (Ludovic Court=C3=A8s) writes:
>
>> A longer term option may be to augment libgc with something akin to our
>> old scm_gc_register_collectable_memory.
>
> This is also necessary, as it turns out.  I added
> scm_gc_register_allocation, which will simply run a GC every so often.
>
> Currently the heuristic is that when GC runs, a counter is reset to be
> equal to the current GC heap size.  scm_gc_register_allocation(size_t)
> decrements this counter.  When it wraps around, we run GC.

OK, sounds good.  I guess scm_gc_register_collectable_memory could be
changed to just call it, ignoring its first argument?

> I made scm_realloc call scm_gc_register_allocation.  I also installed
> custom gmp allocators that call scm_malloc and friends

I was about to say =E2=80=9Cwe can=E2=80=99t do that in 2.0!=E2=80=9D, but =
then saw your
scm_install_gmp_memory_functions trick.  Cool!  :-)

Could you make it SCM_INTERNAL instead of SCM_API?

> That makes the `(factorial 100000)' test take twice as long to run (6
> seconds vs 3 seconds), because GC ran 1000 times instead of 15 times,
> but it kept the memory image size to 18 MB instead of 1800 MB.

Could you check how it affects gc-benchmarks/?  :-)

Thank you for being both an efficient and a brave hacker!

Ludo=E2=80=99.


From MAILER-DAEMON Fri Dec 02 13:12:40 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RWXbE-0005sz-O0
	for mharc-guile-devel@gnu.org; Fri, 02 Dec 2011 13:12:40 -0500
Received: from eggs.gnu.org ([140.186.70.92]:33667)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RWXbA-0005sL-Rj
	for guile-devel@gnu.org; Fri, 02 Dec 2011 13:12:38 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RWXb9-0007xS-1E
	for guile-devel@gnu.org; Fri, 02 Dec 2011 13:12:36 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:47640
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RWXb8-0007x6-Ux; Fri, 02 Dec 2011 13:12:34 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 16DA57818;
	Fri,  2 Dec 2011 13:12:33 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; s=sasl; bh=lIKQR9sqPsGq
	Zto9azMniQfyX9k=; b=PB9bgt3tIiO4j80oRaM7M5jTvrg/g2ReGOxvJIDq6jdM
	PiSmbeT+daQbttfdW0si2BXuq3xGOHJTvNeWLCWo4ZDNeQQbyFPL2Cz1QkNIwHdx
	DHAGe7lkzF5Apyd9QURvUn69qx+Nj4I8TBzabhXvzZh/A6Iq19Jwuw+kekCeMjk=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; q=dns; s=sasl; b=paI3zj
	fqZUDyfVANdJ7fLz5pHaqSNbXKOKgxS7DnwipN/j5gZ55LiCvEunSfffdxI3UyES
	MynU+qOD1GfClbZ2OD91PlnZKlxzEe+xN7oppkX3dNuweQncZPdApLFSg9wibVS+
	bVs39oaQxVzhmH0kii+wAGvjaGCdI7iaZThyU=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 0FEF97817;
	Fri,  2 Dec 2011 13:12:33 -0500 (EST)
Received: from badger (unknown [91.117.99.155]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 853777816;
	Fri,  2 Dec 2011 13:12:32 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: ludo@gnu.org (Ludovic =?utf-8?Q?Court=C3=A8s?=)
Subject: Re: [PATCH] Configure GMP to use GC allocation functions, remove
	bignum finalizers
References: <87tycaodlk.fsf@netris.org> <87k4d6edvr.fsf@gnu.org>
	<8739jue9wk.fsf@neil-laptop.ossau.uklinux.net>
	<m362oqne59.fsf@unquote.localdomain> <87zkfh9x8r.fsf@pobox.com>
	<8762i5mf4x.fsf@gnu.org> <874nxj8c00.fsf@pobox.com>
	<877h2enbzk.fsf@gnu.org>
Date: Fri, 02 Dec 2011 19:12:29 +0100
In-Reply-To: <877h2enbzk.fsf@gnu.org> ("Ludovic =?utf-8?Q?Court=C3=A8s=22'?=
	=?utf-8?Q?s?= message of "Fri, 02 Dec 2011 18:02:07 +0100")
Message-ID: <87vcpy7she.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Pobox-Relay-ID: 344B79BE-1D11-11E1-B6C7-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: Neil Jerram <neil@ossau.uklinux.net>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 02 Dec 2011 18:12:38 -0000

Heya,

On Fri 02 Dec 2011 18:02, ludo@gnu.org (Ludovic Court=C3=A8s) writes:

> I guess scm_gc_register_collectable_memory could be
> changed to just call it, ignoring its first argument?

Done.

>> I made scm_realloc call scm_gc_register_allocation.  I also installed
>> custom gmp allocators that call scm_malloc and friends
>
> I was about to say =E2=80=9Cwe can=E2=80=99t do that in 2.0!=E2=80=9D, bu=
t then saw your
> scm_install_gmp_memory_functions trick.  Cool!  :-)

Did you also see that we used to^H^H still `free' the memory returned
from mpz_get_str?  That means that in practice, since the 1.8 days we
did not support other allocators for mp_memory_functions.  For that
reason I defaulted scm_install_gmp_memory_functions to 1.  I will fix
the other instance of scm_take_locale_string.

> Could you make it SCM_INTERNAL instead of SCM_API?

Sure, but you don't want to allow users to set it?

> Could you check how it affects gc-benchmarks/?  :-)

Are there tests for numbers there?  This change would only affect that,
I think.

Cheers,

Andy
--=20
http://wingolog.org/


From MAILER-DAEMON Fri Dec 02 17:17:34 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RWbQE-0001qV-MD
	for mharc-guile-devel@gnu.org; Fri, 02 Dec 2011 17:17:34 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55088)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RWbQB-0001mU-DQ
	for guile-devel@gnu.org; Fri, 02 Dec 2011 17:17:32 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RWbQA-0004ke-8G
	for guile-devel@gnu.org; Fri, 02 Dec 2011 17:17:31 -0500
Received: from mail1-relais-roc.national.inria.fr ([192.134.164.82]:38872)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <ludo@gnu.org>)
	id 1RWbQA-0004kZ-2M
	for guile-devel@gnu.org; Fri, 02 Dec 2011 17:17:30 -0500
X-IronPort-AV: E=Sophos;i="4.71,286,1320620400"; d="scan'208";a="133757697"
Received: from reverse-83.fdn.fr (HELO pluto) ([80.67.176.83])
	by mail1-relais-roc.national.inria.fr with ESMTP/TLS/DHE-RSA-AES128-SHA;
	02 Dec 2011 23:17:27 +0100
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
To: Andy Wingo <wingo@pobox.com>
Subject: Re: [PATCH] Configure GMP to use GC allocation functions,
	remove bignum finalizers
In-Reply-To: <87vcpy7she.fsf@pobox.com> (Andy Wingo's message of "Fri, 02 Dec
	2011 19:12:29 +0100")
References: <87tycaodlk.fsf@netris.org> <87k4d6edvr.fsf@gnu.org>
	<8739jue9wk.fsf@neil-laptop.ossau.uklinux.net>
	<m362oqne59.fsf@unquote.localdomain> <87zkfh9x8r.fsf@pobox.com>
	<8762i5mf4x.fsf@gnu.org> <874nxj8c00.fsf@pobox.com>
	<877h2enbzk.fsf@gnu.org> <87vcpy7she.fsf@pobox.com>
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 12 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
Date: Fri, 02 Dec 2011 23:17:21 +0100
Message-ID: <87y5uuboum.fsf@gnu.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 192.134.164.82
Cc: Neil Jerram <neil@ossau.uklinux.net>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 02 Dec 2011 22:17:32 -0000

Hello!

Andy Wingo <wingo@pobox.com> skribis:

> On Fri 02 Dec 2011 18:02, ludo@gnu.org (Ludovic Court=C3=A8s) writes:
>
>> I guess scm_gc_register_collectable_memory could be
>> changed to just call it, ignoring its first argument?
>
> Done.

Thanks!

>>> I made scm_realloc call scm_gc_register_allocation.  I also installed
>>> custom gmp allocators that call scm_malloc and friends
>>
>> I was about to say =E2=80=9Cwe can=E2=80=99t do that in 2.0!=E2=80=9D, b=
ut then saw your
>> scm_install_gmp_memory_functions trick.  Cool!  :-)
>
> Did you also see that we used to^H^H still `free' the memory returned
> from mpz_get_str?  That means that in practice, since the 1.8 days we
> did not support other allocators for mp_memory_functions.

Oh, OK.

> For that reason I defaulted scm_install_gmp_memory_functions to 1.

Yes, makes sense.

>> Could you make it SCM_INTERNAL instead of SCM_API?
>
> Sure, but you don't want to allow users to set it?

I=E2=80=99d say no, because that will fail gracelessly if it gets set or cl=
eared
in the middle of a run, won=E2=80=99t it?

>> Could you check how it affects gc-benchmarks/?  :-)
>
> Are there tests for numbers there?

I think so, but I=E2=80=99m not sure.  :-)

(There are some details at <http://www.ccs.neu.edu/home/will/GC/sourcecode.=
html>.)

Thanks,
Ludo=E2=80=99.


From MAILER-DAEMON Sat Dec 03 10:50:16 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RWrqy-0005fb-N1
	for mharc-guile-devel@gnu.org; Sat, 03 Dec 2011 10:50:16 -0500
Received: from eggs.gnu.org ([140.186.70.92]:47855)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RWrqw-0005ep-LF
	for guile-devel@gnu.org; Sat, 03 Dec 2011 10:50:15 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RWrqv-0003ha-KN
	for guile-devel@gnu.org; Sat, 03 Dec 2011 10:50:14 -0500
Received: from lo.gmane.org ([80.91.229.12]:43000)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RWrqu-0003hU-SE
	for guile-devel@gnu.org; Sat, 03 Dec 2011 10:50:13 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RWrqt-0001Vn-8p
	for guile-devel@gnu.org; Sat, 03 Dec 2011 16:50:11 +0100
Received: from p508edaa1.dip.t-dialin.net ([80.142.218.161])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sat, 03 Dec 2011 16:50:11 +0100
Received: from dak by p508edaa1.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sat, 03 Dec 2011 16:50:11 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Anything better for delayed lexical evaluation than (lambda () ...)?
Date: Sat, 03 Dec 2011 16:45:06 +0100
Organization: Organization?!?
Lines: 23
Message-ID: <87liqtpsl9.fsf@fencepost.gnu.org>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508edaa1.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:eBNcyZbPa5k1eNmHOtiO8gCAGeI=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sat, 03 Dec 2011 15:50:15 -0000


Hi, if I have something read that is evaluated later, the lack of
procedure-environment in Guilev2 implies that I have to wrap the stuff
in (lambda () ...) in order to capture the lexical environment for
evaluation.

Is it possible to have a shortcut (make-closure ...) or so for that
purpose?  The reason is that if ... is a call to a
procedure-with-setter, (lambda () ...) actually does not cut it for
capturing the semantics of ..., and I need
(make-procedure-with-setter (lambda () ...)
                            (lambda (x) (set! ... x)))

But x is not hygienic, so this is again too simplistic.  And a separate
macro make-closure also could decide that the expression is pure anyway
and not go to the pain of creating an actual closure.

In any way, using (lambda () ...) might have more cases where it just is
not equivalent to the lexical expression inside when macros come into
play.

-- 
David Kastrup



From MAILER-DAEMON Sat Dec 03 11:44:29 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RWshR-0003A5-JD
	for mharc-guile-devel@gnu.org; Sat, 03 Dec 2011 11:44:29 -0500
Received: from eggs.gnu.org ([140.186.70.92]:38297)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RWshP-00039v-LT
	for guile-devel@gnu.org; Sat, 03 Dec 2011 11:44:28 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RWshO-0002yB-2k
	for guile-devel@gnu.org; Sat, 03 Dec 2011 11:44:27 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:37022
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RWshN-0002y1-UM; Sat, 03 Dec 2011 11:44:25 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id EBBED873F;
	Sat,  3 Dec 2011 11:44:24 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; s=sasl; bh=uH4uscUEtg8t
	hOgtf4hwgGoIHCE=; b=KgLyxhHuYCcfqGYz/m6O8LWpdTvC4lhmd1vIyhNLD9Tz
	9QqZMXjWpDrUomfM/1b2Dy7KcE8RxG+aphbySSbk7iewko1qri8LTS+h/vh/Ckhy
	SeEyzlOc4QKPv8QpCp4cPh61uoUZW4cY6yXuKCa4d4PNlPWEc7vh20cbWiwejo8=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; q=dns; s=sasl; b=mTsmXT
	3Zm2+yA6MOg1hpcySk9IDoR9uYAjMvlKQ6gAD1q0rJqCFj8pbrIKM46iy6qyMWpx
	BT8q0AsgZTWAv/6X22rR8k6irxyNbQOvcaXwclSdFfV5w2pD7YMEzVIzVNWDnvsJ
	StFBY2UVUhrOysvcOMrlIRmC1/yFkV+SqzER8=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id E48CF873E;
	Sat,  3 Dec 2011 11:44:24 -0500 (EST)
Received: from badger (unknown [91.117.99.155]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 5CDB3873D;
	Sat,  3 Dec 2011 11:44:24 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: ludo@gnu.org (Ludovic =?utf-8?Q?Court=C3=A8s?=)
Subject: Re: [PATCH] Configure GMP to use GC allocation functions, remove
	bignum finalizers
References: <87tycaodlk.fsf@netris.org> <87k4d6edvr.fsf@gnu.org>
	<8739jue9wk.fsf@neil-laptop.ossau.uklinux.net>
	<m362oqne59.fsf@unquote.localdomain> <87zkfh9x8r.fsf@pobox.com>
	<8762i5mf4x.fsf@gnu.org> <874nxj8c00.fsf@pobox.com>
	<877h2enbzk.fsf@gnu.org>
	<87vcpy7she.fsf@pobox.com> <87y5uuboum.fsf@gnu.org>
Date: Sat, 03 Dec 2011 11:57:31 +0100
In-Reply-To: <87y5uuboum.fsf@gnu.org> ("Ludovic =?utf-8?Q?Court=C3=A8s=22'?=
	=?utf-8?Q?s?= message of "Fri, 02 Dec 2011 23:17:21 +0100")
Message-ID: <87r50l7wis.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Pobox-Relay-ID: 0EB7CB86-1DCE-11E1-993D-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: Neil Jerram <neil@ossau.uklinux.net>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sat, 03 Dec 2011 16:44:28 -0000

On Fri 02 Dec 2011 23:17, ludo@gnu.org (Ludovic Court=C3=A8s) writes:

>> For that reason I defaulted scm_install_gmp_memory_functions to 1.
>
>>> Could you make it SCM_INTERNAL instead of SCM_API?
>>
>> Sure, but you don't want to allow users to set it?
>
> I=E2=80=99d say no, because that will fail gracelessly if it gets set or =
cleared
> in the middle of a run, won=E2=80=99t it?

To use it, you have to set it before scm_init_numbers() runs, as that is
the only place it is checked.  So it should be OK.  We could define a
more procedural interface, if that's useful, but I punted.

Andy
--=20
http://wingolog.org/


From MAILER-DAEMON Sat Dec 03 11:44:37 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RWshZ-0003F9-0A
	for mharc-guile-devel@gnu.org; Sat, 03 Dec 2011 11:44:37 -0500
Received: from eggs.gnu.org ([140.186.70.92]:38383)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RWshW-0003EP-Tp
	for guile-devel@gnu.org; Sat, 03 Dec 2011 11:44:35 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RWshU-00030a-RT
	for guile-devel@gnu.org; Sat, 03 Dec 2011 11:44:34 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:37105
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RWshS-0002zu-Ur; Sat, 03 Dec 2011 11:44:30 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 9B48C8748;
	Sat,  3 Dec 2011 11:44:30 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=502Sup0W854Rs1uE0MbGBycPlm8=; b=gkuM2J
	0Zdac96I4HtsHluFmQ35Z+efdaWUUQPIWPQL+zT/rbkx5KBcRimfYh6qNG+J1Wvl
	E1VNndHQ2jTtu72uMcpHECI/GB+wte87PExtWFJ/sglNIWpAzckM2JGRPy2l612A
	/88X0L3ssmod1oL+VlipG9czPWiHCjEb7qGbU=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=sUUw06Kaw0eErb9QHzzNyKDJS9UpXetL
	IesLVwloA/3n4aPvDUSMYnPT4U29WXyfnA9umIJY07tSATsJDtB4nFt+F9PiAAaV
	boVePL7Bj9SIyfP9ZFFqU0Si729lJd4WzI2WNoE/h43ePfR5jnjAgJecp/wXUjI1
	4rgtX5CH14g=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 9420F8747;
	Sat,  3 Dec 2011 11:44:30 -0500 (EST)
Received: from badger (unknown [91.117.99.155]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id C5D4F8745;
	Sat,  3 Dec 2011 11:44:28 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org>
Date: Sat, 03 Dec 2011 17:44:21 +0100
In-Reply-To: <87liqtpsl9.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Sat, 03 Dec 2011 16:45:06 +0100")
Message-ID: <87mxb97ggq.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 115F802C-1DCE-11E1-B7F7-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sat, 03 Dec 2011 16:44:35 -0000

On Sat 03 Dec 2011 16:45, David Kastrup <dak@gnu.org> writes:

> Hi, if I have something read that is evaluated later, the lack of
> procedure-environment in Guilev2 implies that I have to wrap the stuff
> in (lambda () ...) in order to capture the lexical environment for
> evaluation.
>
> Is it possible to have a shortcut (make-closure ...) or so for that
> purpose?  The reason is that if ... is a call to a
> procedure-with-setter, (lambda () ...) actually does not cut it for
> capturing the semantics of ..., and I need
> (make-procedure-with-setter (lambda () ...)
>                             (lambda (x) (set! ... x)))
>
> But x is not hygienic, so this is again too simplistic.  And a separate
> macro make-closure also could decide that the expression is pure anyway
> and not go to the pain of creating an actual closure.

I'm having a hard time parsing this, as it is very high level.  Could
you give an example of what you are trying to do?

Thanks,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Sat Dec 03 12:57:06 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RWtpi-0001Ag-Uj
	for mharc-guile-devel@gnu.org; Sat, 03 Dec 2011 12:57:06 -0500
Received: from eggs.gnu.org ([140.186.70.92]:43840)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RWtph-00018u-0R
	for guile-devel@gnu.org; Sat, 03 Dec 2011 12:57:05 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RWtpf-0006tM-L1
	for guile-devel@gnu.org; Sat, 03 Dec 2011 12:57:04 -0500
Received: from mail4-relais-sop.national.inria.fr ([192.134.164.105]:16848)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <ludo@gnu.org>)
	id 1RWtpf-0006tG-9r
	for guile-devel@gnu.org; Sat, 03 Dec 2011 12:57:03 -0500
X-IronPort-AV: E=Sophos;i="4.71,290,1320620400"; d="scan'208";a="121930747"
Received: from reverse-83.fdn.fr (HELO pluto) ([80.67.176.83])
	by mail4-relais-sop.national.inria.fr with ESMTP/TLS/DHE-RSA-AES128-SHA;
	03 Dec 2011 18:57:01 +0100
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
To: Andy Wingo <wingo@pobox.com>
Subject: Re: [PATCH] Configure GMP to use GC allocation functions,
	remove bignum finalizers
References: <87tycaodlk.fsf@netris.org> <87k4d6edvr.fsf@gnu.org>
	<8739jue9wk.fsf@neil-laptop.ossau.uklinux.net>
	<m362oqne59.fsf@unquote.localdomain> <87zkfh9x8r.fsf@pobox.com>
	<8762i5mf4x.fsf@gnu.org> <874nxj8c00.fsf@pobox.com>
	<877h2enbzk.fsf@gnu.org> <87vcpy7she.fsf@pobox.com>
	<87y5uuboum.fsf@gnu.org> <87r50l7wis.fsf@pobox.com>
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 13 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
Date: Sat, 03 Dec 2011 18:57:00 +0100
In-Reply-To: <87r50l7wis.fsf@pobox.com> (Andy Wingo's message of "Sat, 03 Dec
	2011 11:57:31 +0100")
Message-ID: <878vmtbksz.fsf@gnu.org>
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 192.134.164.105
Cc: Neil Jerram <neil@ossau.uklinux.net>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sat, 03 Dec 2011 17:57:05 -0000

Andy Wingo <wingo@pobox.com> skribis:

> On Fri 02 Dec 2011 23:17, ludo@gnu.org (Ludovic Court=C3=A8s) writes:
>
>>> For that reason I defaulted scm_install_gmp_memory_functions to 1.
>>
>>>> Could you make it SCM_INTERNAL instead of SCM_API?
>>>
>>> Sure, but you don't want to allow users to set it?
>>
>> I=E2=80=99d say no, because that will fail gracelessly if it gets set or=
 cleared
>> in the middle of a run, won=E2=80=99t it?
>
> To use it, you have to set it before scm_init_numbers() runs, as that is
> the only place it is checked.

OK, it doesn=E2=80=99t hurt to leave it public, then.

Thanks,
Ludo=E2=80=99.


From MAILER-DAEMON Sun Dec 04 10:38:01 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXE8f-0002Ea-3h
	for mharc-guile-devel@gnu.org; Sun, 04 Dec 2011 10:38:01 -0500
Received: from eggs.gnu.org ([140.186.70.92]:44412)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXE8c-0002BS-8k
	for guile-devel@gnu.org; Sun, 04 Dec 2011 10:37:58 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXE8b-00036a-Cc
	for guile-devel@gnu.org; Sun, 04 Dec 2011 10:37:58 -0500
Received: from lo.gmane.org ([80.91.229.12]:55392)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXE8b-00036W-6J
	for guile-devel@gnu.org; Sun, 04 Dec 2011 10:37:57 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXE8a-0007LQ-1J
	for guile-devel@gnu.org; Sun, 04 Dec 2011 16:37:56 +0100
Received: from p508eb953.dip.t-dialin.net ([80.142.185.83])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sun, 04 Dec 2011 16:37:56 +0100
Received: from dak by p508eb953.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sun, 04 Dec 2011 16:37:56 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: What's with `symbol-set!' is deprecated. Use the module system
	instead.
Date: Sun, 04 Dec 2011 16:37:42 +0100
Organization: Organization?!?
Lines: 19
Message-ID: <8762hwmjp5.fsf@fencepost.gnu.org>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508eb953.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:ezuTKgkkz2mjtb4saIXaNKyn0Cw=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sun, 04 Dec 2011 15:37:59 -0000


The module system documentation provides _no_ _clue_ _whatsoever_ about
how something like
(symbol-set! #f (string->symbol name) value)
could be replaced.  In fact, the module system documentation provides
_no_ _clue_ _whatsoever_ how to actually access module variables short
of calling eval on little programs working with symbols.

I don't want to call eval for the simple act of setting a symbol to a
value.

The funny thing is that symbol-fset! and symbol-pset! are documented.
But nothing whatsoever that could set a symbol value itself on a symbol
that has been generated.

What's up with that?

-- 
David Kastrup



From MAILER-DAEMON Sun Dec 04 11:01:28 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXEVM-0006vn-8l
	for mharc-guile-devel@gnu.org; Sun, 04 Dec 2011 11:01:28 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55521)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXEVK-0006vh-5z
	for guile-devel@gnu.org; Sun, 04 Dec 2011 11:01:27 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXEVJ-00077j-5S
	for guile-devel@gnu.org; Sun, 04 Dec 2011 11:01:26 -0500
Received: from lo.gmane.org ([80.91.229.12]:43095)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXEVJ-00077d-0N
	for guile-devel@gnu.org; Sun, 04 Dec 2011 11:01:25 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXEVG-0005Yn-FN
	for guile-devel@gnu.org; Sun, 04 Dec 2011 17:01:22 +0100
Received: from p508eb953.dip.t-dialin.net ([80.142.185.83])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sun, 04 Dec 2011 17:01:22 +0100
Received: from dak by p508eb953.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sun, 04 Dec 2011 17:01:22 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: What's with `symbol-set!' is deprecated. Use the module system
	instead.
Date: Sun, 04 Dec 2011 17:01:10 +0100
Organization: Organization?!?
Lines: 27
Message-ID: <871uskmim1.fsf@fencepost.gnu.org>
References: <8762hwmjp5.fsf@fencepost.gnu.org>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508eb953.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:sPUFAA/Va/B2DB7XJT9KTDg9ALE=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sun, 04 Dec 2011 16:01:27 -0000

David Kastrup <dak@gnu.org> writes:

> The module system documentation provides _no_ _clue_ _whatsoever_ about
> how something like
> (symbol-set! #f (string->symbol name) value)
> could be replaced.  In fact, the module system documentation provides
> _no_ _clue_ _whatsoever_ how to actually access module variables short
> of calling eval on little programs working with symbols.
>
> I don't want to call eval for the simple act of setting a symbol to a
> value.
>
> The funny thing is that symbol-fset! and symbol-pset! are documented.
> But nothing whatsoever that could set a symbol value itself on a symbol
> that has been generated.
>
> What's up with that?

Well, I disassembled enough to come up with
(module-define! (current-module) (string->symbol name) value)

It is not like there is _any_ documentation for this in the manual.

Is this somebody's idea of a joke?

-- 
David Kastrup



From MAILER-DAEMON Sun Dec 04 14:23:01 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXHeP-0001Ic-6s
	for mharc-guile-devel@gnu.org; Sun, 04 Dec 2011 14:23:01 -0500
Received: from eggs.gnu.org ([140.186.70.92]:36821)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <stefan.itampe@gmail.com>) id 1RXHeL-0001F1-IA
	for guile-devel@gnu.org; Sun, 04 Dec 2011 14:22:58 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <stefan.itampe@gmail.com>) id 1RXHeK-0006my-3m
	for guile-devel@gnu.org; Sun, 04 Dec 2011 14:22:57 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:39928)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <stefan.itampe@gmail.com>) id 1RXHeK-0006mo-0a
	for guile-devel@gnu.org; Sun, 04 Dec 2011 14:22:56 -0500
Received: by iapp10 with SMTP id p10so5241227iap.0
	for <guile-devel@gnu.org>; Sun, 04 Dec 2011 11:22:54 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:date:message-id:subject:from:to:content-type;
	bh=N0pWH0EM6rW4YZcuBY5AYei8AgjEPofWtbf97obnJqA=;
	b=QTQXMn/My0qLkvP4zRIDwhwhekpAXGPmzVYxoGdfOdzyXmV3HL4CvEDXg1BHO8IMdr
	FX8BP2mnKqx320FcKDpC0A8w8IBrdX+95HD00RWE3s1fJPX4VIQkdvELgnxUvyJ4dv5p
	P77jgHEOnNC8cYxR7/kjnHJwH2MzipbZItTKE=
MIME-Version: 1.0
Received: by 10.50.76.131 with SMTP id k3mr2136035igw.22.1323026574712; Sun,
	04 Dec 2011 11:22:54 -0800 (PST)
Received: by 10.231.158.74 with HTTP; Sun, 4 Dec 2011 11:22:54 -0800 (PST)
Date: Sun, 4 Dec 2011 20:22:54 +0100
Message-ID: <CAGua6m0XODOL_ge_PhFfMR_e1508fVsFWapM1Yruep3ARKJ83A@mail.gmail.com>
Subject: syntax-local-value
From: Stefan Israelsson Tampe <stefan.itampe@gmail.com>
To: guile-devel <guile-devel@gnu.org>
Content-Type: multipart/alternative; boundary=e89a8f3ba0f103a0d004b349218a
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sun, 04 Dec 2011 19:22:58 -0000

--e89a8f3ba0f103a0d004b349218a
Content-Type: text/plain; charset=ISO-8859-1

In looking at racket syntax-parse there seems to be some advanced macrology
that is not included in guile.

The light now is on the possibility to attach data to macros. I figure that
I could
reproduce this by using a weak hash-table but miss the functionality of

syntax-local-value

e.g.
http://docs.racket-lang.org/reference/stxtrans.html#%28def._%28%28quote._~23~25kernel%29._syntax-local-value%29%29

Basically the possibility to get the macro-object associated to a symbol in
an environment if I have understyand this.

So is there a guile feature that matches this at a reasonable level?

Regards
Stefan

--e89a8f3ba0f103a0d004b349218a
Content-Type: text/html; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

In looking at racket syntax-parse there seems to be some advanced macrology=
<br>that is not included in guile.<br><br>The light now is on the possibili=
ty to attach data to macros. I figure that I could <br>reproduce this by us=
ing a weak hash-table but miss the functionality of<br>
<br>syntax-local-value<br><br>e.g.<br><a href=3D"http://docs.racket-lang.or=
g/reference/stxtrans.html#%28def._%28%28quote._~23~25kernel%29._syntax-loca=
l-value%29%29">http://docs.racket-lang.org/reference/stxtrans.html#%28def._=
%28%28quote._~23~25kernel%29._syntax-local-value%29%29</a><br>
<br>Basically the possibility to get the macro-object associated to a symbo=
l in an environment if I have understyand this.<br><br>So is there a guile =
feature that matches this at a reasonable level?<br><br>Regards<br>Stefan<b=
r>

--e89a8f3ba0f103a0d004b349218a--


From MAILER-DAEMON Sun Dec 04 20:23:05 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXNGr-00005y-3Y
	for mharc-guile-devel@gnu.org; Sun, 04 Dec 2011 20:23:05 -0500
Received: from eggs.gnu.org ([140.186.70.92]:50553)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <a.rottmann@gmx.at>) id 1RXNGo-0008VY-7Q
	for guile-devel@gnu.org; Sun, 04 Dec 2011 20:23:03 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <a.rottmann@gmx.at>) id 1RXNGm-0005yZ-L5
	for guile-devel@gnu.org; Sun, 04 Dec 2011 20:23:02 -0500
Received: from mailout-de.gmx.net ([213.165.64.22]:46560)
	by eggs.gnu.org with smtp (Exim 4.71)
	(envelope-from <a.rottmann@gmx.at>) id 1RXNGm-0005yA-8o
	for guile-devel@gnu.org; Sun, 04 Dec 2011 20:23:00 -0500
Received: (qmail invoked by alias); 05 Dec 2011 01:22:57 -0000
Received: from 85-127-59-92.dynamic.xdsl-line.inode.at (EHLO nathot.lan)
	[85.127.59.92]
	by mail.gmx.net (mp040) with SMTP; 05 Dec 2011 02:22:57 +0100
X-Authenticated: #3102804
X-Provags-ID: V01U2FsdGVkX1+SO/B+RJqSr7WUKIwGb7MTL6Ik6R8oAuhh0+t1M9
	uoz329+KDN+sGd
Received: from localhost (localhost.localdomain [127.0.0.1])
	by nathot.lan (Postfix) with ESMTP id 2C2963A68F;
	Mon,  5 Dec 2011 02:22:56 +0100 (CET)
Received: from nathot.lan ([127.0.0.1])
	by localhost (nathot.lan [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id SWtQt5B3op0i; Mon,  5 Dec 2011 02:22:51 +0100 (CET)
Received: from delenn.lan (delenn.lan [192.168.3.11])
	by nathot.lan (Postfix) with ESMTP id D92283A685;
	Mon,  5 Dec 2011 02:22:51 +0100 (CET)
Received: by delenn.lan (Postfix, from userid 1000)
	id 992203A22D7; Mon,  5 Dec 2011 02:22:51 +0100 (CET)
From: Andreas Rottmann <a.rottmann@gmx.at>
To: G-Wrap development <g-wrap-dev@nongnu.org>
Subject: G-Wrap 1.9.14 released
Date: Mon, 05 Dec 2011 02:22:51 +0100
Message-ID: <87iplvzuac.fsf@rotty.yi.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.91 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-Y-GMX-Trusted: 0
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 213.165.64.22
Cc: Guile Users <guile-user@gnu.org>, Guile Development <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 05 Dec 2011 01:23:03 -0000

Hi!

I'm pleased to announce G-Wrap 1.9.14; as always, it can be downloaded
from <http://www.nongnu.org/g-wrap/>.

This release adds support for the Guile 2.0.x branch, while staying
compatible with 1.8.x.

About G-Wrap:

  G-Wrap is a tool (and Guile library) for generating function wrappers
  for inter-language calls. It currently only supports generating Guile
  wrappers for C functions.

Changes since 1.9.13:

    - Guile 2.0 is now supported.

    - G-Wrap no longer ships SRFI 34 and SRFI 35 implementations, as
      these have been both provided by Guile since 1.8.3.

Regards, Rotty
-- 
Andreas Rottmann -- <http://rotty.yi.org/>


From MAILER-DAEMON Mon Dec 05 03:11:46 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXTeM-0003q1-7T
	for mharc-guile-devel@gnu.org; Mon, 05 Dec 2011 03:11:46 -0500
Received: from eggs.gnu.org ([140.186.70.92]:42958)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXTeJ-0003oD-3N
	for guile-devel@gnu.org; Mon, 05 Dec 2011 03:11:44 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXTeI-0000sU-4e
	for guile-devel@gnu.org; Mon, 05 Dec 2011 03:11:43 -0500
Received: from lo.gmane.org ([80.91.229.12]:34978)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXTeH-0000sO-Qg
	for guile-devel@gnu.org; Mon, 05 Dec 2011 03:11:42 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXTeF-0007vu-N2
	for guile-devel@gnu.org; Mon, 05 Dec 2011 09:11:39 +0100
Received: from p508ec74f.dip.t-dialin.net ([80.142.199.79])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Mon, 05 Dec 2011 09:11:39 +0100
Received: from dak by p508ec74f.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Mon, 05 Dec 2011 09:11:39 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: What's with `symbol-set!' is deprecated. Use the module system
	instead.
Date: Mon, 05 Dec 2011 09:11:27 +0100
Organization: Organization?!?
Lines: 42
Message-ID: <87hb1fo2ts.fsf@fencepost.gnu.org>
References: <8762hwmjp5.fsf@fencepost.gnu.org>
	<871uskmim1.fsf@fencepost.gnu.org>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ec74f.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:6xZhx1VKKFhyrx4ZdECNvdfQ5m4=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 05 Dec 2011 08:11:44 -0000

David Kastrup <dak@gnu.org> writes:

> David Kastrup <dak@gnu.org> writes:
>
>> The module system documentation provides _no_ _clue_ _whatsoever_ about
>> how something like
>> (symbol-set! #f (string->symbol name) value)
>> could be replaced.  In fact, the module system documentation provides
>> _no_ _clue_ _whatsoever_ how to actually access module variables short
>> of calling eval on little programs working with symbols.
>>
>> I don't want to call eval for the simple act of setting a symbol to a
>> value.
>>
>> The funny thing is that symbol-fset! and symbol-pset! are documented.
>> But nothing whatsoever that could set a symbol value itself on a symbol
>> that has been generated.
>>
>> What's up with that?
>
> Well, I disassembled enough to come up with
> (module-define! (current-module) (string->symbol name) value)
>
> It is not like there is _any_ documentation for this in the manual.
>
> Is this somebody's idea of a joke?

Apparently.  The C interface offers scm_define which works fine for this
purpose.  But on the Scheme side, there is _no_ equivalent to Lisp's set
(rather than setq or setf).  What is one supposed to do?

(define-macro (mydef! name . rest) `(define ,(primitive-eval name) ,@rest))

Is this supposed to be a puzzle?  Why is there _no_, I repeat _no_
documented way of setting a symbol that is not given literally to a
value?  Neither in the straight way (as with C's scm_define which is a
function rather than a macro and thus useful for this purpose), nor in
connection with modules (since neither module-define! nor module-set!
are documented anywhere).

-- 
David Kastrup



From MAILER-DAEMON Mon Dec 05 09:41:55 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXZjv-0004R9-Pq
	for mharc-guile-devel@gnu.org; Mon, 05 Dec 2011 09:41:55 -0500
Received: from eggs.gnu.org ([140.186.70.92]:40059)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXZjo-0004Ep-8n
	for guile-devel@gnu.org; Mon, 05 Dec 2011 09:41:54 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXZjf-00056R-Q4
	for guile-devel@gnu.org; Mon, 05 Dec 2011 09:41:48 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:64465
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXZjf-00056N-Jv
	for guile-devel@gnu.org; Mon, 05 Dec 2011 09:41:39 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id BC91D7DC5;
	Mon,  5 Dec 2011 09:41:38 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=5lCdRzkXibGb6wih/k2aJ/A0VGU=; b=gfnfjD
	sfMQSARkkB6cXKH/ivSWkSk/ws3G0a839M1qOm2TCQnODpBJRd+fyzG3/YBAOMCZ
	vot1MqG+txT+dIzz37Mf7nZM0oAs9XtHs8Mf+0xFNjL/Ja0aaLY9bWtYrrvn388L
	H8oia3FxUSSmdfQ8S9N3xQaEecuGG4iWwz2Bw=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=Ghs/T2AoS72yMGG2tJ8aUSsp7LvpnADY
	YLY3DOuxO1+qyHUduthkQzM1rcYGX2mDfGdGwVMc7Tpu9Qewc7ugQDTUfMGWh+qt
	HVcndMoAtxkYc3cSeQZibCI5Y1+oQNaqqB7jexI+6GnkHqBUKvL4RO+Nf681b3IA
	xEj7NFl+aHg=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id B5B957DC4;
	Mon,  5 Dec 2011 09:41:38 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 253F17DB1;
	Mon,  5 Dec 2011 09:41:38 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Neil Jerram <neil@ossau.uklinux.net>
Subject: Re: WRITE & linefeed
References: <m3ei2pmrze.fsf@Kagami.home>
	<87fwn1r0xo.fsf@neil-laptop.ossau.uklinux.net>
Date: Sun, 04 Dec 2011 22:37:33 +0100
In-Reply-To: <87fwn1r0xo.fsf@neil-laptop.ossau.uklinux.net> (Neil Jerram's
	message of "Wed, 22 Jun 2011 22:49:55 +0100")
Message-ID: <87liqs9fxe.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 3CEF58B6-1F4F-11E1-A8FC-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: Ian Price <ianprice90@googlemail.com>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 05 Dec 2011 14:41:54 -0000

Hi,

On Wed 22 Jun 2011 23:49, Neil Jerram <neil@ossau.uklinux.net> writes:

> Ian Price <ianprice90@googlemail.com> writes:
>
>> There's a small aesthetic issue that's been bothering me for a
>> while. Namely, newlines aren't treated like other escape sequences when
>> printed with WRITE.
>>
>> scheme@(guile-user)> (write "\n")
>> "
>> "
>
> I agree, but I can imagine that there is a case for the current
> behaviour too, and it's nice to preserve back-compatibility.  Emacs has
> `print-escape-newlines', and I guess we need something like that here -
> an addition to `print-options'?

Good idea.  I implemented this, and will push by the time you get this
mail.  The default is to escape newlines.

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Mon Dec 05 09:41:59 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXZjz-0004eF-Sh
	for mharc-guile-devel@gnu.org; Mon, 05 Dec 2011 09:41:59 -0500
Received: from eggs.gnu.org ([140.186.70.92]:40102)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXZjt-0004QN-Ti
	for guile-devel@gnu.org; Mon, 05 Dec 2011 09:41:58 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXZjm-00057F-3d
	for guile-devel@gnu.org; Mon, 05 Dec 2011 09:41:53 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:64602
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RXZjm-00057B-0v; Mon, 05 Dec 2011 09:41:46 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id C28547DF2;
	Mon,  5 Dec 2011 09:41:45 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; s=sasl; bh=R8Ul5p3peEES
	bMhWeLl5qH3cajc=; b=TCxyWYwND+N208kAmgVuMNoIzeBl+rbITb11SQq6S7Gg
	kz2hkRuwEGINaApHnDNljF2l9yyTFLpwgsTI/4cb/XBHatvptKlIDQ5vf16VCYX8
	/Tf9E1bqpGFYJ64Eeo1T8pb8nDzw4zJX593aGQzd4V6B4gzBWs12xrWiGL5WNQQ=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; q=dns; s=sasl; b=stRKv/
	yLp/qHMwNPPLML8R59nij3+vLnOY+vxqRaQtoPj0InEf4ah4Jvd7qD2ZiVYO9VNe
	9ZrZvaG9cLBwJD53wCsWpx3TdkNTca1W4v3vBJjOa0yvFkMfCkwmGtzxW0CAR8GT
	NQqQhb12hD6x6PPJKKVRbUEQzWeTcWEhHpnZo=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id BC5FE7DF1;
	Mon,  5 Dec 2011 09:41:45 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 1C3227DF0;
	Mon,  5 Dec 2011 09:41:44 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: ludo@gnu.org (Ludovic =?utf-8?Q?Court=C3=A8s?=)
Subject: Re: pollfd-offset
References: <87sjr160wy.fsf@inria.fr>
Date: Sun, 04 Dec 2011 22:45:36 +0100
In-Reply-To: <87sjr160wy.fsf@inria.fr> ("Ludovic =?utf-8?Q?Court=C3=A8s=22?=
	=?utf-8?Q?'s?= message of "Wed, 22 Jun 2011 16:24:35 +0200")
Message-ID: <87hb1g9fjz.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Pobox-Relay-ID: 412540D0-1F4F-11E1-AD64-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 05 Dec 2011 14:41:58 -0000

On Wed 22 Jun 2011 16:24, ludo@gnu.org (Ludovic Court=C3=A8s) writes:

>   (define-syntax pollfd-offset
>     (syntax-rules ()
>       ((_ n) (* n 8))))
>
> I guess 8 is really sizeof (struct pollfd), right?
>
> In that case, how about getting it at configure time and exporting it
> from C?

Done, sorta ;)  You'll see.

Andy
--=20
http://wingolog.org/


From MAILER-DAEMON Mon Dec 05 09:42:04 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXZk4-0004j0-VX
	for mharc-guile-devel@gnu.org; Mon, 05 Dec 2011 09:42:04 -0500
Received: from eggs.gnu.org ([140.186.70.92]:40098)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXZjs-0004Pt-HS
	for guile-devel@gnu.org; Mon, 05 Dec 2011 09:42:03 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXZji-00056p-EN
	for guile-devel@gnu.org; Mon, 05 Dec 2011 09:41:52 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:64535
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXZji-00056j-9X
	for guile-devel@gnu.org; Mon, 05 Dec 2011 09:41:42 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 1AFBF7DC8;
	Mon,  5 Dec 2011 09:41:42 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=K9Ji80vEmWuaqm7RekajHsAiBEY=; b=GI/14N
	EaYoTE6rbWr1+MmL9Ldzq8k5gJLszRtOT42DZ8Iu6+RQCTl1BPG1rXH3BeLtMzGm
	6ijMesd1OuUXXABgz9KvliRooJ1yRQ9AbAxJHiqw/Sm3JILgSsgnxFB2G2paEomn
	HNmD0Utct1nHZmuImez7hHvTJiIeRCt55pJFs=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=OXfoFgI49H+0WlKHr7rm56uuHpAt8sXt
	mnBTPT7II9UYjLSs153FkQBU/p2vOESOBpz0bzr8llAEplB6uy+5YE2EqQEj4Oih
	2Qv2f2cRHFU0A7jvXhefIi4jrGf2KPITeV6+s8+bcVq7cXh6Wzj0+aUpWV99pTLq
	uDrHR4y6hTU=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 146147DC7;
	Mon,  5 Dec 2011 09:41:42 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 7E4C57DC6;
	Mon,  5 Dec 2011 09:41:41 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: BT Templeton <bpt@hcoop.net>
Subject: Re: *current-language*
References: <87pqmjj0zo.fsf@olor.terpri.org>
Date: Sun, 04 Dec 2011 22:01:44 +0100
In-Reply-To: <87pqmjj0zo.fsf@olor.terpri.org> (BT Templeton's message of
	"Sat, 11 Jun 2011 21:24:11 -0400")
Message-ID: <87vcpw9hl3.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 3EF072A8-1F4F-11E1-B6AC-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 05 Dec 2011 14:42:03 -0000

Hello June!

On Sun 12 Jun 2011 03:24, BT Templeton <bpt@hcoop.net> writes:

> What is `*current-language*' supposed to be used for?

It is supposed to be a default language for the compiler and other
things that are interested in languages.

> I see that it's
> set by `(@ (ice-9 eval-string) read-and-eval)' and by `(@ (system base
> compile) read-and-compile)', but not by the REPL.

That's a bug.  Fixed, thanks for the report!

> I think it might be preferable to require explicit language arguments to
> all compilation functions, or to default to Scheme explicitly.

We can change this in 2.2 I think if we want to.  But do we want to?  It
seems like a classic use for dynamic scoping.

> --- a/module/system/base/compile.scm
> +++ b/module/system/base/compile.scm
> @@ -120,9 +120,18 @@
>           (and (false-if-exception (ensure-writable-dir (dirname f)))
>                f))))
>  
> +(define (guess-file-language file)
> +  (cond
> +   ((string-suffix? ".scm" file)
> +    (lookup-language 'scheme))
> +   ((string-suffix? ".el" file)
> +    (lookup-language 'elisp))
> +   (else
> +    (current-language))))
> +
>  (define* (compile-file file #:key
>                         (output-file #f)
> -                       (from (current-language))
> +                       (from (guess-file-language file))

I guess in general I'd prefer something like Racket's #!lang directives,
though I'm not opposed to this approach.  Dunno!

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Mon Dec 05 09:42:09 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXZk9-0004qA-Ap
	for mharc-guile-devel@gnu.org; Mon, 05 Dec 2011 09:42:09 -0500
Received: from eggs.gnu.org ([140.186.70.92]:40160)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXZk1-0004iT-VI
	for guile-devel@gnu.org; Mon, 05 Dec 2011 09:42:07 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXZjs-000585-CG
	for guile-devel@gnu.org; Mon, 05 Dec 2011 09:42:01 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:64401
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXZjs-00056B-A7
	for guile-devel@gnu.org; Mon, 05 Dec 2011 09:41:52 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 671C07DAC;
	Mon,  5 Dec 2011 09:41:34 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=APVTOfkA3dFNzTZAvc7SeaYFN4A=; b=ETeIO0
	WB6ix58dES2ARB5Igznsxz/N5RP1CXqJXsETUBqBwmnLpnaE4ohYuydeq1thRzZ5
	g0Z75XsNEN9W13mkLvv8PTnVT5tq+8r6tJBsheZLqP7sgyC3CvMWLaPj1Wz0EkFw
	ccbeijjpfK4MzhdAF1PY8fA9TqdSNh7lu54I4=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=U2jnyYTTklCjIsrvG6SliXOPsFKbMZcE
	cBKwD0MbJR1kKkatHJo755Vtpe/mBbjGS7MivuV1z6HulgRtd1PVrMBW1Vyzt+fK
	AnXmiq8IN/++UbssZ2LpxIS6WBuB/NKST4L05prhUeOBZsRn3AxpvwdraIGxGumn
	ZxCt1o53GNA=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 60C757DA3;
	Mon,  5 Dec 2011 09:41:34 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id CDC497DA2;
	Mon,  5 Dec 2011 09:41:33 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: BT Templeton <bpt@hcoop.net>
Subject: Re: ELisp Implementation?
References: <BANLkTin1axe0aGKk9f2ebjxk0Q+5v1GpjQ@mail.gmail.com>
	<87fwm0171o.fsf@olor.terpri.org>
Date: Mon, 05 Dec 2011 13:40:04 +0100
In-Reply-To: <87fwm0171o.fsf@olor.terpri.org> (BT Templeton's message of
	"Thu, 21 Jul 2011 02:28:35 -0400")
Message-ID: <87hb1fry3f.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 3A5DABAC-1F4F-11E1-A5C9-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 05 Dec 2011 14:42:07 -0000

Heya BT,

On Thu 21 Jul 2011 08:28, BT Templeton <bpt@hcoop.net> writes:

> * Buffer-local variable support
> * Condition handling, property lists, other new subrs
> * Variable and function aliases
> * Emacs-compatible lexbind
> * Compatibility fixes
> * Most subrs and macros are now written in Elisp
> * Emacs with libgc (it works, but leaks memory)
>
> You can view some of this work in the git repo, branch `bt/master':
>
>   http://git.hcoop.net/?p=bpt/guile.git;a=summary
>   git://git.hcoop.net/git/bpt/guile.git

I (finally) looked at merging this in to stable-2.0 yesterday.  It
looked great; there were a couple of conflicts due to subsequent
development, but nothing serious.  However after merging, I saw some
elisp tests failing.  Perhaps I did the merge wrongly?  Would you mind
taking a look at it?

Thanks, and again, apologies for not merging this sooner!

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Mon Dec 05 09:55:20 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXZwu-0003WV-MH
	for mharc-guile-devel@gnu.org; Mon, 05 Dec 2011 09:55:20 -0500
Received: from eggs.gnu.org ([140.186.70.92]:53853)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXZwr-0003Vw-3A
	for guile-devel@gnu.org; Mon, 05 Dec 2011 09:55:18 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXZwm-0007oD-P9
	for guile-devel@gnu.org; Mon, 05 Dec 2011 09:55:16 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:45573
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RXZwg-0007li-9l; Mon, 05 Dec 2011 09:55:06 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 6CA6F7F97;
	Mon,  5 Dec 2011 09:55:05 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=maEc1Fu1y+ykV4VbDfoY4HXhRHo=; b=OUV9rR
	ptUhNmKNH9sWaN/jUsX5lgpRCi8Phx5ux2wtdHhdsjs244cKwWLkS5pgemH1hGVk
	Za37dz7OOWqqpPV6bekDV/QW8sF7seJAJwRjjdJqUuf/gKxZ+sSAeqmGbKtFbGdu
	MN11KrRHtRfh1AIQ8x9Flc/6Aye1FwoHf7Bms=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=SqgUxXyl5Rte1KrKCFSEoW79lCbHSkJB
	EiOm+mvIXNfnlp3W0g12dL7qT5MfIKHe3fBaI7Nl7gzJumB0GRn4guyZEerjWpxm
	jlH8MHfB0Y5r6mxudv9ZA237AZVpqJ7sR2sFL4gylxZt4rnvJ6QweSl65kMYHeCz
	/z1SJZPmZaA=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 557017F96;
	Mon,  5 Dec 2011 09:55:05 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id B40A17F94;
	Mon,  5 Dec 2011 09:55:03 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: What's with `symbol-set!' is deprecated. Use the module system
	instead.
References: <8762hwmjp5.fsf@fencepost.gnu.org>
	<871uskmim1.fsf@fencepost.gnu.org> <87hb1fo2ts.fsf@fencepost.gnu.org>
Date: Mon, 05 Dec 2011 15:54:59 +0100
In-Reply-To: <87hb1fo2ts.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Mon, 05 Dec 2011 09:11:27 +0100")
Message-ID: <878vmrrruk.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 1D19BED0-1F51-11E1-9235-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 05 Dec 2011 14:55:18 -0000

Hello David,

On Mon 05 Dec 2011 09:11, David Kastrup <dak@gnu.org> writes:

> David Kastrup <dak@gnu.org> writes:
>
>>> (symbol-set! #f (string->symbol name) value)
>> (module-define! (current-module) (string->symbol name) value)

Indeed, the module system needs better documentation.

>> Is this somebody's idea of a joke?

It might be!  I personally can't say though, as things have been this
way for longer than my time in Guile.

> Apparently.  The C interface offers scm_define which works fine for this
> purpose.

Yes.  Version 2.0.x has better-documented interfaces, here:

  http://www.gnu.org/software/guile/manual/html_node/Accessing-Modules-from-C.html

The Scheme equivalents are not documented as well, however.  Definitely
a bug, there.

Regards,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Mon Dec 05 12:15:28 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXc8W-0008Nq-3r
	for mharc-guile-devel@gnu.org; Mon, 05 Dec 2011 12:15:28 -0500
Received: from eggs.gnu.org ([140.186.70.92]:43284)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXc8S-0008IC-TX
	for guile-devel@gnu.org; Mon, 05 Dec 2011 12:15:26 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXc8R-00031y-Go
	for guile-devel@gnu.org; Mon, 05 Dec 2011 12:15:24 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:41130
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXc8R-00031q-Bb
	for guile-devel@gnu.org; Mon, 05 Dec 2011 12:15:23 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id CF6AD72E3;
	Mon,  5 Dec 2011 12:15:22 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=JC/bsnkxMhVvpKonkU9efbmj2FA=; b=kAICyv
	DTorQRwXcyxu6FOXI0/amLDf/0vjBhq45JePXiAWqpsbbRinCXRS1gaMY/eyExIm
	kssOtPssVoqNY38cfqAR28Y5jHT4CRqj55PWNKmCg5lm2YNSyQWIw6ir0QTNpRct
	wj4mSbyDiYw0qCujKXDB9FMftaOz7kSaLb7k8=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=YAVQBKN25pIG6/hhb/5kH9qS55vHNY22
	k9YZ71/eE6MUfSr6hj7I4YHihNa+BL1QYu/jHhww4uUyNQbeN8K4qDxaPeZ512JF
	b5jLAIdzQlI+aujf+YqFr02QD5SRJysqLPS1RC2LBNu5KCtr1fegX011DBA8nl5Y
	KyMKrrPmFY4=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id C749A72E1;
	Mon,  5 Dec 2011 12:15:22 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 31C2B72E0;
	Mon,  5 Dec 2011 12:15:22 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Andreas Rottmann <a.rottmann@gmx.at>
Subject: Re: How can I tell guile to shut up? ;)
References: <99db88be1896528082d33a77ec4cadbe.squirrel@webmail.kapsi.fi>
	<m3tyejy27f.fsf@unquote.localdomain> <87y60lsjx5.fsf@pobox.com>
	<87r56cxgax.fsf@rotty.yi.org>
Date: Mon, 05 Dec 2011 18:15:18 +0100
In-Reply-To: <87r56cxgax.fsf@rotty.yi.org> (Andreas Rottmann's message of
	"Thu, 30 Jun 2011 03:24:06 +0200")
Message-ID: <874nxfrlcp.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: B6E76658-1F64-11E1-87AD-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel <guile-devel@gnu.org>,
	Juhani =?utf-8?Q?Viher=C3=A4koski?= <moonshine@kapsi.fi>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 05 Dec 2011 17:15:26 -0000

Hi,

On Thu 30 Jun 2011 03:24, Andreas Rottmann <a.rottmann@gmx.at> writes:

> Andy Wingo <wingo@pobox.com> writes:
>
>> After some thinking, the base thing to do is just to add a warning port,
>> and make warnings (non-fatal informative messages) write to that port.
>> I have done this in the attached patches.

I have pushed patches implementing (current-warning-port) to
stable-2.0.  Now we need some command-line arg to silence the warning
port :)

> How about (especially since it looks like R7RS will include a subset
> of it in the small language) moving SRFI 39 into the core and using
> that?

I have done this as well, following the discussion in this thread.

Regards,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Mon Dec 05 13:12:36 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXd1o-0006ub-D1
	for mharc-guile-devel@gnu.org; Mon, 05 Dec 2011 13:12:36 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55793)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <stefan.itampe@gmail.com>) id 1RXd1k-0006si-DM
	for guile-devel@gnu.org; Mon, 05 Dec 2011 13:12:33 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <stefan.itampe@gmail.com>) id 1RXd1i-0007D0-Qf
	for guile-devel@gnu.org; Mon, 05 Dec 2011 13:12:32 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:40365)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <stefan.itampe@gmail.com>) id 1RXd1i-0007Cw-EN
	for guile-devel@gnu.org; Mon, 05 Dec 2011 13:12:30 -0500
Received: by iapp10 with SMTP id p10so7068941iap.0
	for <guile-devel@gnu.org>; Mon, 05 Dec 2011 10:12:30 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:date:message-id:subject:from:to:content-type;
	bh=5T84/p67pU7dUwbNHui3n6CvoTY1SN3Gr3xbl7KJz+Y=;
	b=x1BRVHhZa0e9d0Mzz94BHHHfLzoHDi7gOqy/eXcGXaihWDzms8dOuXstAghZiSo49G
	uU8kIAi9GjMlrnp9qYS0WSuaEEoyNCzSJ66CefOLOFAZNYUt6O70aNHrhZ4W2dc8VflM
	nZH9ajj4lSwb7nD5m3UsPZjqfadbkBwW2DTEs=
MIME-Version: 1.0
Received: by 10.42.202.17 with SMTP id fc17mr10768219icb.15.1323108748605;
	Mon, 05 Dec 2011 10:12:28 -0800 (PST)
Received: by 10.231.158.74 with HTTP; Mon, 5 Dec 2011 10:12:28 -0800 (PST)
Date: Mon, 5 Dec 2011 19:12:28 +0100
Message-ID: <CAGua6m0syo=-jz9rxfcPr4NTuirRPFevZ89wHKVF_zi3OAgbig@mail.gmail.com>
Subject: syntax-local-value patch for discussion
From: Stefan Israelsson Tampe <stefan.itampe@gmail.com>
To: guile-devel <guile-devel@gnu.org>
Content-Type: multipart/mixed; boundary=20cf3010e71ff5bae904b35c4237
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 05 Dec 2011 18:12:33 -0000

--20cf3010e71ff5bae904b35c4237
Content-Type: multipart/alternative; boundary=20cf3010e71ff5bae504b35c4235

--20cf3010e71ff5bae504b35c4235
Content-Type: text/plain; charset=ISO-8859-1

So I tried to get hold of the macro binding. So with the following patch
wich should be enogh
for me to make progress porting rackets syntax parse to guile.

Would be very glad if we could find a interface to expose this information
that is sane
and rigid manner. So we should discuss this feature.

Anyway about the patch.
I added a fluid that is setted with a closure that captures enough syntax
information
so that we can lookup the macro value local or global. It basically uses
the same method
as psyntax macroexpander.

Now we can write,
(define-syntax info
  (lambda (x)
    (syntax-case x ()
      ((_ x)
        (pk (syntax-binding-info (syntax->datum #'x)))
        #'#f))))

and calling this in an example lead to
(let-syntax ((a (lambda (x) #'#f)))
      (info a))

;;; ((macro . #<procedure 1a68480 at ice-9/eval.scm:396:13 (a)>))

or

 (let ((a 1)) (info a))
    ((lexical . #{a 310}#))

So with this I can attach meta information to macros local or not by using
a weak hash.

Anyway a hack but it shows what is needed.

Happy Hacking :-)

---------- Forwarded message ----------
From: Stefan Israelsson Tampe <stefan.itampe@gmail.com>
Date: Sun, Dec 4, 2011 at 8:22 PM
Subject: syntax-local-value
To: guile-devel <guile-devel@gnu.org>


In looking at racket syntax-parse there seems to be some advanced macrology
that is not included in guile.

The light now is on the possibility to attach data to macros. I figure that
I could
reproduce this by using a weak hash-table but miss the functionality of

syntax-local-value

e.g.
http://docs.racket-lang.org/reference/stxtrans.html#%28def._%28%28quote._~23~25kernel%29._syntax-local-value%29%29<http://docs.racket-lang.org/reference/stxtrans.html#%28def._%28%28quote._%7E23%7E25kernel%29._syntax-local-value%29%29>

Basically the possibility to get the macro-object associated to a symbol in
an environment if I have understyand this.

So is there a guile feature that matches this at a reasonable level?

Regards
Stefan

--20cf3010e71ff5bae504b35c4235
Content-Type: text/html; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

So I tried to get hold of the macro binding. So with the following patch wi=
ch should be enogh<br>for me to make progress porting rackets syntax parse =
to guile.<br><br>Would be very glad if we could find a interface to expose =
this information that is sane<br>
and rigid manner. So we should discuss this feature.<br><br>Anyway about th=
e patch.<br>I added a fluid that is setted with a closure that captures eno=
ugh syntax information<br>so that we can lookup the macro value local or gl=
obal. It basically uses the same method <br>
as psyntax macroexpander.<br><br>Now we can write,<br>(define-syntax info <=
br>=A0 (lambda (x) <br>=A0=A0=A0 (syntax-case x () <br>=A0=A0=A0=A0=A0 ((_ =
x) <br>=A0=A0=A0=A0=A0=A0=A0 (pk (syntax-binding-info (syntax-&gt;datum #&#=
39;x))) <br>=A0=A0=A0=A0=A0=A0=A0 #&#39;#f))))<br>
<br>and calling this in an example lead to <br>(let-syntax ((a (lambda (x) =
#&#39;#f))) <br>=A0=A0=A0=A0=A0 (info a))<br><br>;;; ((macro . #&lt;procedu=
re 1a68480 at ice-9/eval.scm:396:13 (a)&gt;))<br><br>or<br><br>=A0(let ((a =
1)) (info a))<br>
=A0=A0=A0 ((lexical . #{a 310}#))<br><br>So with this I can attach meta inf=
ormation to macros local or not by using a weak hash.<br><br>Anyway a hack =
but it shows what is needed.<br><br>Happy Hacking :-)<br><br><div class=3D"=
gmail_quote">
---------- Forwarded message ----------<br>From: <b class=3D"gmail_senderna=
me">Stefan Israelsson Tampe</b> <span dir=3D"ltr">&lt;<a href=3D"mailto:ste=
fan.itampe@gmail.com">stefan.itampe@gmail.com</a>&gt;</span><br>Date: Sun, =
Dec 4, 2011 at 8:22 PM<br>
Subject: syntax-local-value<br>To: guile-devel &lt;<a href=3D"mailto:guile-=
devel@gnu.org">guile-devel@gnu.org</a>&gt;<br><br><br>In looking at racket =
syntax-parse there seems to be some advanced macrology<br>that is not inclu=
ded in guile.<br>
<br>The light now is on the possibility to attach data to macros. I figure =
that I could <br>reproduce this by using a weak hash-table but miss the fun=
ctionality of<br>
<br>syntax-local-value<br><br>e.g.<br><a href=3D"http://docs.racket-lang.or=
g/reference/stxtrans.html#%28def._%28%28quote._%7E23%7E25kernel%29._syntax-=
local-value%29%29" target=3D"_blank">http://docs.racket-lang.org/reference/=
stxtrans.html#%28def._%28%28quote._~23~25kernel%29._syntax-local-value%29%2=
9</a><br>

<br>Basically the possibility to get the macro-object associated to a symbo=
l in an environment if I have understyand this.<br><br>So is there a guile =
feature that matches this at a reasonable level?<br><br>Regards<span class=
=3D"HOEnZb"><font color=3D"#888888"><br>
Stefan<br>
</font></span></div><br>

--20cf3010e71ff5bae504b35c4235--
--20cf3010e71ff5bae904b35c4237
Content-Type: text/x-patch; charset=US-ASCII; name="boot-9-local-binding.diff"
Content-Disposition: attachment; filename="boot-9-local-binding.diff"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gvtsvens0

ZGlmZiAtLWdpdCBhL21vZHVsZS9pY2UtOS9ib290LTkuc2NtIGIvbW9kdWxlL2ljZS05L2Jvb3Qt
OS5zY20KaW5kZXggNWFjMDFiOC4uNjE5ZDc2MSAxMDA2NDQKLS0tIGEvbW9kdWxlL2ljZS05L2Jv
b3QtOS5zY20KKysrIGIvbW9kdWxlL2ljZS05L2Jvb3QtOS5zY20KQEAgLTM4Niw2ICszODYsNyBA
QCBJZiB0aGVyZSBpcyBubyBoYW5kbGVyIGF0IGFsbCwgR3VpbGUgcHJpbnRzIGFuIGVycm9yIGFu
ZCB0aGVuIGV4aXRzLiIKIChkZWZpbmUgZ2VuZXJhdGUtdGVtcG9yYXJpZXMgI2YpCiAoZGVmaW5l
IGJvdW5kLWlkZW50aWZpZXI9PyAjZikKIChkZWZpbmUgZnJlZS1pZGVudGlmaWVyPT8gI2YpCiso
ZGVmaW5lIHN5bnRheC1iaW5kaW5nLWluZm8gI2YpCiAKIDs7ICRzYy1kaXNwYXRjaCBpcyBhbiBp
bXBsZW1lbnRhdGlvbiBkZXRhaWwgb2YgcHN5bnRheC4gSXQgaXMgdXNlZCBieQogOzsgZXhwYW5k
ZWQgbWFjcm9zLCB0byBkaXNwYXRjaCBhbiBpbnB1dCBhZ2FpbnN0IGEgc2V0IG9mIHBhdHRlcm5z
Lgo=
--20cf3010e71ff5bae904b35c4237
Content-Type: text/x-patch; charset=US-ASCII; name="psyntax-local-binding.diff"
Content-Disposition: attachment; filename="psyntax-local-binding.diff"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gvtsw6p01

ZGlmZiAtLWdpdCBhL21vZHVsZS9pY2UtOS9wc3ludGF4LnNjbSBiL21vZHVsZS9pY2UtOS9wc3lu
dGF4LnNjbQppbmRleCBlNTIyZjU0Li43MDQ2M2E1IDEwMDY0NAotLS0gYS9tb2R1bGUvaWNlLTkv
cHN5bnRheC5zY20KKysrIGIvbW9kdWxlL2ljZS05L3BzeW50YXguc2NtCkBAIC0xNTUsNiArMTU1
LDEwIEBACiAoZXZhbC13aGVuIChjb21waWxlKQogICAoc2V0LWN1cnJlbnQtbW9kdWxlIChyZXNv
bHZlLW1vZHVsZSAnKGd1aWxlKSkpKQogCisoZGVmaW5lICptYWNyby1sb29rdXAqIChtYWtlLWZs
dWlkKSkKKyhmbHVpZC1zZXQhICptYWNyby1sb29rdXAqIAorICAgICAgICAgICAgKGxhbWJkYSB4
IChlcnJvciAibm90IGluIGEgbWFjcm8gZXZhbHVhdGlvbiBjb250ZXh0IikpKQorCiAobGV0ICgp
CiAgIChkZWZpbmUtc3ludGF4IGRlZmluZS1leHBhbnNpb24tY29uc3RydWN0b3JzCiAgICAgKGxh
bWJkYSAoeCkKQEAgLTEzMDQsOCArMTMwOCwxMiBAQAogICAgICAgICAgICAgICAgICAgIChzeW50
YXgtdmlvbGF0aW9uICNmICJlbmNvdW50ZXJlZCByYXcgc3ltYm9sIGluIG1hY3JvIG91dHB1dCIK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoc291cmNlLXdyYXAgZSB3ICh3
cmFwLXN1YnN0IHcpIG1vZCkgeCkpCiAgICAgICAgICAgICAgICAgICAoZWxzZSAoZGVjb3JhdGUt
c291cmNlIHggcykpKSkpCi0gICAgICAgIChyZWJ1aWxkLW1hY3JvLW91dHB1dCAocCAoc291cmNl
LXdyYXAgZSAoYW50aS1tYXJrIHcpIHMgbW9kKSkKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIChuZXctbWFyaykpKSkKKyAgICAgICAgKHdpdGgtZmx1aWRzICgoKm1hY3JvLWxvb2t1cCoK
KyAgICAgICAgICAgICAgICAgICAgICAgKGxhbWJkYSAoZSkgKGxvb2t1cCAoaWQtdmFyLW5hbWUg
ZSB3KQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIgbW9kKSkp
KQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAorICAgICAgICAg
IChyZWJ1aWxkLW1hY3JvLW91dHB1dCAocCAoc291cmNlLXdyYXAgZSAoYW50aS1tYXJrIHcpIHMg
bW9kKSkKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG5ldy1tYXJrKSkpKSkKIAog
ICAgIChkZWZpbmUgZXhwYW5kLWJvZHkKICAgICAgIDs7IEluIHByb2Nlc3NpbmcgdGhlIGZvcm1z
IG9mIHRoZSBib2R5LCB3ZSBjcmVhdGUgYSBuZXcsIGVtcHR5IHdyYXAuCkBAIC0yMzk4LDEwICsy
NDA2LDE0IEBACiAgICAgICAgICAgKGxhbWJkYSogKHggIzpvcHRpb25hbCAobSAnZSkgKGVzZXcg
JyhldmFsKSkpCiAgICAgICAgICAgICAoZXhwYW5kLXRvcC1zZXF1ZW5jZSAobGlzdCB4KSBudWxs
LWVudiB0b3Atd3JhcCAjZiBtIGVzZXcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IChjb25zICdoeWdpZW5lIChtb2R1bGUtbmFtZSAoY3VycmVudC1tb2R1bGUpKSkpKSkKKyAgICAo
c2V0ISBzeW50YXgtYmluZGluZy1pbmZvCisgICAgICAgICAgKGxhbWJkYSAoeCkKKyAgICAgICAg
ICAgICgoZmx1aWQtcmVmICptYWNyby1sb29rdXAqKSB4KSkpCiAKICAgICAoc2V0ISBpZGVudGlm
aWVyPwogICAgICAgICAgIChsYW1iZGEgKHgpCiAgICAgICAgICAgICAobm9uc3ltYm9sLWlkPyB4
KSkpCisgICAgCiAKICAgICAoc2V0ISBkYXR1bS0+c3ludGF4CiAgICAgICAgICAgKGxhbWJkYSAo
aWQgZGF0dW0pCg==
--20cf3010e71ff5bae904b35c4237--


From MAILER-DAEMON Mon Dec 05 15:23:24 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXf4O-0004oI-Bl
	for mharc-guile-devel@gnu.org; Mon, 05 Dec 2011 15:23:24 -0500
Received: from eggs.gnu.org ([140.186.70.92]:51690)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXf4L-0004nP-JG
	for guile-devel@gnu.org; Mon, 05 Dec 2011 15:23:22 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXf4K-0002JB-Cl
	for guile-devel@gnu.org; Mon, 05 Dec 2011 15:23:21 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:35988
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RXf4K-0002J7-AD; Mon, 05 Dec 2011 15:23:20 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 9F2398AAA;
	Mon,  5 Dec 2011 15:23:19 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=6nxZBEqWNsII+fLPQEi5kOXIad8=; b=ZEMyjO
	IcsbfnLobk0A5kKy1b4SrU2TEFsCdt07NIxGwjz2rrDj4qjLU1crBhh9WtKkeHtk
	+ru9KWIvuE+HNp1F+Rk6QCcjygAbgBrFQi9YOew2Rda+FMmOGjW6kvmqNHAVOvMy
	VDtFykW96h7xrzPaqRyjFaDU8z5zqBb2C6H7o=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=HX7xpXo3YZuRj9nEwchwp44vtUPYdL7C
	S40bAdK5R3m6HYo6xfh+TaxroNSKa9z/w9/YmxZQTuR8G8SFoOCZAXlRHD5yBBFs
	GSoXhe3y2vfz4CFUCDfTSROGRQhqWTykSkqVAM6oXRdOI3H1t5c+0YP5YAK6Y72F
	hYgavLGitD0=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 982148AA9;
	Mon,  5 Dec 2011 15:23:19 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 1490A8AA8;
	Mon,  5 Dec 2011 15:23:18 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: ludo@gnu.org
Subject: Re: when and unless
References: <878vsjd2fh.fsf@pobox.com>
Date: Mon, 05 Dec 2011 21:23:15 +0100
In-Reply-To: <878vsjd2fh.fsf@pobox.com> (Andy Wingo's message of "Thu, 30 Jun
	2011 12:44:02 +0200")
Message-ID: <87r50ircng.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: F8716D16-1F7E-11E1-9039-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 05 Dec 2011 20:23:22 -0000

Heya Ludo,

On Thu 30 Jun 2011 12:44, Andy Wingo <wingo@pobox.com> writes:

> I think we should add `when' and `unless' to the default environment.
>
> They go like this:
>
>   (define-syntax when
>     (syntax-rules ()
>       ((_ test then then* ...)
>        (if test (begin then then* ... (if #f #f))))))
>
>   (define-syntax unless
>     (syntax-rules ()
>       ((_ test else else* ...)
>        (if (not test) (begin else else* ... (if #f #f))))))

WDYT?  `unless' is nice for assertions, `when' is its converse, and most
Schemes have them.  I would like to add them to Guile too.

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Mon Dec 05 15:45:42 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXfPy-0006Dv-20
	for mharc-guile-devel@gnu.org; Mon, 05 Dec 2011 15:45:42 -0500
Received: from eggs.gnu.org ([140.186.70.92]:49535)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXfPv-0006CF-OF
	for guile-devel@gnu.org; Mon, 05 Dec 2011 15:45:40 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXfPt-000798-Qr
	for guile-devel@gnu.org; Mon, 05 Dec 2011 15:45:39 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:65019
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RXfPt-000794-Np; Mon, 05 Dec 2011 15:45:37 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 10D458D62;
	Mon,  5 Dec 2011 15:45:37 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; s=sasl; bh=y6jkm/hBwX/b
	XudqErCM+++toek=; b=FdqndjSH0OK2+7fFZ3PRSzrX6+UCMkZS38IOmRhAQj+q
	yjHmKX114btZ/NMn3Ws5r9S3aUFZhBiQfdodLD67hIX8ry/rmeRyoHTvzGrkukPI
	LeQb7KtlIW/lVr3150aicJx6vaQGmnQJ/k+VZnoxkchFZsZD7dprjfS+KyCpTW4=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; q=dns; s=sasl; b=fj0nFm
	g26SDqmxwTllgSmBTehiL7udpLkCVaK3FvwawbPQ+vORNNFqUdHg4TTBH5kwVa9q
	F4LUpo+/g/NHXooBNJTo923g6qioAQMuj44A/lWmpm/J9KCcuUiWgCEoqxIEU65u
	gY4QgqMT+slNyLF8dC7pSZI22EhVgDsLtJzXY=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 084138D60;
	Mon,  5 Dec 2011 15:45:37 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 6F5468D5D;
	Mon,  5 Dec 2011 15:45:36 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: ludo@gnu.org (Ludovic =?utf-8?Q?Court=C3=A8s?=)
Subject: Re: Lock ordering mismatch
References: <877h81emfv.fsf@gnu.org>
Date: Mon, 05 Dec 2011 21:45:32 +0100
In-Reply-To: <877h81emfv.fsf@gnu.org> ("Ludovic =?utf-8?Q?Court=C3=A8s=22'?=
	=?utf-8?Q?s?= message of "Fri, 01 Jul 2011 23:11:00 +0200")
Message-ID: <87hb1erbmb.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Pobox-Relay-ID: 159504C2-1F82-11E1-A029-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 05 Dec 2011 20:45:40 -0000

On Fri 01 Jul 2011 23:11, ludo@gnu.org (Ludovic Court=C3=A8s) writes:

> As seen in ccb80964cd7cd112e300c34d32f67125a6d6da9a, there=E2=80=99s a lo=
ck
> ordering mismatch between =E2=80=98do_thread=C2=A0exit=E2=80=99 and =E2=
=80=98fat_mutex_lock=E2=80=99
> wrt. =E2=80=98t->admin_mutex=E2=80=99 and =E2=80=98m->lock=E2=80=99.

Filed here: http://debbugs.gnu.org/cgi/bugreport.cgi?bug=3D10225

Regards,

Andy
--=20
http://wingolog.org/


From MAILER-DAEMON Mon Dec 05 19:36:41 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXj1V-0007qf-P0
	for mharc-guile-devel@gnu.org; Mon, 05 Dec 2011 19:36:41 -0500
Received: from eggs.gnu.org ([140.186.70.92]:50597)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RXj1S-0007mj-IQ
	for guile-devel@gnu.org; Mon, 05 Dec 2011 19:36:39 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RXj1R-0008Sl-OX
	for guile-devel@gnu.org; Mon, 05 Dec 2011 19:36:38 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:37324)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RXj1R-0008SU-HM
	for guile-devel@gnu.org; Mon, 05 Dec 2011 19:36:37 -0500
Received: by iapp10 with SMTP id p10so7564471iap.0
	for <guile-devel@gnu.org>; Mon, 05 Dec 2011 16:36:35 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:sender:in-reply-to:references:date
	:x-google-sender-auth:message-id:subject:from:to:cc:content-type
	:content-transfer-encoding;
	bh=NO+iQtiYZVfRcAF3GI2aaCxWBwr9VkgD+rHfOTG2gXA=;
	b=jqB6DwVY9axcP/WwqeFj5AORsPTEBiHg7p+o4TRlex9XedyA5fxHBwz+PbD1m8pAFC
	T87x1sOVBUVD1RuoD/rH33T3o26zQhniI1e/GSBhltm7puXkAjIh+1KhMAgWL60Vzr0T
	deBxZd6nEuxGNdtqSqcFrgDe0MpiL/32iBP3I=
MIME-Version: 1.0
Received: by 10.50.173.74 with SMTP id bi10mr13664317igc.4.1323131795765; Mon,
	05 Dec 2011 16:36:35 -0800 (PST)
Sender: noah549@gmail.com
Received: by 10.42.217.6 with HTTP; Mon, 5 Dec 2011 16:36:35 -0800 (PST)
In-Reply-To: <87vcpw9hl3.fsf@pobox.com>
References: <87pqmjj0zo.fsf@olor.terpri.org>
	<87vcpw9hl3.fsf@pobox.com>
Date: Mon, 5 Dec 2011 19:36:35 -0500
X-Google-Sender-Auth: jtEkdUXTselIH4_3pdiu5Nv9BEE
Message-ID: <CA+U71=MwJUPK4w1AzUtK2zHdDCX8giBMCo=nP4pA63U3VpGknA@mail.gmail.com>
Subject: Re: *current-language*
From: Noah Lavine <noah.b.lavine@gmail.com>
To: Andy Wingo <wingo@pobox.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
Cc: BT Templeton <bpt@hcoop.net>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 00:36:39 -0000

> I guess in general I'd prefer something like Racket's #!lang directives,
> though I'm not opposed to this approach. =A0Dunno!

How about using language directives when available, and trying to
guess the language when not?

And about the directives, what should they be? ',language' is what we
used to use at the REPL, and I was about to write an email arguing for
that, until I realized that there is one big advantage to using the
same thing as Racket - we might actually share some languages.

Specifically, if someone had a Scheme file that started with '#!lang
r5rs', it's possible that Guile and Racket could both run that file
without modification. That seems pretty cool. Mixing other languages
could be scary though.

Noah


From MAILER-DAEMON Mon Dec 05 23:25:19 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXmal-0006CH-T4
	for mharc-guile-devel@gnu.org; Mon, 05 Dec 2011 23:25:19 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59279)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RXmai-0006C0-A1
	for guile-devel@gnu.org; Mon, 05 Dec 2011 23:25:17 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RXmag-0003PZ-Ff
	for guile-devel@gnu.org; Mon, 05 Dec 2011 23:25:15 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:37933)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RXmag-0003OI-CK
	for guile-devel@gnu.org; Mon, 05 Dec 2011 23:25:14 -0500
Received: by iapp10 with SMTP id p10so7865838iap.0
	for <guile-devel@gnu.org>; Mon, 05 Dec 2011 20:25:14 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:sender:date:x-google-sender-auth:message-id:subject
	:from:to:content-type;
	bh=0eMALEZQYPheHLnJW5+ttvOUObrsPhWJyMY2LfDKuaA=;
	b=qOnaYPUj2YNI4EjVatSD9bCc6iNxvuEwPL3GwTtoKL/SBa1Q/wa/cVzpRZBDxva8Af
	hLHau0qc8YZp0UuUozf9SKQyu9xRjIqShptMWPQ+1LJ2UypsqBnqtOVHD41pH/EOfxOg
	d30faMKQGKvzCn1oXE2e1BsFd1mlFBzftAU7c=
MIME-Version: 1.0
Received: by 10.50.173.74 with SMTP id bi10mr14343652igc.4.1323145513926; Mon,
	05 Dec 2011 20:25:13 -0800 (PST)
Sender: noah549@gmail.com
Received: by 10.42.217.6 with HTTP; Mon, 5 Dec 2011 20:25:13 -0800 (PST)
Date: Mon, 5 Dec 2011 23:25:13 -0500
X-Google-Sender-Auth: vcYAHqi5JasW7TSd16trTJB52d0
Message-ID: <CA+U71=MMST=EkYSEgXkaMFpfyvbKnQmKqomJm8XGHeKzpa+Vkg@mail.gmail.com>
Subject: Update and Questions
From: Noah Lavine <noah.b.lavine@gmail.com>
To: guile-devel <guile-devel@gnu.org>
Content-Type: text/plain; charset=ISO-8859-1
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 04:25:17 -0000

Hello Guile developers,

Despite the long gap since my last email, I have in fact been working
on the compiler project. This email has two purposes: first, to make
sure that I have a basically reasonable design before I work more, and
second, to ask a logistical question.

First of all, I very much appreciated your suggestions of things to
read. I did look at the Reasoned Schemer. I also spent quite a while
studying Stalin (the compiler), because I believe that is the current
fastest Scheme compiler. (And therefore, it's the one I'd like to beat
with our compiler.) The design I am currently working with is the same
as Stalin's design.

It is a propagation network. Basically you have a graph of Tree-IL
nodes, where each Tree-IL node is connected to its parent, its
children, and optionally other nodes (a variable is connected to the
place it was declared. A primitive function is connected to the error
continuation it could jump to). The compiler propagates information
along the edges of this graph, attempting to find the minimum set of
possible values for each variable and each jump target. It also
performs partial evaluation as a special case of this.

What I have described also seems to be how Hindley-Milner type
inference works (although I think we can do a bit better than standard
Hindley-Milner systems). Does this seem like a good design for the
static analyzer portion?

One big oversight that I know of is that this doesn't do any sort of
specialization. I think that is an extremely important feature, but
when I looked at doing specialization I thought that it would use all
of the logic this would, but require a bit more work to keep the
complexity down, so I thought I should do this first.

I haven't thought much about the rest of the compiler yet, but I
imagine you can basically walk this graph and try to choose
representations for each piece of it using the information you
gathered in the analysis phase. The key ingredient for that will be a
library of representations for each Tree-IL node.

The second part of this post is a logistical question. I would like to
do this work in public, so other people can see it (and hopefully
contribute). Where is the best place to do this? Should I make a
branch on Savannah? That makes the most sense to me, but it seems a
bit unnatural, since this project is very separate from the rest of
Guile.

And finally, a fun thing. The current best Scheme compiler (that I
know of) is called Stalin. Therefore, I suggest that our compiler be
called "Stallman", after our fearless leader (whose name also starts
with "s"). :-)

Thanks a lot,
Noah


From MAILER-DAEMON Tue Dec 06 02:42:51 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXpfv-00023G-Ex
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 02:42:51 -0500
Received: from eggs.gnu.org ([140.186.70.92]:60164)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <hkBst@gentoo.org>) id 1RXpfs-00020t-ML
	for guile-devel@gnu.org; Tue, 06 Dec 2011 02:42:49 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <hkBst@gentoo.org>) id 1RXpfr-0004OA-Ck
	for guile-devel@gnu.org; Tue, 06 Dec 2011 02:42:48 -0500
Received: from smtp.gentoo.org ([140.211.166.183]:45763)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <hkBst@gentoo.org>)
	id 1RXpfr-0004O6-44; Tue, 06 Dec 2011 02:42:47 -0500
Received: from [10.128.4.252] (unknown [79.170.210.172])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested) (Authenticated sender: hkbst)
	by smtp.gentoo.org (Postfix) with ESMTPSA id 731B71B4001;
	Tue,  6 Dec 2011 07:42:39 +0000 (UTC)
Message-ID: <4EDDC8B1.3000509@gentoo.org>
Date: Tue, 06 Dec 2011 08:48:01 +0100
From: Marijn <hkBst@gentoo.org>
User-Agent: Mozilla/5.0 (X11; Linux x86_64;
	rv:8.0) Gecko/20111117 Thunderbird/8.0
MIME-Version: 1.0
To: Andy Wingo <wingo@pobox.com>
Subject: Re: when and unless
References: <878vsjd2fh.fsf@pobox.com> <87r50ircng.fsf@pobox.com>
In-Reply-To: <87r50ircng.fsf@pobox.com>
X-Enigmail-Version: 1.3.3
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 140.211.166.183
Cc: ludo@gnu.org, guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 07:42:49 -0000

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi Andy,

On 05-12-11 21:23, Andy Wingo wrote:
> Heya Ludo,
> 
> On Thu 30 Jun 2011 12:44, Andy Wingo <wingo@pobox.com> writes:
> 
>> I think we should add `when' and `unless' to the default
>> environment.
>> 
>> They go like this:
>> 
>> (define-syntax when (syntax-rules () ((_ test then then* ...) (if
>> test (begin then then* ... (if #f #f))))))
>> 
>> (define-syntax unless (syntax-rules () ((_ test else else* ...) 
>> (if (not test) (begin else else* ... (if #f #f))))))
> 
> WDYT?  `unless' is nice for assertions, `when' is its converse, and
> most Schemes have them.  I would like to add them to Guile too.

Couldn't help but wonder why they don't return the value of the last
body form, so I looked around a bit and both CLHS[1] and my racket
REPL seem to agree that they should:

$ racket
Welcome to Racket v5.2.0.4.
> (when #t 'hello)
'hello
> (unless #f 'hi)
'hi

Is there some other source that suggests that the return value should
be unspecified?

Marijn

[1]:http://clhs.lisp.se/Body/m_when_.htm
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.18 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk7dyLEACgkQp/VmCx0OL2yAQACeL8y4js+HOZn1IBqFEJEl8n3I
i+MAn0TBdz2e1lP9n2EyP9PDlM7ATKUL
=nrWC
-----END PGP SIGNATURE-----


From MAILER-DAEMON Tue Dec 06 03:29:35 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXqP9-0000HB-K2
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 03:29:35 -0500
Received: from eggs.gnu.org ([140.186.70.92]:56055)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <alexshinn@gmail.com>) id 1RXqP7-0000H2-Um
	for guile-devel@gnu.org; Tue, 06 Dec 2011 03:29:34 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <alexshinn@gmail.com>) id 1RXqP5-0003eA-SK
	for guile-devel@gnu.org; Tue, 06 Dec 2011 03:29:33 -0500
Received: from mail-ey0-f169.google.com ([209.85.215.169]:32843)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <alexshinn@gmail.com>)
	id 1RXqP5-0003dk-EO; Tue, 06 Dec 2011 03:29:31 -0500
Received: by eaah1 with SMTP id h1so5720372eaa.0
	for <multiple recipients>; Tue, 06 Dec 2011 00:29:30 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=4ZIrq59eNWq9U1+O8xIVIfEn5E0jIyKt3K4XBtI31u4=;
	b=Likf4oo21z5Do3gaBShrEc+9vk88t/r/OucaTJTIFP+E3oZLHj2W40ZmfBMmstXUNR
	OEbSGJV/zxeCpL1HGOq676Xum45WWaZWkyiR0xRk8F4H/xkDCyoxAyKisdK/gsFiT6Lu
	B9LYLeq00EJbzHOlMAleErdmb48ks+sWhvI4E=
MIME-Version: 1.0
Received: by 10.213.7.81 with SMTP id c17mr2081844ebc.31.1323160170484; Tue,
	06 Dec 2011 00:29:30 -0800 (PST)
Received: by 10.213.20.17 with HTTP; Tue, 6 Dec 2011 00:29:30 -0800 (PST)
In-Reply-To: <4EDDC8B1.3000509@gentoo.org>
References: <878vsjd2fh.fsf@pobox.com> <87r50ircng.fsf@pobox.com>
	<4EDDC8B1.3000509@gentoo.org>
Date: Tue, 6 Dec 2011 17:29:30 +0900
Message-ID: <CAMMPzYMoKuQSWnBMCoZ_+ggcrmk+SGvbyaKvYLb=eJVRbR6E1Q@mail.gmail.com>
Subject: Re: when and unless
From: Alex Shinn <alexshinn@gmail.com>
To: Marijn <hkBst@gentoo.org>
Content-Type: text/plain; charset=ISO-8859-1
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.215.169
Cc: Andy Wingo <wingo@pobox.com>, ludo@gnu.org,
	guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 08:29:34 -0000

On Tue, Dec 6, 2011 at 4:48 PM, Marijn <hkBst@gentoo.org> wrote:
>
> Couldn't help but wonder why they don't return the value of the last
> body form, so I looked around a bit and both CLHS[1] and my racket
> REPL seem to agree that they should:
>
> $ racket
> Welcome to Racket v5.2.0.4.
>> (when #t 'hello)
> 'hello
>> (unless #f 'hi)
> 'hi
>
> Is there some other source that suggests that the return value should
> be unspecified?

Because the result is meaningless when the condition is false.

CLHS returns nil in this case, but that fits with CL idioms and
not Scheme idioms.  when and unless are for side-effects - it's
better to write (and #t 'hello) if you want the result.

R7RS also leaves it unspecified.

-- 
Alex


From MAILER-DAEMON Tue Dec 06 06:12:00 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXswK-0005ji-8c
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 06:12:00 -0500
Received: from eggs.gnu.org ([140.186.70.92]:53087)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXswH-0005jQ-Jg
	for guile-devel@gnu.org; Tue, 06 Dec 2011 06:11:58 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXswG-00077g-JR
	for guile-devel@gnu.org; Tue, 06 Dec 2011 06:11:57 -0500
Received: from lo.gmane.org ([80.91.229.12]:50871)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXswG-00077D-DK
	for guile-devel@gnu.org; Tue, 06 Dec 2011 06:11:56 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXswB-0000EX-SE
	for guile-devel@gnu.org; Tue, 06 Dec 2011 12:11:51 +0100
Received: from p508ed485.dip.t-dialin.net ([80.142.212.133])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 06 Dec 2011 12:11:51 +0100
Received: from dak by p508ed485.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 06 Dec 2011 12:11:51 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Update and Questions
Date: Tue, 06 Dec 2011 12:11:28 +0100
Organization: Organization?!?
Lines: 11
Message-ID: <87r50ikl9b.fsf@fencepost.gnu.org>
References: <CA+U71=MMST=EkYSEgXkaMFpfyvbKnQmKqomJm8XGHeKzpa+Vkg@mail.gmail.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ed485.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:UQEgRRlNTRlCQWqCXfIjfMQwpNc=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 11:11:58 -0000

Noah Lavine <noah.b.lavine@gmail.com> writes:

> And finally, a fun thing. The current best Scheme compiler (that I
> know of) is called Stalin. Therefore, I suggest that our compiler be
> called "Stallman", after our fearless leader (whose name also starts
> with "s"). :-)

I think that -pedantic should stay optional.

-- 
David Kastrup



From MAILER-DAEMON Tue Dec 06 06:17:26 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXt1a-0006Ot-TA
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 06:17:26 -0500
Received: from eggs.gnu.org ([140.186.70.92]:35114)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXt1V-0006OV-E6
	for guile-devel@gnu.org; Tue, 06 Dec 2011 06:17:25 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXt1U-00082L-4S
	for guile-devel@gnu.org; Tue, 06 Dec 2011 06:17:21 -0500
Received: from lo.gmane.org ([80.91.229.12]:56717)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXt1T-000828-VV
	for guile-devel@gnu.org; Tue, 06 Dec 2011 06:17:20 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXt1T-00038F-4q
	for guile-devel@gnu.org; Tue, 06 Dec 2011 12:17:19 +0100
Received: from p508ed485.dip.t-dialin.net ([80.142.212.133])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 06 Dec 2011 12:17:19 +0100
Received: from dak by p508ed485.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 06 Dec 2011 12:17:19 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: when and unless
Date: Tue, 06 Dec 2011 12:17:06 +0100
Organization: Organization?!?
Lines: 35
Message-ID: <87mxb6kkzx.fsf@fencepost.gnu.org>
References: <878vsjd2fh.fsf@pobox.com> <87r50ircng.fsf@pobox.com>
	<4EDDC8B1.3000509@gentoo.org>
	<CAMMPzYMoKuQSWnBMCoZ_+ggcrmk+SGvbyaKvYLb=eJVRbR6E1Q@mail.gmail.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ed485.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:AJ4er2c2TwMTNghL30d6vjfDftw=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 11:17:25 -0000

Alex Shinn <alexshinn@gmail.com> writes:

> On Tue, Dec 6, 2011 at 4:48 PM, Marijn <hkBst@gentoo.org> wrote:
>>
>> Couldn't help but wonder why they don't return the value of the last
>> body form, so I looked around a bit and both CLHS[1] and my racket
>> REPL seem to agree that they should:
>>
>> $ racket
>> Welcome to Racket v5.2.0.4.
>>> (when #t 'hello)
>> 'hello
>>> (unless #f 'hi)
>> 'hi
>>
>> Is there some other source that suggests that the return value should
>> be unspecified?
>
> Because the result is meaningless when the condition is false.
>
> CLHS returns nil in this case, but that fits with CL idioms and
> not Scheme idioms.  when and unless are for side-effects - it's
> better to write (and #t 'hello) if you want the result.
>
> R7RS also leaves it unspecified.

I've actually wondered if it would not make sense to return
*unspecified* in the case of the plain else-less if even if the
condition is true, namely when you write (if #t #t).

There is probably code relying on this to be #t, but frankly, this
appears like a recipe for breakage.

-- 
David Kastrup



From MAILER-DAEMON Tue Dec 06 09:40:05 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXwBh-0003hi-Nb
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 09:40:05 -0500
Received: from eggs.gnu.org ([140.186.70.92]:58295)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RXwBa-0003eN-Gu
	for guile-devel@gnu.org; Tue, 06 Dec 2011 09:40:04 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RXwBU-0007Aq-Jq
	for guile-devel@gnu.org; Tue, 06 Dec 2011 09:39:58 -0500
Received: from mail1-relais-roc.national.inria.fr ([192.134.164.82]:32225)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <ludo@gnu.org>)
	id 1RXwBU-0007Ae-E1
	for guile-devel@gnu.org; Tue, 06 Dec 2011 09:39:52 -0500
X-IronPort-AV: E=Sophos;i="4.71,306,1320620400"; d="scan'208";a="134177140"
Received: from unknown (HELO pluto) ([193.50.110.208])
	by mail1-relais-roc.national.inria.fr with ESMTP/TLS/DHE-RSA-AES128-SHA;
	06 Dec 2011 15:39:49 +0100
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
To: Andy Wingo <wingo@pobox.com>
Subject: Re: when and unless
References: <878vsjd2fh.fsf@pobox.com> <87r50ircng.fsf@pobox.com>
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 16 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
Date: Tue, 06 Dec 2011 15:39:49 +0100
In-Reply-To: <87r50ircng.fsf@pobox.com> (Andy Wingo's message of "Mon, 05 Dec
	2011 21:23:15 +0100")
Message-ID: <87d3c1lq6i.fsf@gnu.org>
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 192.134.164.82
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 14:40:04 -0000

Hi,

Andy Wingo <wingo@pobox.com> skribis:

> On Thu 30 Jun 2011 12:44, Andy Wingo <wingo@pobox.com> writes:
>
>> I think we should add `when' and `unless' to the default environment.
>>
>> They go like this:
>>
>>   (define-syntax when
>>     (syntax-rules ()
>>       ((_ test then then* ...)
>>        (if test (begin then then* ... (if #f #f))))))
>>
>>   (define-syntax unless
>>     (syntax-rules ()
>>       ((_ test else else* ...)
>>        (if (not test) (begin else else* ... (if #f #f))))))
>
> WDYT?  `unless' is nice for assertions, `when' is its converse, and most
> Schemes have them.  I would like to add them to Guile too.

Yes, feel free.

Ludo=E2=80=99.


From MAILER-DAEMON Tue Dec 06 09:59:10 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXwUA-0002ZT-91
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 09:59:10 -0500
Received: from eggs.gnu.org ([140.186.70.92]:40899)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ttn@gnuvola.org>) id 1RXwU3-0002ZH-2y
	for guile-devel@gnu.org; Tue, 06 Dec 2011 09:59:09 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ttn@gnuvola.org>) id 1RXwTz-0002Px-1C
	for guile-devel@gnu.org; Tue, 06 Dec 2011 09:59:03 -0500
Received: from smtp206.alice.it ([82.57.200.102]:45351)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ttn@gnuvola.org>)
	id 1RXwTn-0002Or-Du; Tue, 06 Dec 2011 09:58:47 -0500
Received: from ambire.localdomain (95.244.65.2) by smtp206.alice.it
	(8.6.023.02) id 4ECA6079026B158A; Tue, 6 Dec 2011 15:58:45 +0100
Received: from ttn by ambire.localdomain with local (Exim 4.69)
	(envelope-from <ttn@gnuvola.org>)
	id 1RXwQx-0001xe-SU; Tue, 06 Dec 2011 15:55:51 +0100
From: Thien-Thi Nguyen <ttn@gnuvola.org>
To: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org>
Date: Tue, 06 Dec 2011 15:55:51 +0100
In-Reply-To: <87liqtpsl9.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Sat, 03 Dec 2011 16:45:06 +0100")
Message-ID: <87ehwh21hk.fsf@ambire.localdomain>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.50 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 82.57.200.102
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 14:59:09 -0000

() David Kastrup <dak@gnu.org>
() Sat, 03 Dec 2011 16:45:06 +0100

   The lack of procedure-environment in Guilev2 implies that I
   have to wrap the stuff in (lambda () ...) in order to capture
   the lexical environment for evaluation.

   Is it possible to have a shortcut (make-closure ...) or so for that
   purpose?

Does =E2=80=98delay=E2=80=99 (and later =E2=80=98force=E2=80=99) work?


From MAILER-DAEMON Tue Dec 06 10:46:11 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXxDf-000782-5J
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 10:46:11 -0500
Received: from eggs.gnu.org ([140.186.70.92]:51596)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXxDa-00077Z-4h
	for guile-devel@gnu.org; Tue, 06 Dec 2011 10:46:09 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXxDW-0004Ub-5t
	for guile-devel@gnu.org; Tue, 06 Dec 2011 10:46:06 -0500
Received: from lo.gmane.org ([80.91.229.12]:42244)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXxDW-0004UW-0m
	for guile-devel@gnu.org; Tue, 06 Dec 2011 10:46:02 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXxDT-0007Q6-V7
	for guile-devel@gnu.org; Tue, 06 Dec 2011 16:45:59 +0100
Received: from p508ed485.dip.t-dialin.net ([80.142.212.133])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 06 Dec 2011 16:45:59 +0100
Received: from dak by p508ed485.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 06 Dec 2011 16:45:59 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Tue, 06 Dec 2011 16:45:47 +0100
Organization: Organization?!?
Lines: 24
Message-ID: <87fwgxk8k4.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org>
	<87ehwh21hk.fsf@ambire.localdomain>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ed485.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:cSmGi5PrXsKZTAniLUSZFvUpqQk=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 15:46:09 -0000

Thien-Thi Nguyen <ttn@gnuvola.org> writes:

> () David Kastrup <dak@gnu.org>
> () Sat, 03 Dec 2011 16:45:06 +0100
>
>    The lack of procedure-environment in Guilev2 implies that I
>    have to wrap the stuff in (lambda () ...) in order to capture
>    the lexical environment for evaluation.
>
>    Is it possible to have a shortcut (make-closure ...) or so for that
>    purpose?
>
> Does ‘delay’ (and later ‘force’) work?

No.
(set! (force (delay (some-procedure-with-setter and its args))))
does not work.

In addition, each expression will be run once or not at all (and its
side effects on the containing environment are desired), so the
memoizing nature of promises does not help.

-- 
David Kastrup



From MAILER-DAEMON Tue Dec 06 11:11:02 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXxbi-0003Lp-OW
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:02 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52182)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbc-0003Kj-GA
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:00 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbW-0001fa-Mq
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:10:56 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:49318
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbW-0001fO-KN
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:10:50 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id DDC76743B;
	Tue,  6 Dec 2011 11:10:48 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=Ghv6NpAbTX3mGIqYdNejQhdkbVw=; b=qk3XCO
	SWE5NEFqa5ncKGv/GsvmZkeB+9dndEU4caj6VE4iWV5cLPA7OHbQagJuW4Vz+1N3
	W1BxtPpiLFAAVBbCAGnJVG/1V7TzbmOZlVk4NzI16h3+rGd88ZDh+xfqx0MRMm/w
	mWc347c9GBNAaJ/ELhxlM5QxiaHCFUNZkX0QY=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=bcojBlcSn9ZDoCn2GCuEwriCw6L6NlvM
	mbAB7Fhuw6dilVEFQ0/wm+DWQFVp3EPkZy4L2wQ8BbUjwfZ5DetiQlTgAF2fNPpj
	RKY5+wNvqgLzvKz9WgyXpkRW9NPv96AxIxFzFVRbWulo5z9TeWRFEkbrBPNjASH2
	UJq5ez7P5mw=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id D0EE6743A;
	Tue,  6 Dec 2011 11:10:48 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 32A3D7439;
	Tue,  6 Dec 2011 11:10:48 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Stefan Israelsson Tampe <stefan.itampe@gmail.com>
Subject: Re: lighter prompts?
References: <CAGua6m37LyEG6vq968BQ3WsU5LiKCOQPht3hcWfie29SSpy5HA@mail.gmail.com>
Date: Tue, 06 Dec 2011 12:04:53 +0100
In-Reply-To: <CAGua6m37LyEG6vq968BQ3WsU5LiKCOQPht3hcWfie29SSpy5HA@mail.gmail.com>
	(Stefan
	Israelsson Tampe's message of "Mon, 18 Jul 2011 23:08:00 +0200")
Message-ID: <877h2aot9m.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: DC3A83A2-2024-11E1-B248-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 16:11:00 -0000

Hi Stefan,

On Mon 18 Jul 2011 23:08, Stefan Israelsson Tampe <stefan.itampe@gmail.com> writes:

> I noted that prompts in guile-2.0 is quite heavy e.g. using vanilla
> setjmp facilities.

Indeed.

> So if I'm not miss-taken a prompt will save several machine
> registers. Is this really needed?

It is needed if you are jumping back into a vm_run invocation from
within a nested vm_run invocation.

> Why I am asking is that everything looks the same after a prompt
> returns e.g. basically setting up registers from stored data and
> recall a structures from that info and do a named goto.

One option would be to do a setjmp() at the beginning of every VM
invocation, and use that jmpbuf for every prompt with the same
vm_cookie.  That does penalize recursion into the VM, though.

Another thing that would make prompts lighter would be to implement the
dynamic stack (scm_i_dynwinds()) as a block-allocated stack, like the VM
stack, rather than as a heap-allocated linked list.

Also, in some cases it should be possible to statically remove prompts,
with a special compiler pass.  This would probably be easier with a
CPS-based IL though.

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 06 11:11:05 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXxbl-0003Qi-RW
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:05 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52209)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbf-0003LJ-GU
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:04 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbZ-0001gX-IW
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:10:59 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:49402
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RXxbZ-0001gS-GP; Tue, 06 Dec 2011 11:10:53 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 53C30743E;
	Tue,  6 Dec 2011 11:10:53 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; s=sasl; bh=sdE98rHHne+n
	V1EoV2DKCcHcMQc=; b=Ua8CchKoZWCVGngVEhK33aNQz/+Lm8rcQGjG7XXF9Miw
	HUDhLZTt95EstiqL+pUq/l/jpIPxFpf9hUBd8coLnR4QVzDjZTSt4VdiUzaiaJ1v
	NvR0p0VCalcvK1MQ7XFEW10ZBwzkDQg4H+XlfznHwpmecuKxXIavwKPqMECsAm8=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; q=dns; s=sasl; b=M/Cqdl
	HSBsVh0QME0W+9eDvUm9ABIzHQDB0b6LolanJXXeyz8bKKp/SPQaeZBoTw+GnlL/
	c1zRZW1XO2v16iYM9kejDaFC9NAdIt7yTNS18o654hsnx6NwgzQV8AWwCzMWhEdI
	KnLNaFoZzyVJHfOIHV2k7AUDgvlTeZ5upCNBU=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 3B7AD743D;
	Tue,  6 Dec 2011 11:10:53 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 92508743C;
	Tue,  6 Dec 2011 11:10:52 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: ludo@gnu.org (Ludovic =?utf-8?Q?Court=C3=A8s?=)
Subject: Re: [PATCH] Add "scandir" procedure
References: <1314475521.3143.47.camel@Renee-desktop> <8762lehoj4.fsf@gnu.org>
Date: Tue, 06 Dec 2011 12:52:02 +0100
In-Reply-To: <8762lehoj4.fsf@gnu.org> ("Ludovic =?utf-8?Q?Court=C3=A8s=22'?=
	=?utf-8?Q?s?= message of "Tue, 30 Aug 2011 18:06:39 +0200")
Message-ID: <87k469or31.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Pobox-Relay-ID: DED852B0-2024-11E1-A4CB-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 16:11:04 -0000

On Tue 30 Aug 2011 18:06, ludo@gnu.org (Ludovic Court=C3=A8s) writes:

> I was actually planning to push =E2=80=98file-system-fold=E2=80=99, a fun=
ctional
> alternative to =E2=80=98ftw=E2=80=99, which would be along the lines of t=
his (from
> <http://git.savannah.gnu.org/cgit/libchop.git/tree/utils/chop-backup#n46>=
):
>
>   (define (file-system-fold enter? leaf down up skip init file-name)
>     "Traverse the directory at FILE-NAME, recursively.  Enter sub-directo=
ries
>   only when (ENTER? PATH STAT RESULT) returns true.  When a sub-directory=
 is
>   entered, call (DOWN PATH STAT RESULT), where PATH is the path of the
>   sub-directory and STAT the result of (lstat PATH); when it is left, cal=
l (UP
>   PATH STAT RESULT).  For each file in a directory, call (LEAF PATH STAT
>   RESULT).  Return the result of these successive applications.  When ENT=
ER?
>   returns no, call (SKIP PATH STAT RESULT)."
>
>     ...)

I see that you haven't pushed this yet.  Want to do so?

I would be happy with a `scandir' implementation on top of this
interface.  We should find a way to push most POSIX things out to a
module, though!

Andy
--=20
http://wingolog.org/


From MAILER-DAEMON Tue Dec 06 11:11:08 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXxbo-0003Wg-IL
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:08 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52237)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbh-0003Lh-5L
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:06 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbd-0001hf-1p
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:01 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:49484
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbc-0001hZ-W7
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:10:57 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id A2F8C7444;
	Tue,  6 Dec 2011 11:10:56 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=gQYhBSI8XAOw4JfwmRJ8Bc2XAug=; b=A/3lrT
	JJgVas2u7onJEBaYahSTHFeWk1q0lruvnIeFOktcXaGsPTnar3H5zERnKEl7PIuz
	JGwzwCVHUyKj8kxIXSKE4c/+UR10XH7z8G+m08AkDXyJr2rYhMVF/dC0owMsauQh
	mzXZ6W06vdlYcvHNyVwAj4/g5sCkCbAvOG1g4=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=fO8t/5s/kmRK2WKaaBWABNxRyqR1HKFx
	0oKeLO+0oICq7wTdEhxigj0sw+T6dZDo0Z3Z5nVvAN0OEEgBXhuRaVntJnZbWLNo
	5ASa2sbULnN7MQN1S99KtGAiwlI0Z9VqktWFNoUDzgbhOZo8B15f5noSbRdopLLW
	PNPte5Grn7I=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 884537443;
	Tue,  6 Dec 2011 11:10:56 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 00AA87442;
	Tue,  6 Dec 2011 11:10:55 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Stefan Israelsson Tampe <stefan.itampe@gmail.com>
Subject: Re: Kanren and guile-log
References: <CAGua6m0NSHTdT-=AFPuU4oqgxgZbgfctV-sisW--TMx_KxBvCA@mail.gmail.com>
Date: Tue, 06 Dec 2011 12:36:52 +0100
In-Reply-To: <CAGua6m0NSHTdT-=AFPuU4oqgxgZbgfctV-sisW--TMx_KxBvCA@mail.gmail.com>
	(Stefan
	Israelsson Tampe's message of "Fri, 12 Aug 2011 19:56:00 +0200")
Message-ID: <87pqg2nd7v.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: E0DFD8D0-2024-11E1-803A-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 16:11:06 -0000

On Fri 12 Aug 2011 19:56, Stefan Israelsson Tampe <stefan.itampe@gmail.com> writes:

> I have read the source code for kanren and want to put the system in
> relation to the work I have been doing which I will
> call guile-log.

Thanks, this was an interesting read.

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 06 11:11:10 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXxbq-0003bx-LL
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:10 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52279)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbk-0003QT-UO
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:09 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbg-0001il-I9
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:04 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:49550
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RXxbg-0001ia-4o; Tue, 06 Dec 2011 11:11:00 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id EFFC7744A;
	Tue,  6 Dec 2011 11:10:59 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; s=sasl; bh=OC4Hbmiujxci
	6fWxQ5zixvVR3rM=; b=CadbomWmxFciQT7tHEfq3P5CDAoGnN6PZ2CSSff6gf7R
	ilCiIxEU7tPQcCJ6sKjqDgsG/VUMh+VR3HXY25rfUz9zNCQGp6GEJuyFi4RVDFbs
	tbuFeOZ5Ot1EuI3FdYuLFqNdVkE8SM93CYEN93q7Htn9H6xcvQm09jCT9gcXpoI=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; q=dns; s=sasl; b=ZQn/n3
	f/C2VfNNHSErgk+vJy9CxqelLvPzHGMiWTLL3yNQ6RwVh/Af9SQX13vkbP5YDo6F
	dTFXUtcpah3D8jzcEqJneAwMqFq1kTeFz48helq4liWJJhkOUdIcQmm+tnWrFbGS
	anVpVzSyEV+Btd8PNCMljRrEPUmWvcTTNmsK4=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id DDB037449;
	Tue,  6 Dec 2011 11:10:59 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 4C1D37448;
	Tue,  6 Dec 2011 11:10:59 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: ludo@gnu.org (Ludovic =?utf-8?Q?Court=C3=A8s?=)
Subject: Re: new module: (web client)
References: <87d3hblrsc.fsf@pobox.com> <87y5zvu4l9.fsf@gnu.org>
Date: Tue, 06 Dec 2011 11:51:05 +0100
In-Reply-To: <87y5zvu4l9.fsf@gnu.org> ("Ludovic =?utf-8?Q?Court=C3=A8s=22'?=
	=?utf-8?Q?s?= message of "Mon, 18 Jul 2011 14:59:46 +0200")
Message-ID: <87hb1eotwm.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Pobox-Relay-ID: E2D8ADE2-2024-11E1-BFA4-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 16:11:09 -0000

On Mon 18 Jul 2011 14:59, ludo@gnu.org (Ludovic Court=C3=A8s) writes:

> Andy Wingo <wingo@pobox.com> skribis:
>
>> (define (open-socket-for-uri uri)
>>   (let* ((ai (car (getaddrinfo (uri-host uri)
>
> What if URI is file://foo?

It will look up the addrinfo for the "file" service of "foo".

    scheme@(guile-user)> (getaddrinfo "foo" "file")
    ERROR: In procedure getaddrinfo:
    ERROR: Throw to key `getaddrinfo-error' with args `(-8)'.

If you use file:///foo:

    scheme@(guile-user)> (getaddrinfo #f "file")
    ERROR: In procedure getaddrinfo:
    ERROR: Throw to key `getaddrinfo-error' with args `(-8)'.

I guess we need to add exception printers for these errors.  Want to do
that?  :-)

Andy
--=20
http://wingolog.org/


From MAILER-DAEMON Tue Dec 06 11:11:25 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXxc5-0003vQ-9Q
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:25 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52515)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbw-0003iF-Ox
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:22 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbq-0001pO-Me
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:16 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:49794
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbq-0001pH-Hs
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:10 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 671E77483;
	Tue,  6 Dec 2011 11:11:10 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=UCt8zIdrnYuamE2HxdwZh6wGFek=; b=orZQ4H
	0Z2mDiUBSRD4UZTWHMBdmOfBWA8qjm+2kWUYC+cXEpIbO8S7bi5dwHYKp1k1sRLu
	aTUvSKmXLwflheQjZsCskpfsxjKsyfNqPpK7tjcHwunX33reOc96mlMVcFIfa64K
	zXRZuy5VWfMy546lCVp+VRtwEfwlnUGSyCJ/g=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=sgngAo65kJlbJxCf0303ghN9vWHLnZ8m
	jG8v5HiROzzOvEegCp3TRV7Jgu9M213BS5SBi0EUvVymXaqY54WM8Vg/8A6IHqAi
	zIJvwH9X8sL4BgrQku3jS2fv4nFiNkC9E00IRJtEjSGidBKuB84Id/7jfHPMVkRP
	2Qs0VFOmjPc=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 49B727470;
	Tue,  6 Dec 2011 11:11:10 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 86A317465;
	Tue,  6 Dec 2011 11:11:09 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: BT Templeton <bpt@hcoop.net>
Subject: Re: language environments
References: <87wrfrqjr3.fsf@olor.terpri.org> <87box12l8e.fsf@pobox.com>
	<87mxgkyzt3.fsf@olor.terpri.org>
Date: Tue, 06 Dec 2011 11:20:39 +0100
In-Reply-To: <87mxgkyzt3.fsf@olor.terpri.org> (BT Templeton's message of
	"Mon, 11 Jul 2011 22:53:44 -0400")
Message-ID: <87pqg2ovbc.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: E8F30272-2024-11E1-B7E0-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 16:11:23 -0000

BT!  Clearly I am a terrible person.  Or perhaps I am very close to the
event horizon of a black hole.  In any case, sorry for the late reply.

On Tue 12 Jul 2011 04:53, BT Templeton <bpt@hcoop.net> writes:

> Andy Wingo <wingo@pobox.com> writes:
>
>> On Sat 09 Jul 2011 22:30, BT Templeton <bpt@hcoop.net> writes:
>>
>>> How are language environments (i.e., the values passed as `#:env'
>>> arguments to the various compilation functions) supposed to be used?
>>> Currently all languages use it as the value of the current module, but
>>> would it be appropriate to use the environment value to keep track of
>>> other compilation-unit-specific settings like the default binding mode
>>> for Elisp or global declarations for CL?
>>
>> For toplevel languages and tree-il they need to be modules I think.
>> Otherwise the REPL won't work.  Lower-level languages might do different
>> things, but it's best to think of them as modules.  Can these other
>> parameters be attached to modules somehow?
>
> Some parameters are local to the compilation unit, like the value of
> `lexical-binding' for Elisp

I guess I'd rather use dynamic bindings for this.

> or OPTIMIZE settings for a hypothetical CL
> compiler

Aren't these lexical?  Perhaps my CL ignorance is showing here.  Or if
they aren't, could they go in #:options ?

It would be irritating if indeed as you say:

> Compiling a `(DECLAIM (OPTIMIZE ...))' form in a CL program shouldn't
> change the SAFETY setting at the user's REPL!

A similar case is Scheme's current-reader:

  #:make-default-environment
                (lambda ()
                  ;; Ideally we'd duplicate the whole module hierarchy so that `set!',
                  ;; `fluid-set!', etc. don't have any effect in the current environment.
                  (let ((m (make-fresh-user-module)))
                    ;; Provide a separate `current-reader' fluid so that
                    ;; compile-time changes to `current-reader' are
                    ;; limited to the current compilation unit.
                    (module-define! m 'current-reader (make-fluid))
                    m))

This is a bit crazy, as it would be better to delimit a new dynamic
binding context rather than allocating a new fluid.  We definitely need
something better.

> Ideally one would be able to use arbitrary objects for the language
> environment in order to track the values of these sorts of parameters
> (in addition to the current module). I think this would be possible if
> the compilation interface were changed as follows. Remove
> `make-default-environment' and replace it with `make-environment'. A
> language's `make-environment' procedure takes one argument, `inherit?'.
> If true, it should return an environment object capturing the relevant
> parts of the dynamic state (current module, global bindings relevant to
> compilation, etc.); otherwise, it returns a default environment.
> Compilers would have to know about the type of environment object
> required by their target language's compiler; no other code would need
> to know about the environment representation used by any particular
> language.

The compiler still needs to know how to get a module from the
environment.  Also, in stable-2.0 we need to be careful about
compatibility.

> Some programs, like the REPL, would need to track the continuation
> environment returned by compilers.

Here I'm a bit skeptical.  If it is important enough to track in the
REPL, surely it is important enough to track in a module?

It seems to me that you would not have this problem if elisp had
modules.  Of course, Elisp doesn't, so we need a solution.  What about
dynamic binding?  You'd have to define a wrapper around `compile' that
establishes a new dynamic binding context for all of the bindings you
are interested in.  Somewhat nasty, but hey.

> One alternative appears to be to add the (undocumented) `joiner' field
> to a language definition so that `compile-file' effectively wraps the
> entire file in an implicit `begin'.

This would be another option, yes.

Regards,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 06 11:11:25 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXxc5-0003xI-R4
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:25 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52553)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbz-0003nY-0o
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:23 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbs-0001rA-9M
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:18 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:49672
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbs-0001mS-71
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:12 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id D055E7453;
	Tue,  6 Dec 2011 11:11:06 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=qROTqvtD8fMeIdtl4F4mQW5jF9Q=; b=fxsZv2
	AjWGnw7xJMkhg+lgUtBOY5ESyqq4fQxqymfiX6PtHQOhUe+ylBkIfG5zyMfMQ8oa
	dat/vcWWQXzC4Ixi8v/TtjZELM3iwihwZuhmKIOVLqGRAnrxRL9dRu6sGsdXfZLo
	hs09X1YNrqPcu/qpzbdUaEFby18pc+F2zU9Jk=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=Q6Cqo0d6OsaD6cmF1td+zpfpIRRvYh0A
	xJ64EdBJJVpy1IPKBYR9oBmyuNTY8x+xCOxlsVLPsEHnvHCC3BQqHSTEQ8QTBUpo
	G+2YXhvoH7pIfxZCOxu4/hdUb5bWpCGIOzePSGnXBd3tucoSCzmJXyvCOK4XwbXS
	rwNgOrHYRTo=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id C97F57452;
	Tue,  6 Dec 2011 11:11:06 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 04B7B7451;
	Tue,  6 Dec 2011 11:11:05 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Nala Ginrut <nalaginrut@gmail.com>
Subject: Re: guildhall update complain connection timeout
References: <1311003284.3054.79.camel@Renee-desktop>
	<1311213723.3136.5.camel@Renee-desktop> <87vctzdo7o.fsf@pobox.com>
	<CAPjoZofZP39k_ZBhR2PFCrRTHwQMJV8vOLaiWZ35B75USf4XmA@mail.gmail.com>
	<87bovpepoj.fsf@pobox.com>
Date: Tue, 06 Dec 2011 11:54:18 +0100
In-Reply-To: <87bovpepoj.fsf@pobox.com> (Andy Wingo's message of "Tue, 16 Aug
	2011 10:16:59 +0200")
Message-ID: <87bormotr9.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: E6D81A22-2024-11E1-A8CC-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 16:11:23 -0000

Hello Nala :)

On Tue 16 Aug 2011 10:16, Andy Wingo <wingo@pobox.com> writes:

> On Tue 16 Aug 2011 06:15, Nala Ginrut <nalaginrut@gmail.com> writes:
>
>> well, I think the network module of Guile uses iso-8859-1 to handle data
>> for some reasons. And my problem is Ubuntu chinese version doesn't have
>> iso-8859-1 installed. And I add it manually, so the connection
>> of Guile is OK now.
>
> I am unclear as to what it means to have iso-8859-1 installed or not.
> Does it mean that you don't have the gconv modules installed?
>
>     $ grep 8859-1// /usr/lib/x86_64-linux-gnu/gconv/gconv-modules
>     alias	ISO-IR-100//		ISO-8859-1//
>     alias	ISO_8859-1:1987//	ISO-8859-1//
>     alias	ISO_8859-1//		ISO-8859-1//
>     alias	ISO8859-1//		ISO-8859-1//
>     alias	ISO88591//		ISO-8859-1//
>     alias	LATIN1//		ISO-8859-1//
>     alias	L1//			ISO-8859-1//
>     alias	IBM819//		ISO-8859-1//
>     alias	CP819//			ISO-8859-1//
>     alias	CSISOLATIN1//		ISO-8859-1//
>     alias	8859_1//		ISO-8859-1//
>     alias	OSF00010001//		ISO-8859-1//
>     module	ISO-8859-1//		INTERNAL		ISO8859-1	1
>     module	INTERNAL		ISO-8859-1//		ISO8859-1	1
>
> (This would probably be on /usr/lib/gconv/gconv-modules on your system.)
>
> I also have a .so file, /usr/lib/x86_64-linux-gnu/gconv/ISO8859-1.so.
> Are these files not on your system by default?

Did you find an answer here?

We will need to change our assumptions if there are no ISO-8859-1
converters on a fresh Chinese Ubuntu install.

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 06 11:11:28 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXxc8-00040g-U1
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:28 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52606)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxc2-0003rF-Pr
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:27 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbx-0001tm-Pn
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:22 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:49928
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbx-0001tY-GG
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:17 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 382A2748D;
	Tue,  6 Dec 2011 11:11:17 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; s=sasl; bh=6BwKJ2Kt1Xq3
	eVt17W3hnnnWciQ=; b=NEM+opljBEeEi3HhaJTMYf2G0sAqfRnys4mgT0fHXOwK
	vms2DR4hlOBb9uReAwpSlcn8Z4MO3zZU93a5Y7D87sNHg4roj2Ud1G8onk3sMHzr
	8Z+kmLZVcxIbVFdKSe5IvHCHqiwDvtqKMuhkJ0zdgtX+Uri8a4CbZ8VZn0GMVjY=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; q=dns; s=sasl; b=us8gyU
	qjNK9o3msazNCPMgUNRkfPvXDEp4jZWs6M7stTcSUxzEyKE1cwU5r0156LPb2oum
	xyWpD9bdoLLnMMFaP3P70DDALQiNGFCJHGMywUsIaQEzAjMQMQ+ydcM+m6Spoaed
	jXHhSsZSBgc9KCwRY5XOxfdk5YZf+p/V0c+o8=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 26197748C;
	Tue,  6 Dec 2011 11:11:17 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 7F95F748B;
	Tue,  6 Dec 2011 11:11:16 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Peter Brett <peter@peter-b.co.uk>
Subject: Re: new module: (web client)
References: <87d3hblrsc.fsf@pobox.com> <87y5zvu4l9.fsf@gnu.org>
	<we1mvcuypv1l.fsf@ssclt001.ee.surrey.ac.uk>
Date: Tue, 06 Dec 2011 11:47:51 +0100
In-Reply-To: <we1mvcuypv1l.fsf@ssclt001.ee.surrey.ac.uk> (Peter Brett's
	message of "Tue, 19 Jul 2011 08:51:50 +0100")
Message-ID: <87liqqou20.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Pobox-Relay-ID: ED1B35EA-2024-11E1-9B24-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 16:11:27 -0000

On Tue 19 Jul 2011 09:51, Peter Brett <peter@peter-b.co.uk> writes:

> ludo@gnu.org (Ludovic Court=C3=A8s) writes:
>
>> What if URI is file://foo?
>
> Per RFC 1630 & RFC 1738, a file URL takes the form:
>
>   file://host/path
>
> For local files, the HOST part is elided:
>
>   file:///path
>
> So IMHO the posted code isn't *wrong* per se. ;-)

In that it specifies "foo" as the host.

file:///path appears to be invalid according to RFC3986, as the `host'
part is not optional if // follows the scheme.  However,
file:///etc/hosts is used as an example in the RFC.  I'm not sure what
to think here.

What is clear is that file:///foo is definitely a "normal" URI, in
practice, so we should probably interpret ://[/?#] as indicating no
authority, instead of being invalid.  I have done this in stable-2.0.

Andy
--=20
http://wingolog.org/


From MAILER-DAEMON Tue Dec 06 11:11:31 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXxcB-00045V-0i
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:31 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52623)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxc4-0003rV-4f
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:29 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxbu-0001sK-2e
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:11:23 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:49861
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RXxbt-0001sE-Sw; Tue, 06 Dec 2011 11:11:14 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id C1BD8748A;
	Tue,  6 Dec 2011 11:11:13 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; s=sasl; bh=kjxWnX/Jim0e
	ym4T3lYOE8hSe/8=; b=V5tYsiNdl6CPiFJj4gwP52irwWvFOcpWzrkPtrRbMPlb
	K2AzHCwKw/8ne+SIFAUj5pWqMC+lwCld91I288/m3sPxklMpFc1zi5xvaIyCcBF/
	KAtwE8RI5l7VLZaI3hytu6PZra2S79jkFtK3yaP02rZY+jtz+8BwULJlriB9wdE=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; q=dns; s=sasl; b=wQR3GC
	1R8J15Hm+kHuFY4AfNc4ne6FGBjl3yY/lqwBl5vK2rgTi+IfP3b34p8VEoNndrPL
	oTp7Px9puqDoLACjfFzvLQWLsLL5M2H32IY5NNJyw3YnEWotIHQkkSuVqDvR60Nr
	an8Wd04MCw8isw+2CMBeD4VZz+CW29ve8lae4=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id BBA227489;
	Tue,  6 Dec 2011 11:11:13 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 0C5C47488;
	Tue,  6 Dec 2011 11:11:12 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: ludo@gnu.org (Ludovic =?utf-8?Q?Court=C3=A8s?=)
Subject: Re: (define-module (foo) #:import (...)), a la r6rs
References: <87fwlqvgg9.fsf@pobox.com> <87wrf2w13m.fsf@gnu.org>
	<87hb2cdhc0.fsf@pobox.com> <87pqh0zwi5.fsf@gnu.org>
Date: Tue, 06 Dec 2011 12:30:31 +0100
In-Reply-To: <87pqh0zwi5.fsf@gnu.org> ("Ludovic =?utf-8?Q?Court=C3=A8s=22'?=
	=?utf-8?Q?s?= message of "Thu, 10 Nov 2011 00:50:10 +0100")
Message-ID: <87ty5endig.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Pobox-Relay-ID: EB095AB6-2024-11E1-A3EA-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 16:11:30 -0000

Hello :)

On Thu 10 Nov 2011 00:50, ludo@gnu.org (Ludovic Court=C3=A8s) writes:

> Andy Wingo <wingo@pobox.com> skribis:
>
>> On Thu 28 Jul 2011 23:23, ludo@gnu.org (Ludovic Court=C3=A8s) writes:
>>
>>> Andy Wingo <wingo@pobox.com> skribis:
>>>
>>>>   (define-module (foo)
>>>>     #:import ((bar)
>>>>               (only (baz) qux foo)
>>>>               ...))
>>>>
>>>> Or even:
>>>>
>>>>   (define-module (foo)
>>>>     (import (bar)
>>>>             (only (baz) qux foo)
>>>>             ...))
>>>
>>> I=E2=80=99d prefer #:use-modules (plural), for consistency:
>>>
>>>   (define-module (foo)
>>>     #:use-modules ((bar)
>>>                    (baz) #:select (qux foo)
>>>                    (chbouib) #:renamer (symbol-prefix-proc 'p)))
>>
>> I don't like the paren placement so much.  Consistency is important, but
>> TBH I think that we should phase out the "use-module" / "use-modules"
>> terminology, in favor of "import" terminology of r6rs and the coming
>> r7rs.
>
> I find aesthetics important, but phasing out such an important construct
> =E2=80=9Cjust=E2=80=9D for aesthetics seems harsh to me.

Yeah, but it is not simply aesthetics: it is consistency with other
schemes, `import' is the natural converse of `export', and the important
cases of "import only these bindings", "rename these particular
bindings", and "import this module with a prefix" are really easy in the
r6rs import language.

> Besides, stuff like #:renamer is strictly more powerful than what
> R[67]RS provide, IIRC.

No argument there!  But I rarely use it.  Even #:select is a bit of a
PITA to use:

  #:use-module ((a) #:select (b c d))
  #:use-module ((e) #:renamer (symbol-prefix-proc 'p:))

vs

  (import (only (a) b c d)
          (prefix (e) p:))

In particular the #:use-module variant has non-obvious paren placement
for #:select two places: the wrapper for the whole form, and the list of
bindings.  And of course #:renamer would still be there for you to
use. if you wanted to.

Dunno, I still think this would be a good idea, but I think we would
need to come to agreement first.

Andy
--=20
http://wingolog.org/


From MAILER-DAEMON Tue Dec 06 11:26:16 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXxqS-0002H2-DQ
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 11:26:16 -0500
Received: from eggs.gnu.org ([140.186.70.92]:50387)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxqL-0002Fj-BC
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:26:14 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXxqC-0005Us-1P
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:26:09 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:64575
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RXxq7-0005Tl-3t; Tue, 06 Dec 2011 11:25:55 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 665727610;
	Tue,  6 Dec 2011 11:25:54 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=3pHKzTE6ReoWgjZHwev4bGTnsxk=; b=LuAiS3
	r0UsH0r30cjIYfIaBRPMcqu0K1p9IO+GwN+defdEQVXWvlBmQlUUtUXWW/c5jcbT
	OFKsCBeJjU0/rHgDYNX70KoX07am+K2Touf+sLFOtIjlnNUCtYFma/X+0DugZoyd
	r57Z6ouuLHk7nPKq5FbMHEqqvOvcV6+8OOv+8=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=lSDExBNdmgvCH/qrzILKxA3p5+N8AzZR
	DTwdqg+7TW7Qa6XOWUiihqIJP9my39fsiyacuT4cfchOB4lEcagQObmqT+IhP4I/
	nabheAFstCowStW5AA4cFxLuTlTDtY1cbfwWS7WIIqJmm6IjCnZLOazj8d2vbPyu
	F/7XeXQqmlA=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 58595760E;
	Tue,  6 Dec 2011 11:25:54 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 9797A760B;
	Tue,  6 Dec 2011 11:25:53 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: when and unless
References: <878vsjd2fh.fsf@pobox.com> <87r50ircng.fsf@pobox.com>
	<4EDDC8B1.3000509@gentoo.org>
	<CAMMPzYMoKuQSWnBMCoZ_+ggcrmk+SGvbyaKvYLb=eJVRbR6E1Q@mail.gmail.com>
	<87mxb6kkzx.fsf@fencepost.gnu.org>
Date: Tue, 06 Dec 2011 17:25:49 +0100
In-Reply-To: <87mxb6kkzx.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Tue, 06 Dec 2011 12:17:06 +0100")
Message-ID: <877h29oeeq.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: F7E5CB32-2026-11E1-8FEB-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 16:26:15 -0000

On Tue 06 Dec 2011 12:17, David Kastrup <dak@gnu.org> writes:

> I've actually wondered if it would not make sense to return
> *unspecified* in the case of the plain else-less if even if the
> condition is true, namely when you write (if #t #t).

I have wondered this too.

> There is probably code relying on this to be #t, but frankly, this
> appears like a recipe for breakage.

Yeah.  A first (and probably worthwhile) step would be to warn if such a
statement is processed for value.  Warning on one-armed ifs in tail
position of a function would be harder, as you would have to analyze the
call sites of the function.

Regards,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 06 11:42:46 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXy6Q-0003TM-Lb
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 11:42:46 -0500
Received: from eggs.gnu.org ([140.186.70.92]:51340)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXy6M-0003SB-Qq
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:42:45 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXy6J-0000VD-6s
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:42:42 -0500
Received: from lo.gmane.org ([80.91.229.12]:44663)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXy6I-0000V9-Qh
	for guile-devel@gnu.org; Tue, 06 Dec 2011 11:42:39 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RXy6F-0005CM-W7
	for guile-devel@gnu.org; Tue, 06 Dec 2011 17:42:35 +0100
Received: from p508ed485.dip.t-dialin.net ([80.142.212.133])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 06 Dec 2011 17:42:35 +0100
Received: from dak by p508ed485.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 06 Dec 2011 17:42:35 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: when and unless
Date: Tue, 06 Dec 2011 17:42:23 +0100
Organization: Organization?!?
Lines: 27
Message-ID: <877h29k5xs.fsf@fencepost.gnu.org>
References: <878vsjd2fh.fsf@pobox.com> <87r50ircng.fsf@pobox.com>
	<4EDDC8B1.3000509@gentoo.org>
	<CAMMPzYMoKuQSWnBMCoZ_+ggcrmk+SGvbyaKvYLb=eJVRbR6E1Q@mail.gmail.com>
	<87mxb6kkzx.fsf@fencepost.gnu.org> <877h29oeeq.fsf@pobox.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ed485.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:/vEVriti5liuzdebONOlUKe9p3M=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 16:42:45 -0000

Andy Wingo <wingo@pobox.com> writes:

> On Tue 06 Dec 2011 12:17, David Kastrup <dak@gnu.org> writes:
>
>> I've actually wondered if it would not make sense to return
>> *unspecified* in the case of the plain else-less if even if the
>> condition is true, namely when you write (if #t #t).
>
> I have wondered this too.
>
>> There is probably code relying on this to be #t, but frankly, this
>> appears like a recipe for breakage.
>
> Yeah.  A first (and probably worthwhile) step would be to warn if such
> a statement is processed for value.

Well, is it being processed for value if what I do with the value is
calling unspecified? on it in order to find out whether I should warn
about a function returning a value when it shouldn't?

I am working on a language where returning values in certain contexts
might at one point of time might lead to the values being used.  So I
need to implement warnings to that effect in order to find out calls
_not_ returning *unspecified*...

-- 
David Kastrup



From MAILER-DAEMON Tue Dec 06 12:35:32 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RXyvU-0003o5-8j
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 12:35:32 -0500
Received: from eggs.gnu.org ([140.186.70.92]:58057)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXyvN-0003j5-Fd
	for guile-devel@gnu.org; Tue, 06 Dec 2011 12:35:29 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RXyvM-0004Cg-5g
	for guile-devel@gnu.org; Tue, 06 Dec 2011 12:35:25 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:43504
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RXyvJ-0004Bc-Kt; Tue, 06 Dec 2011 12:35:21 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 14067801D;
	Tue,  6 Dec 2011 12:35:21 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=pkEWQr+UppHB8ass/GsdN6Xk/c8=; b=hme5Iq
	b7TkT3t6I/oa1k90WOcvKv3U5r96ycu1heUcsuEft+NkxDo0LMLUQ2xgkJ+jDpDo
	uZwMyMmQuJDUxSkecx49lWaUsRFgJkFLhV8F5Jl552L57K/prO2Hhas7fGlLWk7B
	c6b6DLgtejwx6kwZsuGJFS8riDL59ParGcY5o=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=Nxz/bcak8GKhfIbd378YLgIZ0qTl6phE
	9VkVhtXWUfMBADYZZqPkd69AyINZ2d2jjQAcym9p1dmlAMc3SNmjL8IM5tgKXVlY
	SsMDv0hx4Je5dd4x1nCLHFAXKDdDqxOrRmhUjMmX5FdbWtmHew3Dd23iIJAzSs4f
	eEB4OEGP4D4=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 0D050801C;
	Tue,  6 Dec 2011 12:35:21 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 4F71D801A;
	Tue,  6 Dec 2011 12:35:20 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: when and unless
References: <878vsjd2fh.fsf@pobox.com> <87r50ircng.fsf@pobox.com>
	<4EDDC8B1.3000509@gentoo.org>
	<CAMMPzYMoKuQSWnBMCoZ_+ggcrmk+SGvbyaKvYLb=eJVRbR6E1Q@mail.gmail.com>
	<87mxb6kkzx.fsf@fencepost.gnu.org> <877h29oeeq.fsf@pobox.com>
	<877h29k5xs.fsf@fencepost.gnu.org>
Date: Tue, 06 Dec 2011 18:35:16 +0100
In-Reply-To: <877h29k5xs.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Tue, 06 Dec 2011 17:42:23 +0100")
Message-ID: <8739cxob6z.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: AB71FDDE-2030-11E1-A5BA-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 17:35:30 -0000

On Tue 06 Dec 2011 17:42, David Kastrup <dak@gnu.org> writes:

> Andy Wingo <wingo@pobox.com> writes:
>
>> On Tue 06 Dec 2011 12:17, David Kastrup <dak@gnu.org> writes:
>>
>>> I've actually wondered if it would not make sense to return
>>> *unspecified* in the case of the plain else-less if even if the
>>> condition is true, namely when you write (if #t #t).
>>
>> A first (and probably worthwhile) step would be to warn if such
>> a statement is processed for value.
>
> Well, is it being processed for value if what I do with the value is
> calling unspecified? on it in order to find out whether I should warn
> about a function returning a value when it shouldn't?

Yes, it would be.

Note, in R5RS scheme, this should be true:

  (eqv? (if #f #f) (if #f #f))

In R6RS (and R7RS, I think) scheme it does not have any meaning --
implementations are free to do what they like.

The reason is that (if #f #f) returns "unspecified values" rather than a
canonical "unspecified value".  So the implementation may treat it like:

  (eqv? (values) (values))

which is strictly unspecified, as it is returning an unexpected number
of values to a continuation.

Guile 1.8:

    guile> (eqv? (values) (values))
    #f

Guile 2.0:

    scheme@(guile-user)> (eqv? (values) (values))
    ERROR: In procedure values:
    ERROR: Throw to key `vm-error' with args `(vm-run "Zero values returned to single-valued continuation" ())'.

Not a nicely printed error, but oh well.

Guile 2.0 returns a canonical unspecified value in this situation.  I
would like to consider returning 0 values instead in the future, but
figuring out how to do so without breaking the world is tricky.  It's
useful to hear about your experiences with *unspecified*.

> I am working on a language where returning values in certain contexts
> might at one point of time might lead to the values being used.  So I
> need to implement warnings to that effect in order to find out calls
> _not_ returning *unspecified*...

Have you considered using `(values)' as your way of saying, "I'm not
returning any values"?

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 06 14:06:23 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RY0LP-00080J-IL
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 14:06:23 -0500
Received: from eggs.gnu.org ([140.186.70.92]:46009)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RY0LI-0007xx-PN
	for guile-devel@gnu.org; Tue, 06 Dec 2011 14:06:21 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RY0LH-0004Z0-Fh
	for guile-devel@gnu.org; Tue, 06 Dec 2011 14:06:16 -0500
Received: from mail-yx0-f169.google.com ([209.85.213.169]:53413)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RY0LH-0004Yw-DI
	for guile-devel@gnu.org; Tue, 06 Dec 2011 14:06:15 -0500
Received: by yenq10 with SMTP id q10so7055049yen.0
	for <guile-devel@gnu.org>; Tue, 06 Dec 2011 11:06:14 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=date:from:to:subject:message-id:mail-followup-to:references
	:mime-version:content-type:content-disposition:in-reply-to
	:user-agent; bh=XCLxvJlZpboIsWs2GcIRoIlqKOKjfSCGNZWmoMRMlew=;
	b=be8zPDauY8S7n4WpU5NsolNYS7/0+8XxqSKOW/O2fqOzalgLW1dAuukuKHwFBzCxA+
	ayk6ZPJKwHRFYgbWK2bhb1zI+CAEGhdrJb9lYCj/LQGJ349m5re96Y0yoBRevd1pGb0i
	m2Pt65emrzcve49ENNBcj/EKtTNO1Xu9RlfJM=
Received: by 10.236.201.196 with SMTP id b44mr21670722yho.48.1323198374406;
	Tue, 06 Dec 2011 11:06:14 -0800 (PST)
Received: from yarrow.destinee.acro.gen.nz (md82c36d0.tmodns.net.
	[208.54.44.216])
	by mx.google.com with ESMTPS id y40sm26432760yhg.18.2011.12.06.11.06.11
	(version=SSLv3 cipher=OTHER); Tue, 06 Dec 2011 11:06:12 -0800 (PST)
Date: Tue, 6 Dec 2011 14:05:52 -0500
From: "Chris K. Jester-Young" <cky944@gmail.com>
To: guile-devel@gnu.org
Subject: Re: when and unless
Message-ID: <20111206190552.GA14416@yarrow.destinee.acro.gen.nz>
Mail-Followup-To: guile-devel@gnu.org
References: <878vsjd2fh.fsf@pobox.com> <87r50ircng.fsf@pobox.com>
	<4EDDC8B1.3000509@gentoo.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <4EDDC8B1.3000509@gentoo.org>
User-Agent: Mutt/1.5.20 (2009-06-14)
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.213.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 19:06:21 -0000

On Tue, Dec 06, 2011 at 08:48:01AM +0100, Marijn wrote:
> Couldn't help but wonder why they don't return the value of the last
> body form, so I looked around a bit and both CLHS[1] and my racket
> REPL seem to agree that they should:
[...]
> Is there some other source that suggests that the return value should
> be unspecified?

This isn't so much because the return value is somehow specified or
useful, but rather to avoid breaking tail position. See this discussion
I had with Eli Barzilay where this is explained:

http://rotty.yi.org/irclogs/freenode/%23scheme/2011-11-02/#e208

(Start at the 07:24 timestamp if the fragment reference isn't working.)

Cheers,
Chris.


From MAILER-DAEMON Tue Dec 06 14:27:33 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RY0ft-0007K1-EX
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 14:27:33 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52043)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RY0fq-0007Hz-S8
	for guile-devel@gnu.org; Tue, 06 Dec 2011 14:27:31 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RY0fp-0000Ts-Hq
	for guile-devel@gnu.org; Tue, 06 Dec 2011 14:27:30 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:49774
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RY0fp-0000To-Cu
	for guile-devel@gnu.org; Tue, 06 Dec 2011 14:27:29 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id C0D138CF5;
	Tue,  6 Dec 2011 14:27:28 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=BkKQ02/pS9v8V0ZCXLitMjwacmM=; b=xDsCPo
	dC/puqL2uPAUCSlbnT7dhSfKHfbVZP4CvdpCm6nNdDHmfXr4rnJmZDQlB2MaWBWu
	lf0Q9aZ45B3nAgqOKOsXhOPF948prE7n3GjtMPBxg6jRXpRx++0OsSLVYl9x+UQ0
	vbBtL9d18J6Z8YB1+JFCLYL4GbVhULK4gs1VA=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=XKzEjj/QeXSngvwYsBPoGuUEZYo1kFzE
	H8zaJlT7DqPiRI5j0R90VZDtOd4NqMGAprj55d3U0e36IYGC+lTxYtj0zLO28t3D
	U/nAtT6PtFHQCvNMKKeIpCN37LkmwoxzSYJpyixyk+0SIgei0N8ah6DBFgrOlsCW
	vOKs6U21U7A=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id BA9728CF4;
	Tue,  6 Dec 2011 14:27:28 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 2CCDE8CF3;
	Tue,  6 Dec 2011 14:27:28 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Ian Price <ianprice90@googlemail.com>
Subject: Re: Change to write-request-line
References: <m3sjnfm8tn.fsf@Kagami.home>
Date: Tue, 06 Dec 2011 20:27:25 +0100
In-Reply-To: <m3sjnfm8tn.fsf@Kagami.home> (Ian Price's message of "Thu, 29
	Sep 2011 20:45:24 +0100")
Message-ID: <87ty5dmrfm.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 558FE268-2040-11E1-A18C-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 19:27:32 -0000

On Thu 29 Sep 2011 21:45, Ian Price <ianprice90@googlemail.com> writes:

> Two patches for the web stuff in guile. The first removes the second
> definition of 'write-uri' from module/web/http.scm. No point having two
> of them after all :-).

Probably better to remove the first one.  The second one allocates less,
catches some important error conditions, and doesn't write the fragment
component.

> The second changes 'write-request-line' to write paths rather than full
> uris. Quoth the RFC
>
>    The most common form of Request-URI is that used to identify a
>    resource on an origin server or gateway. In this case the absolute
>    path of the URI MUST be transmitted (see section 3.2.1, abs_path) as
>    the Request-URI, and the network location of the URI (authority) MUST
>    be transmitted in a Host header field.
>
> While the RFC also says that "The absoluteURI form is REQUIRED when the
> request is being made to a proxy.", reading through the code for Ruby's
> Net::HTTP and Haskell's Network.HTTP, they both seem to just use the
> path and not provide for this situation, so I've held back on including
> a #:absolute-uri? keyword to cover this.
>
> Any thoughts on this?

I guess that's OK.  Proxies probably DTRT already, and anyone who wants
something different should be able to write it fairly easily.

One thing though, you are missing the query component.  Care to post a
modifed patch?

Thanks, and sorry for the delay!

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 06 14:33:38 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RY0lm-0001MC-Qt
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 14:33:38 -0500
Received: from eggs.gnu.org ([140.186.70.92]:58883)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RY0lk-0001K0-CR
	for guile-devel@gnu.org; Tue, 06 Dec 2011 14:33:37 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RY0li-0001kQ-R2
	for guile-devel@gnu.org; Tue, 06 Dec 2011 14:33:36 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:63276
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RY0li-0001kE-OC
	for guile-devel@gnu.org; Tue, 06 Dec 2011 14:33:34 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 0291B8DCD
	for <guile-devel@gnu.org>; Tue,  6 Dec 2011 14:33:34 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=JbuD9h00Ncvt2qy5uajykuV9kys=; b=O0G8sR
	jK8bB84keKzK84JcyneNDXfm+mvfxJDiEtwJDHWrBS6ONYbc907zpi0FKj0Wcafk
	lxT9pPaJGptzwV9PJQGc1Ugkv2UWhvjzrkIMIM+PouKpEATPZ7dVWvIrDEZHZJpI
	a5gWNJSVzznWsTYAvM3Spn/m3xuB0s34ZpvM0=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:subject
	:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=p/PezQOnWMvm1xBNXNjt0iP6+kX9XMCT
	NEsH/d61SWZUEF/K2oTbiJmPSJOMrnVoa0KVYVXbCluh8z4Cm4F4/irOuEcI24Uj
	2UGDQuj9EZziAjh+2vvzeztaF6ElNpn93ECb9XlsUnLOLmMYl7aAsm+pTY9kCm3n
	WZHWOPUExlU=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id EFD588DCC
	for <guile-devel@gnu.org>; Tue,  6 Dec 2011 14:33:33 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 421168DCB for
	<guile-devel@gnu.org>; Tue,  6 Dec 2011 14:33:33 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: guile-devel@gnu.org
Subject: Re: when and unless
References: <878vsjd2fh.fsf@pobox.com> <87r50ircng.fsf@pobox.com>
	<4EDDC8B1.3000509@gentoo.org>
	<20111206190552.GA14416@yarrow.destinee.acro.gen.nz>
Date: Tue, 06 Dec 2011 20:33:29 +0100
In-Reply-To: <20111206190552.GA14416@yarrow.destinee.acro.gen.nz> (Chris K.
	Jester-Young's message of "Tue, 6 Dec 2011 14:05:52 -0500")
Message-ID: <87pqg1mr5i.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 2F2B9468-2041-11E1-9F79-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 19:33:37 -0000

On Tue 06 Dec 2011 20:05, "Chris K. Jester-Young" <cky944@gmail.com> writes:

> On Tue, Dec 06, 2011 at 08:48:01AM +0100, Marijn wrote:
>> Couldn't help but wonder why they don't return the value of the last
>> body form, so I looked around a bit and both CLHS[1] and my racket
>> REPL seem to agree that they should:
> [...]
>> Is there some other source that suggests that the return value should
>> be unspecified?
>
> This isn't so much because the return value is somehow specified or
> useful, but rather to avoid breaking tail position. See this discussion
> I had with Eli Barzilay where this is explained:
>
> http://rotty.yi.org/irclogs/freenode/%23scheme/2011-11-02/#e208
>
> (Start at the 07:24 timestamp if the fragment reference isn't working.)

Ah, OK.  Indeed this is a very good point, I didn't realize this
before.  Hummm.

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 06 14:37:44 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RY0pk-0002tI-NZ
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 14:37:44 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59577)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RY0pi-0002ry-If
	for guile-devel@gnu.org; Tue, 06 Dec 2011 14:37:43 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RY0pf-0002ek-Or
	for guile-devel@gnu.org; Tue, 06 Dec 2011 14:37:42 -0500
Received: from mail-gx0-f169.google.com ([209.85.161.169]:54214)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RY0pf-0002ea-IV
	for guile-devel@gnu.org; Tue, 06 Dec 2011 14:37:39 -0500
Received: by ggnq4 with SMTP id q4so8042942ggn.0
	for <guile-devel@gnu.org>; Tue, 06 Dec 2011 11:37:38 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=date:from:to:subject:message-id:mail-followup-to:mime-version
	:content-type:content-disposition:user-agent;
	bh=O1WfevFQ6oeH2qVhRndmafOBtZiMHfnSO51+yqNDKkI=;
	b=QsyGFO/auC9Ll0U8M8axlX8+8XHH5fAWUds/kEF2cse4jiEjWtMWc0ejWBy5JgZUGg
	Z3P7PnzjvzuP3VwQGWE9RYl1Xn1Cmq7PRfmjBwS6/HhfKNTFkp3VB8XwXpCftkog4VnX
	UhxH9s9SSnW26po3KU0tGRSZph686sEkKaHXA=
Received: by 10.236.149.243 with SMTP id x79mr8326725yhj.92.1323200256774;
	Tue, 06 Dec 2011 11:37:36 -0800 (PST)
Received: from yarrow.destinee.acro.gen.nz (md82c36d0.tmodns.net.
	[208.54.44.216])
	by mx.google.com with ESMTPS id c10sm38898751yhj.2.2011.12.06.11.37.32
	(version=SSLv3 cipher=OTHER); Tue, 06 Dec 2011 11:37:35 -0800 (PST)
Date: Tue, 6 Dec 2011 14:37:28 -0500
From: "Chris K. Jester-Young" <cky944@gmail.com>
To: guile-devel@gnu.org
Subject: SRFI 41 for Guile
Message-ID: <20111206193728.GB14416@yarrow.destinee.acro.gen.nz>
Mail-Followup-To: guile-devel@gnu.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.5.20 (2009-06-14)
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.161.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 19:37:43 -0000

Hi all,

Just writing to say that after many months of being busy with other
stuff, I finally got around to finishing my Guile port of SRFI 41:

https://github.com/cky/guile2-modules

Basically, both the code and the tests are based on the reference
implementation, albeit with somewhat significant changes (as Andreas
Rottmann pointed out ;-)) to make better use of Guile's features:

+ The tests use Guile's (test-suite lib) test framework.

+ define*/lambda* is used for handling optional arguments, rather than
  manual argument unpacking. In the odd case of stream->list where the
  optional argument is the leftmost one, I used case-lambda instead.

+ Guile's SRFI 45 is used directly, rather than reimplemented as in the
  reference implementation.

+ stream-match and stream-unfolds are complete rewrites. stream-match
  uses (ice-9 match), and stream-unfolds uses (ice-9 q) to store the
  unread results.

+ stream-constant uses circular-list to hold the values of interest,
  rather than...whatever the reference implementation does with append
  (see for yourself, if you're curious ;-)).

The long and short is that whatever functionality is covered by an
existing Guile module or builtin feature, I tried to make the best use
of it. Still, I don't know every Guile module there is, so if I missed
something, please let me know!

Before anyone asks, though, I can't use (ice-9 streams)---it works on
a very different streaming model from SRFI 41, as explained in the
latter's introduction.

Comments are very welcome. :-)

Enjoy!
Chris.


From MAILER-DAEMON Tue Dec 06 14:46:15 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RY0xz-0006jS-1h
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 14:46:15 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59822)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <marco.maggi-ipsu@poste.it>) id 1RY0xw-0006id-S4
	for guile-devel@gnu.org; Tue, 06 Dec 2011 14:46:13 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <marco.maggi-ipsu@poste.it>) id 1RY0xv-0004so-SS
	for guile-devel@gnu.org; Tue, 06 Dec 2011 14:46:12 -0500
Received: from relay-pt2.poste.it ([62.241.5.253]:45923)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <marco.maggi-ipsu@poste.it>)
	id 1RY0xu-0004sQ-GO; Tue, 06 Dec 2011 14:46:10 -0500
Received: from rapitore.luna (2.33.217.176) by relay-pt2.poste.it (8.5.142)
	(authenticated as marco.maggi-ipsu@poste.it)
	id 4EDD5B8100037CC8; Tue, 6 Dec 2011 20:46:08 +0100
Sender: marco@rapitore.luna
Original-Sender: marco.maggi-ipsu@poste.it
X-Loop: marco@maggi.it.invalid
X-Mailer: GNU Emacs
In-Reply-To: marco.maggi-ipsu@poste.it
	"Sat\, 03 Dec 2011 16\:45\:06 +0100")
References: <87liqtpsl9.fsf@fencepost.gnu.org>
To: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
From: Marco Maggi <marco.maggi-ipsu@poste.it>
Date: Tue, 06 Dec 2011 20:50:57 +0100
Message-ID: <874nxdwkbi.fsf@rapitore.luna>
Lines: 21
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-detected-operating-system: by eggs.gnu.org: Solaris 9
X-Received-From: 62.241.5.253
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 19:46:13 -0000

David Kastrup wrote:
> Hi, if I have something  read that is evaluated later, the
> lack  of procedure-environment in  Guilev2 implies  that I
> have  to wrap the  stuff in  (lambda ()  ...) in  order to
> capture the lexical environment for evaluation.

Sorry to step in without  an answer.  What are you trying to
do?  What I  understand is that a Scheme  program reads some
expressions and tries to evaluate them in a specific context
of the program.   Are you looking for a  way to do something
like the following chunk I found on the Net?

(define x 0)
(define clo 
  (let ((x 1)) 
    (lambda () '())))
(local-eval 'x (procedure-environment clo))
=> 1 

-- 
Marco Maggi


From MAILER-DAEMON Tue Dec 06 17:12:30 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RY3FW-0003Gs-LQ
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 17:12:30 -0500
Received: from eggs.gnu.org ([140.186.70.92]:38383)
	by lists.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RY3FU-0003GQ-BZ
	for guile-devel@gnu.org; Tue, 06 Dec 2011 17:12:29 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dak@gnu.org>) id 1RY3FS-0004qO-0M
	for guile-devel@gnu.org; Tue, 06 Dec 2011 17:12:28 -0500
Received: from fencepost.gnu.org ([140.186.70.10]:45004)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RY3FR-0004qK-Tr
	for guile-devel@gnu.org; Tue, 06 Dec 2011 17:12:25 -0500
Received: from localhost ([127.0.0.1]:54923 helo=lola)
	by fencepost.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dak@gnu.org>)
	id 1RY3FR-0000OH-FP; Tue, 06 Dec 2011 17:12:25 -0500
Received: by lola (Postfix, from userid 1000)
	id 99686E0D58; Tue,  6 Dec 2011 23:08:09 +0100 (CET)
From: David Kastrup <dak@gnu.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: when and unless
References: <878vsjd2fh.fsf@pobox.com> <87r50ircng.fsf@pobox.com>
	<4EDDC8B1.3000509@gentoo.org>
	<CAMMPzYMoKuQSWnBMCoZ_+ggcrmk+SGvbyaKvYLb=eJVRbR6E1Q@mail.gmail.com>
	<87mxb6kkzx.fsf@fencepost.gnu.org> <877h29oeeq.fsf@pobox.com>
	<877h29k5xs.fsf@fencepost.gnu.org> <8739cxob6z.fsf@pobox.com>
Date: Tue, 06 Dec 2011 23:08:08 +0100
In-Reply-To: <8739cxob6z.fsf@pobox.com> (Andy Wingo's message of "Tue, 06 Dec
	2011 18:35:16 +0100")
Message-ID: <87y5upicaf.fsf@fencepost.gnu.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.90 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 140.186.70.10
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 22:12:29 -0000

Andy Wingo <wingo@pobox.com> writes:

> which is strictly unspecified, as it is returning an unexpected number
> of values to a continuation.
>
> Guile 1.8:
>
>     guile> (eqv? (values) (values))
>     #f
>
> Guile 2.0:
>
>     scheme@(guile-user)> (eqv? (values) (values))
>     ERROR: In procedure values:
>     ERROR: Throw to key `vm-error' with args `(vm-run "Zero values returned to single-valued continuation" ())'.
>
> Not a nicely printed error, but oh well.
>
> Guile 2.0 returns a canonical unspecified value in this situation.  I
> would like to consider returning 0 values instead in the future, but
> figuring out how to do so without breaking the world is tricky.  It's
> useful to hear about your experiences with *unspecified*.
>
>> I am working on a language where returning values in certain contexts
>> might at one point of time might lead to the values being used.  So I
>> need to implement warnings to that effect in order to find out calls
>> _not_ returning *unspecified*...
>
> Have you considered using `(values)' as your way of saying, "I'm not
> returning any values"?

Testing for that is not all that much fun.  It is also rather useless
since pretty much all of the call-for-effect functions of Guile return
*unspecified* rather than (values).

It is not clear to me why (values) can't just evaluate to a single
*unspecified* just like '() evaluates to null.  Outside of
call-with-values, I don't see much need to treat it special.

-- 
David Kastrup


From MAILER-DAEMON Tue Dec 06 18:06:14 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RY45W-0003GG-SW
	for mharc-guile-devel@gnu.org; Tue, 06 Dec 2011 18:06:14 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52164)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RY45T-0003Co-Oo
	for guile-devel@gnu.org; Tue, 06 Dec 2011 18:06:12 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RY45S-0005Tk-Nf
	for guile-devel@gnu.org; Tue, 06 Dec 2011 18:06:11 -0500
Received: from mail-gx0-f169.google.com ([209.85.161.169]:50522)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RY45S-0005Tg-I0
	for guile-devel@gnu.org; Tue, 06 Dec 2011 18:06:10 -0500
Received: by ggnq4 with SMTP id q4so8273316ggn.0
	for <guile-devel@gnu.org>; Tue, 06 Dec 2011 15:06:10 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=date:from:to:subject:message-id:mail-followup-to:references
	:mime-version:content-type:content-disposition:in-reply-to
	:user-agent; bh=KHoVdTEahGUboxjZ12d5JDtSzFNe9Pe4F9xYfeWw/Fs=;
	b=fPiY2he86Ed5D2f3i+dYbyIe0B6Hcjit2qFGazgsMGsXlpxZ2RcpTyB1SlU60rFSSi
	fPiMyK+CMSHDB/bNglO1tNd00aWcWlwhgSm8idVmOBWs7ZU+gW0fQSJ+clwaf/DGv638
	a9bySuMLNPcwNv0bXjTvayIQPOqG7A6NLWJEs=
Received: by 10.236.189.97 with SMTP id b61mr22869810yhn.116.1323212769992;
	Tue, 06 Dec 2011 15:06:09 -0800 (PST)
Received: from yarrow.destinee.acro.gen.nz (ma92c36d0.tmodns.net.
	[208.54.44.169])
	by mx.google.com with ESMTPS id f75sm39767161yhi.13.2011.12.06.15.06.06
	(version=SSLv3 cipher=OTHER); Tue, 06 Dec 2011 15:06:09 -0800 (PST)
Date: Tue, 6 Dec 2011 18:05:56 -0500
From: "Chris K. Jester-Young" <cky944@gmail.com>
To: guile-devel@gnu.org
Subject: Re: when and unless
Message-ID: <20111206230556.GA14717@yarrow.destinee.acro.gen.nz>
Mail-Followup-To: guile-devel@gnu.org
References: <878vsjd2fh.fsf@pobox.com> <87r50ircng.fsf@pobox.com>
	<4EDDC8B1.3000509@gentoo.org>
	<CAMMPzYMoKuQSWnBMCoZ_+ggcrmk+SGvbyaKvYLb=eJVRbR6E1Q@mail.gmail.com>
	<87mxb6kkzx.fsf@fencepost.gnu.org> <877h29oeeq.fsf@pobox.com>
	<877h29k5xs.fsf@fencepost.gnu.org> <8739cxob6z.fsf@pobox.com>
	<87y5upicaf.fsf@fencepost.gnu.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <87y5upicaf.fsf@fencepost.gnu.org>
User-Agent: Mutt/1.5.20 (2009-06-14)
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.161.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 06 Dec 2011 23:06:13 -0000

On Tue, Dec 06, 2011 at 11:08:08PM +0100, David Kastrup wrote:
> > Have you considered using `(values)' as your way of saying, "I'm not
> > returning any values"?
> 
> Testing for that is not all that much fun.  It is also rather useless
> since pretty much all of the call-for-effect functions of Guile return
> *unspecified* rather than (values).

You're not really supposed to test for it. In fact, if you don't try to
use the value of when, unless, or one-armed ifs, you'll do just fine in
general.

> It is not clear to me why (values) can't just evaluate to a single
> *unspecified* just like '() evaluates to null.  Outside of
> call-with-values, I don't see much need to treat it special.

Implementing that would pretty much either require CPS transforms all
around (then you'd look at the arity of the continuation), or else
you'd have to be keeping track of the arity of the current continuation
some other way. Is it just me, or does that smell like Perl's wantarray?

Which brings me to a bigger question---do we even want anything like
wantarray? It seems so insanely hacky (to me), even in Perl code.

Just my humble opinion,
Chris.


From MAILER-DAEMON Wed Dec 07 04:23:49 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYDjB-000253-VY
	for mharc-guile-devel@gnu.org; Wed, 07 Dec 2011 04:23:49 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55417)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYDj8-00021f-KJ
	for guile-devel@gnu.org; Wed, 07 Dec 2011 04:23:47 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYDj4-0005Rm-8E
	for guile-devel@gnu.org; Wed, 07 Dec 2011 04:23:46 -0500
Received: from lo.gmane.org ([80.91.229.12]:60000)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYDj3-0005Rd-Pt
	for guile-devel@gnu.org; Wed, 07 Dec 2011 04:23:42 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYDj1-00005X-TM
	for guile-devel@gnu.org; Wed, 07 Dec 2011 10:23:39 +0100
Received: from p508eaf98.dip.t-dialin.net ([80.142.175.152])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 07 Dec 2011 10:23:39 +0100
Received: from dak by p508eaf98.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 07 Dec 2011 10:23:39 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: when and unless
Date: Wed, 07 Dec 2011 10:23:25 +0100
Organization: Organization?!?
Lines: 59
Message-ID: <87liqoivle.fsf@fencepost.gnu.org>
References: <878vsjd2fh.fsf@pobox.com> <87r50ircng.fsf@pobox.com>
	<4EDDC8B1.3000509@gentoo.org>
	<CAMMPzYMoKuQSWnBMCoZ_+ggcrmk+SGvbyaKvYLb=eJVRbR6E1Q@mail.gmail.com>
	<87mxb6kkzx.fsf@fencepost.gnu.org> <877h29oeeq.fsf@pobox.com>
	<877h29k5xs.fsf@fencepost.gnu.org> <8739cxob6z.fsf@pobox.com>
	<87y5upicaf.fsf@fencepost.gnu.org>
	<20111206230556.GA14717@yarrow.destinee.acro.gen.nz>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508eaf98.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:sarJt0DaxxBvB7yoQWdFs1j9y8c=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 07 Dec 2011 09:23:47 -0000

"Chris K. Jester-Young" <cky944@gmail.com> writes:

> On Tue, Dec 06, 2011 at 11:08:08PM +0100, David Kastrup wrote:
>> > Have you considered using `(values)' as your way of saying, "I'm not
>> > returning any values"?
>> 
>> Testing for that is not all that much fun.  It is also rather useless
>> since pretty much all of the call-for-effect functions of Guile return
>> *unspecified* rather than (values).
>
> You're not really supposed to test for it.

Lilypond is not Scheme but has a more complex syntax.  You can use
Scheme in a lot of places with different implications on the grammar
depending on the type of the expression.  It would not be feasible to
create a separate Scheme calling operator for every possible type of
expression.  And "called just for action" is one such type.

>> It is not clear to me why (values) can't just evaluate to a single
>> *unspecified* just like '() evaluates to null.  Outside of
>> call-with-values, I don't see much need to treat it special.
>
> Implementing that would pretty much either require CPS transforms all
> around (then you'd look at the arity of the continuation), or else
> you'd have to be keeping track of the arity of the current
> continuation some other way. Is it just me, or does that smell like
> Perl's wantarray?

Well, you'd need to have

(call-with-values (lambda () *unspecified*) (lambda x (length x))) => 0

That's the actual clincher I presume?  If one takes a look at the Scheme
language definition, one finds for one thing:

(define (values . things)
  (call-with-current-continuation 
    (lambda (cont) (apply cont things))))

And, more importantly:

    Except for continuations created by the call-with-values procedure,
    all continuations take exactly one value.

That means that one _only_ needs to consider the implications on
call-with-values continuations.

And it is not like Guile has a problem distinguishing content and
package itself (at least Guile 1.8):

guile> (write *unspecified*)
#<unspecified>guile> (write (values))
#<values ()>guile> 

So I still don't quite see the problem that would arise from making
(eq? *unspecified* (values)) => #t

-- 
David Kastrup



From MAILER-DAEMON Wed Dec 07 07:58:51 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYH5H-00074i-4c
	for mharc-guile-devel@gnu.org; Wed, 07 Dec 2011 07:58:51 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55618)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYH59-00071j-TD
	for guile-devel@gnu.org; Wed, 07 Dec 2011 07:58:49 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYH58-00075I-Kb
	for guile-devel@gnu.org; Wed, 07 Dec 2011 07:58:43 -0500
Received: from lo.gmane.org ([80.91.229.12]:37818)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYH58-00074e-FZ
	for guile-devel@gnu.org; Wed, 07 Dec 2011 07:58:42 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYH53-0004gg-4v
	for guile-devel@gnu.org; Wed, 07 Dec 2011 13:58:37 +0100
Received: from p508eaf98.dip.t-dialin.net ([80.142.175.152])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 07 Dec 2011 13:58:37 +0100
Received: from dak by p508eaf98.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 07 Dec 2011 13:58:37 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: And another deprecation joke
Date: Wed, 07 Dec 2011 13:58:21 +0100
Organization: Organization?!?
Lines: 37
Message-ID: <877h28iln6.fsf@fencepost.gnu.org>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508eaf98.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:5fjDUCUgYshZHeL80M/rPZFUW4g=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 07 Dec 2011 12:58:49 -0000


`dimensions->uniform-array' is deprecated.  Use `make-typed-array' instead.

Unfortunately, this was not even called in the application.

The actual function called was make-uniform-vector.

If we look at the documentation of make-typed-array, we find

<URL:http://www.gnu.org/software/guile/manual/html_node/Array-Procedures.html>

— Scheme Procedure: make-typed-array type fill bound ...
— C Function: scm_make_typed_array (type, fill, bounds)

    Create and return an array that has as many dimensions as there are
    bounds and (maybe) fill it with fill.

    The underlying storage vector is created according to type, which
    must be a symbol whose name is the `vectag' of the array as
    explained above, or #t for ordinary, non-specialized arrays.

This, however, is a lie, since there is no place above where "vectag"
would be explained.  There is an explanation about how it will be
printed as part of an array, but not how it is specified.

Would it please be possible

a) to not just deprecate some function when there are _callers_ in the
   guile code base that are _not_ explicitly deprecated
b) make sure that the recommended replacements are actually
   _documented_?

This is not the first such "deprecation" I have encountered, and it
shows a blatant disrespect of the user base.

-- 
David Kastrup



From MAILER-DAEMON Wed Dec 07 08:38:31 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYHhf-00042F-Oy
	for mharc-guile-devel@gnu.org; Wed, 07 Dec 2011 08:38:31 -0500
Received: from eggs.gnu.org ([140.186.70.92]:46893)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RYHhY-0003zY-Vu
	for guile-devel@gnu.org; Wed, 07 Dec 2011 08:38:30 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RYHhV-0006nh-00
	for guile-devel@gnu.org; Wed, 07 Dec 2011 08:38:24 -0500
Received: from mail4-relais-sop.national.inria.fr ([192.134.164.105]:28608)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <ludo@gnu.org>)
	id 1RYHhU-0006nV-Mm
	for guile-devel@gnu.org; Wed, 07 Dec 2011 08:38:20 -0500
X-IronPort-AV: E=Sophos;i="4.71,313,1320620400"; d="scan'208";a="122413264"
Received: from eduroam-083a.sophia.inria.fr (HELO pluto) ([193.48.247.83])
	by mail4-relais-sop.national.inria.fr with ESMTP/TLS/DHE-RSA-AES128-SHA;
	07 Dec 2011 14:38:19 +0100
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
To: Andy Wingo <wingo@pobox.com>
Subject: Re: new module: (web client)
References: <87d3hblrsc.fsf@pobox.com> <87y5zvu4l9.fsf@gnu.org>
	<87hb1eotwm.fsf@pobox.com>
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 17 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
Date: Wed, 07 Dec 2011 14:38:18 +0100
In-Reply-To: <87hb1eotwm.fsf@pobox.com> (Andy Wingo's message of "Tue, 06 Dec
	2011 11:51:05 +0100")
Message-ID: <87ipls5wol.fsf@gnu.org>
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 192.134.164.105
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 07 Dec 2011 13:38:30 -0000

Hi,

Andy Wingo <wingo@pobox.com> skribis:

>     scheme@(guile-user)> (getaddrinfo #f "file")
>     ERROR: In procedure getaddrinfo:
>     ERROR: Throw to key `getaddrinfo-error' with args `(-8)'.
>
> I guess we need to add exception printers for these errors.  Want to do
> that?  :-)

Yes!  Done.

Ludo=E2=80=99.


From MAILER-DAEMON Wed Dec 07 08:55:35 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYHyB-0007Ah-Ja
	for mharc-guile-devel@gnu.org; Wed, 07 Dec 2011 08:55:35 -0500
Received: from eggs.gnu.org ([140.186.70.92]:40464)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RYHy9-000760-Dx
	for guile-devel@gnu.org; Wed, 07 Dec 2011 08:55:34 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RYHy4-0002PV-Ie
	for guile-devel@gnu.org; Wed, 07 Dec 2011 08:55:33 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:48630)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>)
	id 1RYHxz-0002P0-DY; Wed, 07 Dec 2011 08:55:23 -0500
Received: by iahk25 with SMTP id k25so1145453iah.0
	for <multiple recipients>; Wed, 07 Dec 2011 05:55:22 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:sender:in-reply-to:references:date
	:x-google-sender-auth:message-id:subject:from:to:cc:content-type
	:content-transfer-encoding;
	bh=NbwSr3582Lx91jSzumhWKNmUF4/FWWB3wR7iXhjVqFs=;
	b=h03ELMXm0tvxp63ntC2SBdDaMIamAdEhqGl5LGpjaBHRy+/CeUNz4Nq2H55wOtfSuc
	i5VYBb2nojy9/eu4zNzzCTVzoiv/Vx3HGXjYspqwCLrLAt0wBM4ospKqV+9+eZJQBU6c
	p8Uegu/gx/LCoiciKM3KpU4llJhSKjpK2gElY=
MIME-Version: 1.0
Received: by 10.231.6.135 with SMTP id 7mr4425215ibz.60.1323266121979; Wed, 07
	Dec 2011 05:55:21 -0800 (PST)
Sender: noah549@gmail.com
Received: by 10.42.217.6 with HTTP; Wed, 7 Dec 2011 05:55:21 -0800 (PST)
In-Reply-To: <877h28iln6.fsf@fencepost.gnu.org>
References: <877h28iln6.fsf@fencepost.gnu.org>
Date: Wed, 7 Dec 2011 08:55:21 -0500
X-Google-Sender-Auth: 3zy-8626cH8tx4-DHMK45Pmdik8
Message-ID: <CA+U71=Mjhvbx_Fe4+Eo-u5m9SvxaagpMaiC5P=EuZNUqPXYYFw@mail.gmail.com>
Subject: Re: And another deprecation joke
From: Noah Lavine <noah.b.lavine@gmail.com>
To: David Kastrup <dak@gnu.org>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 07 Dec 2011 13:55:34 -0000

Hello,

> This, however, is a lie, since there is no place above where "vectag"
> would be explained. =A0There is an explanation about how it will be
> printed as part of an array, but not how it is specified.
>
> Would it please be possible
>
> a) to not just deprecate some function when there are _callers_ in the
> =A0 guile code base that are _not_ explicitly deprecated
> b) make sure that the recommended replacements are actually
> =A0 _documented_?
>
> This is not the first such "deprecation" I have encountered, and it
> shows a blatant disrespect of the user base.

Yes, I am well aware that the Guile documentation is missing some
pieces. I didn't know about the deprecation issue, but it fits.

If it makes you feel better though, I suspect that both of these
problems began before the current maintainers took over. As long as I
have been watching the mailing list, Andy and Ludo have been extremely
thorough, and I do not think they would have done something like this.

What you are noticing now is that Guile has some old bits of code that
were not implemented up to the standards we currently have. Since you
seem to be using all the weird corners of Guile, you have the
un-enviable job of going through and finding all of these places so we
can fix them.

I'm not going to solve this problem, because I don't know how, but I
did want to say that I appreciate you finding these things. It is not
a fun job, but it should be done.

Thanks,
Noah


From MAILER-DAEMON Wed Dec 07 09:20:29 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYIMH-0003ZV-Gn
	for mharc-guile-devel@gnu.org; Wed, 07 Dec 2011 09:20:29 -0500
Received: from eggs.gnu.org ([140.186.70.92]:45154)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYIM5-0003Wk-Tp
	for guile-devel@gnu.org; Wed, 07 Dec 2011 09:20:27 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYIM0-0007Ll-6n
	for guile-devel@gnu.org; Wed, 07 Dec 2011 09:20:17 -0500
Received: from lo.gmane.org ([80.91.229.12]:59211)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYILz-0007Lf-W0
	for guile-devel@gnu.org; Wed, 07 Dec 2011 09:20:12 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYILy-0004Wp-1K
	for guile-devel@gnu.org; Wed, 07 Dec 2011 15:20:10 +0100
Received: from eduroam-083a.sophia.inria.fr ([193.48.247.83])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 07 Dec 2011 15:20:10 +0100
Received: from ludo by eduroam-083a.sophia.inria.fr with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 07 Dec 2011 15:20:10 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
Subject: Re: when and unless
Date: Wed, 07 Dec 2011 15:19:58 +0100
Lines: 32
Message-ID: <87ehwg5ur5.fsf@gnu.org>
References: <878vsjd2fh.fsf@pobox.com> <87r50ircng.fsf@pobox.com>
	<87d3c1lq6i.fsf@gnu.org>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: eduroam-083a.sophia.inria.fr
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 17 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:RoEQ/cVm67Fb/Q2g1RKlTVksBjU=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 07 Dec 2011 14:20:27 -0000

Hi,

ludo@gnu.org (Ludovic Courtès) skribis:

> Andy Wingo <wingo@pobox.com> skribis:
>
>> On Thu 30 Jun 2011 12:44, Andy Wingo <wingo@pobox.com> writes:
>>
>>> I think we should add `when' and `unless' to the default environment.
>>>
>>> They go like this:
>>>
>>>   (define-syntax when
>>>     (syntax-rules ()
>>>       ((_ test then then* ...)
>>>        (if test (begin then then* ... (if #f #f))))))
>>>
>>>   (define-syntax unless
>>>     (syntax-rules ()
>>>       ((_ test else else* ...)
>>>        (if (not test) (begin else else* ... (if #f #f))))))
>>
>> WDYT?  `unless' is nice for assertions, `when' is its converse, and most
>> Schemes have them.  I would like to add them to Guile too.
>
> Yes, feel free.

Like Marijn, it seems more natural for me to return the values of the
body’s last expression, rather than *unspecified*.

Thanks,
Ludo’.



From MAILER-DAEMON Wed Dec 07 09:27:40 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYITE-0004uY-1Q
	for mharc-guile-devel@gnu.org; Wed, 07 Dec 2011 09:27:40 -0500
Received: from eggs.gnu.org ([140.186.70.92]:49545)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYIT7-0004s4-FL
	for guile-devel@gnu.org; Wed, 07 Dec 2011 09:27:38 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYIT5-0008T2-KQ
	for guile-devel@gnu.org; Wed, 07 Dec 2011 09:27:33 -0500
Received: from lo.gmane.org ([80.91.229.12]:35533)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYIT5-0008Sw-EA
	for guile-devel@gnu.org; Wed, 07 Dec 2011 09:27:31 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYIT3-0007ZH-GM
	for guile-devel@gnu.org; Wed, 07 Dec 2011 15:27:29 +0100
Received: from p508eaf98.dip.t-dialin.net ([80.142.175.152])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 07 Dec 2011 15:27:29 +0100
Received: from dak by p508eaf98.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 07 Dec 2011 15:27:29 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: when and unless
Date: Wed, 07 Dec 2011 15:27:17 +0100
Organization: Organization?!?
Lines: 39
Message-ID: <8739cwihiy.fsf@fencepost.gnu.org>
References: <878vsjd2fh.fsf@pobox.com> <87r50ircng.fsf@pobox.com>
	<87d3c1lq6i.fsf@gnu.org> <87ehwg5ur5.fsf@gnu.org>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508eaf98.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:M6IvSEQO68mg3Xd5EB+3y13YYKc=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 07 Dec 2011 14:27:38 -0000

ludo@gnu.org (Ludovic Courtès) writes:

> ludo@gnu.org (Ludovic Courtès) skribis:
>
>> Andy Wingo <wingo@pobox.com> skribis:
>>
>>> On Thu 30 Jun 2011 12:44, Andy Wingo <wingo@pobox.com> writes:
>>>
>>>> I think we should add `when' and `unless' to the default environment.
>>>>
>>>> They go like this:
>>>>
>>>>   (define-syntax when
>>>>     (syntax-rules ()
>>>>       ((_ test then then* ...)
>>>>        (if test (begin then then* ... (if #f #f))))))
>>>>
>>>>   (define-syntax unless
>>>>     (syntax-rules ()
>>>>       ((_ test else else* ...)
>>>>        (if (not test) (begin else else* ... (if #f #f))))))
>>>
>>> WDYT?  `unless' is nice for assertions, `when' is its converse, and most
>>> Schemes have them.  I would like to add them to Guile too.
>>
>> Yes, feel free.
>
> Like Marijn, it seems more natural for me to return the values of the
> body’s last expression, rather than *unspecified*.

Can you explain how that would even make sense?  You can't return a
specified value when the condition is not true since then no form gets
evaluated.  So where is the point in returning a value that is only
sometimes specified?  "Sometimes specified" logically is pretty much the
same as "unspecified", and then we might return *unspecified* right
away.

-- 
David Kastrup



From MAILER-DAEMON Wed Dec 07 10:01:55 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYJ0N-0000yC-OD
	for mharc-guile-devel@gnu.org; Wed, 07 Dec 2011 10:01:55 -0500
Received: from eggs.gnu.org ([140.186.70.92]:60473)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RYJ0H-0000y3-Qc
	for guile-devel@gnu.org; Wed, 07 Dec 2011 10:01:54 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RYJ08-0006nq-In
	for guile-devel@gnu.org; Wed, 07 Dec 2011 10:01:49 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:52863
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RYJ05-0006n7-Um; Wed, 07 Dec 2011 10:01:38 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 30BC88FED;
	Wed,  7 Dec 2011 10:01:37 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=NWCEjXIZPa0K3WoSgrhCmnGOhRw=; b=vtL5R9
	65WBB5UaD4yxF6F1YCqPpm77R/yMpiwf0JuFULdLDXEfqoZ+Xa4Kcg0ARIrNAZzA
	LyazM5qiJxU2JzBPYcNR75XSBBP8yZ9yl8Ypk76HcuULVIOnnRbukRYimv2g6CH6
	8dHxwSAPJyaHDjs1TO6kZM100/aP+6jaRD6jk=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=Wo3SIAznpwDeWKK48oXRbnkmOiLp18bC
	2s+OFRAdn3qgJbA1uTYt7rkWGBJEIxedmtsNHiJzNdJWjIH+rD67e9Fo2S6/qWT7
	WY7DZq9IQpYUXF4RsOEVoa1tOMALAO3T31B1/qS1+LPRyYzSkWAM7MUSRU4YxGeT
	tlih09NY+Rk=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id F3C9D8FEB;
	Wed,  7 Dec 2011 10:01:36 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 4E8548FE8;
	Wed,  7 Dec 2011 10:01:36 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: And another deprecation joke
References: <877h28iln6.fsf@fencepost.gnu.org>
Date: Wed, 07 Dec 2011 16:01:32 +0100
In-Reply-To: <877h28iln6.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Wed, 07 Dec 2011 13:58:21 +0100")
Message-ID: <8762hsmnn7.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 5BEC566A-20E4-11E1-A18A-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 07 Dec 2011 15:01:54 -0000

On Wed 07 Dec 2011 13:58, David Kastrup <dak@gnu.org> writes:

> `dimensions->uniform-array' is deprecated.  Use `make-typed-array' instead.
>
> Unfortunately, this was not even called in the application.
>
> The actual function called was make-uniform-vector.

Ah, interesting.

You might not be a native english speaker; I don't know.  However, the
proper word is "bug", not "lie" or "disrespect".  Thanks for finding
them and pointing them out!  In the future though, please be nice, on
this list.

Thanks,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Wed Dec 07 10:30:03 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYJRa-0007Yl-TR
	for mharc-guile-devel@gnu.org; Wed, 07 Dec 2011 10:30:02 -0500
Received: from eggs.gnu.org ([140.186.70.92]:58373)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RYJRW-0007WU-GS
	for guile-devel@gnu.org; Wed, 07 Dec 2011 10:29:59 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RYJRU-0003pA-Vw
	for guile-devel@gnu.org; Wed, 07 Dec 2011 10:29:58 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:51143
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RYJRU-0003p3-TR
	for guile-devel@gnu.org; Wed, 07 Dec 2011 10:29:56 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 4DAC18354;
	Wed,  7 Dec 2011 10:29:56 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=SX/+kO1/Eh9xXqeicXY8NQtP8/s=; b=iF+m0T
	pUvKiSbQZXpG4FwNTrN183R8ckbaYjwW3b0Kfe4aIGGwCgbzmvUOAdKxYHkzqHKf
	PaWKUtT2XXOVX/RVGryqtYirtNsgSVAO4exK40BsHHr+88lgF5J/cbjtZrh74AW9
	wPN16EFOCEM6TxDsZBI0LX15flVJr1t9/IeVw=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=nb657Ve/Y9Vt3wgFzZHe50ayeaNFpA4X
	fMP2+MyxXImPnInm9sTlg0WcNy9eFMoASWSvIB6pS1SzouMyt9TbsNI8jl8vArtp
	I+RfpTKHlC0B3q3/mekgfPNvJ3Pn6ik57ZKemxB/nSXgRT0qkPCwEd2D4G8aguh2
	/iUeE5Qpx8k=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 454148353;
	Wed,  7 Dec 2011 10:29:56 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 0A1BA8350;
	Wed,  7 Dec 2011 10:29:52 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: joakim@verona.se
Subject: Re: guile-clutter
References: <m3r53p6c1q.fsf@chopper.vpn.verona.se>
Date: Wed, 07 Dec 2011 16:29:49 +0100
In-Reply-To: <m3r53p6c1q.fsf@chopper.vpn.verona.se> (joakim@verona.se's
	message of "Fri, 09 Sep 2011 16:11:13 +0200")
Message-ID: <871usgmmc1.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 4F4CE4A2-20E8-11E1-8302-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 07 Dec 2011 15:29:59 -0000

On Fri 09 Sep 2011 16:11, joakim@verona.se writes:

> I would like to experiment with guile-clutter.
> It seems, though, that guile-clutter is a bit out of date and wont build
> with clutter-1.0 which is shipped with Fedora 15.
>
> Is this correct or have I missed something?

It's correct.  Do I recall correctly that eventually you got this
working?  Care to share the patch?

I should really get a guile-gnome release out now that g-wrap has a
version out that works with Guile 2.0.x...

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Wed Dec 07 10:30:38 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYJSA-0007iD-4k
	for mharc-guile-devel@gnu.org; Wed, 07 Dec 2011 10:30:38 -0500
Received: from eggs.gnu.org ([140.186.70.92]:58465)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYJS3-0007gK-VP
	for guile-devel@gnu.org; Wed, 07 Dec 2011 10:30:36 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYJRw-0003xK-8H
	for guile-devel@gnu.org; Wed, 07 Dec 2011 10:30:31 -0500
Received: from lo.gmane.org ([80.91.229.12]:37588)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYJRv-0003xD-Vw
	for guile-devel@gnu.org; Wed, 07 Dec 2011 10:30:24 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYJRv-0002TB-6u
	for guile-devel@gnu.org; Wed, 07 Dec 2011 16:30:23 +0100
Received: from p508eaf98.dip.t-dialin.net ([80.142.175.152])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 07 Dec 2011 16:30:23 +0100
Received: from dak by p508eaf98.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 07 Dec 2011 16:30:23 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: And another deprecation joke
Date: Wed, 07 Dec 2011 16:30:07 +0100
Organization: Organization?!?
Lines: 56
Message-ID: <87liqoh01s.fsf@fencepost.gnu.org>
References: <877h28iln6.fsf@fencepost.gnu.org> <8762hsmnn7.fsf@pobox.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508eaf98.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:E7G/VK2nS5FU7liJLR/5dB3DSCY=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 07 Dec 2011 15:30:36 -0000

Andy Wingo <wingo@pobox.com> writes:

> On Wed 07 Dec 2011 13:58, David Kastrup <dak@gnu.org> writes:
>
>> `dimensions->uniform-array' is deprecated.  Use `make-typed-array' instead.
>>
>> Unfortunately, this was not even called in the application.
>>
>> The actual function called was make-uniform-vector.
>
> Ah, interesting.
>
> You might not be a native english speaker; I don't know.  However, the
> proper word is "bug", not "lie" or "disrespect".

Few people are native speakers: that capacity is usually acquired later
in life.

While I can't claim this status, I don't find that

    This, however, is a bug, since there is no place above where
    "vectag" would be explained.

and particularly

    This is not the first such "deprecation" I have encountered, and it
    shows a blatant bug of the user base.

are convincing replacements.  In the first case, "falsehood" would be a
less loaded term for the same situation.  In the second, "disregard".
And I am afraid it does not get less loaded than that.  The source of
information for users is the documentation.  Changing or adding code and
not documenting it does not cater to users' but to developers' needs.

And it is not like I go hunting for nitpicks.  I try using Guile, and
those things hit me right in the face.  The "deprecation warnings" are
_explicitly_ coded, and obviously nobody bothered checking even
superficially that the user-available documentation documented the
specified replacements.

Whatever procedures lead to that result, it does not appear that they
have working policies or mechanisms that would ascertain either end user
viability (since the end user gets to see the respective deprecation
warnings) or application programmer viability (since the application
programmer is responsible for doing the code replacements).

So when I talk about "shows a blatant disrespect", this does not locate
the source of that disrespect which can also be inherent in the
procedures leading to such results.

It would appear to me that the procedures related to deprecation of
functions could likely make use of some amendments leading to more
consistent usability of the results.

-- 
David Kastrup



From MAILER-DAEMON Wed Dec 07 10:59:09 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYJtl-0007ZZ-8g
	for mharc-guile-devel@gnu.org; Wed, 07 Dec 2011 10:59:09 -0500
Received: from eggs.gnu.org ([140.186.70.92]:41872)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RYJtf-0007XZ-G0
	for guile-devel@gnu.org; Wed, 07 Dec 2011 10:59:07 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RYJte-0001Mk-BG
	for guile-devel@gnu.org; Wed, 07 Dec 2011 10:59:03 -0500
Received: from mail-yx0-f169.google.com ([209.85.213.169]:38322)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RYJte-0001Ma-3e
	for guile-devel@gnu.org; Wed, 07 Dec 2011 10:59:02 -0500
Received: by yenq10 with SMTP id q10so740950yen.0
	for <guile-devel@gnu.org>; Wed, 07 Dec 2011 07:59:01 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=date:from:to:subject:message-id:mail-followup-to:references
	:mime-version:content-type:content-disposition:in-reply-to
	:user-agent; bh=7jB+Hbm22WzWwO7bKFq4X+hBYzUXpUakU2jsS6KWNPc=;
	b=ZkdwWPAqfbvbUdOysjjlEWzfDfcDfLsdWwCWScLbxfTvVLdTsuAAfo5Jb7j5TCfy28
	EbRBWRzq8Qf0dVdlA1nGC4ss+jDivNj2DOFKEYUJltNuYY6AmINAD/ErhVcdV0n6x8jv
	BXqhU0eSp6W79VA7a708NLMBeXcZGU3WYenNE=
Received: by 10.236.190.99 with SMTP id d63mr28407170yhn.73.1323273541330;
	Wed, 07 Dec 2011 07:59:01 -0800 (PST)
Received: from yarrow.destinee.acro.gen.nz (me42c36d0.tmodns.net.
	[208.54.44.228])
	by mx.google.com with ESMTPS id d6sm6005215anm.16.2011.12.07.07.58.59
	(version=SSLv3 cipher=OTHER); Wed, 07 Dec 2011 07:58:59 -0800 (PST)
Date: Wed, 7 Dec 2011 10:58:34 -0500
From: "Chris K. Jester-Young" <cky944@gmail.com>
To: guile-devel@gnu.org
Subject: Re: when and unless
Message-ID: <20111207155834.GA15815@yarrow.destinee.acro.gen.nz>
Mail-Followup-To: guile-devel@gnu.org
References: <87r50ircng.fsf@pobox.com> <4EDDC8B1.3000509@gentoo.org>
	<CAMMPzYMoKuQSWnBMCoZ_+ggcrmk+SGvbyaKvYLb=eJVRbR6E1Q@mail.gmail.com>
	<87mxb6kkzx.fsf@fencepost.gnu.org> <877h29oeeq.fsf@pobox.com>
	<877h29k5xs.fsf@fencepost.gnu.org> <8739cxob6z.fsf@pobox.com>
	<87y5upicaf.fsf@fencepost.gnu.org>
	<20111206230556.GA14717@yarrow.destinee.acro.gen.nz>
	<87liqoivle.fsf@fencepost.gnu.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <87liqoivle.fsf@fencepost.gnu.org>
User-Agent: Mutt/1.5.20 (2009-06-14)
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.213.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 07 Dec 2011 15:59:07 -0000

On Wed, Dec 07, 2011 at 10:23:25AM +0100, David Kastrup wrote:
> Lilypond is not Scheme but has a more complex syntax.  You can use
> Scheme in a lot of places with different implications on the grammar
> depending on the type of the expression.  It would not be feasible to
> create a separate Scheme calling operator for every possible type of
> expression.  And "called just for action" is one such type.

In that case, to be proper, you have to do what the REPL does, which is
to wrap the Scheme expression within a call-with-values wherever you
process the calling operator. Remember that the continuation can be a
case-lambda:

    (call-with-values
     (lambda () (values))
     (case-lambda
      (() "No return values")
      ((x) (format #f "Single value: ~a" x))
      (x (format #f "Multiple values: ~a" x))))

(Guile 2.0 has built-in (VM-level) support for case-lambda, which makes
this super awesome.)

> Well, you'd need to have
> 
> (call-with-values (lambda () *unspecified*) (lambda x (length x))) => 0
[...]
> That means that one _only_ needs to consider the implications on
> call-with-values continuations.

Correct. However, how would you detect whether you're in a context where
call-with-values is being used? Here are some things that won't work:

1. You can't walk the stack. Your void expression would be in tail
   position (it would transfer to the continuation directly, not return
   to call-with-values---try (call-with-values (lambda () (throw 'foo))
   (lambda () 42)) and see what the backtrace looks like).

2. Guile's continuations don't provide meaningful arities: (call/cc
   (lambda (k) (procedure-minimum-arity k))) always says it takes zero
   or more arguments. (Same deal applies with Racket, so I presume it's
   not "just a Guile quirk".)

> And it is not like Guile has a problem distinguishing content and
> package itself (at least Guile 1.8):
> 
> guile> (write *unspecified*)
> #<unspecified>guile> (write (values))
> #<values ()>guile> 

In Guile 2.0, multiple values is not a first-class object. Instead, it
works like Common Lisp: in any context where a single value is needed,
and multiple values are supplied, then only the first value is used,
and the rest are thrown away.

    scheme@(guile-user)> (+ (values 1 2 3) (values 4 5 6))
    $1 = 5
    scheme@(guile-user)> (+ (values 1 2 3) (values))
    ERROR: In procedure values:
    ERROR: Throw to key `vm-error' with args `(vm-run "Zero values returned to single-valued continuation" ())'.

> So I still don't quite see the problem that would arise from making
> (eq? *unspecified* (values)) => #t

Simply that (values) is not valid to pass to eq?, since eq? is a normal
function, that thus expects one value for every argument. That this may
possibly work for Guile 1.8 is simply an accident of its implementation
of multiple values.

Cheers,
Chris.


From MAILER-DAEMON Wed Dec 07 11:10:33 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYK4n-0001Bz-A2
	for mharc-guile-devel@gnu.org; Wed, 07 Dec 2011 11:10:33 -0500
Received: from eggs.gnu.org ([140.186.70.92]:38564)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RYK4k-000194-Uw
	for guile-devel@gnu.org; Wed, 07 Dec 2011 11:10:31 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RYK4h-0003j8-6M
	for guile-devel@gnu.org; Wed, 07 Dec 2011 11:10:30 -0500
Received: from mail-gy0-f169.google.com ([209.85.160.169]:33444)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RYK4g-0003iy-Rj
	for guile-devel@gnu.org; Wed, 07 Dec 2011 11:10:27 -0500
Received: by ghbg19 with SMTP id g19so759154ghb.0
	for <guile-devel@gnu.org>; Wed, 07 Dec 2011 08:10:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=date:from:to:subject:message-id:mail-followup-to:references
	:mime-version:content-type:content-disposition:in-reply-to
	:user-agent; bh=B9bnkSqEGfv1TyfWtLB741xAtqi2stiAM2tLkzbVG3g=;
	b=OP7uz9IbdSjU/Uv28FmIDFJ+/tqIGXpd1zAyOnKwWLM8+wGSqMpgF+v9ibt2+fYsNC
	9inWAr78/rVnMv3/cuZeNQQ8PJ+YkXrImVBuSZdMXFIEBezh4KYdYFpquj3luO4H1NqP
	BRZb8tq0Jopf7Gy4ZjY8sznteW9ftrHkaHaTE=
Received: by 10.236.78.72 with SMTP id f48mr28276861yhe.121.1323274226166;
	Wed, 07 Dec 2011 08:10:26 -0800 (PST)
Received: from yarrow.destinee.acro.gen.nz (me42c36d0.tmodns.net.
	[208.54.44.228])
	by mx.google.com with ESMTPS id f17sm6067808ang.20.2011.12.07.08.10.24
	(version=SSLv3 cipher=OTHER); Wed, 07 Dec 2011 08:10:25 -0800 (PST)
Date: Wed, 7 Dec 2011 11:10:20 -0500
From: "Chris K. Jester-Young" <cky944@gmail.com>
To: guile-devel@gnu.org
Subject: Re: when and unless
Message-ID: <20111207161020.GB15815@yarrow.destinee.acro.gen.nz>
Mail-Followup-To: guile-devel@gnu.org
References: <878vsjd2fh.fsf@pobox.com> <87r50ircng.fsf@pobox.com>
	<4EDDC8B1.3000509@gentoo.org>
	<CAMMPzYMoKuQSWnBMCoZ_+ggcrmk+SGvbyaKvYLb=eJVRbR6E1Q@mail.gmail.com>
	<87mxb6kkzx.fsf@fencepost.gnu.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <87mxb6kkzx.fsf@fencepost.gnu.org>
User-Agent: Mutt/1.5.20 (2009-06-14)
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.160.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 07 Dec 2011 16:10:31 -0000

On Tue, Dec 06, 2011 at 12:17:06PM +0100, David Kastrup wrote:
> I've actually wondered if it would not make sense to return
> *unspecified* in the case of the plain else-less if even if the
> condition is true, namely when you write (if #t #t).

This cannot be done without breaking the tail position guarantee that
"if" has. i.e., Scheme specifies that for expressions of the form

    (if TEST THEN ELSE)
    (if TEST THEN)

that THEN and ELSE are both in tail position. Tail position means that
the evaluation of THEN or ELSE returns to the caller directly, and
there is no chance for the system to intervene, such as by replacing
the return value with unspecified.

Cheers,
Chris.


From MAILER-DAEMON Wed Dec 07 12:24:43 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYLEZ-0007nE-Kc
	for mharc-guile-devel@gnu.org; Wed, 07 Dec 2011 12:24:43 -0500
Received: from eggs.gnu.org ([140.186.70.92]:53537)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYLEU-0007mR-6E
	for guile-devel@gnu.org; Wed, 07 Dec 2011 12:24:42 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYLEL-0003aZ-8d
	for guile-devel@gnu.org; Wed, 07 Dec 2011 12:24:38 -0500
Received: from lo.gmane.org ([80.91.229.12]:60960)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYLEK-0003aF-V2
	for guile-devel@gnu.org; Wed, 07 Dec 2011 12:24:29 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYLEJ-0008E5-Bu
	for guile-devel@gnu.org; Wed, 07 Dec 2011 18:24:27 +0100
Received: from p508eaf98.dip.t-dialin.net ([80.142.175.152])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 07 Dec 2011 18:24:27 +0100
Received: from dak by p508eaf98.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 07 Dec 2011 18:24:27 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: And another deprecation joke
Date: Wed, 07 Dec 2011 18:24:12 +0100
Organization: Organization?!?
Lines: 34
Message-ID: <87d3c0gurn.fsf@fencepost.gnu.org>
References: <877h28iln6.fsf@fencepost.gnu.org>
	<CA+U71=Mjhvbx_Fe4+Eo-u5m9SvxaagpMaiC5P=EuZNUqPXYYFw@mail.gmail.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508eaf98.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:hmp7JlQNXf1L4f/O9HHLOkKTfdk=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 07 Dec 2011 17:24:42 -0000

Noah Lavine <noah.b.lavine@gmail.com> writes:

> What you are noticing now is that Guile has some old bits of code that
> were not implemented up to the standards we currently have. Since you
> seem to be using all the weird corners of Guile, you have the
> un-enviable job of going through and finding all of these places so we
> can fix them.

I don't actually consider most of the corners that hit me so far all
that weird: actually they have been either rather basic, or I've had my
nose explicitly rubbed into them by Guile (like with the deprecation
warnings).  That there is no information about non-literal symbol
manipulation in the Guile-1.8 documentation (except mentioning one
should use modules, and the C interface SCM_define) is appalling.  The
Guile-2.0 documentation still does not give any Scheme interfaces, but
at least the C interface descriptions for modules make it easier
guessing the Scheme interfaces.

The Guile maintainers make it a point to say they won't bother with
Guile-1.8 documentation, but it is not like Guile-1.8 is going to
disappear from software distributions anytime soon due to compatibility
issues.

> I'm not going to solve this problem, because I don't know how, but I
> did want to say that I appreciate you finding these things. It is not
> a fun job, but it should be done.

It is not fun, but it is not as much a job rather than an impediment.
It is certainly not a fun job to hear me crash and burn either.  But I
doubt that crashing and burning silently, as others apparently do, will
be much preferable.

-- 
David Kastrup



From MAILER-DAEMON Wed Dec 07 15:23:32 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYO1c-0002vA-1R
	for mharc-guile-devel@gnu.org; Wed, 07 Dec 2011 15:23:32 -0500
Received: from eggs.gnu.org ([140.186.70.92]:54726)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <joakim@verona.se>) id 1RYO1a-0002v4-Gw
	for guile-devel@gnu.org; Wed, 07 Dec 2011 15:23:31 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <joakim@verona.se>) id 1RYO1Y-0004Hq-SI
	for guile-devel@gnu.org; Wed, 07 Dec 2011 15:23:30 -0500
Received: from mx2.bahnhof.se ([213.80.101.12]:62855)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <joakim@verona.se>) id 1RYO1Y-0004D1-MC
	for guile-devel@gnu.org; Wed, 07 Dec 2011 15:23:28 -0500
Received: from localhost (mf.bahnhof.se [213.80.101.20])
	by mx2-reinject (Postfix) with ESMTP id 914C0D5067;
	Wed,  7 Dec 2011 21:23:23 +0100 (CET)
X-Virus-Scanned: by amavisd-new using ClamAV at bahnhof.se (MF2)
Received: from mf2.bahnhof.se ([127.0.0.1])
	by localhost (mf2.bahnhof.se [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id uT2jhuRyQAvP; Wed,  7 Dec 2011 21:23:11 +0100 (CET)
Received: from exodia.localdomain (h-235-102.a149.priv.bahnhof.se
	[85.24.235.102])
	by mf2.bahnhof.se (Postfix) with ESMTP id 3CC7A450065;
	Wed,  7 Dec 2011 21:23:10 +0100 (CET)
Received: from chopper.vpn.verona.se (DIR-655.a149.priv.bahnhof.se
	[192.168.200.86])
	by exodia.localdomain (Postfix) with ESMTP id 387574E008B;
	Wed,  7 Dec 2011 21:23:01 +0100 (CET)
From: joakim@verona.se
To: Andy Wingo <wingo@pobox.com>
Subject: Re: guile-clutter
References: <m3r53p6c1q.fsf@chopper.vpn.verona.se> <871usgmmc1.fsf@pobox.com>
Date: Wed, 07 Dec 2011 21:23:01 +0100
In-Reply-To: <871usgmmc1.fsf@pobox.com> (Andy Wingo's message of "Wed, 07 Dec
	2011 16:29:49 +0100")
Message-ID: <m3wra8b07u.fsf@chopper.vpn.verona.se>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: FreeBSD 6.x (1)
X-Received-From: 213.80.101.12
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 07 Dec 2011 20:23:31 -0000

Andy Wingo <wingo@pobox.com> writes:

> On Fri 09 Sep 2011 16:11, joakim@verona.se writes:
>
>> I would like to experiment with guile-clutter.
>> It seems, though, that guile-clutter is a bit out of date and wont build
>> with clutter-1.0 which is shipped with Fedora 15.
>>
>> Is this correct or have I missed something?
>
> It's correct.  Do I recall correctly that eventually you got this
> working?  Care to share the patch?

It worked to a point but was incomplete.

What I really wanted to do, though, was feed interactive layout engines
from guile, so I made a patch for
Dunnart(https://github.com/mjwybrow/dunnart/) to provide an embedded
guile interpreter. That was pretty nice(I'll have to push a branch for it)




> I should really get a guile-gnome release out now that g-wrap has a
> version out that works with Guile 2.0.x...

Awesome!

> Andy

-- 
Joakim Verona


From MAILER-DAEMON Wed Dec 07 21:29:52 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYTk8-0003IG-Gq
	for mharc-guile-devel@gnu.org; Wed, 07 Dec 2011 21:29:52 -0500
Received: from eggs.gnu.org ([140.186.70.92]:57124)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <rixed@happyleptic.org>) id 1RYTk5-0003Hy-W3
	for guile-devel@gnu.org; Wed, 07 Dec 2011 21:29:50 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <rixed@happyleptic.org>) id 1RYTk5-0003Wh-1I
	for guile-devel@gnu.org; Wed, 07 Dec 2011 21:29:49 -0500
Received: from smtp1-g21.free.fr ([212.27.42.1]:48527)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <rixed@happyleptic.org>) id 1RYTk4-0003RT-CY
	for guile-devel@gnu.org; Wed, 07 Dec 2011 21:29:49 -0500
Received: from shuttle.happyleptic.org (unknown
	[IPv6:2a01:e35:243c:2590:82ee:73ff:fe07:76f1])
	by smtp1-g21.free.fr (Postfix) with ESMTP id 4E82E9400BA
	for <guile-devel@gnu.org>; Thu,  8 Dec 2011 03:29:35 +0100 (CET)
Received: from rixed by shuttle.happyleptic.org with local (Exim 4.72)
	(envelope-from <rixed@happyleptic.org>) id 1RYTjq-0000od-O9
	for guile-devel@gnu.org; Thu, 08 Dec 2011 03:29:34 +0100
Date: Thu, 8 Dec 2011 03:29:34 +0100
From: rixed@happyleptic.org
To: guile-devel@gnu.org
Subject: Re: And another deprecation joke
Message-ID: <20111208022934.GC1767@shuttle.happyleptic.org>
Mail-Followup-To: rixed@happyleptic.org, guile-devel@gnu.org
References: <877h28iln6.fsf@fencepost.gnu.org> <8762hsmnn7.fsf@pobox.com>
	<87liqoh01s.fsf@fencepost.gnu.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <87liqoh01s.fsf@fencepost.gnu.org>
User-Agent: Mutt/1.5.20 (2009-06-14)
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 212.27.42.1
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 08 Dec 2011 02:29:50 -0000

You seam to believe that there is on one hand the guile developers and on
another one the guile users, facing each others on the ground of some kind
of contract that's being somewhat abused by the developers.  In reality, guile
is a project belonging to the commons and such demarcation does not exist: we
are all using guile as well as contributing to it (and you are doing some good
contributions by reporting all these bugs), and we all stands responsible for
its flaws.

I'm also having some ups and downs trying to use guile in a "professional"
project, having made some promise to my contractors to met some objectives;
but as far as I remember guile community never promised me anything neither
contractually nor informally. Users and providers are an artificial creation
of our times, there is no such thing here.



From MAILER-DAEMON Thu Dec 08 03:29:46 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYZMQ-0005Ii-FD
	for mharc-guile-devel@gnu.org; Thu, 08 Dec 2011 03:29:46 -0500
Received: from eggs.gnu.org ([140.186.70.92]:43343)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYZMO-0005HB-1t
	for guile-devel@gnu.org; Thu, 08 Dec 2011 03:29:45 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYZMM-00030T-NS
	for guile-devel@gnu.org; Thu, 08 Dec 2011 03:29:44 -0500
Received: from lo.gmane.org ([80.91.229.12]:52980)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYZMM-00030P-CQ
	for guile-devel@gnu.org; Thu, 08 Dec 2011 03:29:42 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYZMJ-0000Oe-1A
	for guile-devel@gnu.org; Thu, 08 Dec 2011 09:29:39 +0100
Received: from p508ea104.dip.t-dialin.net ([80.142.161.4])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Thu, 08 Dec 2011 09:29:39 +0100
Received: from dak by p508ea104.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Thu, 08 Dec 2011 09:29:39 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: And another deprecation joke
Date: Thu, 08 Dec 2011 09:29:18 +0100
Organization: Organization?!?
Lines: 65
Message-ID: <87pqfzo49t.fsf@fencepost.gnu.org>
References: <877h28iln6.fsf@fencepost.gnu.org> <8762hsmnn7.fsf@pobox.com>
	<87liqoh01s.fsf@fencepost.gnu.org>
	<20111208022934.GC1767@shuttle.happyleptic.org>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ea104.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:Nbfk7F6xoAEAzj9dSNWG9EO0kmk=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 08 Dec 2011 08:29:45 -0000

rixed@happyleptic.org writes:

> You seam to believe that there is on one hand the guile developers and
> on another one the guile users, facing each others on the ground of
> some kind of contract that's being somewhat abused by the developers.
> In reality, guile is a project belonging to the commons and such
> demarcation does not exist: we are all using guile as well as
> contributing to it (and you are doing some good contributions by
> reporting all these bugs), and we all stands responsible for its
> flaws.

Projects have guidelines and policies, and development works in
transactions.  Deprecating features without providing a documented
alternative is a half-transaction.  In a sane project, they get finished
or unrolled.

There obviously isn't sufficient awareness that leaving them lying
around in half-finished and broken state is a bad idea.

I am trying to make a point that sticks.  This is not a question about
who should be doing what.  If nothing gets done, that's the way the
cookie crumbles.  It is a free project after all.

But if things get done that do more damage than good by making it
impossible to work with Guile if you are not the one having done the
change, it would be better if nothing got done.

And the more changes get done that make it impossible to work with
Guile, the less people will be found that will work on any aspect of
Guile.

More resources are _destroyed_ than used in that manner.  And you
complain that I try making this a sore point with people.

> I'm also having some ups and downs trying to use guile in a
> "professional" project, having made some promise to my contractors to
> met some objectives; but as far as I remember guile community never
> promised me anything neither contractually nor informally. Users and
> providers are an artificial creation of our times, there is no such
> thing here.

For every change, there is one provider and multiple users.  If the
change is not intended to have the qualities where anybody but the
provider could use it, then it should stay out of the central
repository.  Otherwise, you get dozens of half-baked half-documented
implementations of the same functionality in your code base because
nobody can work with the undocumented half-baked implementation of
somebody else and just commits his own version.  The next one to come
around and look closely finds a heap of things he could almost but not
quite use, and after investing a week of work, throws up his hands in
disgust and chooses a different tool.

This is not a question of available manpower.  It is one of discipline
and policies.  I don't know the control structures of this project.  So
I make this a sore point with anybody bothering enough about it to be
reading the developer list.  That's the best I can do.  Making people
annoyed, incredulous, possibly even ashamed about how they permit their
project get destroyed by sloppiness, because that sloppiness costs them
their user and in following their developer base.

If I wanted an incoherent junk yard of half-features, I would start with
Common Lisp instead of Scheme.

-- 
David Kastrup



From MAILER-DAEMON Thu Dec 08 03:42:58 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYZZC-00074i-Oi
	for mharc-guile-devel@gnu.org; Thu, 08 Dec 2011 03:42:58 -0500
Received: from eggs.gnu.org ([140.186.70.92]:43980)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYZZA-00074c-Fi
	for guile-devel@gnu.org; Thu, 08 Dec 2011 03:42:57 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYZZ8-0004iu-Pw
	for guile-devel@gnu.org; Thu, 08 Dec 2011 03:42:56 -0500
Received: from lo.gmane.org ([80.91.229.12]:58650)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYZZ8-0004iq-Aj
	for guile-devel@gnu.org; Thu, 08 Dec 2011 03:42:54 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYZZ3-0004jL-TA
	for guile-devel@gnu.org; Thu, 08 Dec 2011 09:42:49 +0100
Received: from p508ea104.dip.t-dialin.net ([80.142.161.4])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Thu, 08 Dec 2011 09:42:49 +0100
Received: from dak by p508ea104.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Thu, 08 Dec 2011 09:42:49 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: when and unless
Date: Thu, 08 Dec 2011 09:42:36 +0100
Organization: Organization?!?
Lines: 74
Message-ID: <87liqno3nn.fsf@fencepost.gnu.org>
References: <87r50ircng.fsf@pobox.com> <4EDDC8B1.3000509@gentoo.org>
	<CAMMPzYMoKuQSWnBMCoZ_+ggcrmk+SGvbyaKvYLb=eJVRbR6E1Q@mail.gmail.com>
	<87mxb6kkzx.fsf@fencepost.gnu.org> <877h29oeeq.fsf@pobox.com>
	<877h29k5xs.fsf@fencepost.gnu.org> <8739cxob6z.fsf@pobox.com>
	<87y5upicaf.fsf@fencepost.gnu.org>
	<20111206230556.GA14717@yarrow.destinee.acro.gen.nz>
	<87liqoivle.fsf@fencepost.gnu.org>
	<20111207155834.GA15815@yarrow.destinee.acro.gen.nz>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ea104.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:mQvQgNa6OaMy2k8mM07a/W+nUlU=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 08 Dec 2011 08:42:57 -0000

"Chris K. Jester-Young" <cky944@gmail.com> writes:

> On Wed, Dec 07, 2011 at 10:23:25AM +0100, David Kastrup wrote:
>
>> Well, you'd need to have
>> 
>> (call-with-values (lambda () *unspecified*) (lambda x (length x))) => 0
> [...]
>> That means that one _only_ needs to consider the implications on
>> call-with-values continuations.
>
> Correct. However, how would you detect whether you're in a context where
> call-with-values is being used? Here are some things that won't work:
>
> 1. You can't walk the stack. Your void expression would be in tail
>    position (it would transfer to the continuation directly, not return
>    to call-with-values---try (call-with-values (lambda () (throw 'foo))
>    (lambda () 42)) and see what the backtrace looks like).
>
> 2. Guile's continuations don't provide meaningful arities: (call/cc
>    (lambda (k) (procedure-minimum-arity k))) always says it takes zero
>    or more arguments. (Same deal applies with Racket, so I presume it's
>    not "just a Guile quirk".)

> In Guile 2.0, multiple values is not a first-class object. Instead, it
> works like Common Lisp: in any context where a single value is needed,
> and multiple values are supplied, then only the first value is used,
> and the rest are thrown away.

>     scheme@(guile-user)> (+ (values 1 2 3) (values 4 5 6))
>     $1 = 5
>     scheme@(guile-user)> (+ (values 1 2 3) (values))
>     ERROR: In procedure values:
>     ERROR: Throw to key `vm-error' with args `(vm-run "Zero values
> returned to single-valued continuation" ())'.
>
>> So I still don't quite see the problem that would arise from making
>> (eq? *unspecified* (values)) => #t
>
> Simply that (values) is not valid to pass to eq?, since eq? is a normal
> function, that thus expects one value for every argument. That this may
> possibly work for Guile 1.8 is simply an accident of its implementation
> of multiple values.

In any way, you have the existing C API which returns single values for
things like scm_eval.

So here is another proposal: (values) is not the same as *unspecified*.
But if you take the first value of a values list in single-value
contexts, there is nothing about that coercion mechanism that would keep
you from using *unspecified* whenever that values list would be empty.

So you would have

(length (call-with-values (lambda () *unspecified*) list)) => 1
(length (call-with-values (lambda () (values)) list)) => 0
(eq? (values) *unspecified*) => #t

After all, you will also have

(length (call-with-values (lambda () (values #t #t)) list)) => 2
(length (call-with-values (lambda () #t) list)) => 1
(eq? (values #t #t) #t) => #t

and nobody seems all too worried about that, I guess.  There will often
be call chaining through C.  You can't throw an error every time
somebody calls a C function like scm_eval or scm_apply or scm_call for
effect and complain whenever the called function exits with the
equivalent of (values), and you can't remove all of the C API at once
and replace it with something that glues together continuations in a
multiple-value passing manner.

-- 
David Kastrup



From MAILER-DAEMON Thu Dec 08 10:34:29 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYfzR-0004h6-SL
	for mharc-guile-devel@gnu.org; Thu, 08 Dec 2011 10:34:29 -0500
Received: from eggs.gnu.org ([140.186.70.92]:51130)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RYfzP-0004eF-70
	for guile-devel@gnu.org; Thu, 08 Dec 2011 10:34:28 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RYfzO-0006AE-Dn
	for guile-devel@gnu.org; Thu, 08 Dec 2011 10:34:27 -0500
Received: from mail-yx0-f169.google.com ([209.85.213.169]:35832)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RYfzO-0006A9-BH
	for guile-devel@gnu.org; Thu, 08 Dec 2011 10:34:26 -0500
Received: by yenq10 with SMTP id q10so1925553yen.0
	for <guile-devel@gnu.org>; Thu, 08 Dec 2011 07:34:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=date:from:to:subject:message-id:mail-followup-to:references
	:mime-version:content-type:content-disposition:in-reply-to
	:user-agent; bh=EUt/eKebX3mrAgcZCDoE6h/mocKaq+bNARSpZQWVucs=;
	b=TWHKkLak/ZY8zvPcsMZIRu9iZxzdPWMQSKJ0suI60pVWRCojAMKkBwF9gpiPRaAYmD
	960YpCXBaD4VZ70HHZXpdBBJHGzci7+vvZy9sFQTQlf4j8AJ7FVHUbcu9AqY2xiNCdY+
	a0QdnuEc+FB972rEVYx4aHU5aeqW0n2z0NXpI=
Received: by 10.236.77.232 with SMTP id d68mr5445119yhe.98.1323358465603;
	Thu, 08 Dec 2011 07:34:25 -0800 (PST)
Received: from yarrow.destinee.acro.gen.nz (mf42c36d0.tmodns.net.
	[208.54.44.244])
	by mx.google.com with ESMTPS id l27sm15325167ani.21.2011.12.08.07.34.23
	(version=SSLv3 cipher=OTHER); Thu, 08 Dec 2011 07:34:24 -0800 (PST)
Date: Thu, 8 Dec 2011 10:34:17 -0500
From: "Chris K. Jester-Young" <cky944@gmail.com>
To: guile-devel@gnu.org
Subject: Re: when and unless
Message-ID: <20111208153417.GC15815@yarrow.destinee.acro.gen.nz>
Mail-Followup-To: guile-devel@gnu.org
References: <CAMMPzYMoKuQSWnBMCoZ_+ggcrmk+SGvbyaKvYLb=eJVRbR6E1Q@mail.gmail.com>
	<87mxb6kkzx.fsf@fencepost.gnu.org> <877h29oeeq.fsf@pobox.com>
	<877h29k5xs.fsf@fencepost.gnu.org> <8739cxob6z.fsf@pobox.com>
	<87y5upicaf.fsf@fencepost.gnu.org>
	<20111206230556.GA14717@yarrow.destinee.acro.gen.nz>
	<87liqoivle.fsf@fencepost.gnu.org>
	<20111207155834.GA15815@yarrow.destinee.acro.gen.nz>
	<87liqno3nn.fsf@fencepost.gnu.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <87liqno3nn.fsf@fencepost.gnu.org>
User-Agent: Mutt/1.5.20 (2009-06-14)
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.213.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 08 Dec 2011 15:34:28 -0000

On Thu, Dec 08, 2011 at 09:42:36AM +0100, David Kastrup wrote:
> So here is another proposal: (values) is not the same as *unspecified*.
> But if you take the first value of a values list in single-value
> contexts, there is nothing about that coercion mechanism that would keep
> you from using *unspecified* whenever that values list would be empty.

That's easy to implement (patch at bottom of post; I tested it). The
question for the people on the list to decide is whether it's a good
idea. :-) Personally, I don't object to it, but, perhaps others do.

Cheers,
Chris.

			*	*	*

diff --git a/libguile/vm-i-system.c b/libguile/vm-i-system.c
index 474fe78..6ce5ee3 100644
--- a/libguile/vm-i-system.c
+++ b/libguile/vm-i-system.c
@@ -1311,7 +1311,7 @@ VM_DEFINE_INSTRUCTION (68, return_values, "return/values", 1, -1, -1)
       /* Finally null the end of the stack */
       NULLSTACK (vals + nvalues - sp);
     }
-  else if (nvalues >= 1)
+  else
     {
       /* Multiple values for a single-valued continuation -- here's where I
          break with guile tradition and try and do something sensible. (Also,
@@ -1324,13 +1324,11 @@ VM_DEFINE_INSTRUCTION (68, return_values, "return/values", 1, -1, -1)
       fp = SCM_FRAME_DYNAMIC_LINK (fp);
         
       /* Push first value */
-      *++sp = vals[1];
+      *++sp = nvalues >= 1 ? vals[1] : SCM_UNSPECIFIED;
              
       /* Finally null the end of the stack */
       NULLSTACK (vals + nvalues - sp);
     }
-  else
-    goto vm_error_no_values;
 
   /* Restore the last program */
   program = SCM_FRAME_PROGRAM (fp);


From MAILER-DAEMON Thu Dec 08 10:46:39 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYgBD-0006xW-7Y
	for mharc-guile-devel@gnu.org; Thu, 08 Dec 2011 10:46:39 -0500
Received: from eggs.gnu.org ([140.186.70.92]:47429)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RYgB7-0006x9-88
	for guile-devel@gnu.org; Thu, 08 Dec 2011 10:46:37 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RYgB3-0007qi-6s
	for guile-devel@gnu.org; Thu, 08 Dec 2011 10:46:33 -0500
Received: from mail-yx0-f169.google.com ([209.85.213.169]:47520)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RYgB3-0007qe-0S
	for guile-devel@gnu.org; Thu, 08 Dec 2011 10:46:29 -0500
Received: by yenq10 with SMTP id q10so1937792yen.0
	for <guile-devel@gnu.org>; Thu, 08 Dec 2011 07:46:28 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=date:from:to:subject:message-id:mail-followup-to:references
	:mime-version:content-type:content-disposition:in-reply-to
	:user-agent; bh=GgrgOgs4IavGYSG3/HNQ/mTpBc+bi7a9pA1vIpGxK2o=;
	b=v05fERpHFIu8kKXYBBS+cTRkyTV4C7OkUE02TI+NqjgjllLzhyRtyyoLCBqybhBiAa
	FGufm6g0sIfkRLpiiHi6PFBRl0+InUvz4XEJo8wa9BcdFJY+qp3prGmAJEHfjXQrFS/E
	ojgONf8mNPWpCrH29dzaeAe/4AFXaLBTRyxHo=
Received: by 10.236.136.38 with SMTP id v26mr5681630yhi.69.1323359188281;
	Thu, 08 Dec 2011 07:46:28 -0800 (PST)
Received: from yarrow.destinee.acro.gen.nz (mf42c36d0.tmodns.net.
	[208.54.44.244])
	by mx.google.com with ESMTPS id 3sm15471391anv.7.2011.12.08.07.46.26
	(version=SSLv3 cipher=OTHER); Thu, 08 Dec 2011 07:46:26 -0800 (PST)
Date: Thu, 8 Dec 2011 10:46:21 -0500
From: "Chris K. Jester-Young" <cky944@gmail.com>
To: guile-devel@gnu.org
Subject: Re: impressions on gc
Message-ID: <20111208154621.GD15815@yarrow.destinee.acro.gen.nz>
Mail-Followup-To: guile-devel@gnu.org
References: <87d3c799ev.fsf@pobox.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <87d3c799ev.fsf@pobox.com>
User-Agent: Mutt/1.5.20 (2009-06-14)
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.213.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 08 Dec 2011 15:46:37 -0000

On Fri, Dec 02, 2011 at 12:09:12AM +0100, Andy Wingo wrote:
> One change was to make GC run more often when a process is growing, in
> terms of resident memory size.  This seems to be a good idea in general.
> 
> The other was to add a function that users can call to note
> non-gc-managed allocations -- allocations that may be freed when GC is
> run, but which the GC doesn't know about.  That is
> scm_gc_register_allocation.  This routine runs GC after allocated bytes
> exceed some limit, currently the GC-managed heap size, reset after every
> GC.  This is to catch steady-state mallocation.

I looked at the change for it, fd51e66190bde8cef74fec9725de4da3471901c4.
It looks cool. :-)

Alas, part of that diff also breaks libgc 7.1 (which is the version that
Debian currently has packaged), which lack the unmapping functions.
Here's my diff to make it work again.

Many thanks,
Chris.

			*	*	*

diff --git a/configure.ac b/configure.ac
index d63dd63..0cfe961 100644
--- a/configure.ac
+++ b/configure.ac
@@ -1259,7 +1259,7 @@ save_LIBS="$LIBS"
 LIBS="$BDW_GC_LIBS $LIBS"
 CFLAGS="$BDW_GC_CFLAGS $CFLAGS"
 
-AC_CHECK_FUNCS([GC_do_blocking GC_call_with_gc_active GC_pthread_exit GC_pthread_cancel GC_allow_register_threads GC_pthread_sigmask GC_set_start_callback GC_get_heap_usage_safe GC_get_free_space_divisor])
+AC_CHECK_FUNCS([GC_do_blocking GC_call_with_gc_active GC_pthread_exit GC_pthread_cancel GC_allow_register_threads GC_pthread_sigmask GC_set_start_callback GC_get_heap_usage_safe GC_get_free_space_divisor GC_gcollect_and_unmap GC_get_unmapped_bytes])
 
 # Though the `GC_do_blocking ()' symbol is present in GC 7.1, it is not
 # declared, and has a different type (returning void instead of
diff --git a/libguile/gc-malloc.c b/libguile/gc-malloc.c
index 72142ca..b7781f3 100644
--- a/libguile/gc-malloc.c
+++ b/libguile/gc-malloc.c
@@ -96,7 +96,11 @@ scm_realloc (void *mem, size_t size)
     return ptr;
 
   /* Time is hard: trigger a full, ``stop-the-world'' GC, and try again.  */
+#ifdef HAVE_GC_GCOLLECT_AND_UNMAP
   GC_gcollect_and_unmap ();
+#else
+  GC_gcollect ();
+#endif
 
   SCM_SYSCALL (ptr = realloc (mem, size));
   if (ptr)
diff --git a/libguile/gc.c b/libguile/gc.c
index ff1ebe6..0ab27a5 100644
--- a/libguile/gc.c
+++ b/libguile/gc.c
@@ -205,7 +205,11 @@ GC_get_heap_usage_safe (GC_word *pheap_size, GC_word *pfree_bytes,
 {
   *pheap_size = GC_get_heap_size ();
   *pfree_bytes = GC_get_free_bytes ();
+#ifdef HAVE_GC_GET_UNMAPPED_BYTES
   *punmapped_bytes = GC_get_unmapped_bytes ();
+#else
+  *punmapped_bytes = 0;
+#endif
   *pbytes_since_gc = GC_get_bytes_since_gc ();
   *ptotal_bytes = GC_get_total_bytes ();
 }


From MAILER-DAEMON Thu Dec 08 11:11:09 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYgYv-0005Gl-Dl
	for mharc-guile-devel@gnu.org; Thu, 08 Dec 2011 11:11:09 -0500
Received: from eggs.gnu.org ([140.186.70.92]:48738)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYgYt-0005G4-Ha
	for guile-devel@gnu.org; Thu, 08 Dec 2011 11:11:08 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYgYs-0003fU-Bh
	for guile-devel@gnu.org; Thu, 08 Dec 2011 11:11:07 -0500
Received: from lo.gmane.org ([80.91.229.12]:35754)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYgYr-0003f7-Ta
	for guile-devel@gnu.org; Thu, 08 Dec 2011 11:11:06 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYgYn-0005Qt-KQ
	for guile-devel@gnu.org; Thu, 08 Dec 2011 17:11:01 +0100
Received: from p508ea104.dip.t-dialin.net ([80.142.161.4])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Thu, 08 Dec 2011 17:11:01 +0100
Received: from dak by p508ea104.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Thu, 08 Dec 2011 17:11:01 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: when and unless
Date: Thu, 08 Dec 2011 17:10:45 +0100
Organization: Organization?!?
Lines: 38
Message-ID: <87obvjkpru.fsf@fencepost.gnu.org>
References: <CAMMPzYMoKuQSWnBMCoZ_+ggcrmk+SGvbyaKvYLb=eJVRbR6E1Q@mail.gmail.com>
	<87mxb6kkzx.fsf@fencepost.gnu.org> <877h29oeeq.fsf@pobox.com>
	<877h29k5xs.fsf@fencepost.gnu.org> <8739cxob6z.fsf@pobox.com>
	<87y5upicaf.fsf@fencepost.gnu.org>
	<20111206230556.GA14717@yarrow.destinee.acro.gen.nz>
	<87liqoivle.fsf@fencepost.gnu.org>
	<20111207155834.GA15815@yarrow.destinee.acro.gen.nz>
	<87liqno3nn.fsf@fencepost.gnu.org>
	<20111208153417.GC15815@yarrow.destinee.acro.gen.nz>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ea104.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:EUuBwRDQuQqEmpRwIKkATqXznYs=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 08 Dec 2011 16:11:08 -0000

"Chris K. Jester-Young" <cky944@gmail.com> writes:

> On Thu, Dec 08, 2011 at 09:42:36AM +0100, David Kastrup wrote:
>> So here is another proposal: (values) is not the same as *unspecified*.
>> But if you take the first value of a values list in single-value
>> contexts, there is nothing about that coercion mechanism that would keep
>> you from using *unspecified* whenever that values list would be empty.
>
> That's easy to implement (patch at bottom of post; I tested it). The
> question for the people on the list to decide is whether it's a good
> idea. :-) Personally, I don't object to it, but, perhaps others do.

Well, the bad thing about it is that using *unspecified* explicitly is
not equivalent to what Guile does (presuming that it uses (values)
whenever it does not return a value) even though it counts as eq?, just
like using (values #t #t) is not equivalent to what #t does, but will
still count as eq?.

It is somewhat similar to how Lua deals with nil (which is a mixture of
SCM_UNSPECIFIED and SCM_UNDEFINED in semantics) and tail call argument
lists and multiple/single/no value returns.  You can figure out the
difference between a nil return value and none, but not without
tail-calling another function in which you explicitly ask for the number
of arguments.

Anyway, in Guile there are wagonloads of C functions that return exactly
1 value.  I don't think you can always just let them blow up when they
don't have a value to deliver.  That would be a major migration pain.

If you want to discourage people at one time from confusing the two, let
the REPL print *unspecified* when that (rather than no value at all) is
returned.  But I don't think that you should start with this too early.
I suppose user-defined C functions, instead of returning
SCM_UNSPECIFIED, would have to call something like scm_return_values
(SCM_UNDEFINED); instead.

-- 
David Kastrup



From MAILER-DAEMON Thu Dec 08 13:13:48 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYiTc-0001sO-6t
	for mharc-guile-devel@gnu.org; Thu, 08 Dec 2011 13:13:48 -0500
Received: from eggs.gnu.org ([140.186.70.92]:46193)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ianprice90@googlemail.com>) id 1RYiTZ-0001pG-Hs
	for guile-devel@gnu.org; Thu, 08 Dec 2011 13:13:46 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ianprice90@googlemail.com>) id 1RYiTY-0000HE-8r
	for guile-devel@gnu.org; Thu, 08 Dec 2011 13:13:45 -0500
Received: from mail-ww0-f49.google.com ([74.125.82.49]:41422)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ianprice90@googlemail.com>)
	id 1RYiTY-0000H6-1B; Thu, 08 Dec 2011 13:13:44 -0500
Received: by wgbdt11 with SMTP id dt11so3008983wgb.30
	for <multiple recipients>; Thu, 08 Dec 2011 10:13:42 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
	d=googlemail.com; s=gamma;
	h=from:to:cc:subject:references:date:in-reply-to:message-id
	:user-agent:mime-version:content-type;
	bh=pHXUKgeB/qB10M0qLTd5cqEIJYON2VKlzmpDpn0WzPg=;
	b=IguLZExCf2m0QDGN/L2cCbQ/7pqGDmGWkVm7cOacIoLUg8ReE4Kmo5FnHEdAbb0niP
	gTJ88SHtj5t54oJPWXzIWOF/hwx3VGPYmA0D2nQ6hgBNEoqIuu5UU4HVRof3gYlGXvUZ
	eFaRr5OdJ9OaNX3Fvzxikbs09Ae0ItcRcBTe0=
Received: by 10.216.166.205 with SMTP id g55mr3901wel.90.1323368022286;
	Thu, 08 Dec 2011 10:13:42 -0800 (PST)
Received: from Kagami.home (host86-168-32-36.range86-168.btcentralplus.com.
	[86.168.32.36])
	by mx.google.com with ESMTPS id eo4sm9651778wib.19.2011.12.08.10.13.39
	(version=TLSv1/SSLv3 cipher=OTHER);
	Thu, 08 Dec 2011 10:13:40 -0800 (PST)
From: Ian Price <ianprice90@googlemail.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: when and unless
References: <87r50ircng.fsf@pobox.com> <4EDDC8B1.3000509@gentoo.org>
	<CAMMPzYMoKuQSWnBMCoZ_+ggcrmk+SGvbyaKvYLb=eJVRbR6E1Q@mail.gmail.com>
	<87mxb6kkzx.fsf@fencepost.gnu.org> <877h29oeeq.fsf@pobox.com>
	<877h29k5xs.fsf@fencepost.gnu.org> <8739cxob6z.fsf@pobox.com>
	<87y5upicaf.fsf@fencepost.gnu.org>
	<20111206230556.GA14717@yarrow.destinee.acro.gen.nz>
	<87liqoivle.fsf@fencepost.gnu.org>
	<20111207155834.GA15815@yarrow.destinee.acro.gen.nz>
	<87liqno3nn.fsf@fencepost.gnu.org>
Date: Thu, 08 Dec 2011 18:10:16 +0000
In-Reply-To: <87liqno3nn.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Thu, 08 Dec 2011 09:42:36 +0100")
Message-ID: <87y5un9bp3.fsf@Kagami.home>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 74.125.82.49
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 08 Dec 2011 18:13:46 -0000

David Kastrup <dak@gnu.org> writes:

> So here is another proposal: (values) is not the same as *unspecified*.
> But if you take the first value of a values list in single-value
> contexts, there is nothing about that coercion mechanism that would keep
> you from using *unspecified* whenever that values list would be empty.
This seems like a special case of the, I think, CL behaviour where you
get a nil for each of the values expected that were not explicitly
returned. Not my preference, but certainly not the worst thing you can
do.

(As an aside, people who want this behaviour can use
https://gist.github.com/1359350 which I wrote for dsmith a while back)

> So you would have
>
> (length (call-with-values (lambda () *unspecified*) list)) => 1
> (length (call-with-values (lambda () (values)) list)) => 0
> (eq? (values) *unspecified*) => #t
>
> After all, you will also have
>
> (length (call-with-values (lambda () (values #t #t)) list)) => 2
> (length (call-with-values (lambda () #t) list)) => 1
> (eq? (values #t #t) #t) => #t
>
> and nobody seems all too worried about that, I guess.
Some of us are, I think in the guile community this is a minority
view.

-- 
Ian Price

"Programming is like pinball. The reward for doing it well is
the opportunity to do it again" - from "The Wizardy Compiled"


From MAILER-DAEMON Thu Dec 08 15:10:51 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYkIt-0001sH-Kl
	for mharc-guile-devel@gnu.org; Thu, 08 Dec 2011 15:10:51 -0500
Received: from eggs.gnu.org ([140.186.70.92]:40923)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RYkIq-0001rG-ML
	for guile-devel@gnu.org; Thu, 08 Dec 2011 15:10:49 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RYkIo-0002rR-QC
	for guile-devel@gnu.org; Thu, 08 Dec 2011 15:10:48 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:62914
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RYkIo-0002r8-NZ
	for guile-devel@gnu.org; Thu, 08 Dec 2011 15:10:46 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 36D8E8A35
	for <guile-devel@gnu.org>; Thu,  8 Dec 2011 15:10:45 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=eeQfZLij5OYj8IDgJRSXXC7X4BY=; b=kLlJyo
	3W9ySVT7oGkYoh+g2jbXOk5V22/iD000zFvE9n2bChcOEM8xRsAay/gSEl4rkyiz
	Kub0wI6ildRXjO9nVjIQqOZliffke3yJfPwmFM2VwDfum89G1nwUH2pXv5nxGn/W
	uYQ7ta3235nUgxL35saCs5NmzXuYqFkt7Tmks=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:subject
	:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=Hzu/jWfgickhwMx49f1ZE4x+u+nt6I7c
	2bXMjQLzEAM5swB/fIbTvXZ5fB66/bw3kcx9fEjIBKjdM+Mgoi/zS1AfVbSzsOVm
	C3dUw+QxotS1t/3el/psee2z1TC2oefCP+BMvPNh98QkeUvWOreylC9lRywMT1Ol
	flclk9tJfQ8=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 2C1468A33
	for <guile-devel@gnu.org>; Thu,  8 Dec 2011 15:10:45 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 904D58A32 for
	<guile-devel@gnu.org>; Thu,  8 Dec 2011 15:10:44 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: guile-devel@gnu.org
Subject: Re: impressions on gc
References: <87d3c799ev.fsf@pobox.com>
	<20111208154621.GD15815@yarrow.destinee.acro.gen.nz>
Date: Thu, 08 Dec 2011 21:10:40 +0100
In-Reply-To: <20111208154621.GD15815@yarrow.destinee.acro.gen.nz> (Chris K.
	Jester-Young's message of "Thu, 8 Dec 2011 10:46:21 -0500")
Message-ID: <87sjkukenz.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: B5F703EA-21D8-11E1-99D1-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 08 Dec 2011 20:10:49 -0000

On Thu 08 Dec 2011 16:46, "Chris K. Jester-Young" <cky944@gmail.com> writes:

> Alas, part of that diff also breaks libgc 7.1 (which is the version that
> Debian currently has packaged), which lack the unmapping functions.
> Here's my diff to make it work again.

Thanks for the patch!  In the future a git-format-patch attachment is
easiest.  Though, if you like, we can set you up with commit access, I
think.  Request to be added to the `guile' group on savannah and we'll
approve.  I'll push this one though.

Regards,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Thu Dec 08 15:18:34 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYkQM-0004IS-Eo
	for mharc-guile-devel@gnu.org; Thu, 08 Dec 2011 15:18:34 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55831)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RYkQJ-0004IH-Nj
	for guile-devel@gnu.org; Thu, 08 Dec 2011 15:18:32 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RYkQI-0003sG-Qn
	for guile-devel@gnu.org; Thu, 08 Dec 2011 15:18:31 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:38669
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RYkQH-0003op-0z; Thu, 08 Dec 2011 15:18:29 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 157CE8B37;
	Thu,  8 Dec 2011 15:18:28 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=Q1yqxb8ZDiAGhX43qVc2t7rcRpo=; b=phEBw2
	AjNF5DgilCRpCOwB7Atpicvy3AT8xLUSZ9MgBCapDjDdlg4eRyPUO5uGnARhYp3/
	2QMitH0rnGN6OiXooWSy7cNPJTlw1ZfXp1H0tXx6z1GFSj2s37mB0PhZemGHtxLu
	m74BhNvCb8ulQKQUuF8M/MaaxZvlgEyEfJGMM=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=jVCmYosSIE9tFIlLZWWPndvIQx3IEqRf
	+3xvifs+dsmv+BB5lBVLouA91snBfLXV/Qp00MrCSVNmfCmvsMae3NkynKwBPKIb
	7WD+cWwahIQUcMtqwolt2hTDssgGtCqTOYKhUcIpBvconGLEfKek/iuAru4rKElY
	Y61PwIT5GDw=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 0E0608B36;
	Thu,  8 Dec 2011 15:18:28 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 720938B35;
	Thu,  8 Dec 2011 15:18:27 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: And another deprecation joke
References: <877h28iln6.fsf@fencepost.gnu.org> <8762hsmnn7.fsf@pobox.com>
	<87liqoh01s.fsf@fencepost.gnu.org>
	<20111208022934.GC1767@shuttle.happyleptic.org>
	<87pqfzo49t.fsf@fencepost.gnu.org>
Date: Thu, 08 Dec 2011 21:18:24 +0100
In-Reply-To: <87pqfzo49t.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Thu, 08 Dec 2011 09:29:18 +0100")
Message-ID: <87obvikeb3.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: C9DCD352-21D9-11E1-A530-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 08 Dec 2011 20:18:32 -0000

Hi David,

Again, thank you for your bug reports, but Guile development is not
driven by shame.  So please keep up your (useful!) bug reports, but try
to give them a more positive flavor :)

Thanks,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Thu Dec 08 15:32:49 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYke9-0007is-G7
	for mharc-guile-devel@gnu.org; Thu, 08 Dec 2011 15:32:49 -0500
Received: from eggs.gnu.org ([140.186.70.92]:54073)
	by lists.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RYke6-0007fz-O6
	for guile-devel@gnu.org; Thu, 08 Dec 2011 15:32:47 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dak@gnu.org>) id 1RYke5-0005jr-H9
	for guile-devel@gnu.org; Thu, 08 Dec 2011 15:32:46 -0500
Received: from fencepost.gnu.org ([140.186.70.10]:40579)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RYke5-0005jn-Fj
	for guile-devel@gnu.org; Thu, 08 Dec 2011 15:32:45 -0500
Received: from localhost ([127.0.0.1]:50498 helo=lola)
	by fencepost.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dak@gnu.org>)
	id 1RYke5-0004z5-1A; Thu, 08 Dec 2011 15:32:45 -0500
Received: by lola (Postfix, from userid 1000)
	id 96D23E0C78; Thu,  8 Dec 2011 21:32:27 +0100 (CET)
From: David Kastrup <dak@gnu.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: And another deprecation joke
References: <877h28iln6.fsf@fencepost.gnu.org> <8762hsmnn7.fsf@pobox.com>
	<87liqoh01s.fsf@fencepost.gnu.org>
	<20111208022934.GC1767@shuttle.happyleptic.org>
	<87pqfzo49t.fsf@fencepost.gnu.org> <87obvikeb3.fsf@pobox.com>
Date: Thu, 08 Dec 2011 21:32:27 +0100
In-Reply-To: <87obvikeb3.fsf@pobox.com> (Andy Wingo's message of "Thu, 08 Dec
	2011 21:18:24 +0100")
Message-ID: <87fwguls84.fsf@fencepost.gnu.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 140.186.70.10
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 08 Dec 2011 20:32:47 -0000

Andy Wingo <wingo@pobox.com> writes:

> Again, thank you for your bug reports, but Guile development is not
> driven by shame.

Obviously.

> So please keep up your (useful!) bug reports, but try to give them a
> more positive flavor :)

Could you give an example how to deliver with a positive flavor a report
about deprecation messages talking about the wrong function, telling you
in vague terms to use something instead for which no documentation is
available, with both the state of documentation and message apparently
being the same for years?

I mean, reporting to the authorities even something as unsavory as a bug
has a sinister flavor to it after all.  It has found a home and place it
has been enjoying for years in peace and company.

-- 
David Kastrup


From MAILER-DAEMON Thu Dec 08 15:56:05 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYl0f-0003sI-Kq
	for mharc-guile-devel@gnu.org; Thu, 08 Dec 2011 15:56:05 -0500
Received: from eggs.gnu.org ([140.186.70.92]:36388)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RYl0d-0003sC-N7
	for guile-devel@gnu.org; Thu, 08 Dec 2011 15:56:04 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RYl0c-0000z9-Os
	for guile-devel@gnu.org; Thu, 08 Dec 2011 15:56:03 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:33885
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RYl0b-0000yr-75; Thu, 08 Dec 2011 15:56:01 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 8DF788F5E;
	Thu,  8 Dec 2011 15:56:00 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=WfsI4cbpnp75iM5akkMg7l5beZ0=; b=jypn/J
	uWstLQgSMOULfWahJ6Q8VKaZzLI5PROgXpEatw/JIO7Rs52mz8DjP2SZ3kSA0Lm2
	yB57Q5da5nbuJ6SbVscuk0bdQNB5GzBPylBjhSFEwy4JeRxRNnsLRGgjxTCnAbYR
	EVjf4z3P0ON2yJw0SPM3uFwKlcRmozZYT2zNI=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=Qz9v9WxCD122c3NQWJQiGDE89gDHpC9C
	WzY6kXCwbOX6tfkIjPCseDORfjQmWDw8GtB2BOpYOBnv7JciXuXvxCdYZhsu9G+g
	ctd+8I4rW+lWrea4zGMcHAzSFvs5ClZJmPBXDP50gCvGdGQVFZclgzGr1+k4VwOo
	IDn+6SXo2Oo=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 8493A8F5D;
	Thu,  8 Dec 2011 15:56:00 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id C5A868F5A;
	Thu,  8 Dec 2011 15:55:59 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: And another deprecation joke
References: <877h28iln6.fsf@fencepost.gnu.org> <8762hsmnn7.fsf@pobox.com>
	<87liqoh01s.fsf@fencepost.gnu.org>
	<20111208022934.GC1767@shuttle.happyleptic.org>
	<87pqfzo49t.fsf@fencepost.gnu.org> <87obvikeb3.fsf@pobox.com>
	<87fwguls84.fsf@fencepost.gnu.org>
Date: Thu, 08 Dec 2011 21:55:55 +0100
In-Reply-To: <87fwguls84.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Thu, 08 Dec 2011 21:32:27 +0100")
Message-ID: <87fwgukckk.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 086640EA-21DF-11E1-BCA3-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 08 Dec 2011 20:56:04 -0000

On Thu 08 Dec 2011 21:32, David Kastrup <dak@gnu.org> writes:

>> So please keep up your (useful!) bug reports, but try to give them a
>> more positive flavor :)
>
> Could you give an example how to deliver with a positive flavor a report
> about deprecation messages talking about the wrong function, telling you
> in vague terms to use something instead for which no documentation is
> available, with both the state of documentation and message apparently
> being the same for years?

Sure!  Here's one from about a week ago:

  http://thread.gmane.org/gmane.lisp.guile.bugs/5953

There are many more there.

Using bug-guile also has the advantage that it's given an entry in
debbugs, so that we don't forget about it.

Regards,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Thu Dec 08 17:01:33 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYm21-0001p8-PI
	for mharc-guile-devel@gnu.org; Thu, 08 Dec 2011 17:01:33 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55957)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ianprice90@googlemail.com>) id 1RYm1x-0001oz-Bw
	for guile-devel@gnu.org; Thu, 08 Dec 2011 17:01:32 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ianprice90@googlemail.com>) id 1RYm1v-0001jk-Vx
	for guile-devel@gnu.org; Thu, 08 Dec 2011 17:01:29 -0500
Received: from mail-ww0-f49.google.com ([74.125.82.49]:39774)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ianprice90@googlemail.com>) id 1RYm1v-0001je-PJ
	for guile-devel@gnu.org; Thu, 08 Dec 2011 17:01:27 -0500
Received: by wgbdt11 with SMTP id dt11so3321821wgb.30
	for <guile-devel@gnu.org>; Thu, 08 Dec 2011 14:01:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
	d=googlemail.com; s=gamma;
	h=from:to:cc:subject:references:date:in-reply-to:message-id
	:user-agent:mime-version:content-type:content-transfer-encoding;
	bh=h2B2ApLQZX4IpETFYcmLR/ZszKrhc0VqF1N0jDfnc1A=;
	b=SeLYOI5j/EfYpEQ3EBUWbRymNnA9dMYa3rVe4QocIVRglSqCuGdgmvcprO8Y4eb2R0
	qZhNpGOCJ4OHwR5LOKc2FxucLQBmhUeOpOXNe1wHsBlz4vojFpWFdx6rK49tTm9wNxLD
	JEnC/NMv/EVQEBhVWGfIZK0WmHOCDQUJ3ExIU=
Received: by 10.216.137.103 with SMTP id x81mr140114wei.34.1323381685272;
	Thu, 08 Dec 2011 14:01:25 -0800 (PST)
Received: from Kagami.home (host86-168-32-36.range86-168.btcentralplus.com.
	[86.168.32.36])
	by mx.google.com with ESMTPS id w8sm10518548wiz.4.2011.12.08.14.01.23
	(version=TLSv1/SSLv3 cipher=OTHER);
	Thu, 08 Dec 2011 14:01:24 -0800 (PST)
From: Ian Price <ianprice90@googlemail.com>
To: Stefan Israelsson Tampe <stefan.itampe@gmail.com>
Subject: Re: syntax-local-value patch for discussion
References: <CAGua6m0syo=-jz9rxfcPr4NTuirRPFevZ89wHKVF_zi3OAgbig@mail.gmail.com>
Date: Thu, 08 Dec 2011 21:58:01 +0000
In-Reply-To: <CAGua6m0syo=-jz9rxfcPr4NTuirRPFevZ89wHKVF_zi3OAgbig@mail.gmail.com>
	(Stefan Israelsson Tampe's message of "Mon, 5 Dec 2011 19:12:28
	+0100")
Message-ID: <87ty5aafpy.fsf@Kagami.home>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 74.125.82.49
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 08 Dec 2011 22:01:32 -0000

Stefan Israelsson Tampe <stefan.itampe@gmail.com> writes:

> So I tried to get hold of the macro binding. So with the following patch =
wich should be enogh
> for me to make progress porting rackets syntax parse to guile.
>
> Would be very glad if we could find a interface to expose this informatio=
n that is sane
> and rigid manner. So we should discuss this feature.
As it stands, I agree it is pretty simplistic, but I'm not sure what to
propose :) What is the intended use cases for this? A compile-time
values mechanism?

> Anyway about the patch.
> I added a fluid that is setted with a closure that captures enough syntax=
 information
> so that we can lookup the macro value local or global. It basically uses =
the same method
> as psyntax macroexpander.
The patch looks fine to me, although I admit I have little experience
with psyntax.

>
> Now we can write,
> (define-syntax info
> =C2=A0 (lambda (x)
> =C2=A0=C2=A0=C2=A0 (syntax-case x ()
> =C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 ((_ x)
> =C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 (pk (syntax-binding-info (synt=
ax->datum #'x)))
> =C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 #'#f))))
FWIW, I wouldn't expect to have to pass a raw datum to any procedure
with a syntax prefix. If we keep this procedure, I think the
syntax->datum should be hid, or the procedure renamed.

> So with this I can attach meta information to macros local or not by
> using a weak hash.
I have 'define-type' & 'type-case' macros, basically copied from
racket's plai language[0][1] , that suffers from a complete lack of
error handling in the case where the type-id is not, in fact, a
type-id. If I were to use this mechanism, I would create a weak hash of
datatype-ids, adding them to the hash with 'define-type', and checking
if they are in the hash in my 'type-case' macro. Would that be right?

0. http://docs.racket-lang.org/plai/plai-scheme.html
1. I can post these if people want them
--=20
Ian Price

"Programming is like pinball. The reward for doing it well is
the opportunity to do it again" - from "The Wizardy Compiled"


From MAILER-DAEMON Thu Dec 08 20:58:34 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYpjO-0003jx-9F
	for mharc-guile-devel@gnu.org; Thu, 08 Dec 2011 20:58:34 -0500
Received: from eggs.gnu.org ([140.186.70.92]:50948)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYpjL-0003jr-QV
	for guile-devel@gnu.org; Thu, 08 Dec 2011 20:58:32 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYpjK-00028K-99
	for guile-devel@gnu.org; Thu, 08 Dec 2011 20:58:31 -0500
Received: from lo.gmane.org ([80.91.229.12]:46070)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYpjJ-00022j-W6
	for guile-devel@gnu.org; Thu, 08 Dec 2011 20:58:30 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYpjG-00052M-U0
	for guile-devel@gnu.org; Fri, 09 Dec 2011 02:58:26 +0100
Received: from p508ec3c9.dip.t-dialin.net ([80.142.195.201])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 09 Dec 2011 02:58:26 +0100
Received: from dak by p508ec3c9.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 09 Dec 2011 02:58:26 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: And another deprecation joke
Date: Fri, 09 Dec 2011 02:58:11 +0100
Organization: Organization?!?
Lines: 52
Message-ID: <87zkf2jyks.fsf@fencepost.gnu.org>
References: <877h28iln6.fsf@fencepost.gnu.org> <8762hsmnn7.fsf@pobox.com>
	<87liqoh01s.fsf@fencepost.gnu.org>
	<20111208022934.GC1767@shuttle.happyleptic.org>
	<87pqfzo49t.fsf@fencepost.gnu.org> <87obvikeb3.fsf@pobox.com>
	<87fwguls84.fsf@fencepost.gnu.org> <87fwgukckk.fsf@pobox.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ec3c9.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:Kw2FfxmvcXDjPJ9dBlilJXlfeLg=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 09 Dec 2011 01:58:33 -0000

Andy Wingo <wingo@pobox.com> writes:

> On Thu 08 Dec 2011 21:32, David Kastrup <dak@gnu.org> writes:
>
>>> So please keep up your (useful!) bug reports, but try to give them a
>>> more positive flavor :)
>>
>> Could you give an example how to deliver with a positive flavor a report
>> about deprecation messages talking about the wrong function, telling you
>> in vague terms to use something instead for which no documentation is
>> available, with both the state of documentation and message apparently
>> being the same for years?
>
> Sure!  Here's one from about a week ago:
>
>   http://thread.gmane.org/gmane.lisp.guile.bugs/5953
>
> There are many more there.
>
> Using bug-guile also has the advantage that it's given an entry in
> debbugs, so that we don't forget about it.

An application "bug-guile" is not available as a command line tool, or
as a guile function in a standard installation of Guile on Ubuntu.

The Guile reference manual for the currently distributed version (1.8.8)
has a long chapter "Reporting Bugs" that starts with

    Any problems with the installation should be reported to
    <bug-guile@gnu.org>.

An application "guile-bug" is mentioned nowhere.  The most up to date
version of the reference manual, namely that in the repository, can be
read at
<URL:http://hydra.nixos.org/build/1574618/download/2/guile.html/Reporting-Bugs.html#Reporting-Bugs>.
And look and behold, it does not contain a mention of bug-guile either.

You really need to get rid of this "oral tradition" habit and actually
bother writing things down in the manual where people have a chance to
see them.  I often get the "oh, we won't bother updating the manual in
the 1.8 Guile branch anymore, that is so yesterday" brush-off, but it is
not like you actually bother updating the 2.0 Guile manual all that much
either.

So how about starting with the bug reporting instructions, and actually
writing down what a reporter should do to avoid being told his way of
reporting bugs has gone out of fashion?

Then you have a better reason to tell people they are doing it wrong.

-- 
David Kastrup



From MAILER-DAEMON Thu Dec 08 21:38:54 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYqMQ-0002Bo-Ad
	for mharc-guile-devel@gnu.org; Thu, 08 Dec 2011 21:38:54 -0500
Received: from eggs.gnu.org ([140.186.70.92]:57040)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dsmich@roadrunner.com>) id 1RYqMN-0002Bh-0i
	for guile-devel@gnu.org; Thu, 08 Dec 2011 21:38:52 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dsmich@roadrunner.com>) id 1RYqMK-0006ai-Lj
	for guile-devel@gnu.org; Thu, 08 Dec 2011 21:38:50 -0500
Received: from cdptpa-omtalb.mail.rr.com ([75.180.132.120]:4299)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dsmich@roadrunner.com>) id 1RYqMK-0006aG-Je
	for guile-devel@gnu.org; Thu, 08 Dec 2011 21:38:48 -0500
Authentication-Results: cdptpa-omtalb.mail.rr.com
	smtp.user=dsmich@roadrunner.com; auth=pass (LOGIN)
X-Authority-Analysis: v=2.0 cv=IacFqBWa c=1 sm=0 a=MAYWdLLFBbkA:10
	a=zTVDa7HKqxcA:10 a=IkcTkHD0fZMA:10 a=mDV3o1hIAAAA:8
	a=ybZZDoGAAAAA:8 a=TSbVqHtbAAAA:8 a=PVln8giG32RTrsgqAPwA:9
	a=rJvCDu7_M6gf2c_kSgsA:7 a=QEXdDO2ut3YA:10 a=ii61gXl28gQA:10
	a=qIVjreYYsbEA:10 a=KP/YX84if8whyb+LKdk8pQ==:117
X-Cloudmark-Score: 0
Received: from [10.127.132.106] ([10.127.132.106:63458] helo=cdptpa-web15-z01)
	by cdptpa-oedge02.mail.rr.com (envelope-from <dsmich@roadrunner.com>)
	(ecelerity 2.2.3.46 r()) with ESMTPA
	id 21/3B-24539-5B471EE4; Fri, 09 Dec 2011 02:38:45 +0000
Message-ID: <20111209023845.YDGWW.11365.root@cdptpa-web15-z01>
Date: Thu, 8 Dec 2011 21:38:45 -0500
From: <dsmich@roadrunner.com>
To: guile-devel@gnu.org, David Kastrup <dak@gnu.org>
Subject: Re: And another deprecation joke
In-Reply-To: <87zkf2jyks.fsf@fencepost.gnu.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Originating-IP: 
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 75.180.132.120
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 09 Dec 2011 02:38:52 -0000


---- David Kastrup <dak@gnu.org> wrote: 
> Andy Wingo <wingo@pobox.com> writes:
> 
> > On Thu 08 Dec 2011 21:32, David Kastrup <dak@gnu.org> writes:
> >
> >>> So please keep up your (useful!) bug reports, but try to give them a
> >>> more positive flavor :)
> >>
> >> Could you give an example how to deliver with a positive flavor a report
> >> about deprecation messages talking about the wrong function, telling you
> >> in vague terms to use something instead for which no documentation is
> >> available, with both the state of documentation and message apparently
> >> being the same for years?
> >
> > Sure!  Here's one from about a week ago:
> >
> >   http://thread.gmane.org/gmane.lisp.guile.bugs/5953
> >
> > There are many more there.
> >
> > Using bug-guile also has the advantage that it's given an entry in
> > debbugs, so that we don't forget about it.
> 
> An application "bug-guile" is not available as a command line tool, or
> as a guile function in a standard installation of Guile on Ubuntu.
> 
> The Guile reference manual for the currently distributed version (1.8.8)
> has a long chapter "Reporting Bugs" that starts with
> 
>     Any problems with the installation should be reported to
>     <bug-guile@gnu.org>.
> 
> An application "guile-bug" is mentioned nowhere.

"bug-guile@gnu.org" is a mailing list, not an application.  You use your email application to send the bug report.

-Dale




From MAILER-DAEMON Fri Dec 09 04:24:02 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYwgU-00024a-HJ
	for mharc-guile-devel@gnu.org; Fri, 09 Dec 2011 04:24:02 -0500
Received: from eggs.gnu.org ([140.186.70.92]:37545)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYwgP-000242-1V
	for guile-devel@gnu.org; Fri, 09 Dec 2011 04:24:01 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYwgK-0002xi-P5
	for guile-devel@gnu.org; Fri, 09 Dec 2011 04:23:57 -0500
Received: from lo.gmane.org ([80.91.229.12]:39532)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYwgK-0002xT-Jz
	for guile-devel@gnu.org; Fri, 09 Dec 2011 04:23:52 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RYwgI-00049E-Tk
	for guile-devel@gnu.org; Fri, 09 Dec 2011 10:23:50 +0100
Received: from p508ec3c9.dip.t-dialin.net ([80.142.195.201])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 09 Dec 2011 10:23:50 +0100
Received: from dak by p508ec3c9.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 09 Dec 2011 10:23:50 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: And another deprecation joke
Date: Fri, 09 Dec 2011 10:23:39 +0100
Organization: Organization?!?
Lines: 33
Message-ID: <87vcpqjdyc.fsf@fencepost.gnu.org>
References: <87zkf2jyks.fsf@fencepost.gnu.org>
	<20111209023845.YDGWW.11365.root@cdptpa-web15-z01>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ec3c9.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:vI6pYOQx1fRMpdAFwBgQ2iepisI=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 09 Dec 2011 09:24:01 -0000

<dsmich@roadrunner.com> writes:

> ---- David Kastrup <dak@gnu.org> wrote: 
>
>> An application "guile-bug" is mentioned nowhere.
>
> "bug-guile@gnu.org" is a mailing list, not an application.  You use
> your email application to send the bug report.

Indeed.  At some point of time I lost sight that this was not the bug
list.

To make a non-bug specific suggestion to developers: try to answer each
question (that is not solely restricted to an individual's problem) by
quoting a manual passage.  Even if it means having to write or rewrite
or reindex that manual passage first.

If you have trouble finding the right passage, so will the user.  If you
feel that the manual passage is not quite right, so will the user.

There will be hundreds of users with the same problem, hopefully.  They
are all capable of reading the manual.  They are not capable of reading
your mind: that's something you have to do yourself, then write up an
answer.

Make it a habit to write a useful answer once.  Then only reference it.
It is more work the first time round.  But if Guile is supposed to be
successful, that first time is going to have dozens of repetitions.

Be prepared for Guile's success.

-- 
David Kastrup



From MAILER-DAEMON Fri Dec 09 06:49:41 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RYyxR-0004a2-9W
	for mharc-guile-devel@gnu.org; Fri, 09 Dec 2011 06:49:41 -0500
Received: from eggs.gnu.org ([140.186.70.92]:58212)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <stefan.itampe@gmail.com>) id 1RYyxN-0004Zt-Rr
	for guile-devel@gnu.org; Fri, 09 Dec 2011 06:49:39 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <stefan.itampe@gmail.com>) id 1RYyxL-0008Qg-SL
	for guile-devel@gnu.org; Fri, 09 Dec 2011 06:49:37 -0500
Received: from mail-ey0-f169.google.com ([209.85.215.169]:60530)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <stefan.itampe@gmail.com>) id 1RYyxL-0008QS-Ev
	for guile-devel@gnu.org; Fri, 09 Dec 2011 06:49:35 -0500
Received: by eaah1 with SMTP id h1so1819315eaa.0
	for <guile-devel@gnu.org>; Fri, 09 Dec 2011 03:49:33 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=fcJEmlEapmpAh3kS3z1qy+1ac/jNiuyeymIFdPganb8=;
	b=B2NCYch1H+tP14NrT/xunD1AYQg5ELBneY5nKQMsRFPdmtZ3gV/LLUt/KgZAw3QMKy
	GO8rGuNoMgaAP1mZZNz1JeE+VcuXbnQH9utY5iR1P+U2ixEB5/Ex2HpfWcZzl8MhgT0w
	EXnpIXkbw+jupz17/3hgIjtvdESYUY1Cn1fGU=
MIME-Version: 1.0
Received: by 10.213.3.81 with SMTP id 17mr1763209ebm.148.1323431373597; Fri,
	09 Dec 2011 03:49:33 -0800 (PST)
Received: by 10.213.22.210 with HTTP; Fri, 9 Dec 2011 03:49:33 -0800 (PST)
In-Reply-To: <87ty5aafpy.fsf@Kagami.home>
References: <CAGua6m0syo=-jz9rxfcPr4NTuirRPFevZ89wHKVF_zi3OAgbig@mail.gmail.com>
	<87ty5aafpy.fsf@Kagami.home>
Date: Fri, 9 Dec 2011 12:49:33 +0100
Message-ID: <CAGua6m2bbkP8PwXZpjFWLVH-_D_paRpgJ08UsT49iKm6Cq53BQ@mail.gmail.com>
Subject: Re: syntax-local-value patch for discussion
From: Stefan Israelsson Tampe <stefan.itampe@gmail.com>
To: Ian Price <ianprice90@googlemail.com>
Content-Type: multipart/alternative; boundary=0015174c3ccae86e4e04b3a76002
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.215.169
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 09 Dec 2011 11:49:39 -0000

--0015174c3ccae86e4e04b3a76002
Content-Type: text/plain; charset=ISO-8859-1

Hi,

On Thu, Dec 8, 2011 at 10:58 PM, Ian Price <ianprice90@googlemail.com>wrote:

> Stefan Israelsson Tampe <stefan.itampe@gmail.com> writes:
>
> > So I tried to get hold of the macro binding. So with the following patch
> wich should be enogh
> > for me to make progress porting rackets syntax parse to guile.
> >
> > Would be very glad if we could find a interface to expose this
> information that is sane
> > and rigid manner. So we should discuss this feature.
> As it stands, I agree it is pretty simplistic, but I'm not sure what to
> propose :) What is the intended use cases for this? A compile-time
> values mechanism?
>

In syntax-parse they associate atribute data to an attribute variable that
also is a macro.
So later on when the symbol is used the compiler want to get hold of the
attribute data.
So there is a need to get hold on the lambda that is associated with the
symbol and then lookup
the data via a weak hash table.


> > Anyway about the patch.
> > I added a fluid that is setted with a closure that captures enough
> syntax information
> > so that we can lookup the macro value local or global. It basically uses
> the same method
> > as psyntax macroexpander.
> The patch looks fine to me, although I admit I have little experience
> with psyntax.
>

Ok,


> >
> > Now we can write,
> > (define-syntax info
> >   (lambda (x)
> >     (syntax-case x ()
> >       ((_ x)
> >         (pk (syntax-binding-info (syntax->datum #'x)))
> >         #'#f))))
> FWIW, I wouldn't expect to have to pass a raw datum to any procedure
> with a syntax prefix. If we keep this procedure, I think the
> syntax->datum should be hid, or the procedure renamed.
>

An idea is to  change the name to symbol-local-data. Another idea is to
return
the lookup function directly (I think that this might be needed as well to
make sure
that the same symbol has the same interpretation in two contexts)
So for this function we could use the name  local-symbol-lookup-function
and then builed any secondary interfaces on that inside a proper module.


> > So with this I can attach meta information to macros local or not by
> > using a weak hash.
> I have 'define-type' & 'type-case' macros, basically copied from
> racket's plai language[0][1] , that suffers from a complete lack of
> error handling in the case where the type-id is not, in fact, a
> type-id. If I were to use this mechanism, I would create a weak hash of
> datatype-ids, adding them to the hash with 'define-type', and checking
> if they are in the hash in my 'type-case' macro. Would that be right?
>

Yes you can use this mechanism to do what you wan't. There might be better
ways though.
Anyway
1. In a separate module make the type-id:s and let them be macros with the
lambda put as a key
in a weak key hash table
2. in using the type-id in the expansion of a type-case you can now lookup
the symbol's context and deduce the  macro binding, get the lambda and
check if it is in the weak key hash table. and as you say be able to do the
sanity check.

Another method would be to have the type-id:s syntactic context is a module
toplevel variable,
and from the syntax object deduce if it is a toplevel variable and if so
check if the id is in the hash table.
Maybe there is tools alredy made that does this in a simple straightforward
way?

If you would define a type-id locally then the only way to later check for
valid type-id is to do
(let-syntax ((type-id (register-and-return (lambda (x) (error "this is a
type-id not a syntactic element")))
     the-code-that-uses-type-id ...)
where you would use my suggestion.

the machanism I propose

> 0. http://docs.racket-lang.org/plai/plai-scheme.html
> 1. I can post these if people want them
> --
> Ian Price
>
> "Programming is like pinball. The reward for doing it well is
> the opportunity to do it again" - from "The Wizardy Compiled"
>

Cool, these libraries can be useful,
/Stefan

--0015174c3ccae86e4e04b3a76002
Content-Type: text/html; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hi,<br><br><div class=3D"gmail_quote">On Thu, Dec 8, 2011 at 10:58 PM, Ian =
Price <span dir=3D"ltr">&lt;<a href=3D"mailto:ianprice90@googlemail.com">ia=
nprice90@googlemail.com</a>&gt;</span> wrote:<br><blockquote class=3D"gmail=
_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:=
1ex;">
<div class=3D"im">Stefan Israelsson Tampe &lt;<a href=3D"mailto:stefan.itam=
pe@gmail.com">stefan.itampe@gmail.com</a>&gt; writes:<br>
<br>
&gt; So I tried to get hold of the macro binding. So with the following pat=
ch wich should be enogh<br>
&gt; for me to make progress porting rackets syntax parse to guile.<br>
&gt;<br>
&gt; Would be very glad if we could find a interface to expose this informa=
tion that is sane<br>
&gt; and rigid manner. So we should discuss this feature.<br>
</div>As it stands, I agree it is pretty simplistic, but I&#39;m not sure w=
hat to<br>
propose :) What is the intended use cases for this? A compile-time<br>
values mechanism?<br><div class=3D"im"></div></blockquote><div><br>In synta=
x-parse they associate atribute data to an attribute variable that also is =
a macro.<br>So later on when the symbol is used the compiler want to get ho=
ld of the attribute data.<br>
So there is a need to get hold on the lambda that is associated with the sy=
mbol and then lookup<br>the data via a weak hash table.<br>=A0</div><blockq=
uote class=3D"gmail_quote" style=3D"margin: 0pt 0pt 0pt 0.8ex; border-left:=
 1px solid rgb(204, 204, 204); padding-left: 1ex;">
<div class=3D"im">
&gt; Anyway about the patch.<br>
&gt; I added a fluid that is setted with a closure that captures enough syn=
tax information<br>
&gt; so that we can lookup the macro value local or global. It basically us=
es the same method<br>
&gt; as psyntax macroexpander.<br>
</div>The patch looks fine to me, although I admit I have little experience=
<br>
with psyntax.<br></blockquote><div><br>Ok, <br></div><div>=A0</div><blockqu=
ote class=3D"gmail_quote" style=3D"margin: 0pt 0pt 0pt 0.8ex; border-left: =
1px solid rgb(204, 204, 204); padding-left: 1ex;"><div class=3D"im">
&gt;<br>
&gt; Now we can write,<br>
&gt; (define-syntax info<br>
&gt; =A0 (lambda (x)<br>
&gt; =A0=A0=A0 (syntax-case x ()<br>
&gt; =A0=A0=A0=A0=A0 ((_ x)<br>
&gt; =A0=A0=A0=A0=A0=A0=A0 (pk (syntax-binding-info (syntax-&gt;datum #&#39=
;x)))<br>
&gt; =A0=A0=A0=A0=A0=A0=A0 #&#39;#f))))<br>
</div>FWIW, I wouldn&#39;t expect to have to pass a raw datum to any proced=
ure<br>
with a syntax prefix. If we keep this procedure, I think the<br>
syntax-&gt;datum should be hid, or the procedure renamed.<br><div class=3D"=
im"></div></blockquote><div><br>An idea is to=A0 change the name to symbol-=
local-data. Another idea is to return<br>the lookup function directly (I th=
ink that this might be needed as well to make sure<br>
that the same symbol has the same interpretation in two contexts)<br>So for=
 this function we could use the name=A0 local-symbol-lookup-function<br>and=
 then builed any secondary interfaces on that inside a proper module.<br>
=A0</div><blockquote class=3D"gmail_quote" style=3D"margin: 0pt 0pt 0pt 0.8=
ex; border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;"><div cla=
ss=3D"im">
&gt; So with this I can attach meta information to macros local or not by<b=
r>
&gt; using a weak hash.<br>
</div>I have &#39;define-type&#39; &amp; &#39;type-case&#39; macros, basica=
lly copied from<br>
racket&#39;s plai language[0][1] , that suffers from a complete lack of<br>
error handling in the case where the type-id is not, in fact, a<br>
type-id. If I were to use this mechanism, I would create a weak hash of<br>
datatype-ids, adding them to the hash with &#39;define-type&#39;, and check=
ing<br>
if they are in the hash in my &#39;type-case&#39; macro. Would that be righ=
t?<br></blockquote><div><br>Yes you can use this mechanism to do what you w=
an&#39;t. There might be better ways though.<br>Anyway <br>1. In a separate=
 module make the type-id:s and let them be macros with the lambda put as a =
key<br>
in a weak key hash table<br>2. in using the type-id in the expansion of a t=
ype-case you can now lookup the symbol&#39;s context and deduce the=A0 macr=
o binding, get the lambda and check if it is in the weak key hash table. an=
d as you say be able to do the sanity check.<br>
<br>Another method would be to have the type-id:s syntactic context is a mo=
dule toplevel variable, <br>and from the syntax object deduce if it is a to=
plevel variable and if so check if the id is in the hash table.<br>Maybe th=
ere is tools alredy made that does this in a simple straightforward way?<br=
>
<br>If you would define a type-id locally then the only way to later check =
for valid type-id is to do<br>(let-syntax ((type-id (register-and-return (l=
ambda (x) (error &quot;this is a type-id not a syntactic element&quot;)))<b=
r>
=A0=A0=A0=A0 the-code-that-uses-type-id ...)<br>where you would use my sugg=
estion.<br><br>the machanism I propose<br></div><blockquote class=3D"gmail_=
quote" style=3D"margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, =
204, 204); padding-left: 1ex;">

0. <a href=3D"http://docs.racket-lang.org/plai/plai-scheme.html" target=3D"=
_blank">http://docs.racket-lang.org/plai/plai-scheme.html</a><br>
1. I can post these if people want them<br>
<span class=3D"HOEnZb"><font color=3D"#888888">--<br>
Ian Price<br>
<br>
&quot;Programming is like pinball. The reward for doing it well is<br>
the opportunity to do it again&quot; - from &quot;The Wizardy Compiled&quot=
;<br>
</font></span></blockquote></div><br>Cool, these libraries can be useful,<b=
r>/Stefan<br>

--0015174c3ccae86e4e04b3a76002--


From MAILER-DAEMON Fri Dec 09 13:24:04 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RZ576-0006Tf-OQ
	for mharc-guile-devel@gnu.org; Fri, 09 Dec 2011 13:24:04 -0500
Received: from eggs.gnu.org ([140.186.70.92]:54373)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RZ575-0006T3-3e
	for guile-devel@gnu.org; Fri, 09 Dec 2011 13:24:04 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RZ574-0000SV-3I
	for guile-devel@gnu.org; Fri, 09 Dec 2011 13:24:03 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:36759
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RZ572-0000SC-MU; Fri, 09 Dec 2011 13:24:00 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 5E6158409;
	Fri,  9 Dec 2011 13:24:00 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=1uc7XC0sN54AfZha30VbqiqdRTo=; b=vZilEO
	qpTq5I/1N5d5GteuItTOsj7QX3Oxb5iMDCCeHSrQVzsQ0/BMCIXwSxj2gqVuM+yy
	8EcFhFsZUSwunbAi51/xzydeE6F13qePKbBMo1EPw/JVf7LW9HIvH99QWuPW+9pT
	+4kCTkn7iKqkBPGTrTD0iNcoehEzBZmquI3TI=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=E1XjqZTJ2aaRZhONpFbgCjOCXoAG/751
	J5FYv5UvR00LAO32kBMmZmlP+nEOHYX4yFfoMrtpneYNtiUeAmJ3XSHCVvq4SoYw
	KpGP4dq9tUTU1MR4/JKz6VyGuN+Ec62rhxy8VH1/hZoIi2dt4Lv9qf9vPuGmbUam
	xgA8z6/fY0s=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 55A768408;
	Fri,  9 Dec 2011 13:24:00 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id BCBAE8407;
	Fri,  9 Dec 2011 13:23:59 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: And another deprecation joke
References: <87zkf2jyks.fsf@fencepost.gnu.org>
	<20111209023845.YDGWW.11365.root@cdptpa-web15-z01>
	<87vcpqjdyc.fsf@fencepost.gnu.org>
Date: Fri, 09 Dec 2011 19:23:55 +0100
In-Reply-To: <87vcpqjdyc.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Fri, 09 Dec 2011 10:23:39 +0100")
Message-ID: <8739ctk3ic.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: F6CF2B80-2292-11E1-A15D-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 09 Dec 2011 18:24:04 -0000

On Fri 09 Dec 2011 10:23, David Kastrup <dak@gnu.org> writes:

> To make a non-bug specific suggestion to developers: try to answer each
> question (that is not solely restricted to an individual's problem) by
> quoting a manual passage.  Even if it means having to write or rewrite
> or reindex that manual passage first [...]
>
> Be prepared for Guile's success.

Good suggestions, all.

Happy hacking,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Sat Dec 10 09:52:55 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RZOIJ-0005i3-Py
	for mharc-guile-devel@gnu.org; Sat, 10 Dec 2011 09:52:55 -0500
Received: from eggs.gnu.org ([140.186.70.92]:35060)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RZOII-0005hx-6R
	for guile-devel@gnu.org; Sat, 10 Dec 2011 09:52:55 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RZOIG-0004OU-W6
	for guile-devel@gnu.org; Sat, 10 Dec 2011 09:52:54 -0500
Received: from mail4-relais-sop.national.inria.fr ([192.134.164.105]:17528)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <ludo@gnu.org>)
	id 1RZOIG-0004ON-OU
	for guile-devel@gnu.org; Sat, 10 Dec 2011 09:52:52 -0500
X-IronPort-AV: E=Sophos;i="4.71,331,1320620400"; d="scan'208";a="122851638"
Received: from reverse-83.fdn.fr (HELO pluto) ([80.67.176.83])
	by mail4-relais-sop.national.inria.fr with ESMTP/TLS/DHE-RSA-AES128-SHA;
	10 Dec 2011 15:52:50 +0100
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
To: Andy Wingo <wingo@pobox.com>
Subject: Re: [PATCH] Add "scandir" procedure
References: <1314475521.3143.47.camel@Renee-desktop> <8762lehoj4.fsf@gnu.org>
	<87k469or31.fsf@pobox.com>
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 20 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
Date: Sat, 10 Dec 2011 15:52:46 +0100
In-Reply-To: <87k469or31.fsf@pobox.com> (Andy Wingo's message of "Tue, 06 Dec
	2011 12:52:02 +0100")
Message-ID: <87liqkh41t.fsf@gnu.org>
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 192.134.164.105
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sat, 10 Dec 2011 14:52:55 -0000

Hi,

Andy Wingo <wingo@pobox.com> skribis:

> On Tue 30 Aug 2011 18:06, ludo@gnu.org (Ludovic Court=C3=A8s) writes:
>
>> I was actually planning to push =E2=80=98file-system-fold=E2=80=99, a fu=
nctional
>> alternative to =E2=80=98ftw=E2=80=99, which would be along the lines of =
this (from
>> <http://git.savannah.gnu.org/cgit/libchop.git/tree/utils/chop-backup#n46=
>):
>>
>>   (define (file-system-fold enter? leaf down up skip init file-name)
>>     "Traverse the directory at FILE-NAME, recursively.  Enter sub-direct=
ories
>>   only when (ENTER? PATH STAT RESULT) returns true.  When a sub-director=
y is
>>   entered, call (DOWN PATH STAT RESULT), where PATH is the path of the
>>   sub-directory and STAT the result of (lstat PATH); when it is left, ca=
ll (UP
>>   PATH STAT RESULT).  For each file in a directory, call (LEAF PATH STAT
>>   RESULT).  Return the result of these successive applications.  When EN=
TER?
>>   returns no, call (SKIP PATH STAT RESULT)."
>>
>>     ...)
>
> I see that you haven't pushed this yet.  Want to do so?

Yes, I=E2=80=99m looking into this now.

I was planning to make it part of (ice-9 ftw); WDYT?

If there=E2=80=99s anything else you=E2=80=99d like to discuss about the AP=
I or
implementation, please let me know.

> I would be happy with a `scandir' implementation on top of this
> interface.

Yes.  The mixture of concerns in that function is not brilliant, but
OTOH it=E2=80=99s probably good to have a function people are familiar with.

Thanks,
Ludo=E2=80=99.


From MAILER-DAEMON Sat Dec 10 10:37:53 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RZOzp-0000wf-Rc
	for mharc-guile-devel@gnu.org; Sat, 10 Dec 2011 10:37:53 -0500
Received: from eggs.gnu.org ([140.186.70.92]:46729)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RZOzo-0000wY-8V
	for guile-devel@gnu.org; Sat, 10 Dec 2011 10:37:53 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RZOzm-0001vK-TG
	for guile-devel@gnu.org; Sat, 10 Dec 2011 10:37:52 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:47766
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RZOzm-0001v3-Qp; Sat, 10 Dec 2011 10:37:50 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 5C60D84DB;
	Sat, 10 Dec 2011 10:37:49 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; s=sasl; bh=qjGWYHttP1NO
	Y/w7OkLw4Uh3VAc=; b=NwOL5pKqL9YmboiD9HdtK+pfstU1+GV8tBF6HsS4eEi5
	9vNBCx/RtYYRJdXtRMdCNze3rasm0+tHln0W8YLRLT4JmJl3os/yrx0gev7j52b3
	4HU5t4MBHuTjqR4DPMQ7GtOVNIpI+OVeAMGx+TrHtjjFjZd3H5LhwihkOpcBNYE=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; q=dns; s=sasl; b=jGhnpI
	PgMe2kVr6r1iqeLVpvjRHsoQMwmfA9ibcERAlqyj3FY0vcQ9RUpw6GSdgJCBDp1I
	V0A3HLBSVNrzJoLNbylHyMkHy3M14PV6XyeL7zbIdLTfU5Uo4D+HR4UixkBSq+hM
	7NO+15HH09yIqm43D+njLQkvev7GHrfPoPxbE=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 55C0E84DA;
	Sat, 10 Dec 2011 10:37:49 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 9C75A84D9;
	Sat, 10 Dec 2011 10:37:48 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: ludo@gnu.org (Ludovic =?utf-8?Q?Court=C3=A8s?=)
Subject: Re: [PATCH] Add "scandir" procedure
References: <1314475521.3143.47.camel@Renee-desktop> <8762lehoj4.fsf@gnu.org>
	<87k469or31.fsf@pobox.com> <87liqkh41t.fsf@gnu.org>
Date: Sat, 10 Dec 2011 16:37:44 +0100
In-Reply-To: <87liqkh41t.fsf@gnu.org> ("Ludovic =?utf-8?Q?Court=C3=A8s=22'?=
	=?utf-8?Q?s?= message of "Sat, 10 Dec 2011 15:52:46 +0100")
Message-ID: <87mxb0igjb.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Pobox-Relay-ID: E9F86054-2344-11E1-B581-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sat, 10 Dec 2011 15:37:53 -0000

Heya,

On Sat 10 Dec 2011 15:52, ludo@gnu.org (Ludovic Court=C3=A8s) writes:

> Andy Wingo <wingo@pobox.com> skribis:
>
>> On Tue 30 Aug 2011 18:06, ludo@gnu.org (Ludovic Court=C3=A8s) writes:
>>
>>> I was actually planning to push =E2=80=98file-system-fold=E2=80=99, a f=
unctional
>>> alternative to =E2=80=98ftw=E2=80=99, which would be along the lines of=
 this (from
>>> <http://git.savannah.gnu.org/cgit/libchop.git/tree/utils/chop-backup#n4=
6>):
>>>
>>>   (define (file-system-fold enter? leaf down up skip init file-name)
>>>     "Traverse the directory at FILE-NAME, recursively.  Enter sub-direc=
tories
>>>   only when (ENTER? PATH STAT RESULT) returns true.  When a sub-directo=
ry is
>>>   entered, call (DOWN PATH STAT RESULT), where PATH is the path of the
>>>   sub-directory and STAT the result of (lstat PATH); when it is left, c=
all (UP
>>>   PATH STAT RESULT).  For each file in a directory, call (LEAF PATH STAT
>>>   RESULT).  Return the result of these successive applications.  When E=
NTER?
>>>   returns no, call (SKIP PATH STAT RESULT)."
>>>
>>>     ...)
>>
>> I see that you haven't pushed this yet.  Want to do so?
>
> Yes, I=E2=80=99m looking into this now.
>
> I was planning to make it part of (ice-9 ftw); WDYT?

Sounds fine to me.  I didn't take a close look at the implementation,
but the idea of the function sounded sane to me.

>> I would be happy with a `scandir' implementation on top of this
>> interface.
>
> Yes.  The mixture of concerns in that function is not brilliant, but
> OTOH it=E2=80=99s probably good to have a function people are familiar wi=
th.

Yeah, I have the same thoughts.  OTOH, if file-system-fold goes into
(ice-9 ftw), where would a `scandir' go?  There also?  I guess that's
OK.

Just thinking out loud :)

Happy hacking,

Andy
--=20
http://wingolog.org/


From MAILER-DAEMON Sat Dec 10 13:27:02 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RZRdW-0004iR-SR
	for mharc-guile-devel@gnu.org; Sat, 10 Dec 2011 13:27:02 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52357)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RZRdU-0004hV-BK
	for guile-devel@gnu.org; Sat, 10 Dec 2011 13:27:01 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RZRdS-00083K-No
	for guile-devel@gnu.org; Sat, 10 Dec 2011 13:27:00 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:40616
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RZRdS-00083C-LN
	for guile-devel@gnu.org; Sat, 10 Dec 2011 13:26:58 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id CEF848826
	for <guile-devel@gnu.org>; Sat, 10 Dec 2011 13:26:57 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to
	:subject:date:message-id:mime-version:content-type; s=sasl; bh=e
	BmHL+j9ZWjGGt+6beXqPHckD/k=; b=oApjiDpKlrriukAzf+TBSEBcyLzmGQ2SH
	SM2OwkSIpc2FkO7PU7GGqNMFVoGsSkCSxmzVgO8vA7u5SAQOwed1OHSNKn8PQ4Me
	n6qeFDqJyM0dr8ZN8HSCxssl8RXqImWZYmxQnHnGSNvDCx6y4ImzADLjxFafantc
	TpiKloAVnA=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:subject
	:date:message-id:mime-version:content-type; q=dns; s=sasl; b=RwX
	LKG8ZeCrV8rQ7RxtUC3rsTE3aq1l5Iu9VtVMuufQbOYNnZT1nOAqwkdOPojYcqNh
	YBmGQtUDwaSt2Ar7A7Jmkpqh7DkoDy4WHfy1NW+rhfbckkLjq3Oy0dfa/V7SFwFu
	9umGFpKuYvji7wGxadqxbk9xZpI2jv6R0lD1jpoU=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id C8D1F8825
	for <guile-devel@gnu.org>; Sat, 10 Dec 2011 13:26:57 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 13F238824 for
	<guile-devel@gnu.org>; Sat, 10 Dec 2011 13:26:56 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: guile-devel <guile-devel@gnu.org>
Subject: extensibility, compatible changes, and ocap security
Date: Sat, 10 Dec 2011 19:26:53 +0100
Message-ID: <87iploi8pe.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 8AEAA762-235C-11E1-8C33-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sat, 10 Dec 2011 18:27:01 -0000

Hi,

I was compiling guile-gnome recently, saw a warning about a srfi-39
binding replacement, and went to go look at srfi-39 in Guile.  That's
the `parameterize' library, you see.  It is unnecessary, given that
`parameterize' is now in boot-9, but there is a wrinkle: srfi-39
requires that `current-input-port' et al be implemented as parameters.

Currently, `current-input-port' in boot-9 is a procedure of 0
arguments.  We can change it so that it has an optional argument, which
would be the equivalent of calling `set-current-input-port!' on the
arg.

However, this effectively gives another /capability/ to anyone that has
access to the previously idempotent `current-input-port' procedure:
namely, the ability to change the current input port.  The question is,
can we make this change in the default Guile?

(If you don't implement sandboxes for your users, the rest of this mail
doesn't apply to you.)

After some thinking about this, I think that the answer is "yes".  If
you are providing an ocap-style environment to untrusted code, then you
need to prevent Guile from making extensions to your interface that can
compromise your security invariants.  We have added optional and keyword
args to other interfaces in the past.  The kinds of extensions that
Guile could make within a stable series are all of the form, "evaluating
FOO produced a wrong-number-of-arguments error in guile 2.0.3, but in
2.0.4 we have made it do useful action BAR."  We promise that existing
uses will still work, so it's not like you have to implement your own
environment entirely, but you do need to make a number of proxies
(whether as procedure wrappers or identifier-syntax or whatever).

So that's what I'm thinking right now.  Other thoughts are welcome as
well.

Happy hacking,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Sat Dec 10 14:05:13 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RZSET-0007bI-Ob
	for mharc-guile-devel@gnu.org; Sat, 10 Dec 2011 14:05:13 -0500
Received: from eggs.gnu.org ([140.186.70.92]:51619)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RZSER-0007ZK-J5
	for guile-devel@gnu.org; Sat, 10 Dec 2011 14:05:12 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RZSEQ-0005ZE-HD
	for guile-devel@gnu.org; Sat, 10 Dec 2011 14:05:11 -0500
Received: from mail4-relais-sop.national.inria.fr ([192.134.164.105]:13104)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <ludo@gnu.org>)
	id 1RZSEQ-0005Z3-7j
	for guile-devel@gnu.org; Sat, 10 Dec 2011 14:05:10 -0500
X-IronPort-AV: E=Sophos;i="4.71,332,1320620400"; d="scan'208";a="122862494"
Received: from reverse-83.fdn.fr (HELO pluto) ([80.67.176.83])
	by mail4-relais-sop.national.inria.fr with ESMTP/TLS/DHE-RSA-AES128-SHA;
	10 Dec 2011 20:05:08 +0100
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
To: Andy Wingo <wingo@pobox.com>
Subject: Re: [PATCH] Add "scandir" procedure
References: <1314475521.3143.47.camel@Renee-desktop> <8762lehoj4.fsf@gnu.org>
	<87k469or31.fsf@pobox.com> <87liqkh41t.fsf@gnu.org>
	<87mxb0igjb.fsf@pobox.com>
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 20 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
Date: Sat, 10 Dec 2011 20:05:04 +0100
In-Reply-To: <87mxb0igjb.fsf@pobox.com> (Andy Wingo's message of "Sat, 10 Dec
	2011 16:37:44 +0100")
Message-ID: <878vmkgsdb.fsf@gnu.org>
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 192.134.164.105
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sat, 10 Dec 2011 19:05:12 -0000

Hello!


Andy Wingo <wingo@pobox.com> skribis:

> On Sat 10 Dec 2011 15:52, ludo@gnu.org (Ludovic Court=C3=A8s) writes:

[...]

>> Yes.  The mixture of concerns in that function is not brilliant, but
>> OTOH it=E2=80=99s probably good to have a function people are familiar w=
ith.
>
> Yeah, I have the same thoughts.  OTOH, if file-system-fold goes into
> (ice-9 ftw), where would a `scandir' go?  There also?

Yes.

> I guess that's OK.

Someday maybe we=E2=80=99ll have a (posix) module, but until then that=E2=
=80=99s fine.
:-)

Thanks,
Ludo=E2=80=99.


From MAILER-DAEMON Sun Dec 11 04:34:15 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RZfnT-0002k4-6U
	for mharc-guile-devel@gnu.org; Sun, 11 Dec 2011 04:34:15 -0500
Received: from eggs.gnu.org ([140.186.70.92]:43408)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RZfnR-0002jf-EC
	for guile-devel@gnu.org; Sun, 11 Dec 2011 04:34:14 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RZfnQ-0008Tw-1z
	for guile-devel@gnu.org; Sun, 11 Dec 2011 04:34:13 -0500
Received: from lo.gmane.org ([80.91.229.12]:43915)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RZfnP-0008Th-Pd
	for guile-devel@gnu.org; Sun, 11 Dec 2011 04:34:12 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RZfnN-0008AU-PC
	for guile-devel@gnu.org; Sun, 11 Dec 2011 10:34:09 +0100
Received: from p508eab30.dip.t-dialin.net ([80.142.171.48])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sun, 11 Dec 2011 10:34:09 +0100
Received: from dak by p508eab30.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sun, 11 Dec 2011 10:34:09 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Sun, 11 Dec 2011 10:33:50 +0100
Organization: Organization?!?
Lines: 47
Message-ID: <87d3bvfo5d.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508eab30.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:cCRE5wKZY8883ANh7Lsugga8sq8=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sun, 11 Dec 2011 09:34:14 -0000

Marco Maggi <marco.maggi-ipsu@poste.it> writes:

> David Kastrup wrote:
>> Hi, if I have something  read that is evaluated later, the
>> lack  of procedure-environment in  Guilev2 implies  that I
>> have  to wrap the  stuff in  (lambda ()  ...) in  order to
>> capture the lexical environment for evaluation.
>
> Sorry to step in without  an answer.  What are you trying to
> do?  What I  understand is that a Scheme  program reads some
> expressions and tries to evaluate them in a specific context
> of the program.   Are you looking for a  way to do something
> like the following chunk I found on the Net?
>
> (define x 0)
> (define clo 
>   (let ((x 1)) 
>     (lambda () '())))
> (local-eval 'x (procedure-environment clo))
> => 1 

It is more like
(define (myeval what)
  (let* ((x 1)
         (clo (procedure-environment (lambda () #f))))
     (local-eval (read (open-input-string what)) clo)))

(myeval "(+ x 3)")

Basically a string evaluation of a string that will be captured with
read-hash-extend in our application.

In practice, _both_ the environment created by (let* ((x 1)) ...) as
well as the string to be interpreted later are written by the user, but
they are spliced together at quite different points of time since the
environment from which the string for myeval gets delivered is available
only when the definition is being executed, not yet at its definition
time.

Basically I need to evaluate dynamic code in a given lexical environment
rather than at top and/or module level.

For a language that is supposed to be a building block for extension
languages, not really a concept that is all that unusual I would think.

-- 
David Kastrup



From MAILER-DAEMON Sun Dec 11 04:51:31 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RZg4B-0004UT-Fy
	for mharc-guile-devel@gnu.org; Sun, 11 Dec 2011 04:51:31 -0500
Received: from eggs.gnu.org ([140.186.70.92]:46635)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RZg49-0004S7-20
	for guile-devel@gnu.org; Sun, 11 Dec 2011 04:51:29 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RZg47-0002iQ-Gi
	for guile-devel@gnu.org; Sun, 11 Dec 2011 04:51:29 -0500
Received: from lo.gmane.org ([80.91.229.12]:57546)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RZg47-0002ha-4v
	for guile-devel@gnu.org; Sun, 11 Dec 2011 04:51:27 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RZg44-0004fh-W3
	for guile-devel@gnu.org; Sun, 11 Dec 2011 10:51:24 +0100
Received: from p508eab30.dip.t-dialin.net ([80.142.171.48])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sun, 11 Dec 2011 10:51:24 +0100
Received: from dak by p508eab30.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sun, 11 Dec 2011 10:51:24 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Sun, 11 Dec 2011 10:51:06 +0100
Organization: Organization?!?
Lines: 87
Message-ID: <878vmjfncl.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508eab30.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:3KFZMWDUa7mH3B6updmtJCsxgCQ=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sun, 11 Dec 2011 09:51:30 -0000

David Kastrup <dak@gnu.org> writes:

> Marco Maggi <marco.maggi-ipsu@poste.it> writes:
>
>> David Kastrup wrote:
>>> Hi, if I have something  read that is evaluated later, the
>>> lack  of procedure-environment in  Guilev2 implies  that I
>>> have  to wrap the  stuff in  (lambda ()  ...) in  order to
>>> capture the lexical environment for evaluation.
>>
>> Sorry to step in without  an answer.  What are you trying to
>> do?  What I  understand is that a Scheme  program reads some
>> expressions and tries to evaluate them in a specific context
>> of the program.   Are you looking for a  way to do something
>> like the following chunk I found on the Net?
>>
>> (define x 0)
>> (define clo 
>>   (let ((x 1)) 
>>     (lambda () '())))
>> (local-eval 'x (procedure-environment clo))
>> => 1 
>
> It is more like
> (define (myeval what)
>   (let* ((x 1)
>          (clo (procedure-environment (lambda () #f))))
>      (local-eval (read (open-input-string what)) clo)))
>
> (myeval "(+ x 3)")
>
> Basically a string evaluation of a string that will be captured with
> read-hash-extend in our application.
>
> In practice, _both_ the environment created by (let* ((x 1)) ...) as
> well as the string to be interpreted later are written by the user, but
> they are spliced together at quite different points of time since the
> environment from which the string for myeval gets delivered is available
> only when the definition is being executed, not yet at its definition
> time.
>
> Basically I need to evaluate dynamic code in a given lexical environment
> rather than at top and/or module level.
>
> For a language that is supposed to be a building block for extension
> languages, not really a concept that is all that unusual I would think.

To come back to the original request:
> Is it possible to have a shortcut (make-closure ...) or so for that
> purpose?  The reason is that if ... is a call to a
> procedure-with-setter, (lambda () ...) actually does not cut it for
> capturing the semantics of ..., and I need
> (make-procedure-with-setter (lambda () ...)
>                             (lambda (x) (set! ... x)))

I now implement this more or less as
(define clo #t)
(define (myeval what)
  (let* ((x 1))
     (set! clo (list (cons 'x (lambda () x))))
     (primitive-eval (read (open-input-string what)))))

(myeval "(+ ((assq-ref clo 'x)) 3)")

But of course if I want to translate something like
(set! x 7)
(also when x is something like (myprop k 'g) or so)
with that technique, it falls down again.

So in short, doing that sort of stuff by prewrapping all conceivable
evaluation candidates into (lambda () ...) and doing source code location
association at runtime to figure out which lambda to call is quite icky
and more restricted than actually capturing an environment.

See
<URL:http://git.savannah.gnu.org/gitweb/?p=lilypond.git;a=blob;f=scm/parser-ly-from-scheme.scm;h=0e697d22bda657f3e970efa0281b01a0cd56360c;hb=HEAD>

for the actual current source code that pushes small lambda capsules
into the variable "closures" instead of just capturing a single local
procedure-environment for _all_ parts of the string that is going to be
parsed and interpreted at run time including small Scheme scraps.

This is not hypothetical, but bonafide code running in a production
environment.

-- 
David Kastrup



From MAILER-DAEMON Mon Dec 12 00:23:17 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RZyM9-0004jd-UA
	for mharc-guile-devel@gnu.org; Mon, 12 Dec 2011 00:23:17 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52313)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RZyM7-0004jV-PT
	for guile-devel@gnu.org; Mon, 12 Dec 2011 00:23:16 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RZyM6-0006DS-Is
	for guile-devel@gnu.org; Mon, 12 Dec 2011 00:23:15 -0500
Received: from world.peace.net ([96.39.62.75]:57042)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>)
	id 1RZyM6-0006Cf-GS; Mon, 12 Dec 2011 00:23:14 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RZyLk-0001lm-Qp; Mon, 12 Dec 2011 00:22:56 -0500
From: Mark H Weaver <mhw@netris.org>
To: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org>
Date: Mon, 12 Dec 2011 00:21:21 -0500
In-Reply-To: <87d3bvfo5d.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Sun, 11 Dec 2011 10:33:50 +0100")
Message-ID: <871usaicvi.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.91 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 12 Dec 2011 05:23:16 -0000

David Kastrup <dak@gnu.org> writes:
> Basically I need to evaluate dynamic code in a given lexical environment
> rather than at top and/or module level.
>
> For a language that is supposed to be a building block for extension
> languages, not really a concept that is all that unusual I would think.

Guile 2 is an excellent base for building extension languages, but not
in the way that you'd like to do it.  Unfortunately, I see no way to
support `procedure-environment' on arbitrary procedures without
abandoning our optimizing compiler and going back to a simple evaluator.

I suspect it would be possible to implement a special form that captures
its lexical environment in such a way that arbitrary code could later be
evaluated within that lexical environment.  The presence of this special
form would impose onerous constraints on the optimizer within the
top-level form containing it.  In fact, I can't think of an optimization
that would still be possible, because the compiler would have to assume
the worst: that some other thread could, at any time, mutate any lexical
variable or call any lexical procedure visible from the special form.
It gets even worse when you consider first-class continuations.

I believe that this is the wrong approach, though it may be worth
considering for the sake of allowing Lilypond to continue using its
existing implementation strategy.

In general, the _right_ way to build a custom extension language using
Guile 2 is to write a compiler that converts your language into one of
the other languages that Guile 2 supports.

If there's something about Lilypond's language that you believe would
make compilation impractical, let's talk about it.  Maybe the Guile
experts on this list can find a clever solution, or else maybe we can
enhance Guile to support Lilypond's language in a straightforward
manner.

I would be glad to help with this.  In the long run, it might be less
work for us Guile hackers to implement a nice compiler for Lilypond than
to implement and forever maintain the "capture-lexical-environment"
special form, and it would almost certainly have better results.

    Regards,
      Mark


From MAILER-DAEMON Mon Dec 12 01:48:07 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RZzgF-0000S7-28
	for mharc-guile-devel@gnu.org; Mon, 12 Dec 2011 01:48:07 -0500
Received: from eggs.gnu.org ([140.186.70.92]:43742)
	by lists.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RZzgC-0000Rp-3w
	for guile-devel@gnu.org; Mon, 12 Dec 2011 01:48:05 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dak@gnu.org>) id 1RZzgA-0003Pb-DS
	for guile-devel@gnu.org; Mon, 12 Dec 2011 01:48:04 -0500
Received: from fencepost.gnu.org ([140.186.70.10]:42372)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RZzgA-0003PX-Bt
	for guile-devel@gnu.org; Mon, 12 Dec 2011 01:48:02 -0500
Received: from localhost ([127.0.0.1]:52291 helo=lola)
	by fencepost.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dak@gnu.org>)
	id 1RZzg9-00075C-6S; Mon, 12 Dec 2011 01:48:01 -0500
Received: by lola (Postfix, from userid 1000)
	id 764B7E065A; Mon, 12 Dec 2011 07:47:39 +0100 (CET)
From: David Kastrup <dak@gnu.org>
To: Mark H Weaver <mhw@netris.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
Date: Mon, 12 Dec 2011 07:47:38 +0100
In-Reply-To: <871usaicvi.fsf@netris.org> (Mark H. Weaver's message of "Mon, 12
	Dec 2011 00:21:21 -0500")
Message-ID: <87mxaycmlx.fsf@fencepost.gnu.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 140.186.70.10
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 12 Dec 2011 06:48:05 -0000

Mark H Weaver <mhw@netris.org> writes:

> David Kastrup <dak@gnu.org> writes:
>> Basically I need to evaluate dynamic code in a given lexical environment
>> rather than at top and/or module level.
>>
>> For a language that is supposed to be a building block for extension
>> languages, not really a concept that is all that unusual I would think.
>
> Guile 2 is an excellent base for building extension languages, but not
> in the way that you'd like to do it.  Unfortunately, I see no way to
> support `procedure-environment' on arbitrary procedures without
> abandoning our optimizing compiler and going back to a simple
> evaluator.

Sure.  In an optimizing compiler, I would expect "procedure-environment"
to only contain actually used parts of the environment, and that would
make (procedure-environment (lambda () '())) fabulously useless.  And of
course I am not interested in the environment of that procedure, but
rather in that where procedure-environment is called.

> I suspect it would be possible to implement a special form that
> captures its lexical environment in such a way that arbitrary code
> could later be evaluated within that lexical environment.  The
> presence of this special form would impose onerous constraints on the
> optimizer within the top-level form containing it.  In fact, I can't
> think of an optimization that would still be possible, because the
> compiler would have to assume the worst: that some other thread could,
> at any time, mutate any lexical variable or call any lexical procedure
> visible from the special form.  It gets even worse when you consider
> first-class continuations.

We are calling the Lilypond parser in that "top-level form".  The
optimizer is not much of a worry.

> I believe that this is the wrong approach, though it may be worth
> considering for the sake of allowing Lilypond to continue using its
> existing implementation strategy.

Uh, we are not talking about "implementation strategy" but language
features.

> In general, the _right_ way to build a custom extension language using
> Guile 2 is to write a compiler that converts your language into one of
> the other languages that Guile 2 supports.

Lilypond is not Scheme.  It has syntax ambiguities that are resolved by
lexical tie-ins and thus depend on the context.  You can't easily
compile it in advance.

And you are _totally_ putting the cart before the horse here.  Lilypond
is not supposed to be an extension language for Guile, but Guile is
supposed to be an extension language for Lilypond.  The acronym Guile
stands for "GNU's Ubiquitous Intelligent Language for Extension".  You
are losing sight of what Guile is supposed to be.

As an extension language, it does not make sense that it dictates the
lexical and the program structure of the system it is supposed to be
extending.

> If there's something about Lilypond's language that you believe would
> make compilation impractical, let's talk about it.

Its syntax and semantics.

<URL:http://git.savannah.gnu.org/cgit/lilypond.git/tree/lily/parser.yy>

If I call a function with an optional argument of type integer? before
an argument of type ly:music? and I encounter #x, then the value of x
decides whether this argument will be used as the optional argument or
as the following argument.  The rest of the parsing has to follow.

> Maybe the Guile experts on this list can find a clever solution, or
> else maybe we can enhance Guile to support Lilypond's language in a
> straightforward manner.
>
> I would be glad to help with this.  In the long run, it might be less
> work for us Guile hackers to implement a nice compiler for Lilypond than
> to implement and forever maintain the "capture-lexical-environment"
> special form, and it would almost certainly have better results.

You are working from the premise that Guile should govern the
architecture of the system it is supposed to be extending.  That
Lilypond is one of the few serious systems actually using Guile as an
extension language does not make it a good idea to turn it into a system
that Guile uses as its extension.  The hard way.  With lots of work.
You can't expect that kind of investment to be done for every
application that considers using Guile.

-- 
David Kastrup


From MAILER-DAEMON Mon Dec 12 13:30:52 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaAeK-00011n-LF
	for mharc-guile-devel@gnu.org; Mon, 12 Dec 2011 13:30:52 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55972)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RaAeI-000117-5x
	for guile-devel@gnu.org; Mon, 12 Dec 2011 13:30:51 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RaAeG-0006Lp-Kx
	for guile-devel@gnu.org; Mon, 12 Dec 2011 13:30:50 -0500
Received: from world.peace.net ([96.39.62.75]:42141)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>)
	id 1RaAeG-0006LX-Eq; Mon, 12 Dec 2011 13:30:48 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RaAe8-0003dc-R8; Mon, 12 Dec 2011 13:30:41 -0500
From: Mark H Weaver <mhw@netris.org>
To: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org>
Date: Mon, 12 Dec 2011 13:29:07 -0500
In-Reply-To: <87mxaycmlx.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Mon, 12 Dec 2011 07:47:38 +0100")
Message-ID: <87wra1hcek.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.91 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 12 Dec 2011 18:30:51 -0000

David Kastrup <dak@gnu.org> writes:
>> In general, the _right_ way to build a custom extension language using
>> Guile 2 is to write a compiler that converts your language into one of
>> the other languages that Guile 2 supports.
>
> Lilypond is not Scheme.  It has syntax ambiguities that are resolved by
> lexical tie-ins and thus depend on the context.  You can't easily
> compile it in advance.

Lexical tie-ins require the use of a context-sensitive parser, but how
does it prevent compilation in advance?  Guile 2 places no constraints
whatsoever on the parser used to compile your language to Guile.  You
could use the exact same Bison parser you are currently using, but with
different actions.

>> If there's something about Lilypond's language that you believe would
>> make compilation impractical, let's talk about it.
>
> Its syntax and semantics.
>
> <URL:http://git.savannah.gnu.org/cgit/lilypond.git/tree/lily/parser.yy>
>
> If I call a function with an optional argument of type integer? before
> an argument of type ly:music? and I encounter #x, then the value of x
> decides whether this argument will be used as the optional argument or
> as the following argument.  The rest of the parsing has to follow.

I don't see a serious problem here.  In general, anything that can't be
done at compile time can be postponed to runtime easily enough.  To
address the specific example you give above, the compiled Lilypond
procedure could look something like this:

(define (myproc . args)
  (extract-lyargs args `((#:optional ,integer?) (#:required ,ly:music?))
    (lambda (x music)
      body ...)))

where `extract-lyargs' is a procedure (part of the runtime environment)
that takes the list of arguments and a formal-parameter specification,
and does the runtime tests needed to decide how the arguments should be
put into `x' and `music'.

> And you are _totally_ putting the cart before the horse here.  Lilypond
> is not supposed to be an extension language for Guile, but Guile is
> supposed to be an extension language for Lilypond.  The acronym Guile
> stands for "GNU's Ubiquitous Intelligent Language for Extension".  You
> are losing sight of what Guile is supposed to be.

I don't know about that.  You seem to imply that Lilypond's use of Guile
is very typical, and that other programs that use Guile for extension
will run into similar difficulties, but as far as I can tell Lilypond is
quite unique here.

Typically, an application using libguile (or any other language library)
allows the library to handle all aspects of parsing and running the
supported extension language(s).  In Guile's case, the idea is that
whenever a new language is added to Guile, applications using libguile
can automatically make use of those new languages.

You are using Guile in a very unusual way.  You have constructed a
hybrid language of both Scheme and Lilypond, where each can be nested
within the other (so far so good), but -- and here's the kicker -- you
apparently want to implement this hybrid language using two separate
interpreters maintained by two separate groups that are each able to run
code within lexical environments established by the other one.

This is a fundamentally bad idea, because this structure makes it
impossible for either of these language implementations to evolve in any
significant way.  It forces them both to remain simple interpreters.

> You are working from the premise that Guile should govern the
> architecture of the system it is supposed to be extending.

I can understand why it appears that way to you, but this is only
because you have built a system on Guile that places unreasonable
constraints upon the internal workings of Guile.

Please try to look at it from our perspective, and also from the
perspective of other programs that use Guile in a more typical way.
Most users of Guile 2 benefit from the architectural and efficiency
improvements, and are not harmed by them.

We are not trying to impose any particular architecture on your system,
only on the way the language implementation itself works.  Is it really
so unreasonable that the language implementation should be under Guile's
control?  Is this really a betrayal of the original vision of what Guile
is "supposed to be", as you wrote above?  If you think so, can you
please back this up with some references?

     Mark


From MAILER-DAEMON Mon Dec 12 15:08:50 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaCB8-0006Q0-6Z
	for mharc-guile-devel@gnu.org; Mon, 12 Dec 2011 15:08:50 -0500
Received: from eggs.gnu.org ([140.186.70.92]:44128)
	by lists.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RaCB4-0006OA-ML
	for guile-devel@gnu.org; Mon, 12 Dec 2011 15:08:48 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dak@gnu.org>) id 1RaCB2-0006br-Qa
	for guile-devel@gnu.org; Mon, 12 Dec 2011 15:08:46 -0500
Received: from fencepost.gnu.org ([140.186.70.10]:55545)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RaCB2-0006bn-Nh
	for guile-devel@gnu.org; Mon, 12 Dec 2011 15:08:44 -0500
Received: from localhost ([127.0.0.1]:37232 helo=lola)
	by fencepost.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dak@gnu.org>)
	id 1RaCB1-0005Vc-W0; Mon, 12 Dec 2011 15:08:44 -0500
Received: by lola (Postfix, from userid 1000)
	id BDF0FE065A; Mon, 12 Dec 2011 20:56:06 +0100 (CET)
From: David Kastrup <dak@gnu.org>
To: Mark H Weaver <mhw@netris.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
Date: Mon, 12 Dec 2011 20:56:05 +0100
In-Reply-To: <87wra1hcek.fsf@netris.org> (Mark H. Weaver's message of "Mon, 12
	Dec 2011 13:29:07 -0500")
Message-ID: <87liqhbm3u.fsf@fencepost.gnu.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 140.186.70.10
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 12 Dec 2011 20:08:48 -0000

Mark H Weaver <mhw@netris.org> writes:

> David Kastrup <dak@gnu.org> writes:
>>> In general, the _right_ way to build a custom extension language using
>>> Guile 2 is to write a compiler that converts your language into one of
>>> the other languages that Guile 2 supports.
>>
>> Lilypond is not Scheme.  It has syntax ambiguities that are resolved by
>> lexical tie-ins and thus depend on the context.  You can't easily
>> compile it in advance.
>
> Lexical tie-ins require the use of a context-sensitive parser, but how
> does it prevent compilation in advance?  Guile 2 places no constraints
> whatsoever on the parser used to compile your language to Guile.  You
> could use the exact same Bison parser you are currently using, but with
> different actions.
>
>>> If there's something about Lilypond's language that you believe would
>>> make compilation impractical, let's talk about it.
>>
>> Its syntax and semantics.
>>
>> <URL:http://git.savannah.gnu.org/cgit/lilypond.git/tree/lily/parser.yy>
>>
>> If I call a function with an optional argument of type integer? before
>> an argument of type ly:music? and I encounter #x, then the value of x
>> decides whether this argument will be used as the optional argument or
>> as the following argument.  The rest of the parsing has to follow.
>
> I don't see a serious problem here.  In general, anything that can't be
> done at compile time can be postponed to runtime easily enough.

We are running in circles here.  The problem is that I don't get to keep
the lexical environment from compile time for use at runtime.

> To address the specific example you give above, the compiled Lilypond
> procedure could look something like this:

You are putting me on, right?  I explain why Lilypond is not compiled,
and you talk about a "compiled Lilypond procedure".

> (define (myproc . args)
>   (extract-lyargs args `((#:optional ,integer?) (#:required ,ly:music?))
>     (lambda (x music)
>       body ...)))
>
> where `extract-lyargs' is a procedure (part of the runtime environment)
> that takes the list of arguments and a formal-parameter specification,
> and does the runtime tests needed to decide how the arguments should be
> put into `x' and `music'.

Very funny.  If x is not an integer, it is put into the music argument
instead, and the next "argument" is not an argument but independent
code.

>> And you are _totally_ putting the cart before the horse here.
>> Lilypond is not supposed to be an extension language for Guile, but
>> Guile is supposed to be an extension language for Lilypond.  The
>> acronym Guile stands for "GNU's Ubiquitous Intelligent Language for
>> Extension".  You are losing sight of what Guile is supposed to be.
>
> I don't know about that.  You seem to imply that Lilypond's use of
> Guile is very typical,

Not at all.  I imply that Lilypond's use corresponds to what Guile is
advertised as being useful for.  Not all that many people bother using
it in that way, and Guile 2 is taking a definite step backward with
regard to being useful for it.  The "Guile 2 migration project" for
Lilypond is solidly running into man-months of work with no end in
sight.  I have been working around killing capturable lexical
environments (quite more important for an extension language than
capturing continuations), but it is not like this is the only problem.

> and that other programs that use Guile for extension will run into
> similar difficulties, but as far as I can tell Lilypond is quite
> unique here.

Because nobody else uses Guile for serious extensions.  And not because
of its performance: that is _irrelevant_ for most extension purposes.
The performance angle is interesting when one uses Guile as a general
purpose _programming_ language.  You are sacrificing your target
clientele here.

> Typically, an application using libguile (or any other language
> library) allows the library to handle all aspects of parsing and
> running the supported extension language(s).  In Guile's case, the
> idea is that whenever a new language is added to Guile, applications
> using libguile can automatically make use of those new languages.
>
> You are using Guile in a very unusual way.  You have constructed a
> hybrid language of both Scheme and Lilypond,

That's what "extension language" as opposed to "implementation language"
means.

> where each can be nested within the other (so far so good), but -- and
> here's the kicker -- you apparently want to implement this hybrid
> language using two separate interpreters maintained by two separate
> groups that are each able to run code within lexical environments
> established by the other one.

Not really.  We run Guile code inside of lexical environments
established by Guile code, just with a difference in timing.  That is
exactly the same thing as Guile does when using macros.  But there is no
point in turning everything into macros (since we then need to run
primitive-eval for everything), and actually Guile v2 _also_ throws a
wrench into using macros (Ian Hulin has been working on migrating the
use of macros to Guile v2 and it has not exactly been fun and smooth
sailing up to now).

> This is a fundamentally bad idea, because this structure makes it
> impossible for either of these language implementations to evolve in
> any significant way.  It forces them both to remain simple
> interpreters.

We are talking about the syntactic front end here.  A miniscule amount
of the runtime is actually spent in it.  You are arguing for turning a
convenient user environment for processing an input language that can
make good and logical use of Scheme into a complex compiled mess for the
sake of hypothetical performance gains.  This is O(n) for n being the
size of the input.  It is irrelevant for the performance of the system.

>> You are working from the premise that Guile should govern the
>> architecture of the system it is supposed to be extending.
>
> I can understand why it appears that way to you, but this is only
> because you have built a system on Guile that places unreasonable
> constraints upon the internal workings of Guile.

Again, you are putting the cart before the horse.  If an "extension
language" dictates the structure and syntax of the system it is supposed
to extend, it is no longer doing the job of an extension.

> Please try to look at it from our perspective, and also from the
> perspective of other programs that use Guile in a more typical way.

Name a few other programs that use Guile as an _extension_ language
rather than as a _programming_ language.

> Most users of Guile 2 benefit from the architectural and efficiency
> improvements, and are not harmed by them.

You are trying to compete with systems like Chicken, Stalin and C rather
than Tcl, JavaScript and Lua.  But losing by a smaller margin in their
market niche is not going to buy you anything in exchange for ignoring
the needs of your existing users.

So you say we should not be using Guile anymore if we intend to extend
the functionality of Lilypond in a manner where Guile and Lilypond play
smooth and predictably hand in hand.

-- 
David Kastrup


From MAILER-DAEMON Mon Dec 12 15:41:32 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaCgm-0003dO-Gc
	for mharc-guile-devel@gnu.org; Mon, 12 Dec 2011 15:41:32 -0500
Received: from eggs.gnu.org ([140.186.70.92]:36580)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <rixed@happyleptic.org>) id 1RaCgj-0003au-8F
	for guile-devel@gnu.org; Mon, 12 Dec 2011 15:41:30 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <rixed@happyleptic.org>) id 1RaCgi-0004qK-3J
	for guile-devel@gnu.org; Mon, 12 Dec 2011 15:41:29 -0500
Received: from smtp5-g21.free.fr ([212.27.42.5]:58479)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <rixed@happyleptic.org>) id 1RaCgh-0004ni-E1
	for guile-devel@gnu.org; Mon, 12 Dec 2011 15:41:28 -0500
Received: from yeeloong (unknown [82.67.194.89])
	by smtp5-g21.free.fr (Postfix) with SMTP id 28D54D48474
	for <guile-devel@gnu.org>; Mon, 12 Dec 2011 21:41:13 +0100 (CET)
Received: by yeeloong (sSMTP sendmail emulation);
	Mon, 12 Dec 2011 21:39:08 +0100
Date: Mon, 12 Dec 2011 21:39:08 +0100
From: rixed@happyleptic.org
To: guile-devel@gnu.org
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Message-ID: <20111212203908.GC2686@yeeloong.happyleptic.org>
Mail-Followup-To: rixed@happyleptic.org, guile-devel@gnu.org
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87liqhbm3u.fsf@fencepost.gnu.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <87liqhbm3u.fsf@fencepost.gnu.org>
User-Agent: Mutt/1.5.21 (2010-09-15)
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 212.27.42.5
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 12 Dec 2011 20:41:30 -0000

> > and that other programs that use Guile for extension will run into
> > similar difficulties, but as far as I can tell Lilypond is quite
> > unique here.
> 
> Because nobody else uses Guile for serious extensions.  And not because
> of its performance: that is _irrelevant_ for most extension purposes.
> The performance angle is interesting when one uses Guile as a general
> purpose _programming_ language.  You are sacrificing your target
> clientele here.

Obviously Guile does not suffer from too many users right now, but stating
that Lilypond is the only project using Guile seriously seams a little
excessive.

Be confident that I'm ashamed by my ignorance but I do not know how
exactly Lilypond uses Guile (nor what Lilypond exactly does), but your
description of it does sound like it's the only way to "extend" a
program.  You seams to view an extension language as a tool to extend a
language, while many projects use guile merely to extend a program.  So
let me present you the view of the average Joe Schemer with regard to
Guile as an extension language: For me, extending a program (supposedly
written in some kind of low level language, let's say some kind of C)
with Guile or any other higher level language, is the action of linking
together the low level stuff and libguile in a way that some scheme
programs can be run with easy access to the inner functionalities of the
program, so that :

- the poor maintainers of the old C-like program are not forced to code
  every trivia in C-like language
- the poor users are given an easier way to configure and even program
  the old C dinosaur
- if time permits, evolve from extending the C with Scheme to extending
  the Scheme with C, so that not only the C program can access all
  scheme facilities and libraries, but also all other programs can use
  the internal of the old C program (this being only possible if you
  have only one extension language)

In that regard, having Guile being compiled to bytecode, to native,
interpreted, JITed or whatever is irrelevant. Indeed, it's also
quite irrelevant if it's scheme or anything else, but :

- the more expressiveness we have the better
- the faster the better
- the more available front-end languages, the less frightened the users
  will be (if not less parentheses then at least at there usual
  locations...)

In my experience these two elements played a great role in the
acceptance of Guile (over Lua, mainly) as the extension language.
I don't pretend you were wrong to use Guile as you did of course!

My 2c, which is not a lot per line, just to let you know that
some projects are indeed enjoying their migration from guile 1.8
to guile 2.



From MAILER-DAEMON Mon Dec 12 16:03:00 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaD1Y-0003r5-EZ
	for mharc-guile-devel@gnu.org; Mon, 12 Dec 2011 16:03:00 -0500
Received: from eggs.gnu.org ([140.186.70.92]:35476)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaD1W-0003qd-0c
	for guile-devel@gnu.org; Mon, 12 Dec 2011 16:02:58 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaD1U-0002Ae-S9
	for guile-devel@gnu.org; Mon, 12 Dec 2011 16:02:57 -0500
Received: from lo.gmane.org ([80.91.229.12]:56721)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaD1U-0002AH-J1
	for guile-devel@gnu.org; Mon, 12 Dec 2011 16:02:56 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaD1S-0006cy-Mi
	for guile-devel@gnu.org; Mon, 12 Dec 2011 22:02:54 +0100
Received: from p508e9bda.dip.t-dialin.net ([80.142.155.218])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Mon, 12 Dec 2011 22:02:54 +0100
Received: from dak by p508e9bda.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Mon, 12 Dec 2011 22:02:54 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Mon, 12 Dec 2011 22:02:41 +0100
Organization: Organization?!?
Lines: 34
Message-ID: <87hb15bj0u.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87liqhbm3u.fsf@fencepost.gnu.org>
	<20111212203908.GC2686@yeeloong.happyleptic.org>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508e9bda.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:SG2p7usq6CtwE0Xa92L7BPqgknk=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 12 Dec 2011 21:02:59 -0000

rixed@happyleptic.org writes:

>> > and that other programs that use Guile for extension will run into
>> > similar difficulties, but as far as I can tell Lilypond is quite
>> > unique here.
>> 
>> Because nobody else uses Guile for serious extensions.  And not because
>> of its performance: that is _irrelevant_ for most extension purposes.
>> The performance angle is interesting when one uses Guile as a general
>> purpose _programming_ language.  You are sacrificing your target
>> clientele here.
>
> Obviously Guile does not suffer from too many users right now, but
> stating that Lilypond is the only project using Guile seriously seams
> a little excessive.

_As_ _an_ _extension_ _language_ rather than as a mostly independent
subsystem.

> Be confident that I'm ashamed by my ignorance but I do not know how
> exactly Lilypond uses Guile (nor what Lilypond exactly does), but your
> description of it does sound like it's the only way to "extend" a
> program.

Not at all.  But when we are talking about an _extension_ _language_,
the implication is that it works in bits and pieces where it is
convenient.  That it _integrates_ with a larger system.  Lexical
environments are a fundamental part of what integration may involve, and
they operate at a different level as modules.  Macros play _into_
lexical environments, so obviously Scheme itself recognizes the
importance of being able to extend.

-- 
David Kastrup



From MAILER-DAEMON Mon Dec 12 16:41:40 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaDcy-0000va-28
	for mharc-guile-devel@gnu.org; Mon, 12 Dec 2011 16:41:40 -0500
Received: from eggs.gnu.org ([140.186.70.92]:41215)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RaDcu-0000rt-Jy
	for guile-devel@gnu.org; Mon, 12 Dec 2011 16:41:37 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RaDct-0003wS-JA
	for guile-devel@gnu.org; Mon, 12 Dec 2011 16:41:36 -0500
Received: from world.peace.net ([96.39.62.75]:47408)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>)
	id 1RaDct-0003w7-FW; Mon, 12 Dec 2011 16:41:35 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RaDcn-0004Bk-Ob; Mon, 12 Dec 2011 16:41:29 -0500
From: Mark H Weaver <mhw@netris.org>
To: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87liqhbm3u.fsf@fencepost.gnu.org>
Date: Mon, 12 Dec 2011 16:40:03 -0500
In-Reply-To: <87liqhbm3u.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Mon, 12 Dec 2011 20:56:05 +0100")
Message-ID: <87sjkph3kc.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.91 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 12 Dec 2011 21:41:37 -0000

David Kastrup <dak@gnu.org> writes:
> Very funny.  If x is not an integer, it is put into the music argument
> instead, and the next "argument" is not an argument but independent
> code.

Ah, okay.  In that case, the design of the Lilypond language does indeed
make compilation (or even parsing) before execution absolutely
impossible.  Oh well.

>> You are using Guile in a very unusual way.  You have constructed a
>> hybrid language of both Scheme and Lilypond,
>
> That's what "extension language" as opposed to "implementation language"
> means.

I guess this is the crux of your misunderstanding over what Guile is
"supposed to be".  Apparently you believe that an "extension language"
is one that allows you to mix your own language interpreter with the
extension language's interpreter to build a hybrid language that is
implemented by both code bases working together.

Can you please find a reference to back up your definition of "extension
language"?  I looked and I couldn't find one that supports your view.
For the record, I don't believe that this use of Guile was _ever_ what
Guile was intended for.

Anyway, it's water under the bridge now.  To be fair, some past
maintainer of Guile apparently decided to make "procedure-environment"
part of the public API -- a very serious error in my view -- and the
Lilypond developers made use of this functionality to build their
system.  I guess the responsibility to make this right ultimately rests
on our shoulders, as inheritors of the unwise promises made by our
predecessors.

In order to make this right, and in general to support languages like
Lilypond that cannot even be parsed before execution, I guess we should
implement the "capture-lexical-environment" special form, along with a
"local-eval" that makes use of it.  I guess the most straightforward
implementation is to simply inhibit compilation of any top-level form
that contains a "capture-lexical-environment" special form.  Instead we
would use the bootstrap evaluator to execute such top-level forms, and
also to implement "local-eval".

Andy, this is your area.  I'd be willing to work on this, but before I
do, can you at least comment on whether you think this is the right
approach, and what complications I'm likely to run into along the way?

    Thanks,
      Mark


From MAILER-DAEMON Mon Dec 12 16:50:28 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaDlU-0005ie-5A
	for mharc-guile-devel@gnu.org; Mon, 12 Dec 2011 16:50:28 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59109)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaDlO-0005bU-9z
	for guile-devel@gnu.org; Mon, 12 Dec 2011 16:50:23 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaDlM-0005wq-Gm
	for guile-devel@gnu.org; Mon, 12 Dec 2011 16:50:22 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:51550
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RaDlK-0005wT-Gn; Mon, 12 Dec 2011 16:50:18 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id A5E79816B;
	Mon, 12 Dec 2011 16:50:17 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=ScnvrMM01Ezfs8Fh64e9V4ZTMpw=; b=huUryh
	IQNS0x77J6/hAWOC2rTEKf2YApfX8/Vc4ti8rjR4MHoEHyIgWDIP4Av5IClcZIeV
	xFGGlJk76vOHkXA6rlyVv/QxyJFc1Po8blYYsJj/1txpdE27Q1ZwUnIhXiI5JuIN
	TO0k2YDaJU3RnEt1vVF4NVeIB2eijxmdL4cGU=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=bpKMvUmYCFVmcn+I+w1yonMc9mS3gk9q
	frgfRZoiHWNqxO6E4057iANSy9RE9ZfxaqhHsoBaEgKF0t8vZhErHByOpcMY2BFT
	SvaY+TQzY1EsHKawSqsHKH88vXrI97PNUgGmeBzsWI+rDQV7TfzRUiHaBkt6dPzL
	aqex5wUVylE=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 9F64C816A;
	Mon, 12 Dec 2011 16:50:17 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id E74478169;
	Mon, 12 Dec 2011 16:50:15 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Mark H Weaver <mhw@netris.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
Date: Mon, 12 Dec 2011 22:50:11 +0100
In-Reply-To: <87wra1hcek.fsf@netris.org> (Mark H. Weaver's message of "Mon,
	12 Dec 2011 13:29:07 -0500")
Message-ID: <87mxaxihnw.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 46D3546A-250B-11E1-BC53-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: David Kastrup <dak@gnu.org>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 12 Dec 2011 21:50:23 -0000

On Mon 12 Dec 2011 19:29, Mark H Weaver <mhw@netris.org> writes:

> You are using Guile in a very unusual way.  You have constructed a
> hybrid language of both Scheme and Lilypond, where each can be nested
> within the other (so far so good), but -- and here's the kicker -- you
> apparently want to implement this hybrid language using two separate
> interpreters maintained by two separate groups that are each able to run
> code within lexical environments established by the other one.
>
> This is a fundamentally bad idea, because this structure makes it
> impossible for either of these language implementations to evolve in any
> significant way.  It forces them both to remain simple interpreters.

FWIW Mark I agree with you.

But, in the event that David wants to continue with his current
strategy, there are other things that can be done.  David, did you know
that Guile's evaluator is implemented in Scheme?  That means that if you
want an evaluator with different semantics -- for example, something
closer to Kernel[0], as David appears to want -- then you can implement
an evaluator that provides for fexprs and the like, and it will run
about as well as Guile's evaluator.

Did you see my implementation of `local-eval' [1]?  It leverages (hah!)
Guile's macro expander, but otherwise is a straightforward interpreter.
If you find it slow, there are some simple, classic optimizations that
can be made.  With some work, it could present a similar interface to
1.8's `local-eval', `procedure-environment', `the-environment', and such
things.

[0] http://web.cs.wpi.edu/~jshutt/kernel.html; a lovely language.
Terrifies me, as an implementor.  Looks like a user's delight though.

[1] http://lists.gnu.org/archive/html/guile-user/2011-02/msg00032.html

Regards,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Mon Dec 12 17:03:57 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaDyX-0000CH-NH
	for mharc-guile-devel@gnu.org; Mon, 12 Dec 2011 17:03:57 -0500
Received: from eggs.gnu.org ([140.186.70.92]:60034)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RaDyV-0000A2-Iw
	for guile-devel@gnu.org; Mon, 12 Dec 2011 17:03:56 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RaDyU-0008OW-C5
	for guile-devel@gnu.org; Mon, 12 Dec 2011 17:03:55 -0500
Received: from world.peace.net ([96.39.62.75]:39714)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>)
	id 1RaDun-0007aj-1q; Mon, 12 Dec 2011 17:00:07 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RaDuf-0004DU-Dz; Mon, 12 Dec 2011 16:59:57 -0500
From: Mark H Weaver <mhw@netris.org>
To: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87liqhbm3u.fsf@fencepost.gnu.org>
	<20111212203908.GC2686@yeeloong.happyleptic.org>
	<87hb15bj0u.fsf@fencepost.gnu.org>
Date: Mon, 12 Dec 2011 16:58:31 -0500
In-Reply-To: <87hb15bj0u.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Mon, 12 Dec 2011 22:02:41 +0100")
Message-ID: <87obvdh2pk.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.91 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 12 Dec 2011 22:03:56 -0000

David Kastrup <dak@gnu.org> writes:
>> Be confident that I'm ashamed by my ignorance but I do not know how
>> exactly Lilypond uses Guile (nor what Lilypond exactly does), but your
>> description of it does sound like it's the only way to "extend" a
>> program.
>
> Not at all.  But when we are talking about an _extension_ _language_,
> the implication is that it works in bits and pieces where it is
> convenient.  That it _integrates_ with a larger system.

Yes, extension languages are meant to integrate into a larger _program_,
that much we can agree on.  However, I disagree that "extension
languages" are, by definition, meant to integrate into an external
_language_ _implementation_.

> Lexical environments are a fundamental part of what integration may
> involve, and they operate at a different level as modules.  Macros
> play _into_ lexical environments, so obviously Scheme itself
> recognizes the importance of being able to extend.

Yes, Scheme recognizes the importance of being able to extend the
language, but only within the framework of a single low-level language
_implementation_.

This is a separate issue from being able to extend a program using an
"extension language".

     Mark


From MAILER-DAEMON Mon Dec 12 23:39:20 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaK9A-0007rP-Mk
	for mharc-guile-devel@gnu.org; Mon, 12 Dec 2011 23:39:20 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59067)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RaK98-0007rE-Dw
	for guile-devel@gnu.org; Mon, 12 Dec 2011 23:39:19 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RaK97-00019m-Ez
	for guile-devel@gnu.org; Mon, 12 Dec 2011 23:39:18 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:39604)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RaK97-00015z-Bd
	for guile-devel@gnu.org; Mon, 12 Dec 2011 23:39:17 -0500
Received: by iahk25 with SMTP id k25so11498326iah.0
	for <guile-devel@gnu.org>; Mon, 12 Dec 2011 20:39:15 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:sender:date:x-google-sender-auth:message-id:subject
	:from:to:content-type;
	bh=zHp8p1bIRKtA7yeIZccjnlCpTmXQpHK2ZwkEGJzGaGA=;
	b=myl1R/k6FjBYjlCsYoOlOgnSOOOiuF6LZGYhLTejpBFLhc0MjGbBO/BnENG+zvXlwL
	KYN3GyzcB08RxaRbOweSnJeTSH3m1CqVp/yinmzSCuU+8eYvbnUblP9QbRmQb2WrWOce
	PSuj6HL0bAzN0wlaW5+4QGtlIGDD2P6vy4gSY=
MIME-Version: 1.0
Received: by 10.42.151.195 with SMTP id f3mr9752870icw.19.1323751155661; Mon,
	12 Dec 2011 20:39:15 -0800 (PST)
Sender: noah549@gmail.com
Received: by 10.42.217.6 with HTTP; Mon, 12 Dec 2011 20:39:15 -0800 (PST)
Date: Mon, 12 Dec 2011 23:39:15 -0500
X-Google-Sender-Auth: siReUUYIVx57BixJGt_cris84S4
Message-ID: <CA+U71=P0WHV-s4Lce3p3=5tfXswgOrvT6tk1r8hFU0KyTnJSYA@mail.gmail.com>
Subject: Compiler Branch
From: Noah Lavine <noah.b.lavine@gmail.com>
To: guile-devel <guile-devel@gnu.org>
Content-Type: text/plain; charset=ISO-8859-1
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 04:39:19 -0000

Hello Guile developers,

Following up on my last email, I am nervously announcing a new branch,
'wip-compiler'. I hope that in a few months this branch will contain a
working compiler. For now, it contains a few new data structures and a
function that converts Tree-IL to a form that will be nicer for
analysis.

I hope making a new branch for this was the right thing to do. I would
have liked to wait and talk about it, but I had a friend ask me if he
could also work on the compiler, so I thought it was time to make it
public, and this seemed like the way to do that. If you don't want the
branch, I suppose it can always be deleted on Savannah. (I would of
course love help from anyone and everyone else, but I was planning to
wait on publicizing it until it was in a less embarrassing state. See
the git log for more information on that. :-) )

My last email contains some information on my ideas. I hope you can
see some of that in the code that's there, especially the
annotated-tree-il data structure, but if not, I plan to add more soon.

Noah


From MAILER-DAEMON Tue Dec 13 03:48:01 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaO1p-0001sr-1T
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 03:48:01 -0500
Received: from eggs.gnu.org ([140.186.70.92]:48761)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaO1m-0001s4-61
	for guile-devel@gnu.org; Tue, 13 Dec 2011 03:47:58 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaO1f-0007FV-In
	for guile-devel@gnu.org; Tue, 13 Dec 2011 03:47:58 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:52085
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaO1f-0007FJ-GN
	for guile-devel@gnu.org; Tue, 13 Dec 2011 03:47:51 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id AC184674B;
	Tue, 13 Dec 2011 03:47:50 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=mxmdwH1m3hxfzP5thcXOTqg8qVU=; b=GKAT91
	X/1ZBv2ScH9hPQRGs+m5p3F65MrBg5cuB03OCRIjGrheAxNgide551p9WIKx+8jH
	MhhsS4bCcZRrVixj1z6agwNcpJvjX8lHw31YF/Y+/LG07E3mDLRxtWvz9HJKUr84
	7Ev67tEuB1ze7QmMUzvemdm1wbTuxu8Er/PoI=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=EWtDtWPOI0FGWCmNCgouQHh0zfBy/VLP
	r3iekb2DqjTQ6ijz06C0UsVeq32VocrRAOCimcH0BUNgSOgirOorBRH/j50uSA1V
	s60NGniRLBfDAwh2O610trKNAjZZ4dXyKFHUQ/T2D4YahAK0I/jmQIxGnvCQO5JN
	LhMuf+EwLf0=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id A64E3674A;
	Tue, 13 Dec 2011 03:47:50 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 159806749;
	Tue, 13 Dec 2011 03:47:49 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Noah Lavine <noah.b.lavine@gmail.com>
Subject: Re: Compiler Branch
References: <CA+U71=P0WHV-s4Lce3p3=5tfXswgOrvT6tk1r8hFU0KyTnJSYA@mail.gmail.com>
Date: Tue, 13 Dec 2011 09:47:46 +0100
In-Reply-To: <CA+U71=P0WHV-s4Lce3p3=5tfXswgOrvT6tk1r8hFU0KyTnJSYA@mail.gmail.com>
	(Noah Lavine's message of "Mon, 12 Dec 2011 23:39:15 -0500")
Message-ID: <87wra0c0y5.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 235D16FE-2567-11E1-8F10-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 08:47:59 -0000

On Tue 13 Dec 2011 05:39, Noah Lavine <noah.b.lavine@gmail.com> writes:

> Following up on my last email, I am nervously announcing a new branch,
> 'wip-compiler'. I hope that in a few months this branch will contain a
> working compiler. For now, it contains a few new data structures and a
> function that converts Tree-IL to a form that will be nicer for
> analysis.

Cool.  As a quick reaction, I have some doubts about this project.  But,
I guess a WIP branch would be a good thing to have, and it would make
the discussion more concrete.

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 13 04:02:50 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaOG9-00054U-U1
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 04:02:49 -0500
Received: from eggs.gnu.org ([140.186.70.92]:39434)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaOFz-00051Y-V9
	for guile-devel@gnu.org; Tue, 13 Dec 2011 04:02:47 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaOFy-0004Na-CF
	for guile-devel@gnu.org; Tue, 13 Dec 2011 04:02:39 -0500
Received: from lo.gmane.org ([80.91.229.12]:37677)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaOFy-0004NW-14
	for guile-devel@gnu.org; Tue, 13 Dec 2011 04:02:38 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaOFu-0003ru-CZ
	for guile-devel@gnu.org; Tue, 13 Dec 2011 10:02:34 +0100
Received: from p508e9a39.dip.t-dialin.net ([80.142.154.57])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 13 Dec 2011 10:02:34 +0100
Received: from dak by p508e9a39.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 13 Dec 2011 10:02:34 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Tue, 13 Dec 2011 10:02:17 +0100
Organization: Organization?!?
Lines: 59
Message-ID: <87obvclu92.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508e9a39.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:npMSytnWXTExVnT29KAcsuVgp0w=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 09:02:47 -0000

Andy Wingo <wingo@pobox.com> writes:

> On Mon 12 Dec 2011 19:29, Mark H Weaver <mhw@netris.org> writes:
>
>> You are using Guile in a very unusual way.  You have constructed a
>> hybrid language of both Scheme and Lilypond, where each can be nested
>> within the other (so far so good), but -- and here's the kicker -- you
>> apparently want to implement this hybrid language using two separate
>> interpreters maintained by two separate groups that are each able to run
>> code within lexical environments established by the other one.
>>
>> This is a fundamentally bad idea, because this structure makes it
>> impossible for either of these language implementations to evolve in any
>> significant way.  It forces them both to remain simple interpreters.
>
> FWIW Mark I agree with you.
>
> But, in the event that David wants to continue with his current
> strategy,

Uh, reality check.  Lilypond's input language is not "David's current
strategy".

> there are other things that can be done.  David, did you know that
> Guile's evaluator is implemented in Scheme?  That means that if you
> want an evaluator with different semantics -- for example, something
> closer to Kernel[0], as David appears to want -- then you can
> implement an evaluator that provides for fexprs and the like, and it
> will run about as well as Guile's evaluator.
>
> Did you see my implementation of `local-eval' [1]?  It leverages (hah!)
> Guile's macro expander, but otherwise is a straightforward
> interpreter.

It does not help because it requires _advance_ knowledge of when you are
going to want to fish for environments.  You can call Lilypond's
#{ ... #} construct in the normal REPL.  You can call it in any function
definition.  It is pervasive.

With Lilypond, I can always wrap stuff requiring closures into
(lambda ()) preventively at compile time, and execute them on an
as-needed base at runtime.  And that's actually what we do.  But there
is no way to ask Guile when it would be needed since Guile does not hand
out the information about bound variables in a given lexical scope.  To
get at that information, we would have to shadow every binding form
in Guile.

> If you find it slow, there are some simple, classic optimizations that
> can be made.  With some work, it could present a similar interface to
> 1.8's `local-eval', `procedure-environment', `the-environment', and
> such things.

When we are forced to reimplement a toy Scheme interpreter from scratch
anyway, including implementing every single defining form, one really
has to ask oneself why pick Guile in the first place if it does not give
you a Scheme language to work with?  Just for the API?

-- 
David Kastrup



From MAILER-DAEMON Tue Dec 13 05:15:33 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaPOX-0004JQ-VJ
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 05:15:33 -0500
Received: from eggs.gnu.org ([140.186.70.92]:44724)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <rixed@happyleptic.org>) id 1RaPOQ-0004Hn-Nv
	for guile-devel@gnu.org; Tue, 13 Dec 2011 05:15:32 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <rixed@happyleptic.org>) id 1RaPOL-0007Bw-Gr
	for guile-devel@gnu.org; Tue, 13 Dec 2011 05:15:26 -0500
Received: from eneide.happyleptic.org ([213.251.171.101]:57399)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <rixed@happyleptic.org>) id 1RaPOL-0007Bm-75
	for guile-devel@gnu.org; Tue, 13 Dec 2011 05:15:21 -0500
Received: from extranet.securactive.org ([82.234.213.170]
	helo=ccellier.rd.securactive.lan)
	by eneide.happyleptic.org with esmtp (Exim 4.72)
	(envelope-from <rixed@happyleptic.org>) id 1RaPXl-0005Z6-1y
	for guile-devel@gnu.org; Tue, 13 Dec 2011 11:25:05 +0100
Received: from rixed by ccellier.rd.securactive.lan with local (Exim 4.72)
	(envelope-from <rixed@happyleptic.org>) id 1RaPOE-0000ge-Ro
	for guile-devel@gnu.org; Tue, 13 Dec 2011 11:15:14 +0100
Date: Tue, 13 Dec 2011 11:15:14 +0100
From: rixed@happyleptic.org
To: guile-devel@gnu.org
Subject: What's the point to keep mmaped objectfile opened?
Message-ID: <20111213101514.GB13363@ccellier.rd.securactive.lan>
Mail-Followup-To: rixed@happyleptic.org, guile-devel@gnu.org
References: <20111213070512.GA7157@yeeloong.happyleptic.org>
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="LZvS9be/3tNcYl/X"
Content-Disposition: inline
In-Reply-To: <20111213070512.GA7157@yeeloong.happyleptic.org>
User-Agent: Mutt/1.5.20 (2009-06-14)
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 213.251.171.101
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 10:15:32 -0000


--LZvS9be/3tNcYl/X
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline

I'm a little worried by the amount of file descriptors left opened
after the objcode is mmaped.
I saw this "note to self" from objcodes.c:

/* FIXME: we leak ourselves and the file descriptor. but then again so does                      
   dlopen(). */

So apparently the author was well aware of the problem but decided to
ignore it, despite the fd being used nowhere as far as I can see
(also, I don't understand the remark about dlopen leaking a fd).

Anyway, the attached patch (which closes the fd and stores -1 inplace
of it in the cell) seams to works and seams to fix the issue (ie. no more
pending opened fd for .go files)


--LZvS9be/3tNcYl/X
Content-Type: text/x-diff; charset=us-ascii
Content-Disposition: attachment; filename="guile-close-fd-on-mmap.patch"

diff --git a/libguile/objcodes.c b/libguile/objcodes.c
index 536094f..9fa8b00 100644
--- a/libguile/objcodes.c
+++ b/libguile/objcodes.c
@@ -203,12 +203,11 @@ make_objcode_from_file (int fd)
                                     scm_from_size_t (total_len)));
       }
 
-    /* FIXME: we leak ourselves and the file descriptor. but then again so does
-       dlopen(). */
+    (void) close (fd);
     return scm_permanent_object
       (scm_double_cell (SCM_MAKE_OBJCODE_TAG (SCM_OBJCODE_TYPE_MMAP, 0),
                         (scm_t_bits)(addr + strlen (SCM_OBJCODE_COOKIE)),
-                        SCM_UNPACK (scm_from_int (fd)), 0));
+                        SCM_UNPACK (scm_from_int (-1)), 0));
   }
 #else
   {

--LZvS9be/3tNcYl/X--


From MAILER-DAEMON Tue Dec 13 06:15:00 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaQK4-0006tw-IO
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 06:15:00 -0500
Received: from eggs.gnu.org ([140.186.70.92]:46576)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaQJx-0006tg-Nu
	for guile-devel@gnu.org; Tue, 13 Dec 2011 06:14:59 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaQJn-00047h-U5
	for guile-devel@gnu.org; Tue, 13 Dec 2011 06:14:53 -0500
Received: from lo.gmane.org ([80.91.229.12]:60615)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaQJn-00047V-LT
	for guile-devel@gnu.org; Tue, 13 Dec 2011 06:14:43 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaQJl-0003K4-Sx
	for guile-devel@gnu.org; Tue, 13 Dec 2011 12:14:41 +0100
Received: from p508e9a39.dip.t-dialin.net ([80.142.154.57])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 13 Dec 2011 12:14:41 +0100
Received: from dak by p508e9a39.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 13 Dec 2011 12:14:41 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Tue, 13 Dec 2011 12:14:26 +0100
Organization: Organization?!?
Lines: 23
Message-ID: <87k460lo4t.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508e9a39.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:72mIQkVY5uOuhxHVtmTbZvE2z9Q=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 11:14:59 -0000

Andy Wingo <wingo@pobox.com> writes:

> Did you see my implementation of `local-eval' [1]?  It leverages (hah!)
> Guile's macro expander, but otherwise is a straightforward interpreter.
> If you find it slow, there are some simple, classic optimizations that
> can be made.  With some work, it could present a similar interface to
> 1.8's `local-eval', `procedure-environment', `the-environment', and such
> things.
>
> [1] http://lists.gnu.org/archive/html/guile-user/2011-02/msg00032.html

If you take that message in context, you'll find that a professor of
computer science is here asking how one would implement a meta-circular
evaluator <URL:http://en.wikipedia.org/wiki/Meta-circular_evaluator> for
Guile after local-eval has been thrown away.

You answer by giving an example of how to use Guile as the
implementation language for a non-meta non-circular evaluator instead.
You could likely also use Guile for _bootstrapping_ a meta circular
evaluator.  But that is not really the same thing.

-- 
David Kastrup



From MAILER-DAEMON Tue Dec 13 07:42:44 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaRgy-0000Ia-IL
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 07:42:44 -0500
Received: from eggs.gnu.org ([140.186.70.92]:36830)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaRgv-0000IJ-UO
	for guile-devel@gnu.org; Tue, 13 Dec 2011 07:42:43 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaRgu-0005Km-LZ
	for guile-devel@gnu.org; Tue, 13 Dec 2011 07:42:41 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:61522
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaRgu-0005Kb-Hj
	for guile-devel@gnu.org; Tue, 13 Dec 2011 07:42:40 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id B12D27945;
	Tue, 13 Dec 2011 07:42:39 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=xBhFm/iztvFUim8cBEk3Y2obTRw=; b=pPVPII
	MVrRQST0xJmGJ1nlL+5vOi5DKPkt2rnzHm0JLKAuzEjaUiiztTe2DNSI/thL73pi
	PvPqr0Re+WwCtMfZzWi9Ls+j1oY8HIQUc6Idir2iuo1L2xYg4EM5t9KTfmFMQumw
	6iKjgVrja5PuXW86iwCc/Vh8/73a1tUcv+cRg=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=QGrQUJMNbzBHmt4Sa0PEK7Q+dV4jiHpk
	8cMzCKIlH0O7cKD4pxLhCuQQhsiW1TKjCz5ujhTu9+uWV6toGkIvYF9ruGHjGE+p
	VpV8a9fA9CAj4klVViJaFc5ImHFwSzVgR9d6FVmPrGH+FKHBxkif+/9r4ebjraz7
	RReE1d5RzyY=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id AA3F07944;
	Tue, 13 Dec 2011 07:42:39 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 239057943;
	Tue, 13 Dec 2011 07:42:39 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: rixed@happyleptic.org
Subject: Re: What's the point to keep mmaped objectfile opened?
References: <20111213070512.GA7157@yeeloong.happyleptic.org>
	<20111213101514.GB13363@ccellier.rd.securactive.lan>
Date: Tue, 13 Dec 2011 13:42:35 +0100
In-Reply-To: <20111213101514.GB13363@ccellier.rd.securactive.lan>
	(rixed@happyleptic.org's message of "Tue, 13 Dec 2011 11:15:14 +0100")
Message-ID: <87k460bq2s.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: F10E5B88-2587-11E1-801D-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 12:42:43 -0000

On Tue 13 Dec 2011 11:15, rixed@happyleptic.org writes:

> I'm a little worried by the amount of file descriptors left opened
> after the objcode is mmaped.
> I saw this "note to self" from objcodes.c:
>
> /* FIXME: we leak ourselves and the file descriptor. but then again so does                      
>    dlopen(). */
>
> So apparently the author was well aware of the problem but decided to
> ignore it, despite the fd being used nowhere as far as I can see
> (also, I don't understand the remark about dlopen leaking a fd).
>
> Anyway, the attached patch (which closes the fd and stores -1 inplace
> of it in the cell) seams to works and seams to fix the issue (ie. no more
> pending opened fd for .go files)

If you close the fd, isn't the memory unmapped?  Isn't that a bad thing?

Maybe I was just under a big misconception here :)

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 13 08:05:38 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaS38-0001ic-HT
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 08:05:38 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55767)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaS32-0001hT-4K
	for guile-devel@gnu.org; Tue, 13 Dec 2011 08:05:36 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaS2x-0002O1-52
	for guile-devel@gnu.org; Tue, 13 Dec 2011 08:05:32 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:47960
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RaS2u-0002Ng-Kw; Tue, 13 Dec 2011 08:05:24 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 28DAB7C14;
	Tue, 13 Dec 2011 08:05:24 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=G35YWB9Hkf8ZmLGU6jNrEFSRqrw=; b=WG9Js6
	iCnrQ2+Bh4elhtrkyfSdJ4IKQAwiltp+KY7kPPog/Ex0cTjgh4qD+gKVjgh2eZVo
	TOeJBSC0TA3CRid9r2AVlaPapz7ci/jlBQZW3aNBhjhs2XGI/tbpClA5j2X9nFa7
	30bLQlqZixSLj/OC9befB2AgMVIE8moPqoS1s=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=BpijjeIOg/iwrv1e/+ge91+IIvW7i/RY
	XW68TaYMhP1ONfQWYqZX8k1Xx+Id9M/6w0RH/+5yT97OZ6y2uRVqJHNPzo2Tbfk8
	buZMCBReJ42Hcgshuie4oWjbk7kYFdAKChz38zJK/zA/wmbzOl5OGBat11q+fJ//
	T0nZnJI9DTo=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 212E17C13;
	Tue, 13 Dec 2011 08:05:24 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 849627C12;
	Tue, 13 Dec 2011 08:05:23 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
Date: Tue, 13 Dec 2011 14:05:19 +0100
In-Reply-To: <87obvclu92.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Tue, 13 Dec 2011 10:02:17 +0100")
Message-ID: <87aa6wbp0w.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 1E4D2FD6-258B-11E1-8398-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 13:05:36 -0000

On Tue 13 Dec 2011 10:02, David Kastrup <dak@gnu.org> writes:

> Lilypond's input language is not "David's current strategy".

I was referring to your implementation strategy.  Mark describes
another implementation strategy.

> It does not help because it requires _advance_ knowledge of when you are
> going to want to fish for environments.  You can call Lilypond's
> #{ ... #} construct in the normal REPL.  You can call it in any function
> definition.  It is pervasive.

I was suggesting to evaluate all lilypond "scheme" code with the lilypond
"scheme" interpreter.  That would make `the-environment' available
everywhere.

I still think making your #{}# parser expand to lexically-scoped Scheme
is the best option.

Another option is to use the reflective facilities to implement a form
of procedure-environment.  If you compile your Scheme procedures, with
partial evaluation disabled, you should be able to use program-bindings
to get this information.

I wonder if we could provide some sort of current-bindings syntactic
form, also.  It would require psyntax hooks, but it could work.

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 13 08:43:59 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaSeF-0007rt-8i
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 08:43:59 -0500
Received: from eggs.gnu.org ([140.186.70.92]:47498)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <rixed@happyleptic.org>) id 1RaSe9-0007e7-Ii
	for guile-devel@gnu.org; Tue, 13 Dec 2011 08:43:57 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <rixed@happyleptic.org>) id 1RaSe7-0001Jb-UR
	for guile-devel@gnu.org; Tue, 13 Dec 2011 08:43:53 -0500
Received: from eneide.happyleptic.org ([213.251.171.101]:43680)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <rixed@happyleptic.org>) id 1RaSe7-0001IW-Pz
	for guile-devel@gnu.org; Tue, 13 Dec 2011 08:43:51 -0500
Received: from extranet.securactive.org ([82.234.213.170]
	helo=ccellier.rd.securactive.lan)
	by eneide.happyleptic.org with esmtp (Exim 4.72)
	(envelope-from <rixed@happyleptic.org>) id 1RaSnN-0005kz-Pw
	for guile-devel@gnu.org; Tue, 13 Dec 2011 14:53:25 +0100
Received: from rixed by ccellier.rd.securactive.lan with local (Exim 4.72)
	(envelope-from <rixed@happyleptic.org>) id 1RaSdq-0003Ub-IK
	for guile-devel@gnu.org; Tue, 13 Dec 2011 14:43:34 +0100
Date: Tue, 13 Dec 2011 14:43:34 +0100
From: rixed@happyleptic.org
To: guile-devel@gnu.org
Subject: Re: What's the point to keep mmaped objectfile opened?
Message-ID: <20111213134334.GA13174@ccellier.rd.securactive.lan>
Mail-Followup-To: rixed@happyleptic.org, guile-devel@gnu.org
References: <20111213070512.GA7157@yeeloong.happyleptic.org>
	<20111213101514.GB13363@ccellier.rd.securactive.lan>
	<87k460bq2s.fsf@pobox.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <87k460bq2s.fsf@pobox.com>
User-Agent: Mutt/1.5.20 (2009-06-14)
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 213.251.171.101
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 13:43:57 -0000

-[ Tue, Dec 13, 2011 at 01:42:35PM +0100, Andy Wingo ]----
> If you close the fd, isn't the memory unmapped?  Isn't that a bad thing?
> 
> Maybe I was just under a big misconception here :)

That's a common misconception. The mapping of VM space to disk storage
is unrelated to the file descriptor set (or any program would have at
least a file descriptor opened for itself, since any program is mapped
into memory).
Compare for instance cat /proc/1/maps with ls -l /proc/1/fd.
As I said, the attached patch, which do closes the fd, actually works
(ie make check and my personal program works). So the memory is clearly
not unmapped :-)



From MAILER-DAEMON Tue Dec 13 08:52:36 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaSma-0004cZ-0d
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 08:52:36 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55625)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RaSmR-0004Wi-ND
	for guile-devel@gnu.org; Tue, 13 Dec 2011 08:52:33 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RaSmH-0003UL-LY
	for guile-devel@gnu.org; Tue, 13 Dec 2011 08:52:27 -0500
Received: from mail-gy0-f169.google.com ([209.85.160.169]:61651)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RaSmH-0003U9-C6
	for guile-devel@gnu.org; Tue, 13 Dec 2011 08:52:17 -0500
Received: by ghrr13 with SMTP id r13so513695ghr.0
	for <guile-devel@gnu.org>; Tue, 13 Dec 2011 05:52:16 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:sender:in-reply-to:references:date
	:x-google-sender-auth:message-id:subject:from:to:cc:content-type
	:content-transfer-encoding;
	bh=f+ZiHhEQs2ns3EmnNuKnDUpvtYrUcMy6SHcyr/nfjYs=;
	b=mpWHXkPMk9mqUH/Zw9sAQ8nfMyNTTPrEYrMh48ZKjbqd8WaJLzF7GxZvgkQBe/7jT5
	HyGW2uQYA6I8Sj0fCJ7OReL5x+/wyKnwRrJmEJrlhdySlBTg9gtvvx1syioXeWhTiOs2
	/pWqPodnLFOiZnWkuE5X11R/By8os0ejJhBEE=
MIME-Version: 1.0
Received: by 10.50.217.199 with SMTP id pa7mr14154263igc.48.1323784336446;
	Tue, 13 Dec 2011 05:52:16 -0800 (PST)
Sender: noah549@gmail.com
Received: by 10.42.217.6 with HTTP; Tue, 13 Dec 2011 05:52:16 -0800 (PST)
In-Reply-To: <87wra0c0y5.fsf@pobox.com>
References: <CA+U71=P0WHV-s4Lce3p3=5tfXswgOrvT6tk1r8hFU0KyTnJSYA@mail.gmail.com>
	<87wra0c0y5.fsf@pobox.com>
Date: Tue, 13 Dec 2011 08:52:16 -0500
X-Google-Sender-Auth: heB5CYo60hyI1SRBuhROAoD8Tb4
Message-ID: <CA+U71=MvxmeKaaO_RHpXkOxCJ52YMs+7_GjCsexU-zGTZYNyAw@mail.gmail.com>
Subject: Re: Compiler Branch
From: Noah Lavine <noah.b.lavine@gmail.com>
To: Andy Wingo <wingo@pobox.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.160.169
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 13:52:33 -0000

> Cool. =A0As a quick reaction, I have some doubts about this project. =A0B=
ut,
> I guess a WIP branch would be a good thing to have, and it would make
> the discussion more concrete.

Probably so. But if you have time, what are your doubts? I would much
rather talk about problems now than after I've implemented something
that we'll have to change.

Noah


From MAILER-DAEMON Tue Dec 13 08:57:27 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaSrH-0006nJ-KM
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 08:57:27 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55616)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaSr9-0006me-LE
	for guile-devel@gnu.org; Tue, 13 Dec 2011 08:57:25 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaSr3-0004RY-Gu
	for guile-devel@gnu.org; Tue, 13 Dec 2011 08:57:19 -0500
Received: from lo.gmane.org ([80.91.229.12]:34648)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaSr3-0004RO-8G
	for guile-devel@gnu.org; Tue, 13 Dec 2011 08:57:13 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaSqz-0001F4-Io
	for guile-devel@gnu.org; Tue, 13 Dec 2011 14:57:09 +0100
Received: from p508e9a39.dip.t-dialin.net ([80.142.154.57])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 13 Dec 2011 14:57:09 +0100
Received: from dak by p508e9a39.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 13 Dec 2011 14:57:09 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Tue, 13 Dec 2011 14:56:50 +0100
Organization: Organization?!?
Lines: 91
Message-ID: <87fwgolgm5.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508e9a39.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:D1/PYLRuw7uELmrLtziS3ojjrL0=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 13:57:25 -0000

Andy Wingo <wingo@pobox.com> writes:

> On Tue 13 Dec 2011 10:02, David Kastrup <dak@gnu.org> writes:
>
>> Lilypond's input language is not "David's current strategy".
>
> I was referring to your implementation strategy.

It's not a strategy.  Merely the least painful way to do things at a
given point of time.  The given point of time is that we need to cater
for both Guile v1 and v2.

> Mark describes another implementation strategy.
>
>> It does not help because it requires _advance_ knowledge of when you are
>> going to want to fish for environments.  You can call Lilypond's
>> #{ ... #} construct in the normal REPL.  You can call it in any function
>> definition.  It is pervasive.
>
> I was suggesting to evaluate all lilypond "scheme" code with the
> lilypond "scheme" interpreter.

Which means exactly that we can't use the repl anymore, and likely also
not the Guile debugger.  And get worse performance than with Guile v1.

> I still think making your #{}# parser expand to lexically-scoped
> Scheme is the best option.

If using Scheme as one humongous block is the best (and pretty much
only) option, Guile is no longer an extension language but a platform.
And that means letting down the admittedly few people who bought into
Guile's previous agenda.

In any case, I don't see what is supposed to make Guile v2 conceptually
distinct from any old Scheme interpreter if its closures are closed and
shut.

> Another option is to use the reflective facilities to implement a form
> of procedure-environment.  If you compile your Scheme procedures, with
> partial evaluation disabled, you should be able to use
> program-bindings to get this information.

program-bindings does not appear present in Guile 1.8, so that's shelved
at the current point of time.  And the documentation in the manual about
"Compiled Procedures" states

    Compiled procedures, also known as programs, respond all procedures
    that operate on procedures. In addition, there are a few more
    accessors for low-level details on programs.

which likely could be phrased a bit more clearly if one wanted to find
out how to make use of it.  It then goes on to state:

    — Scheme Procedure: program-bindings program
    — Scheme Procedure: make-binding name boxed? index start end
    — Scheme Procedure: binding:name binding
    — Scheme Procedure: binding:boxed? binding
    — Scheme Procedure: binding:index binding
    — Scheme Procedure: binding:start binding
    — Scheme Procedure: binding:end binding

        Bindings annotations for programs, along with their accessors.

        Bindings declare names and liveness extents for block-local
        variables. The best way to see what these are is to play around
        with them at a REPL. See VM Concepts, for more information.

Sorry, but "try out and see what it does" is not exactly a guarantee for
and/or a definition of a stable API.  I was not all that surprised to
find that the chapter "VM Concepts" does indeed contain more
information, unfortunately information that is not in any obvious way
related to program-bindings.

With that kind of documentation, few people will actually be using these
functions and as a result you will likely not feel any compulsion to
keep those around, either.

> I wonder if we could provide some sort of current-bindings syntactic
> form, also.  It would require psyntax hooks, but it could work.

I can't help the impression that a dependable and documented long-term
strategy and corresponding commitment would at the current point of time
be more important than brain-storming about short-lived hacks.

The distinguishing feature for Lisp-like systems is the degree to which
it is self-descriptive and "live".  _That_ (and certainly not its syntax
or performance) is what has made this language family the prime platform
for AI applications.

-- 
David Kastrup



From MAILER-DAEMON Tue Dec 13 09:34:40 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaTRI-0002kI-MQ
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 09:34:40 -0500
Received: from eggs.gnu.org ([140.186.70.92]:47455)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaTRD-0002iV-0U
	for guile-devel@gnu.org; Tue, 13 Dec 2011 09:34:39 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaTR7-0003w3-CV
	for guile-devel@gnu.org; Tue, 13 Dec 2011 09:34:34 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:51389
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RaTR5-0003vY-29; Tue, 13 Dec 2011 09:34:27 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 52DC18542;
	Tue, 13 Dec 2011 09:34:26 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=Bu3UXrGjnmQZgOimnVbplrNM9sw=; b=kJgwuN
	vIjAmaiKsNQa1+cfXFvEjJrSLiXRVrE29O6gCh8dth7uuH+7t3WlffIgtacn86Kk
	xR9kzSOPO6vZNz+GFRGikyJtGpF5HgUB23GS06MQrzfi3uNW/ZWKHaf1AIYEoz3D
	6OoRw+PzD51hlRNrQl8SXS4YyTQ/kZi+qykVc=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=KGM2ZSb822nGLH7lOhgAPKi4o5Fqq4BL
	iNWCAns/Cg1xD28J6Odh6mNyYzJS+bR1XDDyT7MH9FNiBwyKY8gkHglWwC9KysXo
	pWyJ80XXtsJLsyOsXtKVc0ZckYprJIDO6Y+85JaCyS7A4MBNenE6S+qm78nNf8ww
	321KnKd3rIY=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 4C6C18541;
	Tue, 13 Dec 2011 09:34:26 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id B6F368540;
	Tue, 13 Dec 2011 09:34:25 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
Date: Tue, 13 Dec 2011 15:34:21 +0100
In-Reply-To: <87fwgolgm5.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Tue, 13 Dec 2011 14:56:50 +0100")
Message-ID: <8762hkbkwi.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 8E819CF4-2597-11E1-AF75-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 14:34:39 -0000

Hello David,

Let us focus on solutions.

If the this realm does have a coin, it is good-will.  All participants
start with ample deposits, but yours is draining fast.  Please listen to
what people are saying; they are trying to help you.

Specifically:

On Tue 13 Dec 2011 14:56, David Kastrup <dak@gnu.org> writes:

>> I wonder if we could provide some sort of current-bindings syntactic
>> form, also.  It would require psyntax hooks, but it could work.
>
> I can't help the impression that a dependable and documented long-term
> strategy and corresponding commitment would at the current point of time
> be more important than brain-storming about short-lived hacks.

Um... what?  It sounds like `current-bindings' is the thing you need.
But, um...  I guess what I want to say is that you are making it pretty
hard to work with you.

Regards,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 13 10:28:22 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaUHG-0002KX-Iz
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 10:28:22 -0500
Received: from eggs.gnu.org ([140.186.70.92]:60182)
	by lists.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RaUHD-0002IF-FN
	for guile-devel@gnu.org; Tue, 13 Dec 2011 10:28:20 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dak@gnu.org>) id 1RaUH7-0006Gd-Fl
	for guile-devel@gnu.org; Tue, 13 Dec 2011 10:28:19 -0500
Received: from fencepost.gnu.org ([140.186.70.10]:46673)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RaUH7-0006GX-EC
	for guile-devel@gnu.org; Tue, 13 Dec 2011 10:28:13 -0500
Received: from localhost ([127.0.0.1]:56592 helo=lola)
	by fencepost.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dak@gnu.org>)
	id 1RaUH6-0000Qn-MS; Tue, 13 Dec 2011 10:28:13 -0500
Received: by lola (Postfix, from userid 1000)
	id D7239E5F55; Tue, 13 Dec 2011 16:27:45 +0100 (CET)
From: David Kastrup <dak@gnu.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com>
Date: Tue, 13 Dec 2011 16:27:45 +0100
In-Reply-To: <8762hkbkwi.fsf@pobox.com> (Andy Wingo's message of "Tue, 13 Dec
	2011 15:34:21 +0100")
Message-ID: <87borclcem.fsf@fencepost.gnu.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 140.186.70.10
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 15:28:20 -0000

Andy Wingo <wingo@pobox.com> writes:

> Hello David,
>
> Let us focus on solutions.
>
> If the this realm does have a coin, it is good-will.  All participants
> start with ample deposits, but yours is draining fast.  Please listen to
> what people are saying; they are trying to help you.

Lilypond already has an ugly inefficient hack in it that will keep it
working in regard of the closure department largely independent of
whatever Guile development chooses to come up with next.

> On Tue 13 Dec 2011 14:56, David Kastrup <dak@gnu.org> writes:
>
>>> I wonder if we could provide some sort of current-bindings syntactic
>>> form, also.  It would require psyntax hooks, but it could work.
>>
>> I can't help the impression that a dependable and documented
>> long-term strategy and corresponding commitment would at the current
>> point of time be more important than brain-storming about short-lived
>> hacks.
>
> Um... what?  It sounds like `current-bindings' is the thing you need.

It will at least be a year before any solution that does not work with
Guile 1.8 will be accepted into Lilypond.  Any effort spent on something
that is not likely to survive that long because nobody will have ever
used it by the time Lilypond would bother picking it up, is going to be
wasted.  And additional cause for bad blood.

And since we are not talking about time-critical code paths in Lilypond,
we'll be able to kludge around the consequences of Guile sacrificing its
introspective qualities.

I am not worried about Lilypond.  I can work with any size of crowbar.
I am worried about Guile.

> But, um...  I guess what I want to say is that you are making it
> pretty hard to work with you.

Since we are working on different projects, that is not a problem.

Take a look at <URL:http://www.gnu.org/s/guile/>.  It states:

    Successful and long-lived examples of Free Software projects that
    use Guile are TeXmacs, LilyPond, and GnuCash.

If you take a look at
<URL:http://www.texmacs.org/tmweb/about/todo.en.html>, you'll find

    3.Scheme interface
    3.1.General

    Scheme plug-in

        Internally present Guile as a plug-in, which could later be
        replaced by another Scheme implementation.

in their list of things to do.

For GNUCash, you have
<URL:http://wiki.gnucash.org/wiki/Roadmap#Scheme_minimization>

    Scheme minimization

    There are some parts of GnuCash that make a round-trip into scheme
    code for no really good reason. The developers would like to throw
    out those parts of Scheme.

    Reports

    Right now reports are scheme scripts that programatically generate HTML.

    Scheme is impenetrable to most programmers. Expecting users to be
    able to write reports in Scheme is completely unreasonable.

    The ideal solution should have three modules:

        Record selection: Ideally graphical with an SQL-like "advanced" option
        Layout: The original item here suggested an HTML template; that
        could be the "advanced" option, with a simple table/graph being
        the default
        Style: CSS. It's built into WebKit, we should use it.
        Javascript: WebKit supports javascript so complicated
        interactivity can be added. Example: ability to expand/collapse
        levels of the account hierarchy in a report. This could be
        extended with Javascript interfaces to the API so that all of
        the report code is written in Javascript instead of Scheme. 

    Any report module will still need some sort of scripting language to
    "calculate the numbers". Currently we have Scheme for this, but the
    developers would like to get away from that. Python might be a
    better option.

So of your three listed showcase applications, the two others are trying
to get away from Guile and/or Scheme.  And it does not look like
performance is the reason.

So I don't think that throwing out _distinguishing_ selling points of
Guile is necessarily doing you a favor.  And the transparency with which
it integrates with its language environment and the fact that one can
continue to use its evaluator and debugger even for the application for
which it serves as an extension language, certainly is a selling point.
Even if documentation and commitment to interfaces are not doing their
share.

There is a reason that pure Scheme compilers like Chicken and Stalin
don't see widespread employment, and that reason is that the
introspective and interactive character of the Lisp-like languages is
lost to a good degree, and the performance gain does not in itself
suffice to compete with classical compiled languages and their usually
more human-readable code and concepts.

-- 
David Kastrup


From MAILER-DAEMON Tue Dec 13 10:49:17 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaUbV-0006Pb-88
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 10:49:17 -0500
Received: from eggs.gnu.org ([140.186.70.92]:45300)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaUbN-0006MX-Ix
	for guile-devel@gnu.org; Tue, 13 Dec 2011 10:49:15 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaUbH-00032p-VV
	for guile-devel@gnu.org; Tue, 13 Dec 2011 10:49:09 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:34243
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RaUb9-000320-KZ; Tue, 13 Dec 2011 10:48:55 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id AAC6A8D0F;
	Tue, 13 Dec 2011 10:48:54 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=lI9Rqu64d1WFbN4+CdphDN/Tz8w=; b=q/ybrQ
	IU0V7JKvhC+8NmP/PZwwhRpeY8WL9u6K0uH6NUXZzBq6gWDup+6T+NpH7CNB8BSQ
	TYwR6LRxSO5cy5Fbl9DdTWMqmepwwjjReVeDUJIZUxrT0OziuEdS6y9pfEIqfXrk
	UsTTlWbM1XnrgEkyoAwV+stLHkzlQIVG6uROc=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=aKXHgbOsrbZFKz1RyREhx3c4+TkuPErm
	MHB335ABJDYtP0sZffDEVMlZkbFm0OCobEPj8ffkESb+THH0WGJ3UTuEaL/clgsG
	KHVguYa+KblsUhH30dp1qyo6y/NhGbyUD4OQpnCnbP3ZbRYl7u0Jwc0X4fjE/WIe
	AbgWNaS2qdw=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id A28A38D0E;
	Tue, 13 Dec 2011 10:48:54 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 13DAD8D0C;
	Tue, 13 Dec 2011 10:48:52 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
Date: Tue, 13 Dec 2011 16:48:49 +0100
In-Reply-To: <87borclcem.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Tue, 13 Dec 2011 16:27:45 +0100")
Message-ID: <87zkewa2vy.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: F53E11D4-25A1-11E1-99DF-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 15:49:15 -0000

On Tue 13 Dec 2011 16:27, David Kastrup <dak@gnu.org> writes:

>> It sounds like `current-bindings' is the thing you need.
>
> It will at least be a year before any solution that does not work with
> Guile 1.8 will be accepted into Lilypond.

It is possible to have similar interfaces with different
implementations, using `cond-expand'.  lily.scm does this in one case,
implementing 2.0 interfaces on 1.8.

I'll take a look at implementing something like this.

To summarize your issue: you have code like:

  (lambda (a b c)
    #{ here I have custom code that references lexical variables;
       should it be able to set them too?  }#) 

It would be relatively easy to pass in an alist of the lexicals, for
reference purposes; but do you want to be able to set them too, from
within that EDSL?

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 13 10:52:47 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaUet-0007ku-Q5
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 10:52:47 -0500
Received: from eggs.gnu.org ([140.186.70.92]:57854)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaUer-0007ht-4z
	for guile-devel@gnu.org; Tue, 13 Dec 2011 10:52:46 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaUei-0003e1-Sa
	for guile-devel@gnu.org; Tue, 13 Dec 2011 10:52:45 -0500
Received: from lo.gmane.org ([80.91.229.12]:32781)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaUei-0003da-GK
	for guile-devel@gnu.org; Tue, 13 Dec 2011 10:52:36 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaUef-0003Cd-Ud
	for guile-devel@gnu.org; Tue, 13 Dec 2011 16:52:34 +0100
Received: from p508e9a39.dip.t-dialin.net ([80.142.154.57])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 13 Dec 2011 16:52:33 +0100
Received: from dak by p508e9a39.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 13 Dec 2011 16:52:33 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Tue, 13 Dec 2011 16:52:17 +0100
Organization: Organization?!?
Lines: 79
Message-ID: <877h20lb9q.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508e9a39.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:D0V+4F41SAx+fTyndQqatUxUlKI=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 15:52:46 -0000

David Kastrup <dak@gnu.org> writes:

> So I don't think that throwing out _distinguishing_ selling points of
> Guile is necessarily doing you a favor.  And the transparency with
> which it integrates with its language environment and the fact that
> one can continue to use its evaluator and debugger even for the
> application for which it serves as an extension language, certainly is
> a selling point.

To illustrate, take a look at
<URL:http://nicolas.sceaux.free.fr/prelude/prelude.html>.  How likely do
you consider an average user to write and master such code?

I am currently writing on a report about recent changes in Lilypond, and
the code looks like the following (it does not work yet because
\parallelMusic is not implemented well enough):

ph = #(define-music-function (parser location p1 p2 p3 p4 p5)
       (ly:pitch? ly:pitch? ly:pitch? ly:pitch? ly:pitch?)
       #{ r8 $p3 16 $p4 $p5 $p3 $p4 $p5 |
          r16 $p2 8. ~ $p2 4 |
          $p1 2 |
       #})

\parallelMusic #'(high middle low)
{
	\oneVoice | \voiceOne | \voiceTwo |
        \ph c'   e'  g' c'' e''
        \ph c'   d'  a' d'' f''
        \ph b    d'  g' d'' f''
        \ph c'   e'  g' c'' e''
        \ph c'   e'  a' e'' a''
        \ph c'   d'  fis' a' d''
[...]
        \ph d    f   a c' f'  
        \ph g,   d   g b f' 
	\oneVoice | \change Staff = "down" \voiceOne | \voiceTwo |
        \ph c    e   g c' e'  
[...]

\score {
  \new PianoStaff
      <<
        \context Staff = "up" {
	  << \high \\ \middle >>
          r8 f16 a c' f' c' a c' a f a f d f d
          r8 g'16 b' d'' f'' d'' b' d'' b' g' b' d' f' e' d'
          <e' g' c''>1 \bar "|."
        }
        \context Staff = "down" {
	  \low
          << { r16 c8. ~ c4 ~ c2 r16 b,8. ~ b,4 ~ b,2 c1 }
             \\ { c,2 c, c, c, c,1 } >>
        }
      >>
  \midi { \tempo 4 = 80 }
  \layout { }
}


So what do you see: minimal Schemeishness, minimal complexity.  That's
something a user could actually hope to be writing and understanding.
And this "minimal Schemeishness" in spite of the music function \ph
being actually written in Scheme is exactly the result of making it
seamless and natural to pass in and out of Guile (including taking the
lexical environment or a simulation of it along) to the user.

If the user wanted to primordinarily deal with cryptic languages and
their own data structures and control mechanisms instead of something
approximating music notation, she would be using MusiXTeX.

You may consider this sort of seamless language integration unimportant
because apparently no project but Lilypond has managed approximating it
given the documentation of local-eval (and now substituting an emulation
of it), but at least Lilypond is not yet in the list of applications
trying to get away from Guile for the sake of its users.

-- 
David Kastrup



From MAILER-DAEMON Tue Dec 13 11:08:33 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaUu9-0004J4-69
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 11:08:33 -0500
Received: from eggs.gnu.org ([140.186.70.92]:54346)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaUu3-0004Iy-7b
	for guile-devel@gnu.org; Tue, 13 Dec 2011 11:08:31 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaUu2-0006NK-5E
	for guile-devel@gnu.org; Tue, 13 Dec 2011 11:08:27 -0500
Received: from lo.gmane.org ([80.91.229.12]:46619)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaUu1-0006NC-SB
	for guile-devel@gnu.org; Tue, 13 Dec 2011 11:08:26 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaUtz-0002tg-Qc
	for guile-devel@gnu.org; Tue, 13 Dec 2011 17:08:23 +0100
Received: from p508e9a39.dip.t-dialin.net ([80.142.154.57])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 13 Dec 2011 17:08:23 +0100
Received: from dak by p508e9a39.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 13 Dec 2011 17:08:23 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Tue, 13 Dec 2011 17:08:04 +0100
Organization: Organization?!?
Lines: 45
Message-ID: <87zkewjvyz.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508e9a39.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:UGba0DdPXtnTULVBdmtCLZic6A8=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 16:08:31 -0000

Andy Wingo <wingo@pobox.com> writes:

> On Tue 13 Dec 2011 16:27, David Kastrup <dak@gnu.org> writes:
>
>>> It sounds like `current-bindings' is the thing you need.
>>
>> It will at least be a year before any solution that does not work with
>> Guile 1.8 will be accepted into Lilypond.
>
> It is possible to have similar interfaces with different
> implementations, using `cond-expand'.  lily.scm does this in one case,
> implementing 2.0 interfaces on 1.8.
>
> I'll take a look at implementing something like this.
>
> To summarize your issue: you have code like:
>
>   (lambda (a b c)
>     #{ here I have custom code that references lexical variables;
>        should it be able to set them too?  }#) 
>
> It would be relatively easy to pass in an alist of the lexicals, for
> reference purposes; but do you want to be able to set them too, from
> within that EDSL?

The current implementation wraps scraps of code into (lambda () ...) and
executes them on-demand.  So the expectation is that embedded Scheme
code can have side-effects on the lexical environment like with

(let ((xxx 2))
  #{ #(set! xxx (1+ xxx)) #})

while something like

(let ((xxx 2))
  #{ xxx = "xx" #})

is not at the current point of time expected to work.  In fact, LilyPond
itself never accesses the lexical environment (or its simulation): the
environment is only made available to embedded Scheme.  It is basically
a black box, Scheme to Scheme.  Lilypond only uses the current module
for reading and writing variables.

-- 
David Kastrup



From MAILER-DAEMON Tue Dec 13 11:24:53 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaV9x-0002Qu-7K
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 11:24:53 -0500
Received: from eggs.gnu.org ([140.186.70.92]:36398)
	by lists.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RaV9o-0002F8-W1
	for guile-devel@gnu.org; Tue, 13 Dec 2011 11:24:50 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dak@gnu.org>) id 1RaV9n-0001mE-88
	for guile-devel@gnu.org; Tue, 13 Dec 2011 11:24:44 -0500
Received: from fencepost.gnu.org ([140.186.70.10]:47821)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RaV9n-0001m9-31
	for guile-devel@gnu.org; Tue, 13 Dec 2011 11:24:43 -0500
Received: from localhost ([127.0.0.1]:57742 helo=lola)
	by fencepost.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dak@gnu.org>)
	id 1RaV9m-0003w0-Hq; Tue, 13 Dec 2011 11:24:42 -0500
Received: by lola (Postfix, from userid 1000)
	id EB7D2E5F55; Tue, 13 Dec 2011 17:24:41 +0100 (CET)
From: David Kastrup <dak@gnu.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com>
Date: Tue, 13 Dec 2011 17:24:41 +0100
In-Reply-To: <87zkewa2vy.fsf@pobox.com> (Andy Wingo's message of "Tue, 13 Dec
	2011 16:48:49 +0100")
Message-ID: <87vcpkjv7a.fsf@fencepost.gnu.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 140.186.70.10
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 16:24:50 -0000

Andy Wingo <wingo@pobox.com> writes:

> On Tue 13 Dec 2011 16:27, David Kastrup <dak@gnu.org> writes:
>
>>> It sounds like `current-bindings' is the thing you need.
>>
>> It will at least be a year before any solution that does not work with
>> Guile 1.8 will be accepted into Lilypond.
>
> It is possible to have similar interfaces with different
> implementations, using `cond-expand'.  lily.scm does this in one case,
> implementing 2.0 interfaces on 1.8.
>
> I'll take a look at implementing something like this.
>
> To summarize your issue: you have code like:
>
>   (lambda (a b c)
>     #{ here I have custom code that references lexical variables;
>        should it be able to set them too?  }#) 
>
> It would be relatively easy to pass in an alist of the lexicals, for
> reference purposes; but do you want to be able to set them too, from
> within that EDSL?

It would appear that program-bindings on an anonymous lambda function
that just creates a list of all # and $ scraps in #{ ... #} would
deliver that.  Then one needs to correlate every structure recursively
with the resulting list of bindings, and create an anonymous lambda
whenever the intersection is non-empty.

It's doable, but its likely easier to just don't bother sorting out the
non-environment depending functions from those that do.  I should hope
that storing and referencing near-trivial lambda functions should not be
all too expensive in Guile v2.

So without something approaching the comparative seamlessness of the
procedure-environment/local-eval pairing, it is not likely that the
effort would be warranted.  The code currently in Lilypond is working
well enough: as I said, I can work with any size of crowbar.  And there
would be little point to exchange the current hack for a differently
tailored and likely more complex hack that is not a part of Guile proper
and thus has an even smaller expected live span than the current
solution.

-- 
David Kastrup


From MAILER-DAEMON Tue Dec 13 11:27:43 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaVCh-0003bf-8I
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 11:27:43 -0500
Received: from eggs.gnu.org ([140.186.70.92]:36906)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaVCa-0003bZ-2I
	for guile-devel@gnu.org; Tue, 13 Dec 2011 11:27:41 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaVCV-0002Ey-Oe
	for guile-devel@gnu.org; Tue, 13 Dec 2011 11:27:35 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:52131
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RaVCT-0002Ef-TA; Tue, 13 Dec 2011 11:27:30 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 519F190E1;
	Tue, 13 Dec 2011 11:27:29 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=wcgGNOX3zjC5lEzJ/oJqE/mfIxQ=; b=wkQgYW
	vZXJZ1/4Is/M5Tkq9tPEhjyIO2VftCx6MWnDKuWCgHd9dJDHxnTNm4Mdd8cjI/Bu
	znOVocAwStWh+BtVOKiJ0/RXEtuOyMoO0BlkibOKAc/7d0YGxdeUK4dDOOiijtpl
	3O8CSUfsLgD+9EO8RSysAellJf1rFiqPv417M=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=qpt094ct4yVHbJulXaQ1Tqcn4nwLQ9iW
	q8JbGImAT2yFmfrdUqz6KMasTxnW/jqiJCXgPbW2BSHeUmLlXsZAqF0l5sbRGTAN
	ohRq6FVDAADGI2UGa8pP4m4t9RHhUlE5SiLkteOLZGBERlNuJ+MyoJLvBYC4pYlq
	1pbU+MCoEms=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 4373390E0;
	Tue, 13 Dec 2011 11:27:29 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id AC55490DB;
	Tue, 13 Dec 2011 11:27:28 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
Date: Tue, 13 Dec 2011 17:27:24 +0100
In-Reply-To: <87zkewjvyz.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Tue, 13 Dec 2011 17:08:04 +0100")
Message-ID: <87vcpka13n.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 597606AC-25A7-11E1-9061-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 16:27:41 -0000

On Tue 13 Dec 2011 17:08, David Kastrup <dak@gnu.org> writes:

> The current implementation wraps scraps of code into (lambda () ...) and
> executes them on-demand.  So the expectation is that embedded Scheme
> code can have side-effects on the lexical environment like with
>
> (let ((xxx 2))
>   #{ #(set! xxx (1+ xxx)) #})

This closure strategy sounds fine, no?  It's what I would do, I think,
if I understand the problem correctly.

I thought that you were saying that lilypond code could reference and
set Scheme lexical variables.  I was also under the impression that
lilypond code could define lexical variables.  If neither of these are
true, then closures sound like a fine solution to me.

Am I missing something?  It has been a long thread :)

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 13 11:55:02 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaVd8-0002oU-OL
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 11:55:02 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59769)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaVd6-0002oJ-7s
	for guile-devel@gnu.org; Tue, 13 Dec 2011 11:55:01 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaVd0-0008Hy-8z
	for guile-devel@gnu.org; Tue, 13 Dec 2011 11:55:00 -0500
Received: from lo.gmane.org ([80.91.229.12]:56479)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaVcz-0008Ht-VJ
	for guile-devel@gnu.org; Tue, 13 Dec 2011 11:54:54 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaVcy-000218-Nb
	for guile-devel@gnu.org; Tue, 13 Dec 2011 17:54:52 +0100
Received: from p508e9a39.dip.t-dialin.net ([80.142.154.57])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 13 Dec 2011 17:54:52 +0100
Received: from dak by p508e9a39.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Tue, 13 Dec 2011 17:54:52 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Tue, 13 Dec 2011 17:54:33 +0100
Organization: Organization?!?
Lines: 58
Message-ID: <87r508jtti.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508e9a39.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:iqDmtig7IcKsf4SpJdZU7DI02hU=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 16:55:01 -0000

Andy Wingo <wingo@pobox.com> writes:

> On Tue 13 Dec 2011 17:08, David Kastrup <dak@gnu.org> writes:
>
>> The current implementation wraps scraps of code into (lambda () ...) and
>> executes them on-demand.  So the expectation is that embedded Scheme
>> code can have side-effects on the lexical environment like with
>>
>> (let ((xxx 2))
>>   #{ #(set! xxx (1+ xxx)) #})
>
> This closure strategy sounds fine, no?  It's what I would do, I think,
> if I understand the problem correctly.
>
> I thought that you were saying that lilypond code could reference and
> set Scheme lexical variables.

This thread started because I was thinking about creating Lilypond
structures that could be defined via procedures with setters.  In that
case, doing the equivalent of

(set! (lambda () (vref x 4)) 3)

would not work out all that well.  But that would likely be utopical
anyway.

> I was also under the impression that lilypond code could define
> lexical variables.

How would it do that without an API?

> If neither of these are true, then closures sound like a fine solution
> to me.
>
> Am I missing something?

Performance, space, simplicity, robustness.  Compiling five closures
that do nothing except accessing a single variable each is a bit
wasteful.

We keep having bug reports about bad stuff happening with #xxx and $xxx
constructs in Lilypond _comments_ inside of embedded Lilypond: since the
preliminary wrapping of $x and #x into lambdas does not recognize the
lexical structure of the embedded Lilypond passage, and one can't let
the lexer run in advance since the lexer is mode-dependent and thus
needs the parser to run in sync.

I am not saying that the current solution is unworkable.  But it does
nothing to recommend Guile in particular, while the solution using
procedure-environment did.  Even though taking the procedure-environment
of an arbitrary lambda function was quite more hackish (and less likely
to survive an optimizing compiler) than a special form for capturing the
current environment would have been.

But it was more like a master key than a crowbar.

-- 
David Kastrup



From MAILER-DAEMON Tue Dec 13 12:30:21 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaWBJ-0008FJ-1k
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 12:30:21 -0500
Received: from eggs.gnu.org ([140.186.70.92]:33012)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RaWB9-00082P-RR
	for guile-devel@gnu.org; Tue, 13 Dec 2011 12:30:19 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RaWB4-0007rU-Mn
	for guile-devel@gnu.org; Tue, 13 Dec 2011 12:30:11 -0500
Received: from world.peace.net ([96.39.62.75]:46699)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>)
	id 1RaWB4-0007qD-Ht; Tue, 13 Dec 2011 12:30:06 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RaWAy-0006qf-QB; Tue, 13 Dec 2011 12:30:01 -0500
From: Mark H Weaver <mhw@netris.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com>
Date: Tue, 13 Dec 2011 12:28:32 -0500
In-Reply-To: <87vcpka13n.fsf@pobox.com> (Andy Wingo's message of "Tue, 13 Dec
	2011 17:27:24 +0100")
Message-ID: <87zkewnzy7.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: David Kastrup <dak@gnu.org>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 17:30:19 -0000

Hi Andy,

Andy Wingo <wingo@pobox.com> writes:
> Am I missing something?  It has been a long thread :)

In case you haven't carefully read my earlier thread with David, I
wanted to briefly explain the difficulties as I understand them, from a
Schemer's perspective.  If I have misunderstood something, hopefully
David will correct me.

Most importantly, the design of the Lilypond language fundamentally
requires that parsing and execution are done simultaneously.  It is not
even possible to detect the boundaries between two statements without
runtime information.

To repeat an example that David provided earlier, consider a Lilypond
function that accepts one optional integer argument followed by a
required music argument.  When the parser/evaluator sees a call to this
function, it must determine the dynamic type of the first argument in
order to know where the function call ends and where the following code
begins.

The prime difficulty this causes for us is that when Scheme code
contains Lilypond code which contains Scheme code, e.g.:

>> (let ((xxx 2))
>>   #{ #(set! xxx (1+ xxx)) #})

In the general case, Lilypond needs to _execute_ the outer Scheme code
before the parser/evaluator is able to even _see_ the inner Scheme code,
because it needs to parse/evaluate the Lily code in between the two, and
we've already established that parsing cannot be not be done without
runtime information.

Therefore, the problem goes beyond simply Scheme within Scheme where the
inner Scheme is time-shifted.  That much could easily be handled by
closures like this:

(let ((xxx 2))
  (lambda () (set! xxx (1+ xxx))))

The problem is that we need to execute the (let ((xxx 2)) ...) part
before we have any idea what code is present in the "...".

Furthermore, it is not enough to simply provide an alist of lexical
variables at the point of the "...".  We need to provide a complete
environment sufficient to execute arbitrary Scheme code at that point,
which could include things like (set! xxx ...) or
(set! (procedure-with-setter xxx ...) ...) or whatever.

My suggestion is to provide something like a
(capture-lexical-environment) special form that would be put in place of
the "...", along with a "local-eval" that makes use of it.  Any
top-level form containing (capture-lexical-environment) would be
interpreted, not compiled.

Then, Lilypond could evaluate:

  (let ((xxx 2))
    (capture-lexical-environment))

which would return a lexical environment object, then proceed to
parse/evaluate the intervening Lilypond code, and then if needed could
call "local-eval" to evaluate any Scheme code within.  In the general
case this inner Scheme code could also contain a
(capture-lexical-environment), and so on.

How difficult would it be to implement this?

     Best,
      Mark


From MAILER-DAEMON Tue Dec 13 13:50:10 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaXQY-0002e2-HK
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 13:50:10 -0500
Received: from eggs.gnu.org ([140.186.70.92]:49056)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaXQV-0002a5-KW
	for guile-devel@gnu.org; Tue, 13 Dec 2011 13:50:08 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaXQR-000189-CA
	for guile-devel@gnu.org; Tue, 13 Dec 2011 13:50:07 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:32928
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RaXQO-00016T-E2; Tue, 13 Dec 2011 13:50:00 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id CB01F9DEC;
	Tue, 13 Dec 2011 13:49:59 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=YLn7ym+UPhdCGTzMql/3wiVdmAE=; b=aZv+VI
	/lbVGdxzhNIUGBAQ37ikhVBfiTmxad8m8A/MkZeG1CMcJw4PJgBMhZ0jBFmnLWSF
	7imKgsrnTwoNG7jSIvWnZuADINc5b9hyxhIuZ8WOVGEQl1V5S/lBZQLOmrIr0B+b
	6ctWi9zoaf3E991z46vVwAHuPIRx0YKbLSMIY=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=oHpwU+ZO6pZNMc0wwrhv8TyBjx0r0d88
	V+xWVLtnrMKrx3ZHPh/8+b2JpllHtJ8Y5HGbrhZ7PcRi5vAFuupdAO11CJyDxR8M
	T0RoaP/9uYj3PaCig86KR64emFtDziCp9zUmbpyUJ1vS5jkFgvyducrE/OEzuVy8
	2uBDMS7+HDQ=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id BFE759DEB;
	Tue, 13 Dec 2011 13:49:59 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 08E689DEA;
	Tue, 13 Dec 2011 13:49:58 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Mark H Weaver <mhw@netris.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
Date: Tue, 13 Dec 2011 19:49:56 +0100
In-Reply-To: <87zkewnzy7.fsf@netris.org> (Mark H. Weaver's message of "Tue,
	13 Dec 2011 12:28:32 -0500")
Message-ID: <87r5089ui3.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 41DB39D6-25BB-11E1-966D-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: David Kastrup <dak@gnu.org>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 18:50:08 -0000

On Tue 13 Dec 2011 18:28, Mark H Weaver <mhw@netris.org> writes:

> >> (let ((xxx 2))
> >>   #{ #(set! xxx (1+ xxx)) #})

> In the general case, Lilypond needs to _execute_ the outer Scheme code
> before the parser/evaluator is able to even _see_ the inner Scheme code,
> because it needs to parse/evaluate the Lily code in between the two, and
> we've already established that parsing cannot be not be done without
> runtime information.

What does it mean to execute a `(let ((xxx 2))' ?  I think I need to
read the thread again, because I am really not getting it.

>   (let ((xxx 2))
>     (capture-lexical-environment))
>
> How difficult would it be to implement this?

Dunno.  I was thinking that we could have a special form to return a
list of the identifiers in scope.  Or perhaps, some syntax-bindings
procedure, to operate on syntax objects.  A macro could use that data to
make a closure that captures all of the bindings, if that's your thing.

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 13 13:59:02 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaXZ8-0004tp-OD
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 13:59:02 -0500
Received: from eggs.gnu.org ([140.186.70.92]:43740)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaXZ2-0004tC-JQ
	for guile-devel@gnu.org; Tue, 13 Dec 2011 13:59:01 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaXZ1-0002Yb-Ar
	for guile-devel@gnu.org; Tue, 13 Dec 2011 13:58:56 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:43324
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RaXYz-0002YN-Cv; Tue, 13 Dec 2011 13:58:53 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id C3CC69EED;
	Tue, 13 Dec 2011 13:58:52 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=SiKVcOHCAFhwqykKQGccGX6rG1w=; b=nFE58P
	tJdU1yYU8qxGrJ7+VNazNAh2314R7JdatziJFQ7FguGLUcjZg6LFmj2/iXDkOBPr
	GfsionZwNU84Q4zKkOnLk6HZij87hLFSKKClhdKncV9u6gLghr/wb7oO62dgzD8P
	0mGmQP0LlT/gB30YPuMEIeSO5/q7ZyAma1wkM=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=xSyFcSzfasv1OUHcY5M5dzbLVQifJSaN
	jD0iSXX3VWW9LI5C1DRm/dWrykQ2HjKN/hpmKe1PuEDfLd1FQGxdmloXCCFgdIN+
	ZvM1Z82dpTXREnsjhwptILA79UBoYEStVvRRjKg5sABBCcVUPphaSe3CikmJs8rR
	EnMmgJiGVAM=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id A07059EEC;
	Tue, 13 Dec 2011 13:58:52 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 04E659EEB;
	Tue, 13 Dec 2011 13:58:51 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87r508jtti.fsf@fencepost.gnu.org>
Date: Tue, 13 Dec 2011 19:58:48 +0100
In-Reply-To: <87r508jtti.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Tue, 13 Dec 2011 17:54:33 +0100")
Message-ID: <87mxaw9u3b.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 7F89D1BA-25BC-11E1-B9A1-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 18:59:01 -0000

On Tue 13 Dec 2011 17:54, David Kastrup <dak@gnu.org> writes:

>> Am I missing something?
>
> Performance, space, simplicity, robustness.  Compiling five closures
> that do nothing except accessing a single variable each is a bit
> wasteful.

Sure.

Let me see if I finally understand the issue here:

You have a function:

  (define-music-function (foo bar)
    (ly:something? bar)
    #{ /la /la /la
       $bar $bar $bar
       #(scheme-expression!)
       /ok }#)

Before, you could turn the #{}# into a lambda and get at the $vars and
evaluate the #(expressions) in the procedure-environment of the lambda.
Now, you have to munge around in the expression and, in this case,
produce 4 closures:  (lambda () bar), 3 times, and (lambda ()
(scheme-expression!)).

Is that right?

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 13 14:16:44 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaXqG-000315-Nb
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 14:16:44 -0500
Received: from eggs.gnu.org ([140.186.70.92]:50873)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RaXqA-0002gV-90
	for guile-devel@gnu.org; Tue, 13 Dec 2011 14:16:43 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RaXq8-0006TN-SP
	for guile-devel@gnu.org; Tue, 13 Dec 2011 14:16:38 -0500
Received: from world.peace.net ([96.39.62.75]:58308)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>)
	id 1RaXq8-0006TI-Mg; Tue, 13 Dec 2011 14:16:36 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RaXq3-0007IO-7N; Tue, 13 Dec 2011 14:16:31 -0500
From: Mark H Weaver <mhw@netris.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com>
Date: Tue, 13 Dec 2011 14:15:03 -0500
In-Reply-To: <87r5089ui3.fsf@pobox.com> (Andy Wingo's message of "Tue, 13 Dec
	2011 19:49:56 +0100")
Message-ID: <87r508nv0o.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: David Kastrup <dak@gnu.org>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 19:16:43 -0000

Andy Wingo <wingo@pobox.com> writes:
> On Tue 13 Dec 2011 18:28, Mark H Weaver <mhw@netris.org> writes:
>
>> >> (let ((xxx 2))
>> >>   #{ #(set! xxx (1+ xxx)) #})
>
>> In the general case, Lilypond needs to _execute_ the outer Scheme code
>> before the parser/evaluator is able to even _see_ the inner Scheme code,
>> because it needs to parse/evaluate the Lily code in between the two, and
>> we've already established that parsing cannot be not be done without
>> runtime information.
>
> What does it mean to execute a `(let ((xxx 2))' ?  I think I need to
> read the thread again, because I am really not getting it.

Well, this example is a bit too simple to illustrate the point.
Let's consider a slightly more complex example:

  (let ((xxx (foobar 1 2)))
    #{ #(begin (set! xxx (1+ xxx))
               (let ((yyy (foobar 3 4)))
                 #{ #(set! yyy (+ xxx yyy)) #} )) #} )

In this case, Lilypond would need to start by evaluating:

  (let ((xxx (foobar 1 2)))
     (capture-lexical-environment))

which entails evaluating (foobar 1 2), extending the lexical environment
with a binding for "xxx", and then returning a new lexical environment
object.

Then Lilypond would then continue to parse/evaluate the Lilypond code
beginning with #{, which in the general case must be done at the same
time as execution.  When it finds the #( it enters Scheme mode again,
so it would then pass the lexical environment object from the previous
step to "local-eval" with the following expression:

  (begin (set! xxx (1+ xxx))
         (let ((yyy (foobar 3 4)))
           (capture-lexical-environment)))

which entails mutating "xxx", evaluating (foobar 3 4) and extending the
lexical environment again (which should now contain both xxx and yyy),
and then returning a new lexical environment object.  And so on.

Does this make sense?

>> How difficult would it be to implement this?
>
> Dunno.  I was thinking that we could have a special form to return a
> list of the identifiers in scope.

I don't think this is sufficient.  The special form must return a
lexical environment object that contains everything needed by a
"local-eval" procedure (which we should also provide) to evaluate
arbitrary scheme code within that lexical environment.

The key is that we must create the lexical environment object before we
know anything about the code that will later be passed to "local-eval".

    Thanks,
      Mark


From MAILER-DAEMON Tue Dec 13 17:45:38 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rab6Q-000525-8x
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 17:45:38 -0500
Received: from eggs.gnu.org ([140.186.70.92]:54356)
	by lists.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1Rab6N-00051u-Ce
	for guile-devel@gnu.org; Tue, 13 Dec 2011 17:45:36 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dak@gnu.org>) id 1Rab6J-0003wY-Nj
	for guile-devel@gnu.org; Tue, 13 Dec 2011 17:45:35 -0500
Received: from fencepost.gnu.org ([140.186.70.10]:55744)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1Rab6J-0003wU-M9
	for guile-devel@gnu.org; Tue, 13 Dec 2011 17:45:31 -0500
Received: from localhost ([127.0.0.1]:37432 helo=lola)
	by fencepost.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dak@gnu.org>)
	id 1Rab6J-0003Ro-4E; Tue, 13 Dec 2011 17:45:31 -0500
Received: by lola (Postfix, from userid 1000)
	id 1CE91E065E; Tue, 13 Dec 2011 23:23:29 +0100 (CET)
From: David Kastrup <dak@gnu.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87r508jtti.fsf@fencepost.gnu.org>
	<87mxaw9u3b.fsf@pobox.com>
Date: Tue, 13 Dec 2011 23:23:28 +0100
In-Reply-To: <87mxaw9u3b.fsf@pobox.com> (Andy Wingo's message of "Tue, 13 Dec
	2011 19:58:48 +0100")
Message-ID: <87hb14cdr3.fsf@fencepost.gnu.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 140.186.70.10
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 22:45:36 -0000

Andy Wingo <wingo@pobox.com> writes:

> On Tue 13 Dec 2011 17:54, David Kastrup <dak@gnu.org> writes:
>
>>> Am I missing something?
>>
>> Performance, space, simplicity, robustness.  Compiling five closures
>> that do nothing except accessing a single variable each is a bit
>> wasteful.
>
> Sure.
>
> Let me see if I finally understand the issue here:
>
> You have a function:
>
>   (define-music-function (foo bar)
>     (ly:something? bar)
      ^^^^^^^^^^^^^^^^^^^ Those are predicates, not arguments.
>     #{ /la /la /la
>        $bar $bar $bar
>        #(scheme-expression!)

Both # and $ come before Scheme expressions.  # is the regular type
visible in the parser, and has, for example, the property that it will
always serve as exactly one argument of a music function.  $ is an
"immediate" type that gets camouflaged as a Lilypond token right in the
lexer.  Using $ for assignments or less static cases than above is prone
to surprises since the parser generally operates with one token of
lookahead, and $ has to be evaluated before a token even exists.  In
contrast, # is read in the lexer and evaluated in the parser.

So basically the Guile relevant angle of the two is identical.

>        /ok }#)

> Before, you could turn the #{}# into a lambda

No, it was turned into a reader expansion.  No closure.  The reader
expansion had as constant contents the #{ ... #} contents as a string,
and a capture of the current lexical environment.  When this got
executed, the parser is let loose on the #{ ... #} contents, and when
encountering $ or #, it evaluates them like it would do outside of #{
... #} except for using a local-eval in the captured environment.

In either case, the Scheme reader is used for skipping over the sexp
following $ and #.  That is still done, but instead of throwing the read
sexp away, we now put it in a lambda together with its position in the
string (unless it is an obvious constant).  When evaluating # or $ at
runtime, we first check the alist of positions to lambdas, and if we
find a record of that position, evaluate a call to the recorded lambda
instead of the read expression.

Of course, this is not good for producing lvalues (pardon the Cism).

> and get at the $vars and evaluate the #(expressions) in the
> procedure-environment of the lambda.  Now, you have to munge around in
> the expression and, in this case, produce 4 closures: (lambda () bar),
> 3 times, and (lambda () (scheme-expression!)).
>
> Is that right?

Yes, that's what we currently do.  I don't know whether Scheme will be
smart enough to use the same memoization for all lambdas in
(list (cons 1 (lambda () bar)) (cons 5 (lambda () bar)) (cons 13 (lambda
      () bar)))
And it is a nuisance that one can't cons that thing together in the
reader and just quote it at runtime, because the read extension works in
the wrong lexical environment to produce the right kind of lambda.  One
could at best use two lists instead of an alist, and at least code the
position list as a single constant.

-- 
David Kastrup


From MAILER-DAEMON Tue Dec 13 18:00:24 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RabKi-0001Jw-J2
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 18:00:24 -0500
Received: from eggs.gnu.org ([140.186.70.92]:46785)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RabKd-0001Ew-9z
	for guile-devel@gnu.org; Tue, 13 Dec 2011 18:00:20 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RabKc-0006cf-4R
	for guile-devel@gnu.org; Tue, 13 Dec 2011 18:00:19 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:59496)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>)
	id 1RabKa-0006cC-0L; Tue, 13 Dec 2011 18:00:16 -0500
Received: by iahk25 with SMTP id k25so277248iah.0
	for <multiple recipients>; Tue, 13 Dec 2011 15:00:14 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:sender:in-reply-to:references:date
	:x-google-sender-auth:message-id:subject:from:to:cc:content-type
	:content-transfer-encoding;
	bh=/4teGO3Z0hD6tMiWuDHm0V6c/SWO/Io5ZUWqsQOGSmk=;
	b=T96wlbxeEYxZpDz3yx99er1oEAIat/mtq6zdm7RhxlSKDZBs9euIjW1QhNsrF1SQQ8
	BDuIhnBqQ1eucEVOkhvIUlkvhTzQqpDxsvRSO7IXO53HNIHN4kjsXBNOtgUZv2AXL5or
	4b7W+c8iUh9Gjp83TTha43lbZiWCimFglh25A=
MIME-Version: 1.0
Received: by 10.50.161.162 with SMTP id xt2mr20948044igb.72.1323817213788;
	Tue, 13 Dec 2011 15:00:13 -0800 (PST)
Sender: noah549@gmail.com
Received: by 10.42.217.6 with HTTP; Tue, 13 Dec 2011 15:00:13 -0800 (PST)
In-Reply-To: <87r508nv0o.fsf@netris.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
Date: Tue, 13 Dec 2011 18:00:13 -0500
X-Google-Sender-Auth: MhsWNB7B1xP21HineZm-uE3WDBc
Message-ID: <CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
From: Noah Lavine <noah.b.lavine@gmail.com>
To: Mark H Weaver <mhw@netris.org>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
Cc: Andy Wingo <wingo@pobox.com>, David Kastrup <dak@gnu.org>,
	guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 23:00:20 -0000

Hello,

I haven't really been contributing to this thread, so please take my
opinion with a grain of salt. But it does appear to me that we should
support capturing a lexical environment, as Mark and David describe.

So I took a look at ice-9/eval.scm to see how difficult it would be to
implement. Offhand, it doesn't look bad: the eval function there
already passes around environment objects, so if it hit this special
form, it would simply return its environment object (probably packaged
up in a record so it would print nicely). Restarting it is also
simple: call eval on an expression with the given environment. The
environment objects already contain all of the information needed to
evaluate expressions, so I don't think there is very much to do there.

The part that seems more interesting to me is that Guile's evaluator
attempts to memoize an entire expression before evaluating any of it,
which I understand is impossible with Lilypond. I assume Lilypond
handles this by bundling the Lilypond code into a string (or some
other object), letting the memoizer look at that, and then later doing
the actual expansion. David, is this how you handle that?

Noah

On Tue, Dec 13, 2011 at 2:15 PM, Mark H Weaver <mhw@netris.org> wrote:
> Andy Wingo <wingo@pobox.com> writes:
>> On Tue 13 Dec 2011 18:28, Mark H Weaver <mhw@netris.org> writes:
>>
>>> >> (let ((xxx 2))
>>> >> =A0 #{ #(set! xxx (1+ xxx)) #})
>>
>>> In the general case, Lilypond needs to _execute_ the outer Scheme code
>>> before the parser/evaluator is able to even _see_ the inner Scheme code=
,
>>> because it needs to parse/evaluate the Lily code in between the two, an=
d
>>> we've already established that parsing cannot be not be done without
>>> runtime information.
>>
>> What does it mean to execute a `(let ((xxx 2))' ? =A0I think I need to
>> read the thread again, because I am really not getting it.
>
> Well, this example is a bit too simple to illustrate the point.
> Let's consider a slightly more complex example:
>
> =A0(let ((xxx (foobar 1 2)))
> =A0 =A0#{ #(begin (set! xxx (1+ xxx))
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 (let ((yyy (foobar 3 4)))
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 #{ #(set! yyy (+ xxx yyy)) #} )) #} )
>
> In this case, Lilypond would need to start by evaluating:
>
> =A0(let ((xxx (foobar 1 2)))
> =A0 =A0 (capture-lexical-environment))
>
> which entails evaluating (foobar 1 2), extending the lexical environment
> with a binding for "xxx", and then returning a new lexical environment
> object.
>
> Then Lilypond would then continue to parse/evaluate the Lilypond code
> beginning with #{, which in the general case must be done at the same
> time as execution. =A0When it finds the #( it enters Scheme mode again,
> so it would then pass the lexical environment object from the previous
> step to "local-eval" with the following expression:
>
> =A0(begin (set! xxx (1+ xxx))
> =A0 =A0 =A0 =A0 (let ((yyy (foobar 3 4)))
> =A0 =A0 =A0 =A0 =A0 (capture-lexical-environment)))
>
> which entails mutating "xxx", evaluating (foobar 3 4) and extending the
> lexical environment again (which should now contain both xxx and yyy),
> and then returning a new lexical environment object. =A0And so on.
>
> Does this make sense?
>
>>> How difficult would it be to implement this?
>>
>> Dunno. =A0I was thinking that we could have a special form to return a
>> list of the identifiers in scope.
>
> I don't think this is sufficient. =A0The special form must return a
> lexical environment object that contains everything needed by a
> "local-eval" procedure (which we should also provide) to evaluate
> arbitrary scheme code within that lexical environment.
>
> The key is that we must create the lexical environment object before we
> know anything about the code that will later be passed to "local-eval".
>
> =A0 =A0Thanks,
> =A0 =A0 =A0Mark
>


From MAILER-DAEMON Tue Dec 13 18:16:16 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Raba4-0005Fd-GO
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 18:16:16 -0500
Received: from eggs.gnu.org ([140.186.70.92]:33221)
	by lists.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1Raba2-0005Dc-EL
	for guile-devel@gnu.org; Tue, 13 Dec 2011 18:16:15 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dak@gnu.org>) id 1Raba1-0001SW-GV
	for guile-devel@gnu.org; Tue, 13 Dec 2011 18:16:14 -0500
Received: from fencepost.gnu.org ([140.186.70.10]:56199)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1Raba1-0001SS-Da
	for guile-devel@gnu.org; Tue, 13 Dec 2011 18:16:13 -0500
Received: from localhost ([127.0.0.1]:37884 helo=lola)
	by fencepost.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dak@gnu.org>)
	id 1Raba0-000547-Iy; Tue, 13 Dec 2011 18:16:13 -0500
Received: by lola (Postfix, from userid 1000)
	id 304C6E5092; Wed, 14 Dec 2011 00:16:11 +0100 (CET)
From: David Kastrup <dak@gnu.org>
To: Noah Lavine <noah.b.lavine@gmail.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
Date: Wed, 14 Dec 2011 00:16:10 +0100
In-Reply-To: <CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	(Noah Lavine's message of "Tue, 13 Dec 2011 18:00:13 -0500")
Message-ID: <878vmgcbb9.fsf@fencepost.gnu.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 140.186.70.10
Cc: Andy Wingo <wingo@pobox.com>, Mark H Weaver <mhw@netris.org>,
	guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 23:16:15 -0000

Noah Lavine <noah.b.lavine@gmail.com> writes:

> Hello,
>
> I haven't really been contributing to this thread, so please take my
> opinion with a grain of salt. But it does appear to me that we should
> support capturing a lexical environment, as Mark and David describe.
>
> So I took a look at ice-9/eval.scm to see how difficult it would be to
> implement. Offhand, it doesn't look bad: the eval function there
> already passes around environment objects, so if it hit this special
> form, it would simply return its environment object (probably packaged
> up in a record so it would print nicely). Restarting it is also
> simple: call eval on an expression with the given environment. The
> environment objects already contain all of the information needed to
> evaluate expressions, so I don't think there is very much to do there.
>
> The part that seems more interesting to me is that Guile's evaluator
> attempts to memoize an entire expression before evaluating any of it,
> which I understand is impossible with Lilypond. I assume Lilypond
> handles this by bundling the Lilypond code into a string (or some
> other object), letting the memoizer look at that, and then later doing
> the actual expansion. David, is this how you handle that?

guile> '#{ \relative c' { $p 2  \mark #4 } #}
(#<procedure embedded-lilypond (parser lily-string filename line closures)> parser " \\relative c' { $p 2  \\mark #4 } " #f 2 (list (cons 17 (lambda () p))))

In this case, $p is placed into a lambda together with its offset in the
string.  The whole thing is a function call to a procedure that clones
the current parser and let's it parse the enclosed string.  Filename and
line are just tracked for providing useful error messages.  #4 is not
turned into a lambda since it is an obvious constant.

The obvious wishlist item would be to replace the potentially long and
expensive to create argument "closures" (which needs to get consed
together on each call since (lambda () p) needs to be created in the
current environment) with (package-environment).

I have no reliable idea what "memoize" means exactly in Guile's
terminology, and the parts of the manual I have consulted have no qualms
using this expression, but don't bother explaining it.

-- 
David Kastrup


From MAILER-DAEMON Tue Dec 13 18:39:47 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rabwp-0008Us-JT
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 18:39:47 -0500
Received: from eggs.gnu.org ([140.186.70.92]:58567)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1Rabwn-0008Um-Mb
	for guile-devel@gnu.org; Tue, 13 Dec 2011 18:39:46 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1Rabwm-00063V-MO
	for guile-devel@gnu.org; Tue, 13 Dec 2011 18:39:45 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:50879
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1Rabwl-00062z-0x; Tue, 13 Dec 2011 18:39:43 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id E67999C00;
	Tue, 13 Dec 2011 18:39:41 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=eGFynF2aACIX6dbb+1y4dyweA5o=; b=CXjkCN
	7hLM+lVtYqBiaXlNcfaqE5V5CMhtYR4XggqThjSZhM78+dG6X9vokYEHSRlYHEDV
	7ESDCsFZ/ShlVXPUz8VjgPDN3uGGBZhmAtpw5I2IrdRHOEa2npkAWikjk/zch5Vn
	cnlQtFNDq2ITB3AiSdros3VnakmXB4wS+wpDA=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=Egr+n/pSynID4cVGnlOMCrrxZl1HTSy2
	1V47gLAthW4rOCNVq1GD7rs1NSO3q54mnpAvII4IzfD3BNeh5PefN8VEb8tzgeda
	KoINazayl6LSYzoUa5ac9yG8xdxCkykmaBTe0PbtAZXGJbo0lkkNIBntoHN9rGRw
	kh8yaeaueqA=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id DCFB39BFF;
	Tue, 13 Dec 2011 18:39:41 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 5120B9BFE;
	Tue, 13 Dec 2011 18:39:41 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Noah Lavine <noah.b.lavine@gmail.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
Date: Wed, 14 Dec 2011 00:39:37 +0100
In-Reply-To: <CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	(Noah Lavine's message of "Tue, 13 Dec 2011 18:00:13 -0500")
Message-ID: <87borc9h3a.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: BA83092C-25E3-11E1-8A2E-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: Mark H Weaver <mhw@netris.org>, David Kastrup <dak@gnu.org>,
	guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 23:39:46 -0000

On Wed 14 Dec 2011 00:00, Noah Lavine <noah.b.lavine@gmail.com> writes:

> I haven't really been contributing to this thread, so please take my
> opinion with a grain of salt. But it does appear to me that we should
> support capturing a lexical environment, as Mark and David describe.
>
> So I took a look at ice-9/eval.scm....

The details of the interpreter's implementation are not public, I'm
afraid.  The interpreter does its job, but not quickly, and any change
to make it better would involve a change to the environment
representation.

Anyway, it's looking in the wrong place.  There is a compiler too.

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 13 18:48:34 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rac5K-0001WG-CK
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 18:48:34 -0500
Received: from eggs.gnu.org ([140.186.70.92]:37501)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1Rac5H-0001W7-N9
	for guile-devel@gnu.org; Tue, 13 Dec 2011 18:48:32 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1Rac5G-0007g1-9I
	for guile-devel@gnu.org; Tue, 13 Dec 2011 18:48:31 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:54688
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1Rac1Q-0007Dt-Gh; Tue, 13 Dec 2011 18:44:32 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 3F0069C7B;
	Tue, 13 Dec 2011 18:44:32 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=vm+m3VeAyVfZUmCpau+pW3eMcTY=; b=MW3+Uk
	r/voqm9MU/DXFmn605qwIAaYhE7WBk5ua4xHPZH2H3n1egRQ6uBTu8f2VADZ3j2X
	sSe/+UQL82XqkQZ8NVZKHE9dJc1xr/LN/O1eDldU8QrkZMowd3tOd5kjj+iOmrKU
	5V6jnHOmHVvq37q2TdDUEupOlecTZCVIsFN+w=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=w3oBH9hMAAeTPYijaOk/bHaySGdE1zep
	dJ3kjVYsbWhi6kFCgV2moQ6ODYIcDa6MxSTITw8gziafMDz6PJ2kUqNwRFsgk0DQ
	kyHFJcQ+8CtNNmx/kP6c5GWj5IA+EHQmdLZ/2TKY2jJ81S1if7x9QrW5ysE34Hbw
	BtwV4dutE9Y=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 2F9949C7A;
	Tue, 13 Dec 2011 18:44:32 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 6E5519C79;
	Tue, 13 Dec 2011 18:44:31 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<878vmgcbb9.fsf@fencepost.gnu.org>
Date: Wed, 14 Dec 2011 00:44:28 +0100
In-Reply-To: <878vmgcbb9.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Wed, 14 Dec 2011 00:16:10 +0100")
Message-ID: <877h209gv7.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 67704BFE-25E4-11E1-979A-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org, Mark H Weaver <mhw@netris.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 23:48:33 -0000

On Wed 14 Dec 2011 00:16, David Kastrup <dak@gnu.org> writes:

> guile> '#{ \relative c' { $p 2  \mark #4 } #}
> (#<procedure embedded-lilypond (parser lily-string filename line closures)> parser " \\relative c' { $p 2  \\mark #4 } " #f 2 (list (cons 17 (lambda () p))))

Ah, thanks for this example.  Thanks also for the previous example music
mail.

> The obvious wishlist item would be to replace the potentially long and
> expensive to create argument "closures" (which needs to get consed
> together on each call since (lambda () p) needs to be created in the
> current environment) with (package-environment).

I can see how this is a bit irritating, but at least if you are running
with the compiler, this is likely to be significantly faster than 1.8.

> I have no reliable idea what "memoize" means exactly in Guile's
> terminology, and the parts of the manual I have consulted have no qualms
> using this expression, but don't bother explaining it.

There are only two instances of this word in the Guile 2.0 manual :)

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Tue Dec 13 18:50:18 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rac70-0002Zs-6v
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 18:50:18 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55096)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rac6x-0002UD-CD
	for guile-devel@gnu.org; Tue, 13 Dec 2011 18:50:16 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rac6v-00085Y-P2
	for guile-devel@gnu.org; Tue, 13 Dec 2011 18:50:15 -0500
Received: from lo.gmane.org ([80.91.229.12]:48912)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rac6v-000851-4v
	for guile-devel@gnu.org; Tue, 13 Dec 2011 18:50:13 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rac6s-0004en-JV
	for guile-devel@gnu.org; Wed, 14 Dec 2011 00:50:10 +0100
Received: from p508e9a39.dip.t-dialin.net ([80.142.154.57])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 00:50:10 +0100
Received: from dak by p508e9a39.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 00:50:10 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Wed, 14 Dec 2011 00:45:35 +0100
Organization: Organization?!?
Lines: 23
Message-ID: <87zkewavds.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87borc9h3a.fsf@pobox.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508e9a39.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:OC9frY50eHaQv7PdQVywYiN0bMM=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 13 Dec 2011 23:50:17 -0000

Andy Wingo <wingo@pobox.com> writes:

> On Wed 14 Dec 2011 00:00, Noah Lavine <noah.b.lavine@gmail.com> writes:
>
>> I haven't really been contributing to this thread, so please take my
>> opinion with a grain of salt. But it does appear to me that we should
>> support capturing a lexical environment, as Mark and David describe.
>>
>> So I took a look at ice-9/eval.scm....
>
> The details of the interpreter's implementation are not public, I'm
> afraid.  The interpreter does its job, but not quickly, and any change
> to make it better would involve a change to the environment
> representation.
>
> Anyway, it's looking in the wrong place.  There is a compiler too.

We might be miscommunicating here.  Lilypond calls eval on the # and $
scraps (though I don't know whether that would be ice-9 or not).
Actually, I have no idea what else it could call.

-- 
David Kastrup



From MAILER-DAEMON Tue Dec 13 19:21:58 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Racbe-0007CI-8J
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 19:21:58 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52765)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1Racbc-0007CC-HF
	for guile-devel@gnu.org; Tue, 13 Dec 2011 19:21:57 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1Racbb-0006nw-IZ
	for guile-devel@gnu.org; Tue, 13 Dec 2011 19:21:56 -0500
Received: from mail4-relais-sop.national.inria.fr ([192.134.164.105]:35650)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <ludo@gnu.org>)
	id 1Racbb-0006ns-Bo
	for guile-devel@gnu.org; Tue, 13 Dec 2011 19:21:55 -0500
X-IronPort-AV: E=Sophos;i="4.71,349,1320620400"; d="scan'208";a="123263556"
Received: from reverse-83.fdn.fr (HELO pluto) ([80.67.176.83])
	by mail4-relais-sop.national.inria.fr with ESMTP/TLS/DHE-RSA-AES128-SHA;
	14 Dec 2011 01:21:53 +0100
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
To: Andy Wingo <wingo@pobox.com>
Subject: Re: [PATCH] Add "scandir" procedure
References: <1314475521.3143.47.camel@Renee-desktop> <8762lehoj4.fsf@gnu.org>
	<87k469or31.fsf@pobox.com> <87liqkh41t.fsf@gnu.org>
	<87mxb0igjb.fsf@pobox.com>
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 24 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
Date: Wed, 14 Dec 2011 01:21:52 +0100
In-Reply-To: <87mxb0igjb.fsf@pobox.com> (Andy Wingo's message of "Sat, 10 Dec
	2011 16:37:44 +0100")
Message-ID: <87aa6wovdr.fsf@gnu.org>
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 192.134.164.105
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 00:21:57 -0000

Hello!

I finally committed =E2=80=98file-system-fold=E2=80=99 (and its new friend
=E2=80=98file-system-tree=E2=80=99), but I have yet to write =E2=80=98scand=
ir=E2=80=99 (unless someone
else does ;-)).

Feedback welcome!

Thanks,
Ludo=E2=80=99.


From MAILER-DAEMON Tue Dec 13 19:32:05 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaclR-0000hs-2c
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 19:32:05 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59720)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RaclO-0000hi-LW
	for guile-devel@gnu.org; Tue, 13 Dec 2011 19:32:03 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RaclM-0000MV-Mv
	for guile-devel@gnu.org; Tue, 13 Dec 2011 19:32:02 -0500
Received: from world.peace.net ([96.39.62.75]:39364)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>)
	id 1RaclM-0000MB-Gg; Tue, 13 Dec 2011 19:32:00 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RaclG-00087U-1P; Tue, 13 Dec 2011 19:31:54 -0500
From: Mark H Weaver <mhw@netris.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87borc9h3a.fsf@pobox.com>
Date: Tue, 13 Dec 2011 19:30:24 -0500
In-Reply-To: <87borc9h3a.fsf@pobox.com> (Andy Wingo's message of "Wed, 14 Dec
	2011 00:39:37 +0100")
Message-ID: <87k460ngf3.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: David Kastrup <dak@gnu.org>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 00:32:03 -0000

Andy Wingo <wingo@pobox.com> writes:
> On Wed 14 Dec 2011 00:00, Noah Lavine <noah.b.lavine@gmail.com> writes:
>> I haven't really been contributing to this thread, so please take my
>> opinion with a grain of salt. But it does appear to me that we should
>> support capturing a lexical environment, as Mark and David describe.
>>
>> So I took a look at ice-9/eval.scm....
>
> The details of the interpreter's implementation are not public, I'm
> afraid.  The interpreter does its job, but not quickly, and any change
> to make it better would involve a change to the environment
> representation.

I agree that the returned "lexical environment object" should opaque.
Probably the only operation that needs this object is "local-eval",
though I'm not sure there's any disadvantage to printing it in
human-readable form for debugging purposes.  It might also be nice to
provide a procedure that converts it into an alist of some sort, but
that's not strictly needed.

I believe this would give us plenty of freedom to change the environment
representation in the future, no?

> Anyway, it's looking in the wrong place.  There is a compiler too.

The most obvious implementation of (capture-lexical-environment) would
inhibit compilation of any top-level form that contains it.  Therefore,
the only thing the compiler would need to do is detect the presence of
(capture-lexical-environment), and in that case, abort compilation of
the entire top-level form.  I guess such a form should be "compiled"
simply as a call to the evaluator with the entire top-level form as its
argument.  This would all happen after macro expansion, of course.

Does this make sense?

      Mark


From MAILER-DAEMON Tue Dec 13 19:42:53 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Racvt-0003IG-Oh
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 19:42:53 -0500
Received: from eggs.gnu.org ([140.186.70.92]:58162)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1Racvr-0003IA-MT
	for guile-devel@gnu.org; Tue, 13 Dec 2011 19:42:52 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1Racvq-0002V4-Mh
	for guile-devel@gnu.org; Tue, 13 Dec 2011 19:42:51 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:49992)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>)
	id 1Racvp-0002Us-7Q; Tue, 13 Dec 2011 19:42:49 -0500
Received: by iahk25 with SMTP id k25so415387iah.0
	for <multiple recipients>; Tue, 13 Dec 2011 16:42:48 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:sender:in-reply-to:references:date
	:x-google-sender-auth:message-id:subject:from:to:cc:content-type
	:content-transfer-encoding;
	bh=P1zyIqVOdZj9cL3FZ51J1Qea2jRZxL78c6DwcaTCG/U=;
	b=AZAj4sMwgQX9irA3SZECtET4/oqr9pYaSYvrkkyywNNJnd0ZsjySLoxpG8hq8Lv6jy
	g9oKXasQi93Ha2Mr7pHZd6eA8OebB3Pikp2P6IhP2EnAjKSBfPb4EiBB4krI8Xkolgr3
	wLfBQYtgwS5/fRbgA5BviuGAIbNpMAy1WfgQc=
MIME-Version: 1.0
Received: by 10.42.154.69 with SMTP id p5mr17303109icw.11.1323823368149; Tue,
	13 Dec 2011 16:42:48 -0800 (PST)
Sender: noah549@gmail.com
Received: by 10.42.217.6 with HTTP; Tue, 13 Dec 2011 16:42:47 -0800 (PST)
In-Reply-To: <87borc9h3a.fsf@pobox.com>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87borc9h3a.fsf@pobox.com>
Date: Tue, 13 Dec 2011 19:42:47 -0500
X-Google-Sender-Auth: nc5YKhZJlj22S-hgv9eatrl9f6c
Message-ID: <CA+U71=NeVr7j2zkvOssu7gs8fLnmN8PBVTAjMbyC40iqy_rC1A@mail.gmail.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
From: Noah Lavine <noah.b.lavine@gmail.com>
To: Andy Wingo <wingo@pobox.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
Cc: Mark H Weaver <mhw@netris.org>, David Kastrup <dak@gnu.org>,
	guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 00:42:52 -0000

On Tue, Dec 13, 2011 at 6:39 PM, Andy Wingo <wingo@pobox.com> wrote:
> On Wed 14 Dec 2011 00:00, Noah Lavine <noah.b.lavine@gmail.com> writes:
>
>> I haven't really been contributing to this thread, so please take my
>> opinion with a grain of salt. But it does appear to me that we should
>> support capturing a lexical environment, as Mark and David describe.
>>
>> So I took a look at ice-9/eval.scm....
>
> The details of the interpreter's implementation are not public, I'm
> afraid. =A0The interpreter does its job, but not quickly, and any change
> to make it better would involve a change to the environment
> representation.

Oh, I just realized that I miscommunicated very badly. When I said
"print nicely", I imagined something like "<procedure environement
object>". So we could hide the implementation inside the record type.

Noah


From MAILER-DAEMON Tue Dec 13 19:48:00 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rad0q-0004pH-Ct
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 19:48:00 -0500
Received: from eggs.gnu.org ([140.186.70.92]:47690)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1Rad0m-0004lL-VA
	for guile-devel@gnu.org; Tue, 13 Dec 2011 19:47:57 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1Rad0m-0003et-1L
	for guile-devel@gnu.org; Tue, 13 Dec 2011 19:47:56 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:58445)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>)
	id 1Rad0k-0003ed-7p; Tue, 13 Dec 2011 19:47:54 -0500
Received: by iahk25 with SMTP id k25so421737iah.0
	for <multiple recipients>; Tue, 13 Dec 2011 16:47:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:sender:in-reply-to:references:date
	:x-google-sender-auth:message-id:subject:from:to:cc:content-type
	:content-transfer-encoding;
	bh=jyk/UBX1f04JTgNMp6el1WMElmtdVGB7eawuj9p3lw8=;
	b=tCH0dE4N42v84ozsiVyWLsBKZFBTg5nfAXBWVIWLZ3+Ga881ZGhiSPbXPuHKlA9xZc
	iwqIfNlWizx1eUmduQxMqhBzu2Lvm3A7Aht1bv6T5SrIqgWux4q0dvz7r2ZM3QHWl2EX
	0bmAMNifPNE7EAH+e0TnsWL7NGyto6HuGvZFo=
MIME-Version: 1.0
Received: by 10.50.161.162 with SMTP id xt2mr21164885igb.72.1323823673455;
	Tue, 13 Dec 2011 16:47:53 -0800 (PST)
Sender: noah549@gmail.com
Received: by 10.42.217.6 with HTTP; Tue, 13 Dec 2011 16:47:53 -0800 (PST)
In-Reply-To: <87borc9h3a.fsf@pobox.com>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87borc9h3a.fsf@pobox.com>
Date: Tue, 13 Dec 2011 19:47:53 -0500
X-Google-Sender-Auth: kGCpuEWHQLZDL-Hs3DBc9V7AJik
Message-ID: <CA+U71=PqXPmjD3YL2Q3yQ1mEZ8u5b0oA4cueWBr6aN5u3QsP1A@mail.gmail.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
From: Noah Lavine <noah.b.lavine@gmail.com>
To: Andy Wingo <wingo@pobox.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
Cc: Mark H Weaver <mhw@netris.org>, David Kastrup <dak@gnu.org>,
	guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 00:47:57 -0000

> The details of the interpreter's implementation are not public, I'm
> afraid. =A0The interpreter does its job, but not quickly, and any change
> to make it better would involve a change to the environment
> representation.
>
> Anyway, it's looking in the wrong place. =A0There is a compiler too.

And since it seems to be my day to send poorly-thought-out emails,
here's another issue. Yes, evaluation should almost always be done by
the compiler. I was imagining that procedures that use the
(capture-local-environment) form would be interpreted, because using
the compiler there could get ugly. (I realize it's possible to use the
compiler there somewhat, but it seems easier at first to just not do
it.) That's why I was looking at primitive-eval.

Thinking about it now, I can imagine a sort of hybrid
compiler-interpreter implementation strategy, but I'm not sure if
that's the right thing to do here. It's a lot more complexity.

Have a nice day,
Noah


From MAILER-DAEMON Tue Dec 13 20:32:27 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Radhr-0004Xa-Jl
	for mharc-guile-devel@gnu.org; Tue, 13 Dec 2011 20:32:27 -0500
Received: from eggs.gnu.org ([140.186.70.92]:49346)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1Radhp-0004XM-Nq
	for guile-devel@gnu.org; Tue, 13 Dec 2011 20:32:26 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1Radho-0005S5-OB
	for guile-devel@gnu.org; Tue, 13 Dec 2011 20:32:25 -0500
Received: from world.peace.net ([96.39.62.75]:51815)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>)
	id 1Radho-0005Rr-FQ; Tue, 13 Dec 2011 20:32:24 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1Radhj-0008Gs-0C; Tue, 13 Dec 2011 20:32:19 -0500
From: Mark H Weaver <mhw@netris.org>
To: Noah Lavine <noah.b.lavine@gmail.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
Date: Tue, 13 Dec 2011 20:30:49 -0500
In-Reply-To: <CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	(Noah Lavine's message of "Tue, 13 Dec 2011 18:00:13 -0500")
Message-ID: <87fwgondme.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: Andy Wingo <wingo@pobox.com>, David Kastrup <dak@gnu.org>,
	guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 01:32:26 -0000

Hi Noah,

Noah Lavine <noah.b.lavine@gmail.com> writes:
> So I took a look at ice-9/eval.scm to see how difficult it would be to
> implement. Offhand, it doesn't look bad: the eval function there
> already passes around environment objects, so if it hit this special
> form, it would simply return its environment object (probably packaged
> up in a record so it would print nicely). Restarting it is also
> simple: call eval on an expression with the given environment. The
> environment objects already contain all of the information needed to
> evaluate expressions, so I don't think there is very much to do there.
>
> The part that seems more interesting to me is that Guile's evaluator
> attempts to memoize an entire expression before evaluating any of it,
> which I understand is impossible with Lilypond.

I also looked at eval.scm, and I see a complication.  The environments
passed around in ice-9/eval.scm do not contain any variable names.  The
evaluator works with memoized expressions, where variable references are
replaced by indices into the environment.

Therefore, the memoizer would need to be enhanced to support
(capture-lexical-environment) specially.  The evaluator may not know the
variable names, but the memoizer does.  After all, one of its jobs is to
convert variable references from symbols to indices.

The most straightforward solution I see is the following: When the
memoizer converts (capture-lexical-environment) into a memoized object,
it should embed within that object its own "memoizer environment" (a
list of variable names).

Then, when the (capture-lexical-environment) is evaluated, it simply
bundles together both the memoizer's environment (a list of variable
names) and the evaluator's environment (a list of variable values) into
an opaque lexical environment object.

When "local-eval" is called, it will need to first call the memoizer and
then the evaluator.  It will have everything it needs to do this within
the lexical environment object.

What do you think?

      Best,
       Mark


From MAILER-DAEMON Wed Dec 14 02:53:00 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Raje8-0000gG-IV
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 02:53:00 -0500
Received: from eggs.gnu.org ([140.186.70.92]:58747)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1Rajdz-0000c4-I8
	for guile-devel@gnu.org; Wed, 14 Dec 2011 02:52:57 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1Rajdt-0004Ti-On
	for guile-devel@gnu.org; Wed, 14 Dec 2011 02:52:51 -0500
Received: from world.peace.net ([96.39.62.75]:37950)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>)
	id 1Rajdt-0004Se-Ll; Wed, 14 Dec 2011 02:52:45 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1Rajdd-0000hZ-Ta; Wed, 14 Dec 2011 02:52:30 -0500
From: Mark H Weaver <mhw@netris.org>
To: Noah Lavine <noah.b.lavine@gmail.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org>
Date: Wed, 14 Dec 2011 02:50:56 -0500
In-Reply-To: <87fwgondme.fsf@netris.org> (Mark H. Weaver's message of "Tue, 13
	Dec 2011 20:30:49 -0500")
Message-ID: <87borboalb.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: Andy Wingo <wingo@pobox.com>, David Kastrup <dak@gnu.org>,
	guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 07:52:57 -0000

I have successfully implemented the (capture-lexical-environment)
special form in the evaluator, and also primitive-local-eval.
Here's a transcript from a test session:

  scheme@(guile-user)> (define env1 (primitive-eval '(let ((x 1) (y 2)) (capture-lexical-environment))))
  scheme@(guile-user)> (primitive-local-eval 'x env1)
  $2 = 1
  scheme@(guile-user)> (primitive-local-eval 'y env1)
  $3 = 2
  scheme@(guile-user)> (primitive-local-eval '(set! x (+ x 10)) env1)
  $4 = 11
  scheme@(guile-user)> (primitive-local-eval 'x env1)
  $5 = 11
  scheme@(guile-user)> (define env2 (primitive-local-eval '(begin (set! x (+ x 1)) (let ((z 3)) (capture-lexical-environment))) env1))
  scheme@(guile-user)> (primitive-local-eval 'z env2)
  $7 = 3
  scheme@(guile-user)> (primitive-local-eval 'x env2)
  $8 = 12
  scheme@(guile-user)> (primitive-local-eval 'y env2)
  $9 = 2

Note that in addition to the evaluator and memoizer environments, I also
needed to add an expander environment to the overall lexical environment
object.

I will post a preliminary patch shortly.  It's fairly small.

     Mark


From MAILER-DAEMON Wed Dec 14 03:16:15 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rak0d-0004UH-Ft
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 03:16:15 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55623)
	by lists.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1Rak0b-0004Qk-GA
	for guile-devel@gnu.org; Wed, 14 Dec 2011 03:16:14 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dak@gnu.org>) id 1Rak0Z-0001H4-VE
	for guile-devel@gnu.org; Wed, 14 Dec 2011 03:16:13 -0500
Received: from fencepost.gnu.org ([140.186.70.10]:35978)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1Rak0Z-0001H0-SL
	for guile-devel@gnu.org; Wed, 14 Dec 2011 03:16:11 -0500
Received: from localhost ([127.0.0.1]:45897 helo=lola)
	by fencepost.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dak@gnu.org>)
	id 1Rak0Y-00020c-OS; Wed, 14 Dec 2011 03:16:11 -0500
Received: by lola (Postfix, from userid 1000)
	id 87705E5092; Wed, 14 Dec 2011 09:16:09 +0100 (CET)
From: David Kastrup <dak@gnu.org>
To: Mark H Weaver <mhw@netris.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87borc9h3a.fsf@pobox.com> <87k460ngf3.fsf@netris.org>
Date: Wed, 14 Dec 2011 09:16:09 +0100
In-Reply-To: <87k460ngf3.fsf@netris.org> (Mark H. Weaver's message of "Tue, 13
	Dec 2011 19:30:24 -0500")
Message-ID: <87r507bmba.fsf@fencepost.gnu.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 140.186.70.10
Cc: Andy Wingo <wingo@pobox.com>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 08:16:14 -0000

Mark H Weaver <mhw@netris.org> writes:

> Andy Wingo <wingo@pobox.com> writes:
>> On Wed 14 Dec 2011 00:00, Noah Lavine <noah.b.lavine@gmail.com> writes:
>>> I haven't really been contributing to this thread, so please take my
>>> opinion with a grain of salt. But it does appear to me that we should
>>> support capturing a lexical environment, as Mark and David describe.
>>>
>>> So I took a look at ice-9/eval.scm....
>>
>> The details of the interpreter's implementation are not public, I'm
>> afraid.  The interpreter does its job, but not quickly, and any change
>> to make it better would involve a change to the environment
>> representation.
>
> I agree that the returned "lexical environment object" should opaque.
> Probably the only operation that needs this object is "local-eval",
> though I'm not sure there's any disadvantage to printing it in
> human-readable form for debugging purposes.

I was actually somewhat surprised that one could not just use "eval"
here and give it the environment instead of a module argument.  It is
not actually obvious from the documentation whether the active module is
part of the environment or not.

To be fair, not much is obvious from the documentation of local-eval
(documented in Guile 1.8, one occurence of "memoized" in this version).

@c snarfed from debug.c:406
@deffn {Scheme Procedure} local-eval exp [env]
@deffnx {C Function} scm_local_eval (exp, env)
Evaluate @var{exp} in its environment.  If @var{env} is supplied,
it is the environment in which to evaluate @var{exp}.  Otherwise,
@var{exp} must be a memoized code object (in which case, its environment
is implicit).
@end deffn

>> Anyway, it's looking in the wrong place.  There is a compiler too.
>
> The most obvious implementation of (capture-lexical-environment) would
> inhibit compilation of any top-level form that contains it.

Well, it probably is less invasive than the equivalent of marking every
local variable (similarly to global ones) as subject to change across
calls.

> Therefore, the only thing the compiler would need to do is detect the
> presence of (capture-lexical-environment), and in that case, abort
> compilation of the entire top-level form.  I guess such a form should
> be "compiled" simply as a call to the evaluator with the entire
> top-level form as its argument.  This would all happen after macro
> expansion, of course.
>
> Does this make sense?

Sounds a bit heavy-handed.  For the use cases in Lilypond, I don't
expect noticeable slow-downs as long as "the evaluator" works with
reasonable performance for an interpreter and is not coded with the "we
have a compiler anyway, so this will only run in exceptional cases and
can be exceptionally slow" frame of mind.

But it does a reasonably simple job, and probably is not significantly
changed from Guile v1, so I don't expect much of a problem here.

So this would basically work for Lilypond.  It would, however, be likely
a good idea to have it in a state where attaching strong-worded warnings
to the documentation is not necessary.

Something like "If an environment is being captured, the enclosing code
can't be optimized (in the current implementation, it is simply left
uncompiled).  So it is a good idea to place performance-critical code in
functions separate from those where you need to capture the
environment." should likely be enough.

-- 
David Kastrup


From MAILER-DAEMON Wed Dec 14 03:49:53 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RakXB-0003V8-Sw
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 03:49:53 -0500
Received: from eggs.gnu.org ([140.186.70.92]:36678)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RakX8-0003TH-9e
	for guile-devel@gnu.org; Wed, 14 Dec 2011 03:49:51 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RakX5-00004w-Ul
	for guile-devel@gnu.org; Wed, 14 Dec 2011 03:49:50 -0500
Received: from world.peace.net ([96.39.62.75]:56526)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>)
	id 1RakX5-0008WH-MD; Wed, 14 Dec 2011 03:49:47 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RakWx-0000nr-OH; Wed, 14 Dec 2011 03:49:40 -0500
From: Mark H Weaver <mhw@netris.org>
To: Noah Lavine <noah.b.lavine@gmail.com>
Subject: [PATCH] Implement `capture-lexical-environment' in evaluator
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
Date: Wed, 14 Dec 2011 03:48:10 -0500
In-Reply-To: <87borboalb.fsf@netris.org> (Mark H. Weaver's message of "Wed, 14
	Dec 2011 02:50:56 -0500")
Message-ID: <877h1zo7xx.fsf_-_@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="=-=-="
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: Andy Wingo <wingo@pobox.com>, David Kastrup <dak@gnu.org>,
	guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 08:49:51 -0000

--=-=-=
Content-Type: text/plain

This is a _preliminary_ patch.  In particular:

* The compiler does not yet handle (capture-lexical-environment)
  (which uses a new tree-il type).

* The lexical environment object is currently non-opaque list structure.

* I deliberately avoided reindenting eval.scm so that the non-whitespace
  changes would be evident, to make review easier.

* I wouldn't be surprised if `primitive-local-eval' does the wrong thing
  if (current-module) is different from what it was when the associated
  `primitive-eval' was called.

* I manually removed the psyntax-pp.scm patch from the output of
  git-format-patch (though the header change summary still mentions it),
  since it was so huge.  I guess you'll need to manually regenerate that
  file yourself, since the Makefiles don't do it automatically:

     cd guile/module; make ice-9/psyntax-pp.scm.gen

Here's an example session:

  mhw:~/guile$ meta/guile
  GNU Guile 2.0.3.66-52b7f-dirty
  Copyright (C) 1995-2011 Free Software Foundation, Inc.
  
  Guile comes with ABSOLUTELY NO WARRANTY; for details type `,show w'.
  This program is free software, and you are welcome to redistribute it
  under certain conditions; type `,show c' for details.
  
  Enter `,help' for help.
  scheme@(guile-user)> (define env1 (primitive-eval '(let ((x 1) (y 2)) (capture-lexical-environment))))
  scheme@(guile-user)> (primitive-local-eval 'x env1)
  $1 = 1
  scheme@(guile-user)> (primitive-local-eval 'y env1)
  $2 = 2
  scheme@(guile-user)> (primitive-local-eval '(set! x (+ x 10)) env1)
  $3 = 11
  scheme@(guile-user)> (primitive-local-eval 'x env1)
  $4 = 11
  scheme@(guile-user)> (define env2 (primitive-local-eval '(begin (set! x (+ x 1)) (let ((z 3)) (capture-lexical-environment))) env1))
  scheme@(guile-user)> (primitive-local-eval 'z env2)
  $5 = 3
  scheme@(guile-user)> (primitive-local-eval 'x env2)
  $6 = 12
  scheme@(guile-user)> (primitive-local-eval 'y env2)
  $7 = 2
  scheme@(guile-user)> (primitive-local-eval 'x env1)
  $8 = 12
  scheme@(guile-user)> (primitive-local-eval '(set! x (+ x 10)) env1)
  $9 = 22
  scheme@(guile-user)> (primitive-local-eval 'x env2)
  $10 = 22
  scheme@(guile-user)> (primitive-local-eval '(set! y (+ y 5)) env2)
  $11 = 7
  scheme@(guile-user)> (primitive-local-eval 'y env1)
  $12 = 7
  scheme@(guile-user)> (define foo 35)
  scheme@(guile-user)> (primitive-local-eval 'foo env1)
  $13 = 35
  scheme@(guile-user)> (primitive-local-eval '(set! foo 37) env1)
  scheme@(guile-user)> foo
  $14 = 37

The preliminary patch follows.  Comments solicited.

     Mark



--=-=-=
Content-Type: text/x-patch
Content-Disposition: inline;
 filename=0001-Implement-capture-lexical-environment-in-evaluator.patch
Content-Description: Implement `capture-lexical-environment' in evaluator

>From 417762cbd3d299bb166ac240bc84fcceeb6dcde9 Mon Sep 17 00:00:00 2001
From: Mark H Weaver <mhw@netris.org>
Date: Wed, 14 Dec 2011 03:12:43 -0500
Subject: [PATCH] Implement `capture-lexical-environment' in evaluator

PRELIMINARY WORK, not ready for commit.
---
 libguile/expand.c           |    5 +
 libguile/expand.h           |   13 +
 libguile/memoize.c          |   18 +
 libguile/memoize.h          |    5 +-
 module/ice-9/eval.scm       |   49 +-
 module/ice-9/psyntax-pp.scm |23314 ++++++++++++++++++++++---------------------
 module/ice-9/psyntax.scm    |   32 +-
 module/language/tree-il.scm |   10 +
 8 files changed, 12127 insertions(+), 11319 deletions(-)

diff --git a/module/ice-9/eval.scm b/module/ice-9/eval.scm
index c0fa64c..e51c662 100644
--- a/module/ice-9/eval.scm
+++ b/module/ice-9/eval.scm
@@ -213,7 +213,16 @@
 ;;; `eval' in this order, to put the most frequent cases first.
 ;;;
 
-(define primitive-eval
+;; FIXME: make this opaque!!
+(define (make-lexical-environment eval-env memo-env expander-env)
+  (list '<lexical-environment> eval-env memo-env expander-env))
+(define lexical-environment:eval-env cadr)
+(define lexical-environment:memo-env caddr)
+(define lexical-environment:expander-env cadddr)
+
+(define primitive-eval #f)
+(define primitive-local-eval #f)
+
   (let ()
     ;; We pre-generate procedures with fixed arities, up to some number of
     ;; arguments; see make-fixed-closure above.
@@ -459,6 +468,9 @@
                   (eval exp env)
                   (eval handler env)))
         
+        (('capture-lexical-environment (memo-env . expander-env))
+         (make-lexical-environment env memo-env expander-env))
+
         (('call/cc proc)
          (call/cc (eval proc env)))
 
@@ -469,12 +481,29 @@
               (memoize-variable-access! exp #f))
           (eval x env)))))
   
-    ;; primitive-eval
-    (lambda (exp)
-      "Evaluate @var{exp} in the current module."
-      (eval 
-       (memoize-expression 
-        (if (macroexpanded? exp)
-            exp
-            ((module-transformer (current-module)) exp)))
-       '()))))
+    (set! primitive-local-eval
+          (lambda (exp env)
+            "Evaluate @var{exp} within the lexical environment @var{env}."
+            (let ((eval-env (lexical-environment:eval-env env))
+                  (memo-env (lexical-environment:memo-env env))
+                  (expander-env (lexical-environment:expander-env env)))
+              (let ((module (capture-env (if (pair? eval-env)
+                                             (cdr (last-pair eval-env))
+                                             eval-env))))
+                (eval
+                 (memoize-local-expression
+                  (if (macroexpanded? exp)
+                      exp
+                      ((module-transformer module) exp #:env expander-env))
+                  memo-env)
+                 eval-env)))))
+
+    (set! primitive-eval
+          (lambda (exp)
+            "Evaluate @var{exp} in the current module."
+            (eval
+             (memoize-expression
+              (if (macroexpanded? exp)
+                  exp
+                  ((module-transformer (current-module)) exp)))
+             '()))))
diff --git a/libguile/memoize.c b/libguile/memoize.c
index 911d972..c06d593 100644
--- a/libguile/memoize.c
+++ b/libguile/memoize.c
@@ -112,6 +112,8 @@ scm_t_bits scm_tc16_memoized;
   MAKMEMO (SCM_M_MODULE_SET, scm_cons (val, scm_cons (mod, scm_cons (var, public))))
 #define MAKMEMO_PROMPT(tag, exp, handler) \
   MAKMEMO (SCM_M_PROMPT, scm_cons (tag, scm_cons (exp, handler)))
+#define MAKMEMO_CAPTURE_LEXICAL_ENVIRONMENT(memo_env, expander_env)	\
+  MAKMEMO (SCM_M_CAPTURE_LEXICAL_ENVIRONMENT, scm_cons(memo_env, expander_env))
 
 
 /* Primitives for the evaluator */
@@ -143,6 +145,7 @@ static const char *const memoized_tags[] =
   "module-ref",
   "module-set!",
   "prompt",
+  "capture-lexical-environment",
 };
 
 static int
@@ -426,6 +429,9 @@ memoize (SCM exp, SCM env)
                                   memoize_exps (REF (exp, DYNLET, VALS), env),
                                   memoize (REF (exp, DYNLET, BODY), env));
 
+    case SCM_EXPANDED_CAPTURE_LEXICAL_ENVIRONMENT:
+      return MAKMEMO_CAPTURE_LEXICAL_ENVIRONMENT (env, REF (exp, CAPTURE_LEXICAL_ENVIRONMENT, ENV));
+
     default:
       abort ();
     }
@@ -444,6 +450,16 @@ SCM_DEFINE (scm_memoize_expression, "memoize-expression", 1, 0, 0,
 }
 #undef FUNC_NAME
 
+SCM_DEFINE (scm_memoize_local_expression, "memoize-local-expression", 2, 0, 0,
+            (SCM exp, SCM env),
+	    "Memoize the expression @var{exp} within the local memoize environment @var{env}.")
+#define FUNC_NAME s_scm_memoize_local_expression
+{
+  SCM_ASSERT_TYPE (SCM_EXPANDED_P (exp), exp, 1, FUNC_NAME, "expanded");
+  return memoize (exp, env);
+}
+#undef FUNC_NAME
+
 
 
 
@@ -706,6 +722,8 @@ unmemoize (const SCM expr)
                          unmemoize (CAR (args)),
                          unmemoize (CADR (args)),
                          unmemoize (CDDR (args)));
+    case SCM_M_CAPTURE_LEXICAL_ENVIRONMENT:
+      return scm_list_3 (scm_sym_capture_lexical_environment, CAR (args), CDR (args));
     default:
       abort ();
     }
diff --git a/libguile/memoize.h b/libguile/memoize.h
index 26bd5b1..4a05bee 100644
--- a/libguile/memoize.h
+++ b/libguile/memoize.h
@@ -44,6 +44,7 @@ SCM_API SCM scm_sym_quote;
 SCM_API SCM scm_sym_quasiquote;
 SCM_API SCM scm_sym_unquote;
 SCM_API SCM scm_sym_uq_splicing;
+SCM_API SCM scm_sym_capture_lexical_environment;
 SCM_API SCM scm_sym_with_fluids;
 
 SCM_API SCM scm_sym_at;
@@ -90,13 +91,15 @@ enum
     SCM_M_TOPLEVEL_SET,
     SCM_M_MODULE_REF,
     SCM_M_MODULE_SET,
-    SCM_M_PROMPT
+    SCM_M_PROMPT,
+    SCM_M_CAPTURE_LEXICAL_ENVIRONMENT
   };
 
 
 
 
 SCM_INTERNAL SCM scm_memoize_expression (SCM exp);
+SCM_INTERNAL SCM scm_memoize_local_expression (SCM exp, SCM env);
 SCM_INTERNAL SCM scm_unmemoize_expression (SCM memoized);
 SCM_INTERNAL SCM scm_memoized_expression_typecode (SCM memoized);
 SCM_INTERNAL SCM scm_memoized_expression_data (SCM memoized);
diff --git a/libguile/expand.h b/libguile/expand.h
index 02e6e17..b78ef1b 100644
--- a/libguile/expand.h
+++ b/libguile/expand.h
@@ -54,6 +54,7 @@ typedef enum
     SCM_EXPANDED_LET,
     SCM_EXPANDED_LETREC,
     SCM_EXPANDED_DYNLET,
+    SCM_EXPANDED_CAPTURE_LEXICAL_ENVIRONMENT,
     SCM_NUM_EXPANDED_TYPES,
   } scm_t_expanded_type;
 
@@ -330,6 +331,18 @@ enum
 #define SCM_MAKE_EXPANDED_DYNLET(src, fluids, vals, body) \
   scm_c_make_struct (exp_vtables[SCM_EXPANDED_DYNLET], 0, SCM_NUM_EXPANDED_DYNLET_FIELDS, SCM_UNPACK (src), SCM_UNPACK (fluids), SCM_UNPACK (vals), SCM_UNPACK (body))
 
+#define SCM_EXPANDED_CAPTURE_LEXICAL_ENVIRONMENT_TYPE_NAME "capture-lexical-environment"
+#define SCM_EXPANDED_CAPTURE_LEXICAL_ENVIRONMENT_FIELD_NAMES  \
+  { "src", "env", }
+enum
+  {
+    SCM_EXPANDED_CAPTURE_LEXICAL_ENVIRONMENT_SRC,
+    SCM_EXPANDED_CAPTURE_LEXICAL_ENVIRONMENT_ENV,
+    SCM_NUM_EXPANDED_CAPTURE_LEXICAL_ENVIRONMENT_FIELDS,
+  };
+#define SCM_MAKE_EXPANDED_CAPTURE_LEXICAL_ENVIRONMENT(src, env)		\
+  scm_c_make_struct (exp_vtables[SCM_EXPANDED_CAPTURE_LEXICAL_ENVIRONMENT], 0, SCM_NUM_EXPANDED_CAPTURE_LEXICAL_ENVIRONMENT_FIELDS, SCM_UNPACK (src), SCM_UNPACK (env))
+
 #endif /* BUILDING_LIBGUILE */
 
 
diff --git a/libguile/expand.c b/libguile/expand.c
index bdecd80..35d1c3a 100644
--- a/libguile/expand.c
+++ b/libguile/expand.c
@@ -85,6 +85,8 @@ static const char** exp_field_names[SCM_NUM_EXPANDED_TYPES];
   SCM_MAKE_EXPANDED_LETREC(src, in_order_p, names, gensyms, vals, body)
 #define DYNLET(src, fluids, vals, body) \
   SCM_MAKE_EXPANDED_DYNLET(src, fluids, vals, body)
+#define CAPTURE_LEXICAL_ENVIRONMENT(src, env)		\
+  SCM_MAKE_EXPANDED_CAPTURE_LEXICAL_ENVIRONMENT(src, env)
 
 #define CAR(x)   SCM_CAR(x)
 #define CDR(x)   SCM_CDR(x)
@@ -203,6 +205,8 @@ SCM_GLOBAL_SYMBOL (scm_sym_unquote, "unquote");
 SCM_GLOBAL_SYMBOL (scm_sym_quasiquote, "quasiquote");
 SCM_GLOBAL_SYMBOL (scm_sym_uq_splicing, "unquote-splicing");
 
+SCM_GLOBAL_SYMBOL (scm_sym_capture_lexical_environment, "capture-lexical-environment");
+
 SCM_KEYWORD (kw_allow_other_keys, "allow-other-keys");
 SCM_KEYWORD (kw_optional, "optional");
 SCM_KEYWORD (kw_key, "key");
@@ -1250,6 +1254,7 @@ scm_init_expand ()
   DEFINE_NAMES (LET);
   DEFINE_NAMES (LETREC);
   DEFINE_NAMES (DYNLET);
+  DEFINE_NAMES (CAPTURE_LEXICAL_ENVIRONMENT);
 
   scm_exp_vtable_vtable =
     scm_make_vtable (scm_from_locale_string (SCM_VTABLE_BASE_LAYOUT "pwuwpw"),
diff --git a/module/language/tree-il.scm b/module/language/tree-il.scm
index 1d391c4..455dccc 100644
--- a/module/language/tree-il.scm
+++ b/module/language/tree-il.scm
@@ -49,6 +49,9 @@
             <dynlet> dynlet? make-dynlet dynlet-src dynlet-fluids dynlet-vals dynlet-body
             <dynref> dynref? make-dynref dynref-src dynref-fluid
             <dynset> dynset? make-dynset dynset-src dynset-fluid dynset-exp
+            <capture-lexical-environment> capture-lexical-environment?
+                                          make-capture-lexical-environment
+                                          capture-lexical-environment-src
             <prompt> prompt? make-prompt prompt-src prompt-tag prompt-body prompt-handler
             <abort> abort? make-abort abort-src abort-tag abort-args abort-tail
 
@@ -125,6 +128,7 @@
   ;; (<let> names gensyms vals body)
   ;; (<letrec> in-order? names gensyms vals body)
   ;; (<dynlet> fluids vals body)
+  ;; (<capture-lexical-environment>)
 
 (define-type (<tree-il> #:common-slots (src) #:printer print-tree-il)
   (<fix> names gensyms vals body)
@@ -324,6 +328,9 @@
     ((<dynset> fluid exp)
      `(dynset ,(unparse-tree-il fluid) ,(unparse-tree-il exp)))
 
+    ((<capture-lexical-environment>)
+     '(capture-lexical-environment))
+
     ((<prompt> tag body handler)
      `(prompt ,(unparse-tree-il tag) ,(unparse-tree-il body) ,(unparse-tree-il handler)))
 
@@ -470,6 +477,9 @@
     ((<dynset> fluid exp)
      `(fluid-set! ,(tree-il->scheme fluid) ,(tree-il->scheme exp)))
 
+    ((<capture-lexical-environment>)
+     '(capture-lexical-environment))
+
     ((<prompt> tag body handler)
      `(call-with-prompt
        ,(tree-il->scheme tag)
diff --git a/module/ice-9/psyntax.scm b/module/ice-9/psyntax.scm
index e522f54..d147902 100644
--- a/module/ice-9/psyntax.scm
+++ b/module/ice-9/psyntax.scm
@@ -307,6 +307,14 @@
             (if (not (assq 'name meta))
                 (set-lambda-meta! val (acons 'name name meta))))))
 
+    ;; data type for exporting the compile-type environment
+    ;; FIXME: make this opaque!
+    (define (make-psyntax-env r w mod)
+      (list '<psyntax-env> r w mod))
+    (define psyntax-env:r cadr)
+    (define psyntax-env:w caddr)
+    (define psyntax-env:mod cadddr)
+
     ;; output constructors
     (define build-void
       (lambda (source)
@@ -410,6 +418,9 @@
     (define (build-data src exp)
       (make-const src exp))
 
+    (define (build-capture-lexical-environment src env)
+      (make-capture-lexical-environment src env))
+
     (define build-sequence
       (lambda (src exps)
         (if (null? (cdr exps))
@@ -1786,6 +1797,13 @@
                        (_ (syntax-violation 'quote "bad syntax"
                                             (source-wrap e w s mod))))))
 
+    (global-extend 'core 'capture-lexical-environment
+                   (lambda (e r w s mod)
+                     (syntax-case e ()
+                       ((_) (build-capture-lexical-environment s (make-psyntax-env r w mod)))
+                       (_ (syntax-violation 'quote "bad syntax"
+                                            (source-wrap e w s mod))))))
+
     (global-extend 'core 'syntax
                    (let ()
                      (define gen-syntax
@@ -2395,10 +2413,17 @@
     ;; expanded, and the expanded definitions are also residualized into
     ;; the object file if we are compiling a file.
     (set! macroexpand
-          (lambda* (x #:optional (m 'e) (esew '(eval)))
-            (expand-top-sequence (list x) null-env top-wrap #f m esew
-                                 (cons 'hygiene (module-name (current-module))))))
+          (lambda* (x #:optional (m 'e) (esew '(eval))
+                      #:key (env (make-psyntax-env
+                                  null-env top-wrap
+                                  (cons 'hygiene (module-name (current-module))))))
+            (expand-top-sequence (list x)
+                                 (psyntax-env:r env)  ;; null-env
+                                 (psyntax-env:w env)  ;; top-wrap
+                                 #f
+                                 m
+                                 esew
+                                 (psyntax-env:mod env)))) ;; (cons 'hygiene (module-name (current-module)))
 
     (set! identifier?
           (lambda (x)
-- 
1.7.5.4


--=-=-=--


From MAILER-DAEMON Wed Dec 14 04:10:23 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rakr1-0001ye-7l
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 04:10:23 -0500
Received: from eggs.gnu.org ([140.186.70.92]:38959)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rakqz-0001yO-K7
	for guile-devel@gnu.org; Wed, 14 Dec 2011 04:10:22 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rakqy-0004hj-31
	for guile-devel@gnu.org; Wed, 14 Dec 2011 04:10:21 -0500
Received: from lo.gmane.org ([80.91.229.12]:47837)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rakqx-0004hc-Oh
	for guile-devel@gnu.org; Wed, 14 Dec 2011 04:10:20 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rakqr-0005qH-MH
	for guile-devel@gnu.org; Wed, 14 Dec 2011 10:10:13 +0100
Received: from p508ecc79.dip.t-dialin.net ([80.142.204.121])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 10:10:13 +0100
Received: from dak by p508ecc79.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 10:10:13 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: [PATCH] Implement `capture-lexical-environment' in evaluator
Date: Wed, 14 Dec 2011 10:08:19 +0100
Organization: Organization?!?
Lines: 24
Message-ID: <87ehw7bjwc.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<877h1zo7xx.fsf_-_@netris.org>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ecc79.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:KsGS3mGc3Py789iorMIvhMFn0sU=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 09:10:22 -0000

Mark H Weaver <mhw@netris.org> writes:

> This is a _preliminary_ patch.  In particular:
>
> * The compiler does not yet handle (capture-lexical-environment)
>   (which uses a new tree-il type).
>
> * The lexical environment object is currently non-opaque list structure.
>
> * I deliberately avoided reindenting eval.scm so that the non-whitespace
>   changes would be evident, to make review easier.
>
> * I wouldn't be surprised if `primitive-local-eval' does the wrong thing
>   if (current-module) is different from what it was when the associated
>   `primitive-eval' was called.

I don't know what the right thing would be (the simplest would likely be
to just save the current module along with the rest) and in my previous
use of local-eval, I had no idea what would happen in this case.  But
since my application seemed to work as expected (likely because of not
changing modules), I left worrying about this alone.

-- 
David Kastrup



From MAILER-DAEMON Wed Dec 14 04:37:57 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RalHh-0002Lf-Qy
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 04:37:57 -0500
Received: from eggs.gnu.org ([140.186.70.92]:37485)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RalHf-0002LU-4R
	for guile-devel@gnu.org; Wed, 14 Dec 2011 04:37:55 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RalHZ-0002GU-Jq
	for guile-devel@gnu.org; Wed, 14 Dec 2011 04:37:55 -0500
Received: from world.peace.net ([96.39.62.75]:48759)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>)
	id 1RalHZ-0002GO-Em; Wed, 14 Dec 2011 04:37:49 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RalHT-0000rv-G1; Wed, 14 Dec 2011 04:37:43 -0500
From: Mark H Weaver <mhw@netris.org>
To: Noah Lavine <noah.b.lavine@gmail.com>
Subject: Re: [PATCH] Implement `capture-lexical-environment' in evaluator
References: <87liqtpsl9.fsf@fencepost.gnu.org>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<877h1zo7xx.fsf_-_@netris.org>
Date: Wed, 14 Dec 2011 04:36:09 -0500
In-Reply-To: <877h1zo7xx.fsf_-_@netris.org> (Mark H. Weaver's message of "Wed, 
	14 Dec 2011 03:48:10 -0500")
Message-ID: <8739cno5py.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: Andy Wingo <wingo@pobox.com>, David Kastrup <dak@gnu.org>,
	guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 09:37:56 -0000

Another note: I realize that I shouldn't use `expand-top-sequence' to
restart the expander within a local lexical environment.  At first
glance, I guess I should be using `expand' instead.

Another possibility: if the (capture-lexical-environment) was found
within a body or sequence where local definitions are permitted, restart
using the appropriate expansion function that allows local definitions.
However, I haven't yet determined whether this is feasible given the way
psyntax handles bodies.  For that matter, I haven't decided whether this
would be desirable.

Anyway, now I must sleep.

    Best,
     Mark


From MAILER-DAEMON Wed Dec 14 05:08:58 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Ralli-00039z-D8
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 05:08:58 -0500
Received: from eggs.gnu.org ([140.186.70.92]:38756)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1Rallf-00039s-7o
	for guile-devel@gnu.org; Wed, 14 Dec 2011 05:08:56 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1Ralle-0000qO-3Z
	for guile-devel@gnu.org; Wed, 14 Dec 2011 05:08:55 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:42716
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RallW-0000pr-OL; Wed, 14 Dec 2011 05:08:46 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 353F75F3A;
	Wed, 14 Dec 2011 05:08:46 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=oiVd4us81i4Lh/8PKE0k15tF32A=; b=iHxSQf
	YA9wUe1HNOFPn/xqQ3h3sDm/mxHitY5y6Ym5YdnASk6YbgdyCfviKZaHSBVW5NqP
	oMT52C48M1DAqIY0eVzZvCHhb0WLcrBcSwEfRULgHOC/uIdWM3QJjExdW252qU+f
	snMz+DVmRAFKgGl20biKwiYejyH574xS/6nDk=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=h0rv6NgatLPsO7GaLhL2Qv51tP/0Ixz6
	H/Jv0O4XeMS6SDHVZqIBboVjhNzEHPR5HHlxo1l70rkX1aOZTYdgiJyLL+X3r5Hk
	wHv7/faho+mKnYtpCxTkQKWl9M+vIuDcCxI+ifPE6AeW07EjLBfMhjxALEv3aXqy
	x+wJB1s4Pe4=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 2E15D5F39;
	Wed, 14 Dec 2011 05:08:46 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 8E87E5F38;
	Wed, 14 Dec 2011 05:08:45 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Mark H Weaver <mhw@netris.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
Date: Wed, 14 Dec 2011 11:08:41 +0100
In-Reply-To: <87borboalb.fsf@netris.org> (Mark H. Weaver's message of "Wed,
	14 Dec 2011 02:50:56 -0500")
Message-ID: <87liqf5uty.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 9BD6B5C0-263B-11E1-B9BE-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: David Kastrup <dak@gnu.org>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 10:08:56 -0000

On Wed 14 Dec 2011 08:50, Mark H Weaver <mhw@netris.org> writes:

> I have successfully implemented the (capture-lexical-environment)
> special form in the evaluator, and also primitive-local-eval.

I dunno, Mark.  That's a neat hack, but why should we have it in Guile?
It can't compile.  It's not for efficiency, because if you wanted more
efficiency, you would compile.  So what is it for?  It has a cost, so it
needs to justify itself.

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Wed Dec 14 05:15:20 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Ralrs-00045d-50
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 05:15:20 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52225)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1Ralrq-00045X-80
	for guile-devel@gnu.org; Wed, 14 Dec 2011 05:15:19 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1Ralrk-00027G-LJ
	for guile-devel@gnu.org; Wed, 14 Dec 2011 05:15:18 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:49850
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1Ralri-00026o-DB; Wed, 14 Dec 2011 05:15:10 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 33F6B5FBA;
	Wed, 14 Dec 2011 05:15:10 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=zFFEHW2wxdjjUJkKm7OdEQQky18=; b=r2c2sI
	tgApMZn8Yplwv+goTCyH3UOcQvF4Hc3N3McdTTZ7E1/roA3awK97seICO9Ejac0M
	FT2U4LmDvN/e7SBnWOtbKor5l5a31YaI6/7VX2BBr4AjZb15oY4asHbozuq9av3s
	ev6wetRSxUJ4PC4mgk2W3+crbsUfzQ1M33wEU=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=TxYCv1a/jlodVHv8C0IVLksMze7kALlk
	T6haSMLFSqnH553SgludU9MkD8Ec0pkgjm0JSpkuskOTjDvoMfgIxVHvXLa1u9A0
	1W94aCKU9H2BM4zY2GHG9Y0zcQ0/jaL0+KLrdGYDcH+Dh6FIn7VJYg+SIgOmwh9E
	ulCBhBKu4BE=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 2C02B5FB9;
	Wed, 14 Dec 2011 05:15:10 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 761255FB7;
	Wed, 14 Dec 2011 05:15:08 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87borc9h3a.fsf@pobox.com> <87zkewavds.fsf@fencepost.gnu.org>
Date: Wed, 14 Dec 2011 11:15:04 +0100
In-Reply-To: <87zkewavds.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Wed, 14 Dec 2011 00:45:35 +0100")
Message-ID: <87hb135ujb.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 80109940-263C-11E1-8398-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 10:15:19 -0000

On Wed 14 Dec 2011 00:45, David Kastrup <dak@gnu.org> writes:

> Andy Wingo <wingo@pobox.com> writes:
>
>> On Wed 14 Dec 2011 00:00, Noah Lavine <noah.b.lavine@gmail.com> writes:
>>
>>> I haven't really been contributing to this thread, so please take my
>>> opinion with a grain of salt. But it does appear to me that we should
>>> support capturing a lexical environment, as Mark and David describe.
>>>
>>> So I took a look at ice-9/eval.scm....
>>
>> There is a compiler too.
>
> Lilypond calls eval on the # and $ scraps (though I don't know whether
> that would be ice-9 or not).  Actually, I have no idea what else it
> could call.

It could call `compile', in 2.0.  It probably doesn't want to though.

It sounds a bit academic, but this is not a moot point: as things are
now, one can replace any call to `eval' with `compile'.  Or, replace the
implementation of `eval' with `compile'.  I suppose local-eval would be
a different beast, though.

Regards,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Wed Dec 14 05:33:05 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Ram93-00007C-CK
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 05:33:05 -0500
Received: from eggs.gnu.org ([140.186.70.92]:34865)
	by lists.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1Ram8x-00006X-Fe
	for guile-devel@gnu.org; Wed, 14 Dec 2011 05:33:03 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dak@gnu.org>) id 1Ram8v-0005dQ-Su
	for guile-devel@gnu.org; Wed, 14 Dec 2011 05:32:59 -0500
Received: from fencepost.gnu.org ([140.186.70.10]:39623)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1Ram8v-0005dG-RU
	for guile-devel@gnu.org; Wed, 14 Dec 2011 05:32:57 -0500
Received: from localhost ([127.0.0.1]:49542 helo=lola)
	by fencepost.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dak@gnu.org>)
	id 1Ram8v-0002RH-92; Wed, 14 Dec 2011 05:32:57 -0500
Received: by lola (Postfix, from userid 1000)
	id 5A951E5F55; Wed, 14 Dec 2011 11:32:02 +0100 (CET)
From: David Kastrup <dak@gnu.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87borc9h3a.fsf@pobox.com> <87zkewavds.fsf@fencepost.gnu.org>
	<87hb135ujb.fsf@pobox.com>
Date: Wed, 14 Dec 2011 11:32:02 +0100
In-Reply-To: <87hb135ujb.fsf@pobox.com> (Andy Wingo's message of "Wed, 14 Dec
	2011 11:15:04 +0100")
Message-ID: <8739cnbg0t.fsf@fencepost.gnu.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 140.186.70.10
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 10:33:03 -0000

Andy Wingo <wingo@pobox.com> writes:

> On Wed 14 Dec 2011 00:45, David Kastrup <dak@gnu.org> writes:
>
>> Andy Wingo <wingo@pobox.com> writes:
>>
>>> On Wed 14 Dec 2011 00:00, Noah Lavine <noah.b.lavine@gmail.com> writes:
>>>
>>>> I haven't really been contributing to this thread, so please take my
>>>> opinion with a grain of salt. But it does appear to me that we should
>>>> support capturing a lexical environment, as Mark and David describe.
>>>>
>>>> So I took a look at ice-9/eval.scm....
>>>
>>> There is a compiler too.
>>
>> Lilypond calls eval on the # and $ scraps (though I don't know whether
>> that would be ice-9 or not).  Actually, I have no idea what else it
>> could call.
>
> It could call `compile', in 2.0.  It probably doesn't want to though.
>
> It sounds a bit academic, but this is not a moot point: as things are
> now, one can replace any call to `eval' with `compile'.

When would that be an advantage?  I could imagine compiling a loop makes
sense, but for most things evaluated once, the effort of compiling would
not appear to offset the savings.

-- 
David Kastrup


From MAILER-DAEMON Wed Dec 14 05:33:06 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Ram94-0000BS-H2
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 05:33:06 -0500
Received: from eggs.gnu.org ([140.186.70.92]:34867)
	by lists.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1Ram8x-00006Y-HU
	for guile-devel@gnu.org; Wed, 14 Dec 2011 05:33:05 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dak@gnu.org>) id 1Ram8w-0005dY-3h
	for guile-devel@gnu.org; Wed, 14 Dec 2011 05:32:59 -0500
Received: from fencepost.gnu.org ([140.186.70.10]:39626)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1Ram8v-0005dU-Vi
	for guile-devel@gnu.org; Wed, 14 Dec 2011 05:32:57 -0500
Received: from localhost ([127.0.0.1]:49543 helo=lola)
	by fencepost.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dak@gnu.org>)
	id 1Ram8v-0002RI-8b; Wed, 14 Dec 2011 05:32:57 -0500
Received: by lola (Postfix, from userid 1000)
	id D1546E5092; Wed, 14 Dec 2011 11:27:51 +0100 (CET)
From: David Kastrup <dak@gnu.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com>
Date: Wed, 14 Dec 2011 11:27:51 +0100
In-Reply-To: <87liqf5uty.fsf@pobox.com> (Andy Wingo's message of "Wed, 14 Dec
	2011 11:08:41 +0100")
Message-ID: <877h1zbg7s.fsf@fencepost.gnu.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 140.186.70.10
Cc: Mark H Weaver <mhw@netris.org>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 10:33:05 -0000

Andy Wingo <wingo@pobox.com> writes:

> On Wed 14 Dec 2011 08:50, Mark H Weaver <mhw@netris.org> writes:
>
>> I have successfully implemented the (capture-lexical-environment)
>> special form in the evaluator, and also primitive-local-eval.
>
> I dunno, Mark.  That's a neat hack, but why should we have it in Guile?
> It can't compile.  It's not for efficiency, because if you wanted more
> efficiency, you would compile.

Most of the multi-list commands in srfi-1 have awful performance
implications once you give them more than a single list.  And you can
usually create more efficient equivalent code manually for most
non-generic uses of them.  So they are obviously not in there for
efficiency, but rather feature completeness and user friendliness.

> So what is it for?  It has a cost, so it needs to justify itself.

It is a trade-off.  The reason to include it in Guile rather than
providing it as an external package is because it depends on internals
of Guile, and thus needs to be maintained along with it.

Is the expected cost of maintenance worth the gain in Guile's
attractiveness?  A more thorough solution that would actually cooperate
with the compiler would likely be more attractive, and more prone to
maintenance.

But it would also likely serve to hold open the architecture for future
developments or plugins that could be interesting for integrating Guile
into other language systems like Emacs Lisp (which is only very slowly
moving towards lexical bindings) or Lua or other binding-intensive
systems.  Language interfaces that are not strictly ad-hoc and
closed-door would certainly help in keeping Guile interesting for
applications where the respective maintainers don't have to count on the
continued cooperation of Guile developers, but merely on the continued
existence of published interfaces.

I can't judge the best trade-off point here.  Nor how complex it would
be to actually work with the compiler, and be reasonably confident that
it will continue to work without too much hassle in future.

But an outside package meddling with undocumented internals is not safe
to rely on at all.  It can break at any point of time with no active
Guile developer being in a position where he would feel compelled to fix
it for the sake of Guile.

-- 
David Kastrup


From MAILER-DAEMON Wed Dec 14 06:05:34 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RameU-0006tj-EX
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 06:05:34 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52766)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RameO-0006rT-70
	for guile-devel@gnu.org; Wed, 14 Dec 2011 06:05:32 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RameL-0006aD-VG
	for guile-devel@gnu.org; Wed, 14 Dec 2011 06:05:28 -0500
Received: from world.peace.net ([96.39.62.75]:57016)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>)
	id 1RameL-0006Zy-Qs; Wed, 14 Dec 2011 06:05:25 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RameG-00013M-MN; Wed, 14 Dec 2011 06:05:20 -0500
From: Mark H Weaver <mhw@netris.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com>
Date: Wed, 14 Dec 2011 06:03:51 -0500
In-Reply-To: <87liqf5uty.fsf@pobox.com> (Andy Wingo's message of "Wed, 14 Dec
	2011 11:08:41 +0100")
Message-ID: <87vcpjmn3c.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: David Kastrup <dak@gnu.org>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 11:05:32 -0000

Andy Wingo <wingo@pobox.com> writes:
> On Wed 14 Dec 2011 08:50, Mark H Weaver <mhw@netris.org> writes:
>
>> I have successfully implemented the (capture-lexical-environment)
>> special form in the evaluator, and also primitive-local-eval.
>
> I dunno, Mark.  That's a neat hack, but why should we have it in Guile?
> It can't compile.  It's not for efficiency, because if you wanted more
> efficiency, you would compile.  So what is it for?  It has a cost, so it
> needs to justify itself.

For starters, it's for handling languages like Lilypond, which
fundamentally _cannot_ be compiled.  It's not a question of
implementation strategy.  Even if someone were willing to rewrite
Lilypond's implementation from scratch, I have become convinced that it
cannot be compiled without redesigning the language itself.

More generally, it's to increase the generality and flexibility of
Guile.  One of the things I like most about Scheme is that it is
powerful enough to implement just about anything on top of it, using
just about any strategy you wish, in a simple, straightforward manner,
thanks to advanced features like macros and continuations.

I found it somewhat embarrassing that Guile 2.0 was unable to gracefully
support a language that Guile 1.8 handled beautifully.  I would like to
fix that.

Also, I think that it is crucially important to keep the Lilypond
developers happy with Guile.  We don't have very many users.  We should
make an effort to keep our existing users happy.

      Mark


From MAILER-DAEMON Wed Dec 14 06:18:22 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Ramqs-0004Ob-Sw
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 06:18:22 -0500
Received: from eggs.gnu.org ([140.186.70.92]:35542)
	by lists.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1Ramqk-0004MQ-SM
	for guile-devel@gnu.org; Wed, 14 Dec 2011 06:18:21 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dak@gnu.org>) id 1Ramqe-0000Op-WC
	for guile-devel@gnu.org; Wed, 14 Dec 2011 06:18:14 -0500
Received: from fencepost.gnu.org ([140.186.70.10]:41128)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1Ramqe-0000Og-Qn
	for guile-devel@gnu.org; Wed, 14 Dec 2011 06:18:08 -0500
Received: from localhost ([127.0.0.1]:51048 helo=lola)
	by fencepost.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dak@gnu.org>)
	id 1Ramqe-0005QD-0K; Wed, 14 Dec 2011 06:18:08 -0500
Received: by lola (Postfix, from userid 1000)
	id 626B1E5092; Wed, 14 Dec 2011 12:18:07 +0100 (CET)
From: David Kastrup <dak@gnu.org>
To: Mark H Weaver <mhw@netris.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com> <87vcpjmn3c.fsf@netris.org>
Date: Wed, 14 Dec 2011 12:18:07 +0100
In-Reply-To: <87vcpjmn3c.fsf@netris.org> (Mark H. Weaver's message of "Wed, 14
	Dec 2011 06:03:51 -0500")
Message-ID: <87liqf9zbk.fsf@fencepost.gnu.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 140.186.70.10
Cc: Andy Wingo <wingo@pobox.com>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 11:18:21 -0000

Mark H Weaver <mhw@netris.org> writes:

> Also, I think that it is crucially important to keep the Lilypond
> developers happy with Guile.  We don't have very many users.  We
> should make an effort to keep our existing users happy.

Basically, you want to be able to write the following in the FAQ:

Q:
Why should I be picking GUILE instead of other Scheme systems for
extending my application that is supposed to expose a user-friendly
language?
A:
Because no other Scheme system, in fact no other system, offers the
tools for integrating your language so tightly with Scheme that you can
harness its power without having to forego the advantages and features
of your own language design.  GUILE supports implementations of Emacs
Lisp, Lua (and also LilyPond) that rely on advertised interfaces rather
than on special-tailored code meddling with GUILE's internals, and that
make it easy to access the power of Scheme transparently without losing
expressivity in the main user language of your system.

-- 
David Kastrup


From MAILER-DAEMON Wed Dec 14 06:44:46 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RanGQ-0002UL-9m
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 06:44:46 -0500
Received: from eggs.gnu.org ([140.186.70.92]:47959)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RanGL-0002UE-4t
	for guile-devel@gnu.org; Wed, 14 Dec 2011 06:44:44 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RanGK-0006yC-0C
	for guile-devel@gnu.org; Wed, 14 Dec 2011 06:44:41 -0500
Received: from mail-vw0-f41.google.com ([209.85.212.41]:48241)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RanGJ-0006y5-Rv
	for guile-devel@gnu.org; Wed, 14 Dec 2011 06:44:39 -0500
Received: by vbbfn1 with SMTP id fn1so626345vbb.0
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 03:44:38 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:content-type; bh=nDsEfHCoVMSA0vQuMamWSGMbRKu3Il4a3zU4NTGFpeE=;
	b=X5ljSxY3lYSNhK6ueCHtsioGCmGjPzkHEWjiTR8PE9eU7eoUPO7v56jv6IuQ+YzmAB
	9iudbDdoVvtN7Ok+u75mvQTbPnh9pBr1yYts+9Qa46PDOmfKM3jGhbtN9jwHLVZnj3+f
	aMoY2v0LR9mEkzwDYdNT20eZOjGDlxUQehYSM=
MIME-Version: 1.0
Received: by 10.52.20.209 with SMTP id p17mr3962526vde.60.1323863078603; Wed,
	14 Dec 2011 03:44:38 -0800 (PST)
Received: by 10.52.31.165 with HTTP; Wed, 14 Dec 2011 03:44:38 -0800 (PST)
In-Reply-To: <87bormotr9.fsf@pobox.com>
References: <1311003284.3054.79.camel@Renee-desktop>
	<1311213723.3136.5.camel@Renee-desktop> <87vctzdo7o.fsf@pobox.com>
	<CAPjoZofZP39k_ZBhR2PFCrRTHwQMJV8vOLaiWZ35B75USf4XmA@mail.gmail.com>
	<87bovpepoj.fsf@pobox.com> <87bormotr9.fsf@pobox.com>
Date: Wed, 14 Dec 2011 19:44:38 +0800
Message-ID: <CAPjoZoeyJWuxbx9d1z8uEZ_2gKd_J0S79t93Fy9v0hV1e9_ZKA@mail.gmail.com>
Subject: Re: guildhall update complain connection timeout
From: Nala Ginrut <nalaginrut@gmail.com>
To: Andy Wingo <wingo@pobox.com>, guile-devel <guile-devel@gnu.org>
Content-Type: multipart/alternative; boundary=20cf307d05cc880a1b04b40be470
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.212.41
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 11:44:45 -0000

--20cf307d05cc880a1b04b40be470
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 6, 2011 at 6:54 PM, Andy Wingo <wingo@pobox.com> wrote:

> Hello Nala :)
>
>
> Did you find an answer here?
>
> We will need to change our assumptions if there are no ISO-8859-1
> converters on a fresh Chinese Ubuntu install.
>
>
I confess I can not point what's the real issue for this problem since
there're less people here using Ubuntu. Moreover, few
Chinese guilers here too. So I haven't collected  sufficient information to
determine what's going on.
Anyway, I think I can provide a way to help Chinese guilers to fix the
"guildhall update halt problem". Hope there'll be some new comers help me
collect more information to fix this.

Thanks Andy!
Please do whatever further for guildhall if you want to.
I believe it's not the best time to get a conclusion for this problem. So
let's ignore it temporary. I'll raise a new discussion if I get new
information for this problem.

--20cf307d05cc880a1b04b40be470
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<br><div class=3D"gmail_quote">On Tue, Dec 6, 2011 at 6:54 PM, Andy Wingo <=
span dir=3D"ltr">&lt;<a href=3D"mailto:wingo@pobox.com">wingo@pobox.com</a>=
&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0=
 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
Hello Nala :)<br>
<div><div class=3D"h5"><br><br>
</div></div>Did you find an answer here?<br>
<br>
We will need to change our assumptions if there are no ISO-8859-1<br>
converters on a fresh Chinese Ubuntu install.<br>
<span class=3D"HOEnZb"><font color=3D"#888888"><br></font></span></blockquo=
te><div><br></div><div>I confess I can not point what&#39;s the real issue =
for this problem since there&#39;re less people here using Ubuntu. Moreover=
, few</div>
<div>Chinese guilers here too. So I haven&#39;t collected =C2=A0sufficient =
information to determine what&#39;s going on.</div><div>Anyway, I think I c=
an provide a way to help Chinese guilers to fix the &quot;guildhall update =
halt problem&quot;. Hope there&#39;ll be some new comers help me collect mo=
re information to fix this.</div>
<div><br></div><div>Thanks Andy!</div><div>Please do whatever further for g=
uildhall if you want to.=C2=A0</div><div>I believe it&#39;s not the best ti=
me to get a conclusion for this problem. So let&#39;s ignore it=C2=A0tempor=
ary. I&#39;ll raise a new=C2=A0discussion=C2=A0if I get new information for=
 this problem.=C2=A0</div>
</div>

--20cf307d05cc880a1b04b40be470--


From MAILER-DAEMON Wed Dec 14 08:31:59 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaowB-0005zv-3B
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 08:31:59 -0500
Received: from eggs.gnu.org ([140.186.70.92]:46191)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1Raow8-0005vs-FI
	for guile-devel@gnu.org; Wed, 14 Dec 2011 08:31:57 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1Raow4-0006aB-Fd
	for guile-devel@gnu.org; Wed, 14 Dec 2011 08:31:56 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:62965)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>)
	id 1Raovw-0006ZF-HO; Wed, 14 Dec 2011 08:31:44 -0500
Received: by iahk25 with SMTP id k25so1554503iah.0
	for <multiple recipients>; Wed, 14 Dec 2011 05:31:43 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:sender:in-reply-to:references:date
	:x-google-sender-auth:message-id:subject:from:to:cc:content-type;
	bh=5hNdh29M9TVFZlsejDouY5lbnLP4H1tS/gu24zpqPKk=;
	b=RwjSi3atZJPPqBLtTUEokID9lKo2hF7kU7ECFcZd2XjueOJGUAlu5YUyGwHeOhcTtr
	ZaCfVhLjDES3IUroqTOfLzCcYV5oc4MsW1ykqK6/1oy9PFOPpnI8fLqpeIrkJAdUn7im
	BMNAoGr+sBAoanZkp6/GFZRJk5jcmahj9Ublk=
MIME-Version: 1.0
Received: by 10.50.156.129 with SMTP id we1mr24497231igb.60.1323869502292;
	Wed, 14 Dec 2011 05:31:42 -0800 (PST)
Sender: noah549@gmail.com
Received: by 10.42.217.6 with HTTP; Wed, 14 Dec 2011 05:31:41 -0800 (PST)
In-Reply-To: <87vcpjmn3c.fsf@netris.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com> <87vcpjmn3c.fsf@netris.org>
Date: Wed, 14 Dec 2011 08:31:41 -0500
X-Google-Sender-Auth: Q32Is6gOJi9tA1LnH3Ey6nz7E3M
Message-ID: <CA+U71=Oq84Y5359NJA_LejvxU2y7hGWH3CNgmwOr4z1Vp3FDEw@mail.gmail.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
From: Noah Lavine <noah.b.lavine@gmail.com>
To: Mark H Weaver <mhw@netris.org>
Content-Type: text/plain; charset=ISO-8859-1
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
Cc: Andy Wingo <wingo@pobox.com>, David Kastrup <dak@gnu.org>,
	guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 13:31:57 -0000

Perhaps this is obvious to everyone else, but it just occurred to me
that (capture-local-environment) is just
(call-with-current-continuation), but running in the environment of
the evaluator instead of the program being evaluated. It's as though
the evaluator was going to look in a tree for more code, but hit a
special node and did a (call/cc). I hope other people find this
interesting.

Good morning,
Noah


From MAILER-DAEMON Wed Dec 14 08:35:26 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaozW-0006Hm-Pf
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 08:35:26 -0500
Received: from eggs.gnu.org ([140.186.70.92]:60925)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaozQ-0006Go-On
	for guile-devel@gnu.org; Wed, 14 Dec 2011 08:35:25 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaozK-0007ZB-VH
	for guile-devel@gnu.org; Wed, 14 Dec 2011 08:35:20 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:38467
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RaozE-0007Wt-CA; Wed, 14 Dec 2011 08:35:08 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 9CCB76FFA;
	Wed, 14 Dec 2011 08:35:07 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=IN2M/T/Z1LG/WAgYL7EG6v1Vbr8=; b=xtRSiq
	aLjcc6MVOtE0/v3NXGjUNt+eT9mCynjTk+YstG1Ck0uwp+9mEK6XRhSrxH6AI1Q/
	Xo9Gm85LnMzNUnZRYhN+eAccSGqr9Oz4IpY5m+TczCmbSZho04LwK4z4nEcEaYnN
	LTzsGTNolPy0iqGXeRjGYHlTGLJ5hR+XUnTSY=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=A8IiJTSLLKHX84QSo6xV1fXBiR5L7Leb
	MWQs6ngGp2N0gsIPsc/T0GP+BGkb1a7ASuUiZJkOGgSqVKY7Lx3I9GTbcN1uy6F6
	ZYWXALiLguJnIBzbs09wr94uXSySop5CPuZHbUx3kAr+Vs7HWk7uDItfTpkfjhPo
	vDkka/uvDXM=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 8B7F06FF9;
	Wed, 14 Dec 2011 08:35:07 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id C6C026FF8;
	Wed, 14 Dec 2011 08:35:05 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com> <877h1zbg7s.fsf@fencepost.gnu.org>
Date: Wed, 14 Dec 2011 14:35:01 +0100
In-Reply-To: <877h1zbg7s.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Wed, 14 Dec 2011 11:27:51 +0100")
Message-ID: <8739cn5la2.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 6F0805CC-2658-11E1-B840-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: Mark H Weaver <mhw@netris.org>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 13:35:25 -0000

Hi David,

On Wed 14 Dec 2011 11:27, David Kastrup <dak@gnu.org> writes:

> Andy Wingo <wingo@pobox.com> writes:
>
>> On Wed 14 Dec 2011 08:50, Mark H Weaver <mhw@netris.org> writes:
>>
>>> I have successfully implemented the (capture-lexical-environment)
>>> special form in the evaluator, and also primitive-local-eval.

Let's call it `(the-environment)', as it is what it was called in Guile
1.8.

>> why should we have it in Guile?
>
> feature completeness and user friendliness.

OK, so we are not arguing for efficiency then.  (That's fine, but we
should be clear about it.)

> Emacs Lisp or Lua or other binding-intensive systems.

`the-environment' is not useful for Elisp or Lua.  We already have an OK
Elisp implementation, and it will be quite good once bipt merges his
branch.  It is implemented as a compiler to tree-il.  Likewise there is
a branch for Lua.  It has some issues, but not unsolveable, and not
related to this question.  It is also implemented as a compiler to
tree-il.

> Language interfaces that are not strictly ad-hoc and closed-door would
> certainly help in keeping Guile interesting for applications where the
> respective maintainers don't have to count on the continued
> cooperation of Guile developers, but merely on the continued existence
> of published interfaces.

Indeed.

> But an outside package meddling with undocumented internals is not safe
> to rely on at all.  It can break at any point of time with no active
> Guile developer being in a position where he would feel compelled to fix
> it for the sake of Guile.

I agree.

I agree also that Guile should do its best to be good for lilypond.

It is my opinion -- and I could be wrong here, either by
misunderstanding (again!) the issues, or for whatever reason -- that
closures are the best solution to the #{#} problem.

Reasons:

  * Lambda is standard, well-understood, and general.

  * Using `lambda' does not preclude compilation.

  * Using closures does not require any additional work on the part of
    Guile.  (This is only partly selfish; it also decreases the amount
    of coupling of lilypond to any particular Guile version.)

  * Allows for integration with the debugger, in 2.0.  (Currently,
    interpreted code does not debug well.)

  * Potentially more efficient, and will benefit from future speed
    improvements in Guile.

WDYT?

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Wed Dec 14 08:52:44 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RapGG-0007Uw-6X
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 08:52:44 -0500
Received: from eggs.gnu.org ([140.186.70.92]:54650)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RapGA-0007U1-Pt
	for guile-devel@gnu.org; Wed, 14 Dec 2011 08:52:42 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RapG5-0002o2-8Q
	for guile-devel@gnu.org; Wed, 14 Dec 2011 08:52:38 -0500
Received: from lo.gmane.org ([80.91.229.12]:34974)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RapG5-0002nw-1N
	for guile-devel@gnu.org; Wed, 14 Dec 2011 08:52:33 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RapG3-0001oV-QD
	for guile-devel@gnu.org; Wed, 14 Dec 2011 14:52:31 +0100
Received: from reverse-83.fdn.fr ([80.67.176.83])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 14:52:31 +0100
Received: from ludo by reverse-83.fdn.fr with local (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 14:52:31 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Wed, 14 Dec 2011 14:52:19 +0100
Lines: 21
Message-ID: <87wr9zntv0.fsf@gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: reverse-83.fdn.fr
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 24 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:eWxS24IJsG1PodpdovGEeMR3ZMg=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 13:52:42 -0000

Hello!

Andy Wingo <wingo@pobox.com> skribis:

> But, in the event that David wants to continue with his current
> strategy, there are other things that can be done.  David, did you know
> that Guile's evaluator is implemented in Scheme?  That means that if you
> want an evaluator with different semantics -- for example, something
> closer to Kernel[0], as David appears to want -- then you can implement
> an evaluator that provides for fexprs and the like, and it will run
> about as well as Guile's evaluator.

Indeed.  FWIW, Skribilo [0] has its own input language, which is similar
to but different from Scheme, so it has its own reader and its own
evaluator, the latter being mostly a wrapper around ‘eval’.  This
strategy has worked well, and portably between 1.8 and 2.0.

Thanks,
Ludo’.

[0] http://nongnu.org/skribilo/



From MAILER-DAEMON Wed Dec 14 09:28:16 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rapoe-0005p5-FB
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 09:28:16 -0500
Received: from eggs.gnu.org ([140.186.70.92]:38197)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RapoY-0005nl-IQ
	for guile-devel@gnu.org; Wed, 14 Dec 2011 09:28:15 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RapoT-0003O0-Hu
	for guile-devel@gnu.org; Wed, 14 Dec 2011 09:28:10 -0500
Received: from lo.gmane.org ([80.91.229.12]:51442)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RapoT-0003Np-4S
	for guile-devel@gnu.org; Wed, 14 Dec 2011 09:28:05 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RapoQ-0003Ho-ND
	for guile-devel@gnu.org; Wed, 14 Dec 2011 15:28:02 +0100
Received: from p508ecc79.dip.t-dialin.net ([80.142.204.121])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 15:28:02 +0100
Received: from dak by p508ecc79.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 15:28:02 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Wed, 14 Dec 2011 15:27:45 +0100
Organization: Organization?!?
Lines: 37
Message-ID: <87y5uf8bz2.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87wr9zntv0.fsf@gnu.org>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ecc79.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:zYG+5702PCMoUCYARd6gCnYRRnQ=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 14:28:15 -0000

ludo@gnu.org (Ludovic Courtès) writes:

> Andy Wingo <wingo@pobox.com> skribis:
>
>> But, in the event that David wants to continue with his current
>> strategy, there are other things that can be done.  David, did you know
>> that Guile's evaluator is implemented in Scheme?  That means that if you
>> want an evaluator with different semantics -- for example, something
>> closer to Kernel[0], as David appears to want -- then you can implement
>> an evaluator that provides for fexprs and the like, and it will run
>> about as well as Guile's evaluator.
>
> Indeed.  FWIW, Skribilo [0] has its own input language, which is similar
> to but different from Scheme, so it has its own reader and its own
> evaluator, the latter being mostly a wrapper around ‘eval’.  This
> strategy has worked well, and portably between 1.8 and 2.0.

There is a saying "a real FORTRAN programmer can write FORTRAN programs
in any language".  But one of the principal attractions of implementing
a Scheme-like language in Scheme is that one can _turn_ Scheme into
one's target language instead of merely using it as an implementation
language.

In contrast, you usually don't implement a C-like language by
manipulating your C compiler (some template libraries may come close),
and you usually do not even want to bootstrap a FORTRAN compiler on
FORTRAN.

And in particular for something like Emacs Lisp, it would be quite more
interesting to turn GUILE into Emacs Lisp rather than implement Elisp on
top of it.  I have not actually looked at the respective code bases.
That's just a gut feeling of what would be cool, and also provide a user
experience that is not purely either/or regarding what layer one is
working in.

-- 
David Kastrup



From MAILER-DAEMON Wed Dec 14 09:28:37 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rapoz-0005y7-Hf
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 09:28:37 -0500
Received: from eggs.gnu.org ([140.186.70.92]:38289)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rapos-0005wW-T0
	for guile-devel@gnu.org; Wed, 14 Dec 2011 09:28:36 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rapom-0003R9-JT
	for guile-devel@gnu.org; Wed, 14 Dec 2011 09:28:30 -0500
Received: from lo.gmane.org ([80.91.229.12]:51536)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rapom-0003Qz-AW
	for guile-devel@gnu.org; Wed, 14 Dec 2011 09:28:24 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rapol-0003S5-MX
	for guile-devel@gnu.org; Wed, 14 Dec 2011 15:28:23 +0100
Received: from reverse-83.fdn.fr ([80.67.176.83])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 15:28:23 +0100
Received: from ludo by reverse-83.fdn.fr with local (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 15:28:23 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
Subject: Re: SRFI 41 for Guile
Date: Wed, 14 Dec 2011 15:28:07 +0100
Lines: 39
Message-ID: <877h1zns7c.fsf@gnu.org>
References: <20111206193728.GB14416@yarrow.destinee.acro.gen.nz>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: reverse-83.fdn.fr
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 24 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:VbzIFPT2xWyzEeZ+KrU5I4RbwnQ=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 14:28:36 -0000

Hello!

"Chris K. Jester-Young" <cky944@gmail.com> skribis:

> Just writing to say that after many months of being busy with other
> stuff, I finally got around to finishing my Guile port of SRFI 41:
>
> https://github.com/cky/guile2-modules

Nice, thank you!

Could you integrate it in the Guile tree in a branch, as you proposed on
IRC?  It would make it easier to review it.

What you be OK with assigning copyright for your changes to the FSF?

Also, to what extent is the reference implementation modified?  If the
modifications are well isolated, it would be nice to see if we could
import the upstream files unmodified, and then just “patch” them at
compile-time as is done for match.scm, sxml-match.scm, lalr, and a few
others.

Likewise, it may be possible to adapt the original test suite just by
defining macros that map the expected test suite API to Guile’s.

The idea is that it would make it easier to see how Guile’s
implementation differs from upstream, and to update Guile’s copy
eventually, if needed.

What do you think?

Also, what about moving all or most of the code in srfi-41.scm, instead
of having several helper modules?

(This has been partly discussed on IRC while I was writing this
message; I hope it’s still relevant.  ;-))

Thanks,
Ludo’.



From MAILER-DAEMON Wed Dec 14 09:41:32 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Raq1U-0001qT-BG
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 09:41:32 -0500
Received: from eggs.gnu.org ([140.186.70.92]:35959)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Raq1R-0001nu-V8
	for guile-devel@gnu.org; Wed, 14 Dec 2011 09:41:30 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Raq1M-0007Hr-29
	for guile-devel@gnu.org; Wed, 14 Dec 2011 09:41:29 -0500
Received: from lo.gmane.org ([80.91.229.12]:36840)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Raq1L-0007Hf-RV
	for guile-devel@gnu.org; Wed, 14 Dec 2011 09:41:24 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1Raq1D-0001nk-LR
	for guile-devel@gnu.org; Wed, 14 Dec 2011 15:41:15 +0100
Received: from reverse-83.fdn.fr ([80.67.176.83])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 15:41:15 +0100
Received: from ludo by reverse-83.fdn.fr with local (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 15:41:15 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
Subject: Re: extensibility, compatible changes, and ocap security
Date: Wed, 14 Dec 2011 15:41:02 +0100
Lines: 30
Message-ID: <87k45zmd1d.fsf@gnu.org>
References: <87iploi8pe.fsf@pobox.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: reverse-83.fdn.fr
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 24 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:mYwupUgDoXYPbj8CnUbBBGoMOSs=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 14:41:31 -0000

Hello!

Andy Wingo <wingo@pobox.com> skribis:

> However, this effectively gives another /capability/ to anyone that has
> access to the previously idempotent `current-input-port' procedure:
> namely, the ability to change the current input port.  The question is,
> can we make this change in the default Guile?

There were 2 potential issues with making ‘current-input-port’ &
co. parameters:

  1. One could have provided a non-input-port object, which would have
     led to a segfault somewhere.  Fortunately, the SRFI-39 parameter
     setters now in boot-9 type-check ‘current-input-port’ & co.

  2. Adding the ability to modify the input port through the parameter.
     In actuality, this is not an addition, since
     ‘set-current-input-port!’ & co. have always been visible in the
     default environment anyway.

IOW, I think making ‘current-input-port’ & co. SRFI-39 parameters was
harmless.

(On a more philosophical note, dynamically-bound capabilities like these
are Considered Harmful™ as mentioned in Section 3.4 of Rees’ “A Security
Kernel Based on the Lambda Calculus”.  ;-))

Thanks,
Ludo’.



From MAILER-DAEMON Wed Dec 14 10:22:10 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Raqeo-0002SU-L5
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 10:22:10 -0500
Received: from eggs.gnu.org ([140.186.70.92]:37801)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Raqem-0002SO-5e
	for guile-devel@gnu.org; Wed, 14 Dec 2011 10:22:09 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Raqeh-0000Mp-Ny
	for guile-devel@gnu.org; Wed, 14 Dec 2011 10:22:08 -0500
Received: from lo.gmane.org ([80.91.229.12]:46013)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Raqeh-0000Mh-7o
	for guile-devel@gnu.org; Wed, 14 Dec 2011 10:22:03 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1Raqea-0000Ke-Mk
	for guile-devel@gnu.org; Wed, 14 Dec 2011 16:21:56 +0100
Received: from p508ecc79.dip.t-dialin.net ([80.142.204.121])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 16:21:56 +0100
Received: from dak by p508ecc79.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 16:21:56 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Wed, 14 Dec 2011 16:21:33 +0100
Organization: Organization?!?
Lines: 68
Message-ID: <87mxav89he.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com> <877h1zbg7s.fsf@fencepost.gnu.org>
	<8739cn5la2.fsf@pobox.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ecc79.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:hHholit871QzCnKG11xBVR8Wd+w=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 15:22:09 -0000

Andy Wingo <wingo@pobox.com> writes:

> It is my opinion -- and I could be wrong here, either by
> misunderstanding (again!) the issues, or for whatever reason -- that
> closures are the best solution to the #{#} problem.
>
> Reasons:
>
>   * Lambda is standard, well-understood, and general.

Well, if they are standard, what benefits does using GUILE give us?

>   * Using `lambda' does not preclude compilation.
>
>   * Using closures does not require any additional work on the part of
>     Guile.  (This is only partly selfish; it also decreases the amount
>     of coupling of lilypond to any particular Guile version.)

Any particular Scheme version.

>   * Allows for integration with the debugger, in 2.0.  (Currently,
>     interpreted code does not debug well.)

Sounds like putting the cart before the horse.  After all,
interpretative environments offer a lot of potential to be _better_ for
debugging than compiled code.  One should not lightly waste this.  In
particular since macro expansion is basically an interpretative
operation and macros are among the nastiest things to debug.

>   * Potentially more efficient, and will benefit from future speed
>     improvements in Guile.
>
> WDYT?

Well, take a look at the following:

dak@lola:/usr/local/tmp/lilypond$ out/bin/lilypond scheme-sandbox
GNU LilyPond 2.15.22
Processing `/usr/local/tmp/lilypond/out/share/lilypond/current/ly/scheme-sandbox.ly'
Parsing...
guile> '#{ ##{ \displayLilyMusic $p #} #}
(#<procedure embedded-lilypond (parser lily-string filename line closures)> parser " ##{ \\displayLilyMusic $p #} " #f 0 (list (cons 2 (lambda () (#<procedure embedded-lilypond (parser lily-string filename line closures)> parser " \\displayLilyMusic $p " #f 0 (list (cons 20 (lambda () p))))))))
guile> 

This case of mutual nesting is not all that outlandish, and the nested
lambdas, while managing to carry the value of p from the current lexical
environment to the inner layer, are not all that pretty.  This could be
just

(#<procedure embedded-lilypond (parser lily-string filename line closures)> parser " ##{ \\displayLilyMusic $p #} " #f 0 (get-environment))

instead.  In short, that I have managed to pick out the nicest prybar
does not mean that a lockpick would not be preferable.  And even if (or
rather: particularly when) we were working like the GUILE gods have
intended it, we would be forced to transform every case of nested
expressions into one large humongous block compiled at once in order to
get lexical nesting (possibly by working with macros which don't exactly
make things easier to track), and that would be quite counterproductive
to getting useful error messages whenever something in the course of
this nesting would go wrong.

So even though we can workaround the current situation well enough for
now, I think that GUILE might be selling itself under value when
compared to its competitors, possibly without compelling need when I
look at the sketches of Mark and the discussion of them.

-- 
David Kastrup



From MAILER-DAEMON Wed Dec 14 10:55:59 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RarBX-00072T-Ko
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 10:55:59 -0500
Received: from eggs.gnu.org ([140.186.70.92]:44436)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RarBT-0006mR-BT
	for guile-devel@gnu.org; Wed, 14 Dec 2011 10:55:56 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RarBR-0007i5-LT
	for guile-devel@gnu.org; Wed, 14 Dec 2011 10:55:55 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:52832
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RarBP-0007hY-KO; Wed, 14 Dec 2011 10:55:51 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id AB07F80E6;
	Wed, 14 Dec 2011 10:55:50 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=CRSgM8foDTr65qmlvJj5F7yykpk=; b=uozbTa
	YaYrvhoXISokjqX2111h814vojibX+Od0UMivGOiatiSNniu5aDab0MW3iFOolKh
	9rds1QJ26ash9WqvYZdf6rrTVxLW5ReFAUDh+0qncRRmYPYLSqd15qYOP4Z8KYjp
	FEJHe75nm52eE0KgJ2wshJq/1ISGTqRdSqCvE=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=FrO83GwBIMq26P/w9meQVjgPX1y8EhG4
	cjfXDBUAIX9xf211sp9VzlpFN0pfzBdjJRtvNgbKpyWmM5xpe6BbNgq5gwfWLAeT
	2ZiMnQsvbdOHWJ3UZOH7/LR5ugNwbl1lCgVhioEzKZ8XaUg01TaXF3gcpRK61vox
	jjT2mQX2fi8=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id A3E7380E5;
	Wed, 14 Dec 2011 10:55:50 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id ECB5C80E4;
	Wed, 14 Dec 2011 10:55:49 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com> <877h1zbg7s.fsf@fencepost.gnu.org>
	<8739cn5la2.fsf@pobox.com> <87mxav89he.fsf@fencepost.gnu.org>
Date: Wed, 14 Dec 2011 16:55:45 +0100
In-Reply-To: <87mxav89he.fsf@fencepost.gnu.org> (David Kastrup's message of
	"Wed, 14 Dec 2011 16:21:33 +0100")
Message-ID: <87mxav4072.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 18238308-266C-11E1-83C7-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 15:55:57 -0000

On Wed 14 Dec 2011 16:21, David Kastrup <dak@gnu.org> writes:

> Andy Wingo <wingo@pobox.com> writes:
>
>> It is my opinion -- and I could be wrong here, either by
>> misunderstanding (again!) the issues, or for whatever reason -- that
>> closures are the best solution to the #{#} problem.
>>
>> Reasons:
>>
>>   * Lambda is standard, well-understood, and general.
>
> Well, if they are standard, what benefits does using GUILE give us?

I'm not sure if this is a rhetorical question or not :), but:

  1) Guile has a C library, with C interfaces to its functionality..

  2) Guile is a GNU project.

  3) You're already using Guile features (modules, among them).

But TBH I don't understand this argument.  Lambda is fantastic, and even
if Guile provided other facilities, I would still use it.  It is the
right tool for the job, IMO.

>>   * Using `lambda' does not preclude compilation.
>>
>>   * Using closures does not require any additional work on the part of
>>     Guile.  (This is only partly selfish; it also decreases the amount
>>     of coupling of lilypond to any particular Guile version.)
>
> Any particular Scheme version.

This is a great thing.  We share the knowledge and in some times the
implementations from other Schemes.  And there are quite a number of
fine Scheme implementations; if you had to switch, for whatever reason,
you could.

>>   * Allows for integration with the debugger, in 2.0.  (Currently,
>>     interpreted code does not debug well.)
>
> Sounds like putting the cart before the horse.  After all,
> interpretative environments offer a lot of potential to be _better_ for
> debugging than compiled code.

I am saying this as the person who wrote the current debugger.

>  One should not lightly waste this.  In
> particular since macro expansion is basically an interpretative
> operation and macros are among the nastiest things to debug.

Very few languages have proper macros.  Very few Scheme implementations
have macro debuggers.  Racket is the only one I know.  It has a separate
debugger for use at syntax expansion time.

I am saying this as the person who maintains the current macro
expander.

:)

>>   * Potentially more efficient, and will benefit from future speed
>>     improvements in Guile.
>
> Well, take a look at the following:
>
> dak@lola:/usr/local/tmp/lilypond$ out/bin/lilypond scheme-sandbox
> GNU LilyPond 2.15.22
> Processing `/usr/local/tmp/lilypond/out/share/lilypond/current/ly/scheme-sandbox.ly'
> Parsing...
> guile> '#{ ##{ \displayLilyMusic $p #} #}
> (#<procedure embedded-lilypond (parser lily-string filename line closures)> parser " ##{ \\displayLilyMusic $p #} " #f 0 (list (cons 2 (lambda () (#<procedure embedded-lilypond (parser lily-string filename line closures)> parser " \\displayLilyMusic $p " #f 0 (list (cons 20 (lambda () p))))))))

It's not what you see, it's what you don't see :)

In Guile 1.8, you don't see:

 * (Lazy) memoization.  (A 1.8 implementation technique.)
 * Consing up procedure arguments.
 * Consing up lexicals.
 * Looking up lexicals.
 * The evaluator dispatch loop.
 * Out-of-line calls to primitives.

Etc.

You are right in saying that it will be slower on 1.8.  Oh well.  On 2.0
it will probably be faster, and potentially could be much faster -- if
it matters.

I am sympathetic to your argument.  Using closures is more code on your
part than using first-class environments.  If Guile only provided an
interpreter, that would certainly be the way to go.  But using closures
is not without its advantages as well, as I listed, and it works also
with a compiler.

Regards,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Wed Dec 14 12:28:18 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rascs-0005fz-Ge
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 12:28:18 -0500
Received: from eggs.gnu.org ([140.186.70.92]:34091)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1Rascm-0005fd-I6
	for guile-devel@gnu.org; Wed, 14 Dec 2011 12:28:16 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1Rascl-0005qa-1L
	for guile-devel@gnu.org; Wed, 14 Dec 2011 12:28:12 -0500
Received: from world.peace.net ([96.39.62.75]:47979)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>)
	id 1Rasck-0005qP-Ty; Wed, 14 Dec 2011 12:28:10 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1Rascf-0002L0-Kd; Wed, 14 Dec 2011 12:28:05 -0500
From: Mark H Weaver <mhw@netris.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com> <877h1zbg7s.fsf@fencepost.gnu.org>
	<8739cn5la2.fsf@pobox.com>
Date: Wed, 14 Dec 2011 12:26:35 -0500
In-Reply-To: <8739cn5la2.fsf@pobox.com> (Andy Wingo's message of "Wed, 14 Dec
	2011 14:35:01 +0100")
Message-ID: <87r507m5dg.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: David Kastrup <dak@gnu.org>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 17:28:16 -0000

Andy Wingo <wingo@pobox.com> writes:
>>> On Wed 14 Dec 2011 08:50, Mark H Weaver <mhw@netris.org> writes:
>>>> I have successfully implemented the (capture-lexical-environment)
>>>> special form in the evaluator, and also primitive-local-eval.
>
> Let's call it `(the-environment)', as it is what it was called in Guile
> 1.8.

Ah, okay, I didn't know that.  It's also a better name :)

> It is my opinion -- and I could be wrong here, either by
> misunderstanding (again!) the issues, or for whatever reason -- that
> closures are the best solution to the #{#} problem.

I would love to use closures for this, but they simply are not powerful
enough to implement `local-eval' properly.

First of all, closures cannot capture the syntactic environment, so
things like (let-syntax ((foo ...)) (the-environment)) would not work.

Even if you don't use let-syntax, handling macro expansion properly
would be difficult using closures.  As you know, when you expand
(let ((xxx ...)) (the-environment)), the expander replaces `xxx' with a
gensym.  So `local-eval' needs to somehow map `xxx' to the same gensym.

If, on the other hand, you create a closure that instead recognizes the
original names found in the source code, then you will break hygiene and
cause unintended variable capture problems when macros are even _used_
by the code in question.

I think these problems are already serious enough to make the closure
method unworkable, but let's suppose that the macro expander wasn't an
issue.  Even so, there are other problems:

How do you build a closure that can be used to evaluate _arbitrary_
Guile code that is not known until after the surrounding code has
already been compiled and run?

It would apparently involve creating a monster closure that could both
access and mutate any lexical variable within its view (ugly, but
doable), and then -- and here's the really bad part -- we'd need to
create and maintain a `local-eval' that supports the entire Guile
language, but is able to handle some (but not all) of its lexical
variables being accessible only via these monster closures.

IMHO, maintaining this special local evaluator would be a massive
maintenance burden.

Finally, I'd like to argue that supporting `the-environment' and
`local-eval' is really not so bad.  Previously, I thought that
Lilypond's use of Guile was very intrusive, but now that I understand
the situation better, I no longer think so.

Lilypond has no need to inspect nor manipulate our lexical environment
objects.  They only need to be able to pass an opaque environment object
from `the-environment' to `local-eval'.  This still gives us plenty of
freedom to change the representation of these environment objects.

The only serious constraint this places on us is that we must keep a
full-featured interpreter around.  I don't think this is so bad.  I love
optimizing compilers as much as anyone, but sometimes they are the wrong
tool.  When efficiency is not a concern, evaluators can provide
additional flexibility, as demonstrated by the Lilypond case.

Personally, I don't view `the-environment' and `local-eval' as an ugly
hack, but rather as a cool feature like delimited continuations.  It's
something Guile 1.8 could brag about.  I'd like for Guile 2.0 to be able
to brag about it too :)

     Mark


From MAILER-DAEMON Wed Dec 14 13:24:07 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RatUt-0004lc-B9
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 13:24:07 -0500
Received: from eggs.gnu.org ([140.186.70.92]:56834)
	by lists.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RatUl-0004lI-L3
	for guile-devel@gnu.org; Wed, 14 Dec 2011 13:24:05 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dak@gnu.org>) id 1RatUj-0001aH-Tn
	for guile-devel@gnu.org; Wed, 14 Dec 2011 13:23:59 -0500
Received: from fencepost.gnu.org ([140.186.70.10]:53395)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RatUj-0001a0-S5
	for guile-devel@gnu.org; Wed, 14 Dec 2011 13:23:57 -0500
Received: from localhost ([127.0.0.1]:35080 helo=lola)
	by fencepost.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dak@gnu.org>)
	id 1RatUj-0006VG-7h; Wed, 14 Dec 2011 13:23:57 -0500
Received: by lola (Postfix, from userid 1000)
	id 7DC51E5F5A; Wed, 14 Dec 2011 19:23:37 +0100 (CET)
From: David Kastrup <dak@gnu.org>
To: Mark H Weaver <mhw@netris.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com> <877h1zbg7s.fsf@fencepost.gnu.org>
	<8739cn5la2.fsf@pobox.com> <87r507m5dg.fsf@netris.org>
Date: Wed, 14 Dec 2011 19:23:37 +0100
In-Reply-To: <87r507m5dg.fsf@netris.org> (Mark H. Weaver's message of "Wed, 14
	Dec 2011 12:26:35 -0500")
Message-ID: <87borb811y.fsf@fencepost.gnu.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 140.186.70.10
Cc: Andy Wingo <wingo@pobox.com>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 18:24:05 -0000

Mark H Weaver <mhw@netris.org> writes:

> Personally, I don't view `the-environment' and `local-eval' as an ugly
> hack, but rather as a cool feature like delimited continuations.  It's
> something Guile 1.8 could brag about.

I wish it had bragged about it at all (in the case of the-environment)
or more coherently (in the case of procedure-environment and
local-eval).  Then maybe enough people would have found a use for them
that they would not have to rely on me to stand up for them.

-- 
David Kastrup


From MAILER-DAEMON Wed Dec 14 13:40:08 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RatkO-0008Rm-83
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 13:40:08 -0500
Received: from eggs.gnu.org ([140.186.70.92]:48254)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RatkL-0008QU-8A
	for guile-devel@gnu.org; Wed, 14 Dec 2011 13:40:06 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RatkG-0005bn-Jt
	for guile-devel@gnu.org; Wed, 14 Dec 2011 13:40:05 -0500
Received: from world.peace.net ([96.39.62.75]:44277)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>)
	id 1RatkG-0005bL-Em; Wed, 14 Dec 2011 13:40:00 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RatkA-0002Zr-HZ; Wed, 14 Dec 2011 13:39:54 -0500
From: Mark H Weaver <mhw@netris.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com> <877h1zbg7s.fsf@fencepost.gnu.org>
	<8739cn5la2.fsf@pobox.com> <87r507m5dg.fsf@netris.org>
Date: Wed, 14 Dec 2011 13:38:24 -0500
In-Reply-To: <87r507m5dg.fsf@netris.org> (Mark H. Weaver's message of "Wed, 14
	Dec 2011 12:26:35 -0500")
Message-ID: <87k45zm21r.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: David Kastrup <dak@gnu.org>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 18:40:06 -0000

Replying to myself:

> Andy Wingo <wingo@pobox.com> writes:
>> It is my opinion -- and I could be wrong here, either by
>> misunderstanding (again!) the issues, or for whatever reason -- that
>> closures are the best solution to the #{#} problem.
>
> I would love to use closures for this, but they simply are not powerful
> enough to implement `local-eval' properly.
>
> First of all, closures cannot capture the syntactic environment, so
> things like (let-syntax ((foo ...)) (the-environment)) would not work.

This statement (and the rest of my previous email), may have been based
on a mistaken impression of your "closure" proposal.  I assumed that you
meant that (the-environment) should essentially implemented as a macro
that expands into a (lambda () ...) that would handle every possible
lexical variable access or mutation.

However, based on the IRC logs, now I think you may have meant that
Lilypond should _scan_ the Lily code between #{ and #} looking for
embedded Scheme code, _before_ evaluating anything.

If this could be done reliably, it would certainly make our lives
easier.  Lilypond could create the entire Scheme expression with all the
embedded bits of Scheme as closures (not general purpose ones, but with
the exact right code within).  We could compile the resulting code, and
life would be good.

I don't know enough about Lilypond's language to know whether it is
feasible to do this robustly.  We have already established that Lily
cannot be parsed without runtime information.  Furthermore, their
language needs to use lexical tie-ins, which means that the lexer needs
contextual information from the parser.  Therefore, they cannot even
produce a stream of lexical tokens prior to execution.

So, with no help from either the parser or scanner, it sounds like
they'd be stuck with something like the usual Emacs strategy of scanning
source code with regexps to do syntax highlighting: it works in practice
most of the time, but it will fail sometimes for unusual inputs.  That's
fine for a syntax highlighter, but a language implementation should be
more robust.

Now, once they have found the Scheme bits, how do they go back and parse
the Lilypond code?  I get that means running something like their
existing lexer and parser on ... what exactly?  It can't simply the
lexer and parser just on the bits in between the Scheme bits, because in
general the parser non-terminals can span across one or more of the
Scheme bits.  I guess they would either have to rescan all of the Scheme
code a second time.

In summary, it makes my head hurt to even think about how I would
implement and maintain Lilypond on Guile 2.0 using this strategy.

It shouldn't be this difficult.  This case with Lilypond has convinced
me that `the-environment' and `local-eval' can be very useful, and
sometimes they cannot be easily replaced with our other facilities.

     Mark


From MAILER-DAEMON Wed Dec 14 14:15:02 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RauIA-0002L1-Ai
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 14:15:02 -0500
Received: from eggs.gnu.org ([140.186.70.92]:50879)
	by lists.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RauI7-0002KF-5H
	for guile-devel@gnu.org; Wed, 14 Dec 2011 14:15:00 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dak@gnu.org>) id 1RauI5-0005MR-3C
	for guile-devel@gnu.org; Wed, 14 Dec 2011 14:14:59 -0500
Received: from fencepost.gnu.org ([140.186.70.10]:55208)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RauI4-0005MN-MD
	for guile-devel@gnu.org; Wed, 14 Dec 2011 14:14:56 -0500
Received: from localhost ([127.0.0.1]:36895 helo=lola)
	by fencepost.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dak@gnu.org>)
	id 1RauI3-0001t4-OA; Wed, 14 Dec 2011 14:14:56 -0500
Received: by lola (Postfix, from userid 1000)
	id 00644E5092; Wed, 14 Dec 2011 20:14:54 +0100 (CET)
From: David Kastrup <dak@gnu.org>
To: Mark H Weaver <mhw@netris.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <87mxaxihnw.fsf@pobox.com>
	<87obvclu92.fsf@fencepost.gnu.org> <87aa6wbp0w.fsf@pobox.com>
	<87fwgolgm5.fsf@fencepost.gnu.org> <8762hkbkwi.fsf@pobox.com>
	<87borclcem.fsf@fencepost.gnu.org> <87zkewa2vy.fsf@pobox.com>
	<87zkewjvyz.fsf@fencepost.gnu.org> <87vcpka13n.fsf@pobox.com>
	<87zkewnzy7.fsf@netris.org> <87r5089ui3.fsf@pobox.com>
	<87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com> <877h1zbg7s.fsf@fencepost.gnu.org>
	<8739cn5la2.fsf@pobox.com> <87r507m5dg.fsf@netris.org>
	<87k45zm21r.fsf@netris.org>
Date: Wed, 14 Dec 2011 20:14:54 +0100
In-Reply-To: <87k45zm21r.fsf@netris.org> (Mark H. Weaver's message of "Wed, 14
	Dec 2011 13:38:24 -0500")
Message-ID: <8739cn7yoh.fsf@fencepost.gnu.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 140.186.70.10
Cc: Andy Wingo <wingo@pobox.com>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 19:15:00 -0000

Mark H Weaver <mhw@netris.org> writes:

> Replying to myself:
>
>> Andy Wingo <wingo@pobox.com> writes:
>>> It is my opinion -- and I could be wrong here, either by
>>> misunderstanding (again!) the issues, or for whatever reason -- that
>>> closures are the best solution to the #{#} problem.
>>
>> I would love to use closures for this, but they simply are not powerful
>> enough to implement `local-eval' properly.
>>
>> First of all, closures cannot capture the syntactic environment, so
>> things like (let-syntax ((foo ...)) (the-environment)) would not work.
>
> This statement (and the rest of my previous email), may have been based
> on a mistaken impression of your "closure" proposal.  I assumed that you
> meant that (the-environment) should essentially implemented as a macro
> that expands into a (lambda () ...) that would handle every possible
> lexical variable access or mutation.
>
> However, based on the IRC logs, now I think you may have meant that
> Lilypond should _scan_ the Lily code between #{ and #} looking for
> embedded Scheme code, _before_ evaluating anything.
>
> If this could be done reliably, it would certainly make our lives
> easier.  Lilypond could create the entire Scheme expression with all the
> embedded bits of Scheme as closures (not general purpose ones, but with
> the exact right code within).  We could compile the resulting code, and
> life would be good.

To be fair: this is what we currently do, and we only actually call
those lambdas that end up actually being recognized by the grammar.  So
as long as (primitive-eval `(lambda () ,(read))) is guaranteed to not
ever choke, the potential for error is limited.  And to be fair: we
already need to use the Scheme reader for skipping stuff behind # and $
or it would be hard to reliably detect the matching #} for the #{
construct when it occurs nested within Scheme again.

It took a number of iterations to make all this robust and dependable,
and just recently a Lilypond comment of the form
% (this can be either #UP or #DOWN)
caused trouble since the Scheme reader not just read #DOWN but also )
and then unread it again, making it end up at the start of the _next_
embedded expression for which the Scheme reader was asked for its
opinion.

> I don't know enough about Lilypond's language to know whether it is
> feasible to do this robustly.

So-so, but then we don't get around _scanning_ (and thus reading) the
potential sexps in a dry run anyway with the current design.  This would
be different if Lilypond employed a different delimiter strategy.

> We have already established that Lily cannot be parsed without runtime
> information.  Furthermore, their language needs to use lexical
> tie-ins, which means that the lexer needs contextual information from
> the parser.  Therefore, they cannot even produce a stream of lexical
> tokens prior to execution.
>
> So, with no help from either the parser or scanner, it sounds like
> they'd be stuck with something like the usual Emacs strategy of
> scanning source code with regexps to do syntax highlighting: it works
> in practice most of the time, but it will fail sometimes for unusual
> inputs.  That's fine for a syntax highlighter, but a language
> implementation should be more robust.

Because of the delimiting issue, there is actually not much of a gain to
be expected.  Results would improve in cases like

#{ % A Lilypond comment before a Scheme element #(
   #y %) and the comment ends again
#}

In this case, the current behavior will be that #y has no (lambda ()...)
associated with it, and consequently evaluation will be done without a
lexical environment, and fail.  The old version using local-eval would
have worked, but it would still have required the sexp starting at #( to
end somewhere before #}.

> In summary, it makes my head hurt to even think about how I would
> implement and maintain Lilypond on Guile 2.0 using this strategy.

I posted a link to the working code already.  It made my head hurt.

> It shouldn't be this difficult.  This case with Lilypond has convinced
> me that `the-environment' and `local-eval' can be very useful, and
> sometimes they cannot be easily replaced with our other facilities.

I think that it is a good thought experiment to assume Lilypond _could_
be properly compiled.  To get lexical closure, we would have to bounce
_everything_ around in uncompiled or macro form until the top-level form
got assembled.  For debugging and error messages, that would be
inconvenient.  Again, to be fair: the current code has to associate file
names and line numbers with the string in order to get useful error
messages.  So it took work getting errors to throw where they belong.

So at its current state, Lilypond itself does not much more than
lukewarmly ask for local-eval.  But for the sake of GUILE, I would
consider it a mistake to lose sight of it.  It is a powerful tool in the
language embedding and self-awareness department.

-- 
David Kastrup


From MAILER-DAEMON Wed Dec 14 14:45:03 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaulD-0002NE-5K
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 14:45:03 -0500
Received: from eggs.gnu.org ([140.186.70.92]:45266)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaulA-0002Mj-F6
	for guile-devel@gnu.org; Wed, 14 Dec 2011 14:45:01 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Raul9-0006Ou-CR
	for guile-devel@gnu.org; Wed, 14 Dec 2011 14:45:00 -0500
Received: from lo.gmane.org ([80.91.229.12]:57063)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Raul9-0006Oq-5w
	for guile-devel@gnu.org; Wed, 14 Dec 2011 14:44:59 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1Raul7-0003N6-G0
	for guile-devel@gnu.org; Wed, 14 Dec 2011 20:44:57 +0100
Received: from p508ecc79.dip.t-dialin.net ([80.142.204.121])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 20:44:57 +0100
Received: from dak by p508ecc79.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 20:44:57 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Wed, 14 Dec 2011 20:44:39 +0100
Organization: Organization?!?
Lines: 16
Message-ID: <87ty536iqg.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org>
	<87obvclu92.fsf@fencepost.gnu.org> <87aa6wbp0w.fsf@pobox.com>
	<87fwgolgm5.fsf@fencepost.gnu.org> <8762hkbkwi.fsf@pobox.com>
	<87borclcem.fsf@fencepost.gnu.org> <87zkewa2vy.fsf@pobox.com>
	<87zkewjvyz.fsf@fencepost.gnu.org> <87vcpka13n.fsf@pobox.com>
	<87zkewnzy7.fsf@netris.org> <87r5089ui3.fsf@pobox.com>
	<87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com> <877h1zbg7s.fsf@fencepost.gnu.org>
	<8739cn5la2.fsf@pobox.com> <87r507m5dg.fsf@netris.org>
	<87k45zm21r.fsf@netris.org> <8739cn7yoh.fsf@fencepost.gnu.org>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ecc79.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:sci15jzLMXUVZ5RHcwwYI9taoWE=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 19:45:01 -0000

David Kastrup <dak@gnu.org> writes:

> To be fair: this is what we currently do, and we only actually call
> those lambdas that end up actually being recognized by the grammar.
> So as long as (primitive-eval `(lambda () ,(read))) is guaranteed to
> not ever choke, the potential for error is limited.

Come to think of it: an actual optimizing compiler is quite more likely
to get annoyed at (lambda () total-garbage-sexp) before one actually
tries calling it.  So even when letting Guilev1 and Guilev2 compete by
letting both use the lambda-based implementation, we might run into more
problems using Guilev2 because of having to wrap all _potential_ runtime
candidates for lexical evaluation into closures.

-- 
David Kastrup



From MAILER-DAEMON Wed Dec 14 16:05:28 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Raw12-0004iM-92
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 16:05:28 -0500
Received: from eggs.gnu.org ([140.186.70.92]:39141)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1Raw0x-0004dQ-Ma
	for guile-devel@gnu.org; Wed, 14 Dec 2011 16:05:24 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1Raw0w-00076s-6l
	for guile-devel@gnu.org; Wed, 14 Dec 2011 16:05:23 -0500
Received: from world.peace.net ([96.39.62.75]:37340)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>)
	id 1Raw0v-00076g-Q4; Wed, 14 Dec 2011 16:05:22 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1Raw0n-00031P-Lc; Wed, 14 Dec 2011 16:05:13 -0500
From: Mark H Weaver <mhw@netris.org>
To: Noah Lavine <noah.b.lavine@gmail.com>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com> <87vcpjmn3c.fsf@netris.org>
	<CA+U71=Oq84Y5359NJA_LejvxU2y7hGWH3CNgmwOr4z1Vp3FDEw@mail.gmail.com>
Date: Wed, 14 Dec 2011 16:03:37 -0500
In-Reply-To: <CA+U71=Oq84Y5359NJA_LejvxU2y7hGWH3CNgmwOr4z1Vp3FDEw@mail.gmail.com>
	(Noah Lavine's message of "Wed, 14 Dec 2011 08:31:41 -0500")
Message-ID: <87fwgmn9w6.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: Andy Wingo <wingo@pobox.com>, David Kastrup <dak@gnu.org>,
	guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 21:05:24 -0000

Hi Noah,

Noah Lavine <noah.b.lavine@gmail.com> writes:
> Perhaps this is obvious to everyone else, but it just occurred to me
> that (capture-local-environment) is just
> (call-with-current-continuation), but running in the environment of
> the evaluator instead of the program being evaluated. It's as though
> the evaluator was going to look in a tree for more code, but hit a
> special node and did a (call/cc). I hope other people find this
> interesting.

Ah yes, that's an excellent point!

In fact it makes me wonder whether `the-environment' and `local-eval'
could actually be implemented this way.  I see some complications that
might make this strategy impractical or fragile, most notably that we
must be assured that the (call/cc) does not happen until
(the-environment) would have been _evaluated_, whereas the
expander/memoizer/evaluator will want to see what code is there _before_
evaluation.  I'll have to think about this.  There might be an easy and
robust way to do this, or maybe not.

Regardless, this is a great way to _think_ about these primitives in
terms that Schemers can understand, and maybe a selling point too.  I
hope we can agree that first-class continuations are insanely great.
They carry a significant maintenance cost, but they also add great power
when they are needed.  So why not first-class continuations for the
evaluator itself? :)

     Thanks!
       Mark


From MAILER-DAEMON Wed Dec 14 16:31:18 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RawQ2-0006rO-48
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 16:31:18 -0500
Received: from eggs.gnu.org ([140.186.70.92]:36083)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RawPy-0006nI-QD
	for guile-devel@gnu.org; Wed, 14 Dec 2011 16:31:15 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RawPu-00056c-8i
	for guile-devel@gnu.org; Wed, 14 Dec 2011 16:31:14 -0500
Received: from lo.gmane.org ([80.91.229.12]:34271)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RawPu-00056T-2D
	for guile-devel@gnu.org; Wed, 14 Dec 2011 16:31:10 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RawPs-0007fX-TD
	for guile-devel@gnu.org; Wed, 14 Dec 2011 22:31:08 +0100
Received: from reverse-83.fdn.fr ([80.67.176.83])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 22:31:08 +0100
Received: from ludo by reverse-83.fdn.fr with local (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 22:31:08 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Wed, 14 Dec 2011 22:30:56 +0100
Lines: 26
Message-ID: <87wr9ykfhr.fsf@gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <874nxdwkbi.fsf@rapitore.luna>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87wr9zntv0.fsf@gnu.org>
	<87y5uf8bz2.fsf@fencepost.gnu.org>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: reverse-83.fdn.fr
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 24 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:PNvF5Al72hdFvaoNmjOOs6E2JGM=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 21:31:15 -0000

David Kastrup <dak@gnu.org> skribis:

> ludo@gnu.org (Ludovic Courtès) writes:
>
>> Andy Wingo <wingo@pobox.com> skribis:
>>
>>> But, in the event that David wants to continue with his current
>>> strategy, there are other things that can be done.  David, did you know
>>> that Guile's evaluator is implemented in Scheme?  That means that if you
>>> want an evaluator with different semantics -- for example, something
>>> closer to Kernel[0], as David appears to want -- then you can implement
>>> an evaluator that provides for fexprs and the like, and it will run
>>> about as well as Guile's evaluator.
>>
>> Indeed.  FWIW, Skribilo [0] has its own input language, which is similar
>> to but different from Scheme, so it has its own reader and its own
>> evaluator, the latter being mostly a wrapper around ‘eval’.  This
>> strategy has worked well, and portably between 1.8 and 2.0.
>
> There is a saying

[...]

I just meant to say that this strategy can work, but of course YMMV.

Ludo’.



From MAILER-DAEMON Wed Dec 14 17:12:59 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rax4N-0004K2-U4
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 17:12:59 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59249)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rax4L-0004Jq-Gu
	for guile-devel@gnu.org; Wed, 14 Dec 2011 17:12:58 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rax4K-0004nC-Cg
	for guile-devel@gnu.org; Wed, 14 Dec 2011 17:12:57 -0500
Received: from lo.gmane.org ([80.91.229.12]:36405)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rax4J-0004n5-Ro
	for guile-devel@gnu.org; Wed, 14 Dec 2011 17:12:56 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rax4I-0004BF-Fa
	for guile-devel@gnu.org; Wed, 14 Dec 2011 23:12:54 +0100
Received: from p508ecc79.dip.t-dialin.net ([80.142.204.121])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 23:12:54 +0100
Received: from dak by p508ecc79.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 23:12:54 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Wed, 14 Dec 2011 23:12:39 +0100
Organization: Organization?!?
Lines: 47
Message-ID: <87pqfq7qg8.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com> <87vcpjmn3c.fsf@netris.org>
	<CA+U71=Oq84Y5359NJA_LejvxU2y7hGWH3CNgmwOr4z1Vp3FDEw@mail.gmail.com>
	<87fwgmn9w6.fsf@netris.org>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ecc79.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:vU83Jjkq6G22otVUuywgGELqqsI=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 22:12:58 -0000

Mark H Weaver <mhw@netris.org> writes:

> Hi Noah,
>
> Noah Lavine <noah.b.lavine@gmail.com> writes:
>> Perhaps this is obvious to everyone else, but it just occurred to me
>> that (capture-local-environment) is just
>> (call-with-current-continuation), but running in the environment of
>> the evaluator instead of the program being evaluated. It's as though
>> the evaluator was going to look in a tree for more code, but hit a
>> special node and did a (call/cc). I hope other people find this
>> interesting.
>
> Ah yes, that's an excellent point!

(define (my-eval form env)
  (call-with-current-continuation
   (lambda (x)
     (env (list x form)))))

(define-macro (my-env)
  (call-with-current-continuation
   identity))
     

(format #t "~a" (my-eval '(+ x 3) (let ((x 4)) (my-env))))

> In fact it makes me wonder whether `the-environment' and `local-eval'
> could actually be implemented this way.  I see some complications that
> might make this strategy impractical or fragile, most notably that we
> must be assured that the (call/cc) does not happen until
> (the-environment) would have been _evaluated_, whereas the
> expander/memoizer/evaluator will want to see what code is there _before_
> evaluation.  I'll have to think about this.  There might be an easy and
> robust way to do this, or maybe not.

Feel free to experiment with the above.  I have my doubt that it leads
to sane behavior.  In particular, it will refinish macro expansion (so
you don't want significant material behind it) and reevaluate the
_whole_ eval it is in up to the point of calling my-env (so you don't
want significant material before it).

So it is more a joke than anything of practical value.  But is _is_ good
for a few dropjaws.

-- 
David Kastrup



From MAILER-DAEMON Wed Dec 14 17:25:08 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaxG8-0007Lr-Bo
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 17:25:08 -0500
Received: from eggs.gnu.org ([140.186.70.92]:42323)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaxG5-0007BJ-7o
	for guile-devel@gnu.org; Wed, 14 Dec 2011 17:25:06 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaxG3-0007NO-V7
	for guile-devel@gnu.org; Wed, 14 Dec 2011 17:25:05 -0500
Received: from lo.gmane.org ([80.91.229.12]:45715)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaxG3-0007Mx-LZ
	for guile-devel@gnu.org; Wed, 14 Dec 2011 17:25:03 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RaxG1-0002ey-PN
	for guile-devel@gnu.org; Wed, 14 Dec 2011 23:25:01 +0100
Received: from p508ecc79.dip.t-dialin.net ([80.142.204.121])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 23:25:01 +0100
Received: from dak by p508ecc79.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 14 Dec 2011 23:25:01 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
Date: Wed, 14 Dec 2011 23:24:45 +0100
Organization: Organization?!?
Lines: 39
Message-ID: <87liqe7pw2.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <87mxaxihnw.fsf@pobox.com>
	<87obvclu92.fsf@fencepost.gnu.org> <87aa6wbp0w.fsf@pobox.com>
	<87fwgolgm5.fsf@fencepost.gnu.org> <8762hkbkwi.fsf@pobox.com>
	<87borclcem.fsf@fencepost.gnu.org> <87zkewa2vy.fsf@pobox.com>
	<87zkewjvyz.fsf@fencepost.gnu.org> <87vcpka13n.fsf@pobox.com>
	<87zkewnzy7.fsf@netris.org> <87r5089ui3.fsf@pobox.com>
	<87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com> <87vcpjmn3c.fsf@netris.org>
	<CA+U71=Oq84Y5359NJA_LejvxU2y7hGWH3CNgmwOr4z1Vp3FDEw@mail.gmail.com>
	<87fwgmn9w6.fsf@netris.org> <87pqfq7qg8.fsf@fencepost.gnu.org>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ecc79.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:oI7fkCQNpKkeE8HOpxVORfIJ7QA=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 22:25:06 -0000

David Kastrup <dak@gnu.org> writes:

> (define (my-eval form env)
>   (call-with-current-continuation
>    (lambda (x)
>      (env (list x form)))))
>
> (define-macro (my-env)
>   (call-with-current-continuation
>    identity))
>      
>
> (format #t "~a" (my-eval '(+ x 3) (let ((x 4)) (my-env))))
>
> Mark H Weaver <mhw@netris.org> writes:
>
>> In fact it makes me wonder whether `the-environment' and `local-eval'
>> could actually be implemented this way.  I see some complications that
>> might make this strategy impractical or fragile, most notably that we
>> must be assured that the (call/cc) does not happen until
>> (the-environment) would have been _evaluated_, whereas the
>> expander/memoizer/evaluator will want to see what code is there _before_
>> evaluation.  I'll have to think about this.  There might be an easy and
>> robust way to do this, or maybe not.
>
> Feel free to experiment with the above.  I have my doubt that it leads
> to sane behavior.  In particular, it will refinish macro expansion (so
> you don't want significant material behind it) and reevaluate the
> _whole_ eval it is in up to the point of calling my-env (so you don't
> want significant material before it).
>
> So it is more a joke than anything of practical value.  But is _is_ good
> for a few dropjaws.

Actually, if the evaluator does macro expansion on the fly instead of en
bloc, it may even be a practical joke.

-- 
David Kastrup



From MAILER-DAEMON Wed Dec 14 17:55:20 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RaxjM-0005vV-AI
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 17:55:20 -0500
Received: from eggs.gnu.org ([140.186.70.92]:48637)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaxjJ-0005vL-N0
	for guile-devel@gnu.org; Wed, 14 Dec 2011 17:55:18 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RaxjI-00051q-PQ
	for guile-devel@gnu.org; Wed, 14 Dec 2011 17:55:17 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:65458
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1RaxjG-00051Q-Tv; Wed, 14 Dec 2011 17:55:15 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 466918F35;
	Wed, 14 Dec 2011 17:55:14 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=AZyk7BQwlmRnu8h89E3SDM0IxHc=; b=cVUtj7
	OYHvgMeVm8zET2QcMad64cFbiupxm7tWK499iRY8qzRDwPPaMO+mCYmqTrY713x2
	59b1U6RSzXDaipb99lGCvRhGRbr9ZfdESI2PmnQBSFfuuvFNitrdY3TDaoees9Cr
	aOI4KNbY4Ti5dexhXI+tePi9c7VIqebEz+65I=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=rbvfODPXAL3eXGPxA+4/kF/xk9oTxzpV
	lplpSaOZNT03CVNgb3dD5G/a8GL6LUDFBLHAhAlBNaV2OiUl/FsI/QzFeMajmjnI
	FKWz4H6ty25UZbDHYzN4AlnqFEXA3ZLi8NA1TkyXFx1ngLtzhLjRtkNA6FJKM2aN
	ERfW1/WKMKQ=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 3A7D38F34;
	Wed, 14 Dec 2011 17:55:14 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 6AF3E8F32;
	Wed, 14 Dec 2011 17:55:12 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Mark H Weaver <mhw@netris.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com> <87vcpjmn3c.fsf@netris.org>
	<CA+U71=Oq84Y5359NJA_LejvxU2y7hGWH3CNgmwOr4z1Vp3FDEw@mail.gmail.com>
	<87fwgmn9w6.fsf@netris.org>
Date: Wed, 14 Dec 2011 23:55:09 +0100
In-Reply-To: <87fwgmn9w6.fsf@netris.org> (Mark H. Weaver's message of "Wed,
	14 Dec 2011 16:03:37 -0500")
Message-ID: <877h1ywype.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: AE23F704-26A6-11E1-80C4-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: David Kastrup <dak@gnu.org>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 22:55:18 -0000

On Wed 14 Dec 2011 22:03, Mark H Weaver <mhw@netris.org> writes:

> Noah Lavine <noah.b.lavine@gmail.com> writes:
>> [(the-environment)] is just (call-with-current-continuation),

> In fact it makes me wonder whether `the-environment' and `local-eval'
> could actually be implemented this way.

This prevents the evaluator from running an analysis pass beforehand.
It would also prevent syntax expansion from happening beforehand, I
think.

As an example, Chez Scheme, if it uses the interpreter, actually runs
the cp0 pass (like our peval) before passing code off to the
interpreter.

> Regardless, this is a great way to _think_ about these primitives in
> terms that Schemers can understand, and maybe a selling point too.

It is an interesting thought experiment, yes ;-)

Cheers,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Wed Dec 14 17:56:48 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Raxkm-0006ca-Ra
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 17:56:48 -0500
Received: from eggs.gnu.org ([140.186.70.92]:49092)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1Raxkh-0006bj-HA
	for guile-devel@gnu.org; Wed, 14 Dec 2011 17:56:47 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1Raxke-0005EP-RC
	for guile-devel@gnu.org; Wed, 14 Dec 2011 17:56:43 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:34262
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>)
	id 1Raxkd-0005Do-CG; Wed, 14 Dec 2011 17:56:39 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id F33CC8F4C;
	Wed, 14 Dec 2011 17:56:38 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=hHEP/F1W+NKJd1FrJ3MSw+/MyeU=; b=Qvw3QP
	uiqICHv7B3upeQjBwv5q0m47h2vXYPSTlLoq/jX9xmg20oECLIk/fDRmyJw8orZk
	K7vVSj+UVxLOc5vvmn1BMEJ2HnwMYWUk8LnhnPONrXrX3rAxJkW6K2OP0BZWZIW0
	MDXP528tH2f2gGygUFbbp3dekg3yfP5R0ShrI=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=OJ/JxKc0JhM/Cxwqld06pIJrysajnqA+
	MNa05P39y6Rsm8D7tg04Fj4J8S6sUty4qCX/zf1RpzuS1H7G05h3rTzVu8p3tp4y
	1PZd4EOZGKAZyHy+WCMeMF/82FNk08wAg1WVQSKMyntMXFpkMwZkuCz/tJVDQa6h
	au5qsTOns6k=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id DF42F8F4B;
	Wed, 14 Dec 2011 17:56:38 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 4DA638F4A;
	Wed, 14 Dec 2011 17:56:38 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Mark H Weaver <mhw@netris.org>
Subject: Re: Anything better for delayed lexical evaluation than (lambda ()
	...)?
References: <87liqtpsl9.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<87liqf5uty.fsf@pobox.com> <877h1zbg7s.fsf@fencepost.gnu.org>
	<8739cn5la2.fsf@pobox.com> <87r507m5dg.fsf@netris.org>
Date: Wed, 14 Dec 2011 23:56:34 +0100
In-Reply-To: <87r507m5dg.fsf@netris.org> (Mark H. Weaver's message of "Wed,
	14 Dec 2011 12:26:35 -0500")
Message-ID: <8739cmwyn1.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: E154345E-26A6-11E1-A7CE-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: David Kastrup <dak@gnu.org>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 14 Dec 2011 22:56:47 -0000

On Wed 14 Dec 2011 18:26, Mark H Weaver <mhw@netris.org> writes:

> Andy Wingo <wingo@pobox.com> writes:
>> It is my opinion -- and I could be wrong here, either by
>> misunderstanding (again!) the issues, or for whatever reason -- that
>> closures are the best solution to the #{#} problem.
>
> I would love to use closures for this, but they simply are not powerful
> enough to implement `local-eval' properly.

Agreed, but I think at this point that it's fair to say while that
lilypond's use case would be more convenient with local-eval, lambda is
certainly powerful enough.

I'll send a mail tomorrow specifically about local-eval.

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Wed Dec 14 19:41:41 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RazOH-0006zm-RT
	for mharc-guile-devel@gnu.org; Wed, 14 Dec 2011 19:41:41 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59045)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RazOD-0006vg-5O
	for guile-devel@gnu.org; Wed, 14 Dec 2011 19:41:38 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RazOB-0002TX-Tn
	for guile-devel@gnu.org; Wed, 14 Dec 2011 19:41:37 -0500
Received: from mail1-relais-roc.national.inria.fr ([192.134.164.82]:41877)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <ludo@gnu.org>)
	id 1RazOB-0002TE-NQ; Wed, 14 Dec 2011 19:41:35 -0500
X-IronPort-AV: E=Sophos;i="4.71,355,1320620400"; d="scan'208";a="135461271"
Received: from reverse-83.fdn.fr (HELO pluto) ([80.67.176.83])
	by mail1-relais-roc.national.inria.fr with ESMTP/TLS/DHE-RSA-AES128-SHA;
	15 Dec 2011 01:41:33 +0100
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
To: Bruno Haible <bruno@clisp.org>
Subject: Re: Accessing the environment's locale encoding settings
References: <877h30exfk.fsf@gnu.org> <201111201755.18910.bruno@clisp.org>
	<87ehx2bsis.fsf@gnu.org> <201111202112.46974.bruno@clisp.org>
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 25 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
Date: Thu, 15 Dec 2011 01:41:32 +0100
In-Reply-To: <201111202112.46974.bruno@clisp.org> (Bruno Haible's message of
	"Sun, 20 Nov 2011 21:12:46 +0100")
Message-ID: <87k45y8y4j.fsf@gnu.org>
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 192.134.164.82
Cc: bug-gnulib@gnu.org, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 15 Dec 2011 00:41:38 -0000

Hi,

Since adding an implicit setlocale(LC_ALL, "") cannot be done in Guile
2.0 (it would change the default port encoding as a side effect, etc.),
I committed something similar to the hack proposed in [0].

Bruno Haible <bruno@clisp.org> skribis:

> If I were you, I would start using the gnulib-tool option --local-dir
> with a local modification of the 'localcharset' module, as documented in =
[1].

I followed your suggestion:

  http://git.sv.gnu.org/cgit/guile.git/tree/gnulib-local/lib?h=3Dstable-2.0

Thanks!

Ludo=E2=80=99.

[0] http://lists.gnu.org/archive/html/guile-devel/2011-11/msg00039.html


From MAILER-DAEMON Thu Dec 15 05:21:40 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rb8RY-0004ZX-0w
	for mharc-guile-devel@gnu.org; Thu, 15 Dec 2011 05:21:40 -0500
Received: from eggs.gnu.org ([140.186.70.92]:41430)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1Rb8RP-0004TU-Dc
	for guile-devel@gnu.org; Thu, 15 Dec 2011 05:21:37 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1Rb8RJ-0004vM-Cs
	for guile-devel@gnu.org; Thu, 15 Dec 2011 05:21:31 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:46171
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1Rb8RJ-0004v9-6l
	for guile-devel@gnu.org; Thu, 15 Dec 2011 05:21:25 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 86CE17973
	for <guile-devel@gnu.org>; Thu, 15 Dec 2011 05:21:24 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to
	:subject:date:message-id:mime-version:content-type; s=sasl; bh=0
	N7oQU2VNI8QJZqxS0mMmTuYg4A=; b=i4OX5hVSImPUQBeatLnQroHMJMKUUY53U
	FdWoabdRHhbD+bGZuGAufc+VFmxtYCVPPt6H4aYu0OorlIoSo5bqmlGGelBY4mFH
	6N9uQbwGM1DAyIWtQHVkmHSlVgwuF4fLjFeN+NsW6Lt0CTScxrccynhNrI/ab4jS
	Cqh25IsOiI=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:subject
	:date:message-id:mime-version:content-type; q=dns; s=sasl; b=QiZ
	vzbtBCMEBlWj4Q3Xut8ZdWmkNjz43s1slKfeGygdnFMBxURTHVGaVHA/434RXIBb
	B6LCVrf096MTu6prTfh4XRy/RntDIF8Zyu5upTXxz4f5rHTGMpEK/tKHc46U12OO
	9oUIn5VGlu55reHrJ769ujIfsWkhzLkcpyjg4x4A=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 7ECD77972
	for <guile-devel@gnu.org>; Thu, 15 Dec 2011 05:21:24 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 91DD57971 for
	<guile-devel@gnu.org>; Thu, 15 Dec 2011 05:21:22 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: guile-devel <guile-devel@gnu.org>
Subject: summary: lilypond, lambda, and local-eval
Date: Thu, 15 Dec 2011 11:21:18 +0100
Message-ID: <87r506uodd.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 897F8DB8-2706-11E1-B19C-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 15 Dec 2011 10:21:37 -0000

Hi,

The "delayed evaluation" thread is a bit long and confusing, so I would
like to try to summarize it.

Lilypond has a way to embed Lilypond code in Scheme, and Scheme code in
Lilypond code.  The former uses a reader macro, #{#}.  The latter uses
specially-marked variables and expressions, specifically, those preceded
by $ or #.

For example, the following Scheme expression is an embedded lilypond
code fragment:

    #{ \displayLilyMusic $p #}

which expands out at read-time to:

    (#<procedure embedded-lilypond (parser lily-string filename line closures)>
     parser
     " \\displayLilyMusic $p "
     #f
     0
     (list (cons 20 (lambda () p))))

Here the procedure is embedded in the output of the reader macro.  We
can see that the $p is translated to (cons 20 (lambda () p)).  Whenever
$p is evaluated, that lambda is run.

Embedded Scheme (via $ or #) has access to Scheme's environment.
Variables in lilypond are in a separate environment (implemented using
modules), so we don't have to be concerned about lilypond accessing or
defining Scheme lexicals.

David hacks on Lilypond.  He notes that the above expression used to
expand out to:

    (#<procedure embedded-lilypond (parser lily-string filename line closures)>
     parser
     " \\displayLilyMusic $p "
     #f
     0
     (the-environment))

in 1.8.  Then, whenever lilypond needed to evaluate an embedded Scheme
value, it would use `local-eval' with the captured environment.  It is
clearly much more convenient for lilypond hackers than having to scan
for embedded Scheme beforehand and build up closures for each embedded
Scheme expression.  David noted that while "the closure solution" works
for him, he wondered if there was something better to use.

It took some time for everyone to understand the problem.  In the end,
there were four workable possibilities.

  1) Keep using closures.

  2) Incorporate local-eval and the-environment into Guile 2.0.

  3) Have lilypond use its own evaluator or compiler.

  4) Have lilypond make the embedded lilypond code expand out to actual
     Scheme.  (It was unclear whether the lilypond grammar allowed
     this.)

Mark and Noah looked at implementing local-eval, and I recommended
staying with the closure solution.  Ludovic noted success with method
(3) in the Skribilo context.

I would like to start a new thread around local-eval, but besides that,
we should probably agree on the summary first.  So please do send any
corrections to this summary to the list.  Thanks :)

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Thu Dec 15 09:46:45 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbCa5-0002ZI-2A
	for mharc-guile-devel@gnu.org; Thu, 15 Dec 2011 09:46:45 -0500
Received: from eggs.gnu.org ([140.186.70.92]:33744)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbCZx-0002Je-Mr
	for guile-devel@gnu.org; Thu, 15 Dec 2011 09:46:43 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbCZr-00050b-N5
	for guile-devel@gnu.org; Thu, 15 Dec 2011 09:46:37 -0500
Received: from lo.gmane.org ([80.91.229.12]:44167)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbCZr-00050M-Dl
	for guile-devel@gnu.org; Thu, 15 Dec 2011 09:46:31 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbCZp-0001hG-00
	for guile-devel@gnu.org; Thu, 15 Dec 2011 15:46:29 +0100
Received: from p508eb977.dip.t-dialin.net ([80.142.185.119])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Thu, 15 Dec 2011 15:46:28 +0100
Received: from dak by p508eb977.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Thu, 15 Dec 2011 15:46:28 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: summary: lilypond, lambda, and local-eval
Date: Thu, 15 Dec 2011 15:46:15 +0100
Organization: Organization?!?
Lines: 61
Message-ID: <87aa6t7v0o.fsf@fencepost.gnu.org>
References: <87r506uodd.fsf@pobox.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508eb977.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:eTl2G5mwQuU8sCdfq4FMqIgQsFQ=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 15 Dec 2011 14:46:43 -0000

Andy Wingo <wingo@pobox.com> writes:

> It took some time for everyone to understand the problem.  In the end,
> there were four workable possibilities.
>
>   1) Keep using closures.
>
>   2) Incorporate local-eval and the-environment into Guile 2.0.
>
>   3) Have lilypond use its own evaluator or compiler.
>
>   4) Have lilypond make the embedded lilypond code expand out to actual
>      Scheme.  (It was unclear whether the lilypond grammar allowed
>      this.)

It is pretty clear that the Lilypond grammar will not allow this.  It
has ambiguities that can only be resolved at runtime and impact both the
parse tree as well as the tokenizing process.

> Mark and Noah looked at implementing local-eval, and I recommended
> staying with the closure solution.  Ludovic noted success with method
> (3) in the Skribilo context.

Mark basically showed a sketch that worked by switching off the compiler
of the current top form when the-environment got used.

With LilyPond, my basic statement was that performance of the Scheme
part was a non-issue when compared against the Lilypond parts.  As an
afterthought, this may not be totally correct: if you have code of the
kind

(define-music-function ... (x y z)
  (do a complex calculation purely in Scheme)
  (return results using #{ ... #}))

then the speed of the "calculation" can conceivably govern the runtime
after all, so switching off all compilations in the enclosing top form
might have runtime effects not masked by the costs of #{ ... #}.  It is,
however, untypical to have costly calculations in the front end of
Lilypond.  The runtime is usually spent elsewhere, mostly in C++ code.

> I would like to start a new thread around local-eval, but besides
> that, we should probably agree on the summary first.  So please do
> send any corrections to this summary to the list.  Thanks :)

A note to point 4) if LilyPond were a language for which expansion to
Scheme would be feasible, compilation of the whole nested constructs
would have to happen in one humongous piece since there is no other way
to share lexical environments.

And a note to point 1) the Scheme compiler is more likely to complain
about (lambda () arbitrary-garbage-sexp) than the interpreter when the
preliminary closure-building step picks up line noise from inside of
Lilypond comments or strings.

In comparison to the previous code version running under Guile 1.8,
robustness, cleanliness and manageability of the code have taken a step
backwards.  It's not a mile, but not trivial either.

-- 
David Kastrup



From MAILER-DAEMON Thu Dec 15 10:23:25 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbD9Z-00046L-4V
	for mharc-guile-devel@gnu.org; Thu, 15 Dec 2011 10:23:25 -0500
Received: from eggs.gnu.org ([140.186.70.92]:46615)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RbD9Q-00042N-Kh
	for guile-devel@gnu.org; Thu, 15 Dec 2011 10:23:22 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RbD9P-0004qj-8V
	for guile-devel@gnu.org; Thu, 15 Dec 2011 10:23:16 -0500
Received: from mail-vw0-f41.google.com ([209.85.212.41]:60214)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RbD9P-0004qc-0X
	for guile-devel@gnu.org; Thu, 15 Dec 2011 10:23:15 -0500
Received: by vbbfn1 with SMTP id fn1so1914720vbb.0
	for <guile-devel@gnu.org>; Thu, 15 Dec 2011 07:23:14 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:content-type; bh=4YrySyqxI9q20VSHclFCBZ0Ce/Qk4aFTGzrway9tljg=;
	b=XL6rSh3tJGnvwIF/ttqqTQ3JqQGP5MYHGFgQ76xTOHLW+bsikFAxqV5DK3wIXUDuAg
	Jq20tvABGW39leucBxcPubzr7aX1YUNoVIN+SKek0PIAtEQvZ8UD/rKe3O4vM1UaQT1B
	Rc3OH9B53EkNmEbI0dfzGYfYsKSSxRwrBvTB0=
MIME-Version: 1.0
Received: by 10.52.114.232 with SMTP id jj8mr3344595vdb.94.1323962594146; Thu,
	15 Dec 2011 07:23:14 -0800 (PST)
Received: by 10.52.31.165 with HTTP; Thu, 15 Dec 2011 07:23:14 -0800 (PST)
In-Reply-To: <CA+U71=MMST=EkYSEgXkaMFpfyvbKnQmKqomJm8XGHeKzpa+Vkg@mail.gmail.com>
References: <CA+U71=MMST=EkYSEgXkaMFpfyvbKnQmKqomJm8XGHeKzpa+Vkg@mail.gmail.com>
Date: Thu, 15 Dec 2011 23:23:14 +0800
Message-ID: <CAPjoZocybpKLANd0WaoV-214eNWt4C=zqpDzA4eVJQ8PPT_30g@mail.gmail.com>
Subject: Re: Update and Questions
From: Nala Ginrut <nalaginrut@gmail.com>
To: Noah Lavine <noah.b.lavine@gmail.com>, guile-devel@gnu.org
Content-Type: multipart/alternative; boundary=bcaec547cad91ebad504b42310b6
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.212.41
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 15 Dec 2011 15:23:22 -0000

--bcaec547cad91ebad504b42310b6
Content-Type: text/plain; charset=UTF-8

So it'd be the preform of something kind of Guile's AOT compiler which
we(all guilers)  had talked about few months ago?
I think it's a great idea!  And I'm glad to see your work.

PS:  I agree with "Stallman". ;-)

On Tue, Dec 6, 2011 at 12:25 PM, Noah Lavine <noah.b.lavine@gmail.com>wrote:

> Hello Guile developers,
>
> Despite the long gap since my last email, I have in fact been working
> on the compiler project. This email has two purposes: first, to make
> sure that I have a basically reasonable design before I work more, and
> second, to ask a logistical question.
>
> First of all, I very much appreciated your suggestions of things to
> read. I did look at the Reasoned Schemer. I also spent quite a while
> studying Stalin (the compiler), because I believe that is the current
> fastest Scheme compiler. (And therefore, it's the one I'd like to beat
> with our compiler.) The design I am currently working with is the same
> as Stalin's design.
>
> It is a propagation network. Basically you have a graph of Tree-IL
> nodes, where each Tree-IL node is connected to its parent, its
> children, and optionally other nodes (a variable is connected to the
> place it was declared. A primitive function is connected to the error
> continuation it could jump to). The compiler propagates information
> along the edges of this graph, attempting to find the minimum set of
> possible values for each variable and each jump target. It also
> performs partial evaluation as a special case of this.
>
> What I have described also seems to be how Hindley-Milner type
> inference works (although I think we can do a bit better than standard
> Hindley-Milner systems). Does this seem like a good design for the
> static analyzer portion?
>
> One big oversight that I know of is that this doesn't do any sort of
> specialization. I think that is an extremely important feature, but
> when I looked at doing specialization I thought that it would use all
> of the logic this would, but require a bit more work to keep the
> complexity down, so I thought I should do this first.
>
> I haven't thought much about the rest of the compiler yet, but I
> imagine you can basically walk this graph and try to choose
> representations for each piece of it using the information you
> gathered in the analysis phase. The key ingredient for that will be a
> library of representations for each Tree-IL node.
>
> The second part of this post is a logistical question. I would like to
> do this work in public, so other people can see it (and hopefully
> contribute). Where is the best place to do this? Should I make a
> branch on Savannah? That makes the most sense to me, but it seems a
> bit unnatural, since this project is very separate from the rest of
> Guile.
>
> And finally, a fun thing. The current best Scheme compiler (that I
> know of) is called Stalin. Therefore, I suggest that our compiler be
> called "Stallman", after our fearless leader (whose name also starts
> with "s"). :-)
>
> Thanks a lot,
> Noah
>
>

--bcaec547cad91ebad504b42310b6
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

So it&#39;d be the preform of something kind of Guile&#39;s AOT compiler wh=
ich we(all guilers) =C2=A0had talked about few months ago?<br>I think it&#3=
9;s a great idea! =C2=A0And I&#39;m glad to see your work.<div><br></div><d=
iv>PS: =C2=A0I agree with &quot;Stallman&quot;. ;-)<br>
<br><div class=3D"gmail_quote">On Tue, Dec 6, 2011 at 12:25 PM, Noah Lavine=
 <span dir=3D"ltr">&lt;<a href=3D"mailto:noah.b.lavine@gmail.com">noah.b.la=
vine@gmail.com</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" s=
tyle=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
Hello Guile developers,<br>
<br>
Despite the long gap since my last email, I have in fact been working<br>
on the compiler project. This email has two purposes: first, to make<br>
sure that I have a basically reasonable design before I work more, and<br>
second, to ask a logistical question.<br>
<br>
First of all, I very much appreciated your suggestions of things to<br>
read. I did look at the Reasoned Schemer. I also spent quite a while<br>
studying Stalin (the compiler), because I believe that is the current<br>
fastest Scheme compiler. (And therefore, it&#39;s the one I&#39;d like to b=
eat<br>
with our compiler.) The design I am currently working with is the same<br>
as Stalin&#39;s design.<br>
<br>
It is a propagation network. Basically you have a graph of Tree-IL<br>
nodes, where each Tree-IL node is connected to its parent, its<br>
children, and optionally other nodes (a variable is connected to the<br>
place it was declared. A primitive function is connected to the error<br>
continuation it could jump to). The compiler propagates information<br>
along the edges of this graph, attempting to find the minimum set of<br>
possible values for each variable and each jump target. It also<br>
performs partial evaluation as a special case of this.<br>
<br>
What I have described also seems to be how Hindley-Milner type<br>
inference works (although I think we can do a bit better than standard<br>
Hindley-Milner systems). Does this seem like a good design for the<br>
static analyzer portion?<br>
<br>
One big oversight that I know of is that this doesn&#39;t do any sort of<br=
>
specialization. I think that is an extremely important feature, but<br>
when I looked at doing specialization I thought that it would use all<br>
of the logic this would, but require a bit more work to keep the<br>
complexity down, so I thought I should do this first.<br>
<br>
I haven&#39;t thought much about the rest of the compiler yet, but I<br>
imagine you can basically walk this graph and try to choose<br>
representations for each piece of it using the information you<br>
gathered in the analysis phase. The key ingredient for that will be a<br>
library of representations for each Tree-IL node.<br>
<br>
The second part of this post is a logistical question. I would like to<br>
do this work in public, so other people can see it (and hopefully<br>
contribute). Where is the best place to do this? Should I make a<br>
branch on Savannah? That makes the most sense to me, but it seems a<br>
bit unnatural, since this project is very separate from the rest of<br>
Guile.<br>
<br>
And finally, a fun thing. The current best Scheme compiler (that I<br>
know of) is called Stalin. Therefore, I suggest that our compiler be<br>
called &quot;Stallman&quot;, after our fearless leader (whose name also sta=
rts<br>
with &quot;s&quot;). :-)<br>
<br>
Thanks a lot,<br>
Noah<br>
<br>
</blockquote></div><br></div>

--bcaec547cad91ebad504b42310b6--


From MAILER-DAEMON Thu Dec 15 10:34:34 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbDKM-0002b5-5s
	for mharc-guile-devel@gnu.org; Thu, 15 Dec 2011 10:34:34 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55398)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbDKF-0002TT-3E
	for guile-devel@gnu.org; Thu, 15 Dec 2011 10:34:32 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbDK9-0007QR-8v
	for guile-devel@gnu.org; Thu, 15 Dec 2011 10:34:27 -0500
Received: from lo.gmane.org ([80.91.229.12]:36608)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbDK9-0007Ph-3o
	for guile-devel@gnu.org; Thu, 15 Dec 2011 10:34:21 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbDK6-0001fd-PV
	for guile-devel@gnu.org; Thu, 15 Dec 2011 16:34:18 +0100
Received: from p508eb977.dip.t-dialin.net ([80.142.185.119])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Thu, 15 Dec 2011 16:34:18 +0100
Received: from dak by p508eb977.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Thu, 15 Dec 2011 16:34:18 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Update and Questions
Date: Thu, 15 Dec 2011 16:34:05 +0100
Organization: Organization?!?
Lines: 15
Message-ID: <87wr9x6e8i.fsf@fencepost.gnu.org>
References: <CA+U71=MMST=EkYSEgXkaMFpfyvbKnQmKqomJm8XGHeKzpa+Vkg@mail.gmail.com>
	<CAPjoZocybpKLANd0WaoV-214eNWt4C=zqpDzA4eVJQ8PPT_30g@mail.gmail.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508eb977.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:OVX/z0BsfRBxt3Uq3jNCYz3mtEk=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 15 Dec 2011 15:34:32 -0000

Nala Ginrut <nalaginrut@gmail.com> writes:

> So it'd be the preform of something kind of Guile's AOT compiler which
> we(all guilers) had talked about few months ago?
> I think it's a great idea! And I'm glad to see your work.
>
>
> PS: I agree with "Stallman". ;-)

Stallman -pedantic guile.scm

looks redundant.

-- 
David Kastrup



From MAILER-DAEMON Thu Dec 15 10:42:48 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbDSK-0005Ni-5x
	for mharc-guile-devel@gnu.org; Thu, 15 Dec 2011 10:42:48 -0500
Received: from eggs.gnu.org ([140.186.70.92]:60397)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RbDSD-0005NZ-Sz
	for guile-devel@gnu.org; Thu, 15 Dec 2011 10:42:46 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RbDS7-00016U-Jl
	for guile-devel@gnu.org; Thu, 15 Dec 2011 10:42:41 -0500
Received: from mail-vw0-f41.google.com ([209.85.212.41]:59625)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>)
	id 1RbDS1-00015I-IC; Thu, 15 Dec 2011 10:42:29 -0500
Received: by vbbfn1 with SMTP id fn1so1935723vbb.0
	for <multiple recipients>; Thu, 15 Dec 2011 07:42:29 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=Y1EGrvkB4P8xJdY97FZ56KO0Iv0aqrppKeQrOSRv+nY=;
	b=hv+cuLCg2ZeHibPqC0LTkRx/MFbbIbpq4mvHhmY0xTNXutgbcTWljnqDYcBly11BSu
	AYlvTUVeBmsCMXDnmgCP89u+RgXm/rEl7AhvdFhqNzLRkda0u1pc1ev85bj7pdjhJkO8
	33s2yaVqdo6IMRDp0/yqOiKul9K1NJUO0gVk0=
MIME-Version: 1.0
Received: by 10.52.94.75 with SMTP id da11mr3386393vdb.111.1323963748973; Thu,
	15 Dec 2011 07:42:28 -0800 (PST)
Received: by 10.52.31.165 with HTTP; Thu, 15 Dec 2011 07:42:28 -0800 (PST)
In-Reply-To: <87wr9x6e8i.fsf@fencepost.gnu.org>
References: <CA+U71=MMST=EkYSEgXkaMFpfyvbKnQmKqomJm8XGHeKzpa+Vkg@mail.gmail.com>
	<CAPjoZocybpKLANd0WaoV-214eNWt4C=zqpDzA4eVJQ8PPT_30g@mail.gmail.com>
	<87wr9x6e8i.fsf@fencepost.gnu.org>
Date: Thu, 15 Dec 2011 23:42:28 +0800
Message-ID: <CAPjoZocQbkR6c5gaW8QR2B0ZHBM45T8VA+mkG7g4r7YmMxdLBQ@mail.gmail.com>
Subject: Re: Update and Questions
From: Nala Ginrut <nalaginrut@gmail.com>
To: David Kastrup <dak@gnu.org>, Noah Lavine <noah.b.lavine@gmail.com>
Content-Type: multipart/alternative; boundary=20cf307f312ef3fd9c04b42354f4
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.212.41
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 15 Dec 2011 15:42:46 -0000

--20cf307f312ef3fd9c04b42354f4
Content-Type: text/plain; charset=UTF-8

-pedantic? Sorry, but I'm afraid I didn't see it in Noah's description.
Anyone give me some context?

On Thu, Dec 15, 2011 at 11:34 PM, David Kastrup <dak@gnu.org> wrote:

> Nala Ginrut <nalaginrut@gmail.com> writes:
>
> > So it'd be the preform of something kind of Guile's AOT compiler which
> > we(all guilers)  had talked about few months ago?
> > I think it's a great idea!  And I'm glad to see your work.
> >
> >
> > PS:  I agree with "Stallman". ;-)
>
> Stallman -pedantic guile.scm
>
> looks redundant.
>
> --
> David Kastrup
>
>
>

--20cf307f312ef3fd9c04b42354f4
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

-pedantic? Sorry, but I&#39;m afraid I didn&#39;t see it in Noah&#39;s desc=
ription.=C2=A0<div>Anyone give me some context?<br><br><div class=3D"gmail_=
quote">On Thu, Dec 15, 2011 at 11:34 PM, David Kastrup <span dir=3D"ltr">&l=
t;<a href=3D"mailto:dak@gnu.org">dak@gnu.org</a>&gt;</span> wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex"><div class=3D"im">Nala Ginrut &lt;<a href=3D=
"mailto:nalaginrut@gmail.com">nalaginrut@gmail.com</a>&gt; writes:<br>
<br>
&gt; So it&#39;d be the preform of something kind of Guile&#39;s AOT compil=
er which<br>
&gt; we(all guilers) =C2=A0had talked about few months ago?<br>
&gt; I think it&#39;s a great idea! =C2=A0And I&#39;m glad to see your work=
.<br>
&gt;<br>
&gt;<br>
&gt; PS: =C2=A0I agree with &quot;Stallman&quot;. ;-)<br>
<br>
</div>Stallman -pedantic guile.scm<br>
<br>
looks redundant.<br>
<span class=3D"HOEnZb"><font color=3D"#888888"><br>
--<br>
David Kastrup<br>
<br>
<br>
</font></span></blockquote></div><br></div>

--20cf307f312ef3fd9c04b42354f4--


From MAILER-DAEMON Thu Dec 15 11:00:17 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbDjF-0003Qs-Qc
	for mharc-guile-devel@gnu.org; Thu, 15 Dec 2011 11:00:17 -0500
Received: from eggs.gnu.org ([140.186.70.92]:33731)
	by lists.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RbDj9-0003Pn-7N
	for guile-devel@gnu.org; Thu, 15 Dec 2011 11:00:15 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dak@gnu.org>) id 1RbDj3-0005XR-1Q
	for guile-devel@gnu.org; Thu, 15 Dec 2011 11:00:11 -0500
Received: from fencepost.gnu.org ([140.186.70.10]:55357)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <dak@gnu.org>)
	id 1RbDj2-0005XN-Uu
	for guile-devel@gnu.org; Thu, 15 Dec 2011 11:00:05 -0500
Received: from localhost ([127.0.0.1]:37043 helo=lola)
	by fencepost.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dak@gnu.org>)
	id 1RbDj2-0003yr-Hh; Thu, 15 Dec 2011 11:00:04 -0500
Received: by lola (Postfix, from userid 1000)
	id 4C3EFE05DF; Thu, 15 Dec 2011 17:00:03 +0100 (CET)
From: David Kastrup <dak@gnu.org>
To: Nala Ginrut <nalaginrut@gmail.com>
Subject: Re: Update and Questions
References: <CA+U71=MMST=EkYSEgXkaMFpfyvbKnQmKqomJm8XGHeKzpa+Vkg@mail.gmail.com>
	<CAPjoZocybpKLANd0WaoV-214eNWt4C=zqpDzA4eVJQ8PPT_30g@mail.gmail.com>
	<87wr9x6e8i.fsf@fencepost.gnu.org>
	<CAPjoZocQbkR6c5gaW8QR2B0ZHBM45T8VA+mkG7g4r7YmMxdLBQ@mail.gmail.com>
Date: Thu, 15 Dec 2011 17:00:03 +0100
In-Reply-To: <CAPjoZocQbkR6c5gaW8QR2B0ZHBM45T8VA+mkG7g4r7YmMxdLBQ@mail.gmail.com>
	(Nala Ginrut's message of "Thu, 15 Dec 2011 23:42:28 +0800")
Message-ID: <87obv96d18.fsf@fencepost.gnu.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 140.186.70.10
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 15 Dec 2011 16:00:15 -0000

Nala Ginrut <nalaginrut@gmail.com> writes:

> -pedantic? Sorry, but I'm afraid I didn't see it in Noah's
> description.=A0
>
> Anyone give me some context?

gcc has an option -pedantic for strict standard adherence.

--=20
David Kastrup


From MAILER-DAEMON Thu Dec 15 11:20:09 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbE2T-0001YR-8I
	for mharc-guile-devel@gnu.org; Thu, 15 Dec 2011 11:20:09 -0500
Received: from eggs.gnu.org ([140.186.70.92]:54742)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RbE2L-0001TN-LE
	for guile-devel@gnu.org; Thu, 15 Dec 2011 11:20:07 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RbE2G-0003tf-GO
	for guile-devel@gnu.org; Thu, 15 Dec 2011 11:20:01 -0500
Received: from mail-vx0-f169.google.com ([209.85.220.169]:56571)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>)
	id 1RbE2A-0003ox-EP; Thu, 15 Dec 2011 11:19:50 -0500
Received: by vcge1 with SMTP id e1so808755vcg.0
	for <multiple recipients>; Thu, 15 Dec 2011 08:19:50 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=IBPtPEZOCNs0vILwQX9PRNwsPegm0S7c2GREsh48XAI=;
	b=Bx/jtofj0iGA08ouq3JOg6HV7XT+Ssi/SXPLKl4olEd5ywjaljJbku8eS/qo8sAa12
	9bzXJWpLqQgMtCsXQl02tGZ4cipIBuR0StOxUegz7kbCNUGa/371xxG2cZaDW6bM8GSE
	teUykoELbPzNdf6yV2db4/HK4C0T7ZwYN2Tt4=
MIME-Version: 1.0
Received: by 10.220.224.194 with SMTP id ip2mr562609vcb.41.1323965989860; Thu,
	15 Dec 2011 08:19:49 -0800 (PST)
Received: by 10.52.31.165 with HTTP; Thu, 15 Dec 2011 08:19:49 -0800 (PST)
In-Reply-To: <87obv96d18.fsf@fencepost.gnu.org>
References: <CA+U71=MMST=EkYSEgXkaMFpfyvbKnQmKqomJm8XGHeKzpa+Vkg@mail.gmail.com>
	<CAPjoZocybpKLANd0WaoV-214eNWt4C=zqpDzA4eVJQ8PPT_30g@mail.gmail.com>
	<87wr9x6e8i.fsf@fencepost.gnu.org>
	<CAPjoZocQbkR6c5gaW8QR2B0ZHBM45T8VA+mkG7g4r7YmMxdLBQ@mail.gmail.com>
	<87obv96d18.fsf@fencepost.gnu.org>
Date: Fri, 16 Dec 2011 00:19:49 +0800
Message-ID: <CAPjoZodNeqaQvRCmr1J5wc6VKzLTrmnQD=oNzfYg6C+m6BZ+Kw@mail.gmail.com>
Subject: Re: Update and Questions
From: Nala Ginrut <nalaginrut@gmail.com>
To: David Kastrup <dak@gnu.org>
Content-Type: multipart/alternative; boundary=14dae9cdc34585357104b423da8b
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.220.169
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 15 Dec 2011 16:20:07 -0000

--14dae9cdc34585357104b423da8b
Content-Type: text/plain; charset=UTF-8

well, I see. I haven't used Stalin before, so I guess the generated C code
must be compiled without any Gcc extension?

@Noah: Anyway, will you add r5rs support to it? I found Stalin doesn't
provide that.

On Fri, Dec 16, 2011 at 12:00 AM, David Kastrup <dak@gnu.org> wrote:

> Nala Ginrut <nalaginrut@gmail.com> writes:
>
> > -pedantic? Sorry, but I'm afraid I didn't see it in Noah's
> > description.
> >
> > Anyone give me some context?
>
> gcc has an option -pedantic for strict standard adherence.
>
> --
> David Kastrup
>

--14dae9cdc34585357104b423da8b
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

well, I see. I haven&#39;t used=C2=A0Stalin=C2=A0before, so I guess the gen=
erated C code must be compiled without any Gcc extension?<div><div><br></di=
v><div>@Noah: Anyway, will you add r5rs support to it? I found Stalin doesn=
&#39;t provide that.</div>
<div><br><div class=3D"gmail_quote">On Fri, Dec 16, 2011 at 12:00 AM, David=
 Kastrup <span dir=3D"ltr">&lt;<a href=3D"mailto:dak@gnu.org">dak@gnu.org</=
a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0=
 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
<div class=3D"im">Nala Ginrut &lt;<a href=3D"mailto:nalaginrut@gmail.com">n=
alaginrut@gmail.com</a>&gt; writes:<br>
<br>
&gt; -pedantic? Sorry, but I&#39;m afraid I didn&#39;t see it in Noah&#39;s=
<br>
&gt; description.=C2=A0<br>
&gt;<br>
&gt; Anyone give me some context?<br>
<br>
</div>gcc has an option -pedantic for strict standard adherence.<br>
<span class=3D"HOEnZb"><font color=3D"#888888"><br>
--<br>
David Kastrup<br>
</font></span></blockquote></div><br></div></div>

--14dae9cdc34585357104b423da8b--


From MAILER-DAEMON Thu Dec 15 11:53:10 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbEYQ-0004bH-PO
	for mharc-guile-devel@gnu.org; Thu, 15 Dec 2011 11:53:10 -0500
Received: from eggs.gnu.org ([140.186.70.92]:56526)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <haberg-1@telia.com>) id 1RbEYO-0004b3-IA
	for guile-devel@gnu.org; Thu, 15 Dec 2011 11:53:09 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <haberg-1@telia.com>) id 1RbEYJ-0003OU-PZ
	for guile-devel@gnu.org; Thu, 15 Dec 2011 11:53:08 -0500
Received: from smtp-out21.han.skanova.net ([195.67.226.208]:39479)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <haberg-1@telia.com>) id 1RbEYJ-0003Nv-C5
	for guile-devel@gnu.org; Thu, 15 Dec 2011 11:53:03 -0500
Received: from [10.0.1.2] (217.210.127.13) by smtp-out21.han.skanova.net
	(8.5.133) (authenticated as u26619196)
	id 4EC0B93A00CFAB59; Thu, 15 Dec 2011 17:52:04 +0100
Subject: Re: summary: lilypond, lambda, and local-eval
Mime-Version: 1.0 (Apple Message framework v1251.1)
Content-Type: text/plain; charset=us-ascii
From: Hans Aberg <haberg-1@telia.com>
In-Reply-To: <87r506uodd.fsf@pobox.com>
Date: Thu, 15 Dec 2011 17:52:03 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <9365BFAA-2F16-438E-A6B7-7C2AE4E48B08@telia.com>
References: <87r506uodd.fsf@pobox.com>
To: Andy Wingo <wingo@pobox.com>
X-Mailer: Apple Mail (2.1251.1)
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 195.67.226.208
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 15 Dec 2011 16:53:09 -0000

On 15 Dec 2011, at 11:21, Andy Wingo wrote:

> The "delayed evaluation" thread is a bit long and confusing, so I =
would
> like to try to summarize it.
>=20
> Lilypond has a way to embed Lilypond code in Scheme, and Scheme code =
in
> Lilypond code.  The former uses a reader macro, #{#}.  The latter uses
> specially-marked variables and expressions, specifically, those =
preceded
> by $ or #.
...
> It took some time for everyone to understand the problem.  In the end,
> there were four workable possibilities.
>=20
>  1) Keep using closures.

When doing a parser on top of Guile, I noticed one must first build an =
unevaluated closure, and only thereafter call the evaluator. Scheme has =
some restrictions forcing this, for example, the lambda cannot appear as =
a free symbol, though it is possible in Guile using scm_sym_lambda.=20

It might be useful with a variation of scm_eval_string() that only =
parses and builds the closure, but not calls the evaluator.

Hans




From MAILER-DAEMON Thu Dec 15 12:24:37 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbF2r-0000w0-Nf
	for mharc-guile-devel@gnu.org; Thu, 15 Dec 2011 12:24:37 -0500
Received: from eggs.gnu.org ([140.186.70.92]:36898)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbF2o-0000tO-LC
	for guile-devel@gnu.org; Thu, 15 Dec 2011 12:24:35 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbF2n-0002Xs-Bd
	for guile-devel@gnu.org; Thu, 15 Dec 2011 12:24:34 -0500
Received: from lo.gmane.org ([80.91.229.12]:49290)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbF2n-0002Xe-07
	for guile-devel@gnu.org; Thu, 15 Dec 2011 12:24:33 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbF2k-0006BN-Rl
	for guile-devel@gnu.org; Thu, 15 Dec 2011 18:24:30 +0100
Received: from p508eb977.dip.t-dialin.net ([80.142.185.119])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Thu, 15 Dec 2011 18:24:30 +0100
Received: from dak by p508eb977.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Thu, 15 Dec 2011 18:24:30 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: summary: lilypond, lambda, and local-eval
Date: Thu, 15 Dec 2011 18:24:16 +0100
Organization: Organization?!?
Lines: 63
Message-ID: <87bor9694v.fsf@fencepost.gnu.org>
References: <87r506uodd.fsf@pobox.com>
	<9365BFAA-2F16-438E-A6B7-7C2AE4E48B08@telia.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508eb977.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:6kxdCc1KKqWo/WMVWOY1xGIw8so=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 15 Dec 2011 17:24:35 -0000

Hans Aberg <haberg-1@telia.com> writes:

> On 15 Dec 2011, at 11:21, Andy Wingo wrote:
>
>> The "delayed evaluation" thread is a bit long and confusing, so I would
>> like to try to summarize it.
>> 
>> Lilypond has a way to embed Lilypond code in Scheme, and Scheme code in
>> Lilypond code.  The former uses a reader macro, #{#}.  The latter uses
>> specially-marked variables and expressions, specifically, those preceded
>> by $ or #.
> ...
>> It took some time for everyone to understand the problem.  In the end,
>> there were four workable possibilities.
>> 
>>  1) Keep using closures.
>
> When doing a parser on top of Guile, I noticed one must first build an
> unevaluated closure, and only thereafter call the evaluator. Scheme
> has some restrictions forcing this, for example, the lambda cannot
> appear as a free symbol, though it is possible in Guile using
> scm_sym_lambda.
>
> It might be useful with a variation of scm_eval_string() that only
> parses and builds the closure, but not calls the evaluator.

I am not sure what you mean with "closure" here, but just "read" parses
a form.

I was actually surprised playing around with the dirty call/cc hack I
posted about just how many uses of my-eval and my-env appear to do what
you would expect to in Guilev1:

(define (my-eval form env)
  (call-with-current-continuation
   (lambda (x)
     (env (list x form)))))

(define-macro (my-env)
  (call-with-current-continuation identity))

(define (xxx)
  (let* ((x 2))
    (set! x (+ x 3))
    (my-env)))

(format #t "~a\n"
	(my-eval
	 '(begin (set! x (+ x 5))
		 x)
	 (xxx)))

So far, just fooling around in the expectation that things will break
has not succeeded.  One probably should do a more analytic attempt of
breakage.  I have little doubt that using a compiler would make it much
less likely to get working results, but haven't tried.

Of course, exporting a half-finished evaluator is much less likely to
work reliably and with tolerable amount of stored information than a
properly exported environment would.

-- 
David Kastrup



From MAILER-DAEMON Thu Dec 15 12:52:49 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbFU9-0007lL-Da
	for mharc-guile-devel@gnu.org; Thu, 15 Dec 2011 12:52:49 -0500
Received: from eggs.gnu.org ([140.186.70.92]:34070)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <haberg-1@telia.com>) id 1RbFU5-0007kv-V4
	for guile-devel@gnu.org; Thu, 15 Dec 2011 12:52:47 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <haberg-1@telia.com>) id 1RbFU4-000256-V8
	for guile-devel@gnu.org; Thu, 15 Dec 2011 12:52:45 -0500
Received: from smtp-out21.han.skanova.net ([195.67.226.208]:49251)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <haberg-1@telia.com>)
	id 1RbFTy-00023G-8g; Thu, 15 Dec 2011 12:52:38 -0500
Received: from [10.0.1.2] (217.210.127.13) by smtp-out21.han.skanova.net
	(8.5.133) (authenticated as u26619196)
	id 4EC0B93A00D001A2; Thu, 15 Dec 2011 18:52:35 +0100
Subject: Re: summary: lilypond, lambda, and local-eval
Mime-Version: 1.0 (Apple Message framework v1251.1)
Content-Type: text/plain; charset=us-ascii
From: Hans Aberg <haberg-1@telia.com>
In-Reply-To: <87bor9694v.fsf@fencepost.gnu.org>
Date: Thu, 15 Dec 2011 18:52:35 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <9015E9C4-44FC-4786-83DC-61E90A5F0586@telia.com>
References: <87r506uodd.fsf@pobox.com>
	<9365BFAA-2F16-438E-A6B7-7C2AE4E48B08@telia.com>
	<87bor9694v.fsf@fencepost.gnu.org>
To: David Kastrup <dak@gnu.org>
X-Mailer: Apple Mail (2.1251.1)
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 195.67.226.208
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 15 Dec 2011 17:52:47 -0000

On 15 Dec 2011, at 18:24, David Kastrup wrote:

>>> The "delayed evaluation" thread is a bit long and confusing, so I =
would
>>> like to try to summarize it.
>>>=20
>>> Lilypond has a way to embed Lilypond code in Scheme, and Scheme code =
in
>>> Lilypond code.  The former uses a reader macro, #{#}.  The latter =
uses
>>> specially-marked variables and expressions, specifically, those =
preceded
>>> by $ or #.
>> ...
>>> It took some time for everyone to understand the problem.  In the =
end,
>>> there were four workable possibilities.
>>>=20
>>> 1) Keep using closures.
>>=20
>> When doing a parser on top of Guile, I noticed one must first build =
an
>> unevaluated closure, and only thereafter call the evaluator. Scheme
>> has some restrictions forcing this, for example, the lambda cannot
>> appear as a free symbol, though it is possible in Guile using
>> scm_sym_lambda.
>>=20
>> It might be useful with a variation of scm_eval_string() that only
>> parses and builds the closure, but not calls the evaluator.
>=20
> I am not sure what you mean with "closure" here, but just "read" =
parses
> a form.

I build them from scratch, using the scm_x calls, with a parser. This =
way, it is possible to a more than within the Scheme paradigm itself. =
For example,
  scm_list_x(scm_sym_lambda, ...)
gives an unevaluated lambda-expression. Some symbols are not available =
in Guile, so for example, I have in my init():
  SCM list_ =3D scm_from_locale_symbol("list");

After an expression has been built, the parser calls =
scm_primitive_eval(). However, suppose one wants to insert some Scheme =
code in to the expression, then scm_eval_string() will call the =
evaluator, enforcing that only complete Scheme expressions can be =
inserted:

Without that restriction it would be possible to have an expression like
  f :=3D x |-> scheme "(+ x 1)"
where only the quote is the actual scheme code and the other handled by =
the external parser, and where the external "x" binds to the one in the =
Scheme code string "(+ x 1)". However, when scm_eval_string() calls the =
evaluator, one gets an error, because "x" is not bound.

Hans




From MAILER-DAEMON Thu Dec 15 14:08:39 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbGfX-0006N5-K4
	for mharc-guile-devel@gnu.org; Thu, 15 Dec 2011 14:08:39 -0500
Received: from eggs.gnu.org ([140.186.70.92]:38295)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RbGfV-0006KM-1L
	for guile-devel@gnu.org; Thu, 15 Dec 2011 14:08:37 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RbGfT-0002rD-TE
	for guile-devel@gnu.org; Thu, 15 Dec 2011 14:08:37 -0500
Received: from mail4-relais-sop.national.inria.fr ([192.134.164.105]:9683)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <ludo@gnu.org>)
	id 1RbGfT-0002r6-Ia
	for guile-devel@gnu.org; Thu, 15 Dec 2011 14:08:35 -0500
X-IronPort-AV: E=Sophos;i="4.71,359,1320620400"; d="scan'208";a="123555425"
Received: from reverse-83.fdn.fr (HELO pluto) ([80.67.176.83])
	by mail4-relais-sop.national.inria.fr with ESMTP/TLS/DHE-RSA-AES128-SHA;
	15 Dec 2011 20:08:33 +0100
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
To: Mark H Weaver <mhw@netris.org>
Subject: Re: Accessing the environment's locale encoding settings
References: <877h30exfk.fsf@gnu.org> <201111160300.38410.bruno@clisp.org>
	<87r5189wxw.fsf@gnu.org> <201111201755.18910.bruno@clisp.org>
	<87ehx2bsis.fsf@gnu.org>
	<1321818250.84716.YahooMailNeo@web37905.mail.mud.yahoo.com>
	<878vn6l8qf.fsf@gnu.org> <87d3ch6jdv.fsf@netris.org>
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 25 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
Date: Thu, 15 Dec 2011 20:08:31 +0100
In-Reply-To: <87d3ch6jdv.fsf@netris.org> (Mark H. Weaver's message of "Thu, 24
	Nov 2011 21:11:40 -0500")
Message-ID: <87fwglejps.fsf@gnu.org>
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 192.134.164.105
Cc: Bruno Haible <bruno@clisp.org>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 15 Dec 2011 19:08:38 -0000

Hi,

Apologies for not answering earlier, and for making changes without
continuing this discussion.  So here=E2=80=99s an after-the-fact reply.

Mark H Weaver <mhw@netris.org> skribis:

> ludo@gnu.org (Ludovic Court=C3=A8s) writes:
>> It=E2=80=99s not completely satisfying either because --locale is not in
>> 2.0.[0-3], so users who really need it will need some configury;
>> furthermore, from 2.2.x on, it will be mostly unneeded.
>>
>> Yet, a choice has to be made between this hack and the other one.  :-)
>>
>> Thoughts?
>
> I like the --locale argument, except that the default (if there is no
> --locale argument) should be to either (A) call setlocale(LC_ALL, "") or
> (B) do something like the other hack, where the arguments are decoded as
> if the locale had been temporarily set according to the environment
> variables.
>
> My strong preference would be Option A.

The problem I see with changing the default to call setlocale(LC_ALL,
"") is that %default-port-encoding would no longer match the current
locale, as is currently the case.  Or we=E2=80=99d have to change its defau=
lt
value.  But I thought this would be too disruptive in either case, and
thus I stick to Option B.

> If you are trying to maintain backward compatibility, keep in mind that
> for most practical purposes, Guile 1.8 acts closer to option A than the
> other options.  Furthermore, Option A is the Right Thing moving forward,
> and matches what Guile 2.2 will do.
>
> If we accept only ASCII arguments by default, then _most_ Guile scripts
> will need to add the --locale argument, but only for versions after
> 2.0.3.  More likely, many authors won't bother with this ugliness, and
> their scripts will be broken for non-ASCII locales.

Yes, I thought about that too, and thought it counted against Option A.

So the current situation is:

  =E2=80=A2 In 2.0, one still has to call =E2=80=98setlocale=E2=80=99 impli=
citly, but
    command-line arguments are converted from the locale encoding
    suggested by the environment variables (commit
    ed4c3739668b4b111b38555b8bc101cb74c87c1c).

  =E2=80=A2 In 2.1, the =E2=80=98setlocale=E2=80=99 call is implicit when t=
he =E2=80=98guile=E2=80=99 executable
    is used (commit bb9b357e2b98cea82f844115ee5f66704bb6a1c8).  The
    %default-port-encoding value is still Latin-1, but presumably that
    would need to be changed to the current locale encoding.  Thoughts?

Nothing=E2=80=99s set in stone and I=E2=80=99m glad to revisit the situatio=
n.

Thanks,
Ludo=E2=80=99.


From MAILER-DAEMON Thu Dec 15 14:19:45 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbGqH-00083e-Nv
	for mharc-guile-devel@gnu.org; Thu, 15 Dec 2011 14:19:45 -0500
Received: from eggs.gnu.org ([140.186.70.92]:46521)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbGqE-000803-4E
	for guile-devel@gnu.org; Thu, 15 Dec 2011 14:19:43 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbGqD-0005Yf-1v
	for guile-devel@gnu.org; Thu, 15 Dec 2011 14:19:42 -0500
Received: from lo.gmane.org ([80.91.229.12]:57764)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbGqC-0005YI-Ss
	for guile-devel@gnu.org; Thu, 15 Dec 2011 14:19:41 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbGq8-0007Ay-FY
	for guile-devel@gnu.org; Thu, 15 Dec 2011 20:19:36 +0100
Received: from reverse-83.fdn.fr ([80.67.176.83])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Thu, 15 Dec 2011 20:19:36 +0100
Received: from ludo by reverse-83.fdn.fr with local (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Thu, 15 Dec 2011 20:19:36 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
Subject: Re: "exec" procedures don't handle the optional parameters unbounded
	situation?
Date: Thu, 15 Dec 2011 20:19:19 +0100
Lines: 21
Message-ID: <877h1xej7s.fsf@gnu.org>
References: <CAPjoZocbzu__+KOmvZf1h9P854HxbAawdR=poM0nHNa9RSi1jg@mail.gmail.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: reverse-83.fdn.fr
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 25 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:y7/aTQlYK5/sJrz9cCnw/Hz3gKQ=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 15 Dec 2011 19:19:43 -0000

Hi!

Sorry for the late reply.

Nala Ginrut <nalaginrut@gmail.com> skribis:

> I found "exec" serial procedures didn't check the unbounded optional
> parameters.
> (execlp "ls")  ==> segment fault

What you’re seeing here is SIGABRT, not SIGSEGV, preceded by the message:

  A NULL argv[0] was passed through an exec system call.

That message comes from Gnulib’s ‘set_program_name’ [0], which is used
by all GNU Coreutils program, and which aborts when argv[0] is NULL.

Thanks,
Ludo’.

[0] http://git.savannah.gnu.org/cgit/gnulib.git/tree/lib/progname.c#n53



From MAILER-DAEMON Thu Dec 15 18:06:20 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbKNY-0005zJ-O0
	for mharc-guile-devel@gnu.org; Thu, 15 Dec 2011 18:06:20 -0500
Received: from eggs.gnu.org ([140.186.70.92]:44971)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RbKNV-0005xa-NL
	for guile-devel@gnu.org; Thu, 15 Dec 2011 18:06:18 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RbKNU-00084W-Qt
	for guile-devel@gnu.org; Thu, 15 Dec 2011 18:06:17 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:56910)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>)
	id 1RbKNT-00084G-Tn; Thu, 15 Dec 2011 18:06:15 -0500
Received: by iacb35 with SMTP id b35so1998256iac.0
	for <multiple recipients>; Thu, 15 Dec 2011 15:06:15 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:sender:in-reply-to:references:date
	:x-google-sender-auth:message-id:subject:from:to:cc:content-type
	:content-transfer-encoding;
	bh=G2Cq7+orFB7jMppepaJiQTVeAiqn+NPzOEhYEYkZruQ=;
	b=NYei26JY7Fq9/FLnb0DrIhczyH9xgFJbQdg/DIj2+CVJWfpjRZeHWfj+cNipodwzLt
	VIrTkMkRI0ojYn/GxDtZCdhkaR4qtOPc5shSSgPtqFCOVavig1QTT7KLJHv6WHc3wMLT
	+aPA+xaB/WEu6rv/0b6602DfmheZpX2m6MyMY=
MIME-Version: 1.0
Received: by 10.50.161.162 with SMTP id xt2mr4523615igb.72.1323990374802; Thu,
	15 Dec 2011 15:06:14 -0800 (PST)
Sender: noah549@gmail.com
Received: by 10.42.217.6 with HTTP; Thu, 15 Dec 2011 15:06:14 -0800 (PST)
In-Reply-To: <CAPjoZodNeqaQvRCmr1J5wc6VKzLTrmnQD=oNzfYg6C+m6BZ+Kw@mail.gmail.com>
References: <CA+U71=MMST=EkYSEgXkaMFpfyvbKnQmKqomJm8XGHeKzpa+Vkg@mail.gmail.com>
	<CAPjoZocybpKLANd0WaoV-214eNWt4C=zqpDzA4eVJQ8PPT_30g@mail.gmail.com>
	<87wr9x6e8i.fsf@fencepost.gnu.org>
	<CAPjoZocQbkR6c5gaW8QR2B0ZHBM45T8VA+mkG7g4r7YmMxdLBQ@mail.gmail.com>
	<87obv96d18.fsf@fencepost.gnu.org>
	<CAPjoZodNeqaQvRCmr1J5wc6VKzLTrmnQD=oNzfYg6C+m6BZ+Kw@mail.gmail.com>
Date: Thu, 15 Dec 2011 18:06:14 -0500
X-Google-Sender-Auth: aOIOjhomMyGT1sjzyMljQTdieok
Message-ID: <CA+U71=NPZvfwVtpBeL7AnE5_TsfgOj5Yxt3sbuQiYm4tDweKSQ@mail.gmail.com>
Subject: Re: Update and Questions
From: Noah Lavine <noah.b.lavine@gmail.com>
To: Nala Ginrut <nalaginrut@gmail.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
Cc: David Kastrup <dak@gnu.org>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 15 Dec 2011 23:06:19 -0000

On Thu, Dec 15, 2011 at 11:19 AM, Nala Ginrut <nalaginrut@gmail.com> wrote:
> well, I see. I haven't used=A0Stalin=A0before, so I guess the generated C=
 code
> must be compiled without any Gcc extension?

I think he's making a joke that Richard Stallman is always pedantic,
so the -pedantic flag is redundant.

> @Noah: Anyway, will you add r5rs support to it? I found Stalin doesn't
> provide that.

I would love to. That is far in the future, though - my current goal
is to type-check Tree-IL. I have been working on that, and I think I
am close to having something ready to show, although not quite there.
Expect an email about the wip-compiler branch in the next few days.

Noah

> On Fri, Dec 16, 2011 at 12:00 AM, David Kastrup <dak@gnu.org> wrote:
>>
>> Nala Ginrut <nalaginrut@gmail.com> writes:
>>
>> > -pedantic? Sorry, but I'm afraid I didn't see it in Noah's
>> > description.
>> >
>> > Anyone give me some context?
>>
>> gcc has an option -pedantic for strict standard adherence.
>>
>> --
>> David Kastrup
>
>


From MAILER-DAEMON Thu Dec 15 21:52:30 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbNuQ-0008QX-SR
	for mharc-guile-devel@gnu.org; Thu, 15 Dec 2011 21:52:30 -0500
Received: from eggs.gnu.org ([140.186.70.92]:58989)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RbNuO-0008QR-Mh
	for guile-devel@gnu.org; Thu, 15 Dec 2011 21:52:29 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RbNuN-0004Ap-M3
	for guile-devel@gnu.org; Thu, 15 Dec 2011 21:52:28 -0500
Received: from mail-vw0-f41.google.com ([209.85.212.41]:51534)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>)
	id 1RbNuM-0004AS-7J; Thu, 15 Dec 2011 21:52:26 -0500
Received: by vbbfn1 with SMTP id fn1so2494388vbb.0
	for <multiple recipients>; Thu, 15 Dec 2011 18:52:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=JGjxDTFYPd6X1GvAgQuIrk8XVjtBgZwlkrcYBbLLHLk=;
	b=XfLOIbLaKnPggPQzDLz4LC3frT6b7Hz7tN3NfgGAXrQw1iGuiv+fg5Ts1KJsi6dROb
	T4hULJ0cTOIa1YbI1fxC4waalR6PaMlae09vRTpgXBi492mIkoCFLXlpAuSgjY4k1OGe
	xHyTqIMfuEyNb+JjLuqRWfCWxZJpaTKxCNk4U=
MIME-Version: 1.0
Received: by 10.52.92.148 with SMTP id cm20mr4927389vdb.81.1324003944993; Thu,
	15 Dec 2011 18:52:24 -0800 (PST)
Received: by 10.52.69.83 with HTTP; Thu, 15 Dec 2011 18:52:24 -0800 (PST)
In-Reply-To: <CA+U71=NPZvfwVtpBeL7AnE5_TsfgOj5Yxt3sbuQiYm4tDweKSQ@mail.gmail.com>
References: <CA+U71=MMST=EkYSEgXkaMFpfyvbKnQmKqomJm8XGHeKzpa+Vkg@mail.gmail.com>
	<CAPjoZocybpKLANd0WaoV-214eNWt4C=zqpDzA4eVJQ8PPT_30g@mail.gmail.com>
	<87wr9x6e8i.fsf@fencepost.gnu.org>
	<CAPjoZocQbkR6c5gaW8QR2B0ZHBM45T8VA+mkG7g4r7YmMxdLBQ@mail.gmail.com>
	<87obv96d18.fsf@fencepost.gnu.org>
	<CAPjoZodNeqaQvRCmr1J5wc6VKzLTrmnQD=oNzfYg6C+m6BZ+Kw@mail.gmail.com>
	<CA+U71=NPZvfwVtpBeL7AnE5_TsfgOj5Yxt3sbuQiYm4tDweKSQ@mail.gmail.com>
Date: Fri, 16 Dec 2011 10:52:24 +0800
Message-ID: <CAPjoZofYTmcLvpdxrCOVw2AqdGe7WCPs-2vF29yuNeRqdZsK1A@mail.gmail.com>
Subject: Re: Update and Questions
From: Nala Ginrut <nalaginrut@gmail.com>
To: Noah Lavine <noah.b.lavine@gmail.com>
Content-Type: multipart/alternative; boundary=20cf3071c6b2d293f404b42cb099
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.212.41
Cc: David Kastrup <dak@gnu.org>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 02:52:29 -0000

--20cf3071c6b2d293f404b42cb099
Content-Type: text/plain; charset=UTF-8

On Fri, Dec 16, 2011 at 7:06 AM, Noah Lavine <noah.b.lavine@gmail.com>wrote:

> On Thu, Dec 15, 2011 at 11:19 AM, Nala Ginrut <nalaginrut@gmail.com>
> wrote:
> > well, I see. I haven't used Stalin before, so I guess the generated C
> code
> > must be compiled without any Gcc extension?
>
> I think he's making a joke that Richard Stallman is always pedantic,
> so the -pedantic flag is redundant.
>
>
cool.
If Stallman imply -pedantic, then you may consider "Stallman -hasty" for
enabling Gcc extension.


> > @Noah: Anyway, will you add r5rs support to it? I found Stalin doesn't
> > provide that.
>
> I would love to. That is far in the future, though - my current goal
> is to type-check Tree-IL. I have been working on that, and I think I
> am close to having something ready to show, although not quite there.
> Expect an email about the wip-compiler branch in the next few days.
>
>
 cool too~

--20cf3071c6b2d293f404b42cb099
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<br><br><div class=3D"gmail_quote">On Fri, Dec 16, 2011 at 7:06 AM, Noah La=
vine <span dir=3D"ltr">&lt;<a href=3D"mailto:noah.b.lavine@gmail.com">noah.=
b.lavine@gmail.com</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quot=
e" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
<div class=3D"im">On Thu, Dec 15, 2011 at 11:19 AM, Nala Ginrut &lt;<a href=
=3D"mailto:nalaginrut@gmail.com">nalaginrut@gmail.com</a>&gt; wrote:<br>
&gt; well, I see. I haven&#39;t used=C2=A0Stalin=C2=A0before, so I guess th=
e generated C code<br>
&gt; must be compiled without any Gcc extension?<br>
<br>
</div>I think he&#39;s making a joke that Richard Stallman is always pedant=
ic,<br>
so the -pedantic flag is redundant.<br>
<div class=3D"im"><br></div></blockquote><div><br></div><div>cool.</div><di=
v>If Stallman imply -pedantic, then you may consider &quot;Stallman -hasty&=
quot; for enabling Gcc extension.</div><div>=C2=A0</div><blockquote class=
=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padd=
ing-left:1ex">
<div class=3D"im">
&gt; @Noah: Anyway, will you add r5rs support to it? I found Stalin doesn&#=
39;t<br>
&gt; provide that.<br>
<br>
</div>I would love to. That is far in the future, though - my current goal<=
br>
is to type-check Tree-IL. I have been working on that, and I think I<br>
am close to having something ready to show, although not quite there.<br>
Expect an email about the wip-compiler branch in the next few days.<br>
<span class=3D"HOEnZb"><font color=3D"#888888"><br></font></span></blockquo=
te><div><br></div><div>=C2=A0cool too~</div></div>

--20cf3071c6b2d293f404b42cb099--


From MAILER-DAEMON Thu Dec 15 23:03:56 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbP1Y-0000uC-Sr
	for mharc-guile-devel@gnu.org; Thu, 15 Dec 2011 23:03:56 -0500
Received: from eggs.gnu.org ([140.186.70.92]:58555)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RbP1V-0000u2-QA
	for guile-devel@gnu.org; Thu, 15 Dec 2011 23:03:54 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RbP1T-00075f-K2
	for guile-devel@gnu.org; Thu, 15 Dec 2011 23:03:53 -0500
Received: from mail-vx0-f169.google.com ([209.85.220.169]:64316)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>)
	id 1RbP1T-00075b-FX; Thu, 15 Dec 2011 23:03:51 -0500
Received: by vcge1 with SMTP id e1so1381917vcg.0
	for <multiple recipients>; Thu, 15 Dec 2011 20:03:50 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:content-type; bh=ZOEqJEexwwm1QkuhsG1MIOAjkpfrl2Ws4I3B8KXfPq4=;
	b=hEncfexDsw9MretMSF7CBKd8PKQDY3aheSEJbD8HKod+G6Oam+rxf6R2o6OOo8/AAO
	sFOEnPWGTUAL7rjkYBP2HOYTHwFO9YioBF6zsqBiCpxXVs4ufgKLP/IlY67UCAfmSL6r
	+MdOHpsGEZ25D4iMOVgmhBorsbMYzNUP2SIT8=
MIME-Version: 1.0
Received: by 10.220.66.70 with SMTP id m6mr2130105vci.57.1324008230644; Thu,
	15 Dec 2011 20:03:50 -0800 (PST)
Received: by 10.52.69.83 with HTTP; Thu, 15 Dec 2011 20:03:50 -0800 (PST)
In-Reply-To: <877h1xej7s.fsf@gnu.org>
References: <CAPjoZocbzu__+KOmvZf1h9P854HxbAawdR=poM0nHNa9RSi1jg@mail.gmail.com>
	<877h1xej7s.fsf@gnu.org>
Date: Fri, 16 Dec 2011 12:03:50 +0800
Message-ID: <CAPjoZoemjo7HArNgsBGFb2SUF+3RMtVm1XOoU+UF-ryh92fQnQ@mail.gmail.com>
Subject: Re: "exec" procedures don't handle the optional parameters unbounded
	situation?
From: Nala Ginrut <nalaginrut@gmail.com>
To: =?UTF-8?Q?Ludovic_Court=C3=A8s?= <ludo@gnu.org>, 
	guile-devel <guile-devel@gnu.org>
Content-Type: multipart/alternative; boundary=14dae9cdc89d446c8904b42db0ff
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.220.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 04:03:54 -0000

--14dae9cdc89d446c8904b42db0ff
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

hi Ludo, thanks for reply.
I realized that it's not SIGSEGV ,it's an "abort" while argv[0] is NULL.
Now the problem is  "can we avoid to pass void string to exec proc
explicitly"?
Since Guile provides flexible optional arguments handling, why we can not
do this:
let (execlp "ls")  equal to (execlp "ls" "") if the second argument is
unbounded?

On Fri, Dec 16, 2011 at 3:19 AM, Ludovic Court=C3=A8s <ludo@gnu.org> wrote:

> Hi!
>
> Sorry for the late reply.
>
> Nala Ginrut <nalaginrut@gmail.com> skribis:
>
> > I found "exec" serial procedures didn't check the unbounded optional
> > parameters.
> > (execlp "ls")  =3D=3D> segment fault
>
> What you=E2=80=99re seeing here is SIGABRT, not SIGSEGV, preceded by the =
message:
>
>  A NULL argv[0] was passed through an exec system call.
>
> That message comes from Gnulib=E2=80=99s =E2=80=98set_program_name=E2=80=
=99 [0], which is used
> by all GNU Coreutils program, and which aborts when argv[0] is NULL.
>
> Thanks,
> Ludo=E2=80=99.
>
> [0] http://git.savannah.gnu.org/cgit/gnulib.git/tree/lib/progname.c#n53
>
>
>

--14dae9cdc89d446c8904b42db0ff
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

hi Ludo, thanks for reply.<div>I realized that it&#39;s not SIGSEGV ,it&#39=
;s an &quot;abort&quot; while argv[0] is NULL.=C2=A0</div><div>Now the prob=
lem is =C2=A0&quot;can we avoid to pass void string to exec proc explicitly=
&quot;?</div>
<div>Since Guile provides flexible optional arguments handling, why we can =
not do this:</div><div>let (execlp &quot;ls&quot;) =C2=A0equal to (execlp &=
quot;ls&quot; &quot;&quot;) if the second argument is unbounded?<br><div><b=
r>
<div class=3D"gmail_quote">On Fri, Dec 16, 2011 at 3:19 AM, Ludovic Court=
=C3=A8s <span dir=3D"ltr">&lt;<a href=3D"mailto:ludo@gnu.org">ludo@gnu.org<=
/a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:=
0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
Hi!<br>
<br>
Sorry for the late reply.<br>
<br>
Nala Ginrut &lt;<a href=3D"mailto:nalaginrut@gmail.com">nalaginrut@gmail.co=
m</a>&gt; skribis:<br>
<div class=3D"im"><br>
&gt; I found &quot;exec&quot; serial procedures didn&#39;t check the unboun=
ded optional<br>
&gt; parameters.<br>
&gt; (execlp &quot;ls&quot;) =C2=A0=3D=3D&gt; segment fault<br>
<br>
</div>What you=E2=80=99re seeing here is SIGABRT, not SIGSEGV, preceded by =
the message:<br>
<br>
 =C2=A0A NULL argv[0] was passed through an exec system call.<br>
<br>
That message comes from Gnulib=E2=80=99s =E2=80=98set_program_name=E2=80=99=
 [0], which is used<br>
by all GNU Coreutils program, and which aborts when argv[0] is NULL.<br>
<br>
Thanks,<br>
Ludo=E2=80=99.<br>
<br>
[0] <a href=3D"http://git.savannah.gnu.org/cgit/gnulib.git/tree/lib/prognam=
e.c#n53" target=3D"_blank">http://git.savannah.gnu.org/cgit/gnulib.git/tree=
/lib/progname.c#n53</a><br>
<br>
<br>
</blockquote></div><br></div></div>

--14dae9cdc89d446c8904b42db0ff--


From MAILER-DAEMON Fri Dec 16 01:46:10 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbRYY-0002Qi-Lf
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 01:46:10 -0500
Received: from eggs.gnu.org ([140.186.70.92]:38996)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RbRYV-0002QA-HX
	for guile-devel@gnu.org; Fri, 16 Dec 2011 01:46:08 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RbRYU-0007Kj-3l
	for guile-devel@gnu.org; Fri, 16 Dec 2011 01:46:07 -0500
Received: from mail-qy0-f169.google.com ([209.85.216.169]:47290)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cky944@gmail.com>) id 1RbRYT-0007KN-TD
	for guile-devel@gnu.org; Fri, 16 Dec 2011 01:46:06 -0500
Received: by qcsd17 with SMTP id d17so1872275qcs.0
	for <guile-devel@gnu.org>; Thu, 15 Dec 2011 22:46:05 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=date:from:to:subject:message-id:mail-followup-to:references
	:mime-version:content-type:content-disposition
	:content-transfer-encoding:in-reply-to:user-agent;
	bh=57oK/Mm+Ll7xYJZdVHX2L7f8oqlupbjoqRehnij/pX8=;
	b=Ww38Ppe5V/UCl22qFpRmh1mTK3/wHbs4Smg2wZml8Em3yp9/+jIQuBO9devW9u3XUZ
	Es/PIOdouMt8/FFzrXyJlHQx5mDBlsxE4OWM/72HhCt9NMsxkfwJv0/WHOxJT4NEPgRS
	kdKaseOav6/hhLrkP1tosK9wnU2MSwyzcwGoc=
Received: by 10.229.137.21 with SMTP id u21mr941529qct.23.1324017964907;
	Thu, 15 Dec 2011 22:46:04 -0800 (PST)
Received: from lotus.destinee.acro.gen.nz (cpe-069-134-102-132.nc.res.rr.com.
	[69.134.102.132])
	by mx.google.com with ESMTPS id r10sm17828806qaz.7.2011.12.15.22.46.03
	(version=SSLv3 cipher=OTHER); Thu, 15 Dec 2011 22:46:03 -0800 (PST)
Date: Fri, 16 Dec 2011 01:45:49 -0500
From: "Chris K. Jester-Young" <cky944@gmail.com>
To: guile-devel@gnu.org
Subject: Re: SRFI 41 for Guile
Message-ID: <20111216064549.GA18181@lotus.destinee.acro.gen.nz>
Mail-Followup-To: guile-devel@gnu.org
References: <20111206193728.GB14416@yarrow.destinee.acro.gen.nz>
	<877h1zns7c.fsf@gnu.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <877h1zns7c.fsf@gnu.org>
User-Agent: Mutt/1.5.20 (2009-06-14)
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.216.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 06:46:08 -0000

On Wed, Dec 14, 2011 at 03:28:07PM +0100, Ludovic Courtès wrote:
> Could you integrate it in the Guile tree in a branch, as you proposed on
> IRC?  It would make it easier to review it.

Indeed. I might only get to do that in the weekend, and with Christmas
and all that coming up, I can't even promise it'd get done this weekend.

> What you be OK with assigning copyright for your changes to the FSF?

Of course! Just for the record, I've already signed all the necessary
paperwork, but you knew that already. The copyright notices will get
updated when they go "in-tree".

> Also, to what extent is the reference implementation modified?  If the
> modifications are well isolated, it would be nice to see if we could
> import the upstream files unmodified, and then just “patch” them at
> compile-time as is done for match.scm, sxml-match.scm, lalr, and a few
> others.

The changes are very extensive. Almost no function was left intact,
except perhaps the stream-of macro. (It stuck out as one that I wasn't
able to "do better" on.)

I chose to do this because I don't expect the reference implementation
to receive any maintenance at this stage. This is in contrast to the
modules you mentioned above, where you do want to touch base with
upstream from time to time, so leaving them unchanged would reduce the
maintenance burden.

In the case of SRFI 41, I would expect that we'd have an independent
implementation that would become its own thing, and eventually diverge
more and more from the reference implementation as we find things to
improve. Again, this is because I feel the reference implementation
is no longer maintained.

The most important change is that any place where some function can use
another module to do its work, I choose to use the external module to
do so. A prime example is SRFIs. Whereas the reference implementation
goes to extraordinary lengths to avoid depending on other SRFIs, I do
the opposite, and use any and all SRFIs available in Guile that do the
job. For example, I use Guile's SRFI 45 for lazy promises instead of
replicating the whole thing as the reference implementation does.

Other than that, for most functions, the changes followed a predictable
pattern, which didn't change the logic at all, but rather just made the
functions easier to read (for me, at least).

In particular, the reference implementation uses this format:

    (define (stream-foo strm)
      (define (stream-foo strm)
        ...)
      (if (not (stream? strm) ERROR))
      (stream-foo strm))

I use this format instead:

    (define (stream-foo strm)
      (must stream? strm)
      (stream-let recur ((strm strm))
        ...))

The latter is better, in my view, because I don't have to remember that
inside stream-foo, there's an internal binding for stream-foo that
shadows the outer one. stream-foo means one thing only.

stream-drop-while and stream-reverse are further refactored to use a
new stream-do macro.

All the eager-folding functions (stream->list, stream-drop, stream-fold,
stream-length) are refactored to use a common stream-fold-aux function.
This reduces code duplication quite a bit.

For functions that take 1+ streams (stream-for-each, stream-map), I
used case-lambda to both optimise for the one-stream case, and to block
calling the function with no streams.

The above covers changes that don't change the actual logic, they just
reformulate it in a different way.

There are also functions where the actual logic is changed, particularly
stream-constant, stream-match, and stream-unfolds. Those do not bear any
similarities to the reference implementation; they are indeed complete
rewrites. You will want to review those in full.

> Likewise, it may be possible to adapt the original test suite just by
> defining macros that map the expected test suite API to Guile’s.

This is hard, for several reasons.

Guile's test framework has labels for each test, to easily identify
which ones fail. The reference tests do not have such labels. Coming
up with good labels is not something a macro can do, I believe. In
particular, I don't think a stringification of the form under test is
a good, human-readable label.

Also, Guile's test framework has explicit functions for testing for
expected exceptions. The reference tests do not. They simply catch
exceptions, return the message string, and the tests simply expects
the message string. It works in a pinch, but is nowhere as useful as
Guile's pass-if-exception.

There are a number of tests that test whether a given stream has the
expected contents. The reference tests use stream->list to materialise
the whole stream, then compare to the expected values. I don't do that.
Instead, I wrote a stream-equal? function that stops as soon as the
first mismatched element is found.

> The idea is that it would make it easier to see how Guile’s
> implementation differs from upstream, and to update Guile’s copy
> eventually, if needed.

As stated above, because my intention is for Guile's version to be
independent of upstream, my stance is that if the tests do test
everything in the reference test suite (and they do, and some more),
and they all pass, then it's a valid implementation.

When I first started the port, I wanted to be as faithful to the
reference implementation as possible, just to reduce my work. However,
when I realised that it basically reimplemented most everything already
available in Guile modules, I decided that using the modules is more
appropriate. Then updates to those modules would benefit SRFI 41 too.

Case in point: (ice-9 match) still gets upstream updates. By using that
module for matching, we get all its future benefits for free.

> Also, what about moving all or most of the code in srfi-41.scm, instead
> of having several helper modules?

I don't oppose this per se, but I should state for the record what the
purpose of the primitive/derived split is.

(streams primitive), as it's called in SRFI 41, provide the basic
operations needed to have streams. It's totally bloat-free, and if you
want to create your own stream utility module, you would import just
this module.

(streams derived), as it's called in SRFI 41, provide utility functions
and macros atop the (streams primitive) streams. Most end-users will
want to import this module, but it's probably a bit bloaty for stream
library authors to use.

So, while I don't oppose moving all of the _implementation_ into the
top-level (srfi srfi-41), it'd be good to retain the primitive/derived
submodules that can be used to do selective imports of (srfi srfi-41).
That way, people who want bloat-free can do so without having to rewrite
their own import lists.

(In so saying, (streams derived) isn't very useful without (streams
primitive), so perhaps a (srfi srfi-41 derived) selective import module
is probably not useful, and people should just import (srfi srfi-41)
straight. But (srfi srfi-41 primitive) is still, IMHO, useful.)

> (This has been partly discussed on IRC while I was writing this
> message; I hope it’s still relevant.  ;-))

Sure; if nothing else, this puts the whole conversation "on the record".
:-)

Cheers,
Chris.


From MAILER-DAEMON Fri Dec 16 02:37:33 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbSMH-00005G-JW
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 02:37:33 -0500
Received: from eggs.gnu.org ([140.186.70.92]:37125)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbSMC-0008Sc-Kd
	for guile-devel@gnu.org; Fri, 16 Dec 2011 02:37:30 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbSMB-0007Pc-A4
	for guile-devel@gnu.org; Fri, 16 Dec 2011 02:37:28 -0500
Received: from world.peace.net ([96.39.62.75]:36307)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbSMB-0007PW-46
	for guile-devel@gnu.org; Fri, 16 Dec 2011 02:37:27 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RbSM4-0007hx-P5; Fri, 16 Dec 2011 02:37:21 -0500
From: Mark H Weaver <mhw@netris.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: summary: lilypond, lambda, and local-eval
References: <87r506uodd.fsf@pobox.com>
Date: Fri, 16 Dec 2011 02:35:48 -0500
In-Reply-To: <87r506uodd.fsf@pobox.com> (Andy Wingo's message of "Thu, 15 Dec
	2011 11:21:18 +0100")
Message-ID: <87pqfpj7e3.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 07:37:30 -0000

Hello all,

Although it has not yet been decided whether `local-eval' will be
accepted into Guile 2, I've decided to proceed with a proper
implementation that is fully integrated into the compiler.

I hope to demonstrate that this feature can be implemented easily
without creating any significant maintenance burden.

Here's an outline of my plan:


How to compile (the-environment)
================================

Most passes of the compiler will pretend that (the-environment) is
replaced by tree-il code corresponding to the following standard scheme
code:

  (make-lexical-environment  ;; a normal procedure (constructor)
    (case-lambda  ;; general dispatcher to access or mutate any lexical
      (() #f)
      ((name-XXX)            ;; name-XXX is a gensym
       (case name-XXX
         ((<var>) <var>)     ;; one clause for each lexical
         ...))
      ((name-XXX value-XXX)  ;; name-XXX and value-XXX are gensyms
       (case name-XXX
         ((<var>) (set! <var> value-XXX)) ;; one clause for each lexical
         ...)))
    (quote <compiler-environment>)  ;; simple list structure
    (quote <expander-environment>)  ;; simple list structure
    <module>)  ;; XXX not sure how best to represent this

The <expander-environment> is extracted from the tree-il node
corresponding to (the-environment), created by the macro expander.
I've already implemented this part in my previous patch.

The <compiler-environment> would include a list of lexical variable
names (<var> ...), which must exactly correspond to the closure slots of
the `case-lambda', in order to implement `local-eval'.  We _might_ also
need to include some information about how those variables are stored,
e.g. a flag telling whether they are boxed.  (Usually they will all be
boxed, but

Note that general-purpose dispatcher will not actually be used by
`local-eval'.  Its purpose is primarily to force all of the visible
lexicals to be boxed and included within the closure.  They are also
there to make any fancy optimizers do the right thing.

KEY POINT: Since the general-purpose dispatcher would be sufficient to
implement `local-eval' in standard scheme, it communicates exactly the
right facts to the code analyzers, no matter how clever they are, and it
does so without the analyzers having to know anything about these new
primitives!


How to implement `local-eval'
=============================

When `local-eval' is called on a lexical environment that was created by
compiled code, it will do the following:

* Macroexpand the local expression within <expander-environment>.

* Compile the expanded expression within <compiler-environment>.
  (I'll explain how to do this below)

* Make a copy of the closure from the lexical environment object, but
  replace its code (the dispatcher) with the newly compiled code.

* Call the newly created closure.

So, the trick is to make sure that the newly compiled code accesses the
closure variables in exactly the same way as the general-purpose
dispatcher.

I haven't yet dug deeply enough into the compiler internals to know the
best way to do this.  Ideally I would create a new procedure to handle
this simply and robustly, making use of <compiler-environment>.

For now, I will describe a method that I suspect would do the right
thing without any new compiler interfaces, though not as efficiently or
robustly: Simply compile the same general-purpose dispatcher as before,
except replace the #f (from the first case-lambda clause) with the
expanded local expression:

  (lambda (<var> ...)  ;; list of lexicals from <compiler-environment>
    (case-lambda
      (() <expanded local expression>)
      ((name-XXX)            ;; name-XXX is a gensym
       (case name-XXX
         ((<var>) <var>)     ;; one clause for each lexical
         ...))
      ((name-XXX value-XXX)  ;; name-XXX and value-XXX are gensyms
       (case name-XXX
         ((<var>) (set! <var> value-XXX)) ;; one clause for each lexical
         ...))))

and then extract the code from the inner `case-lambda'.  As described
above, this code would replace the code portion of the captured closure.

NOTE: This assumes that case-lambda creates only one closure for all
cases.  I confess that I haven't yet verified this suspicion.  If this
is not true, one could replace the case-lambda with the equivalent using
standard scheme.


Again, I don't expect to actually use this hack.  I expect to simply
introduce a new internal compiler interface that essentially does the
same thing, but in a less fragile way.

However, I hope that these draft notes will give confidence that it is
possible to implement `the-environment' and `local-eval' without adding
any additional complexity to the compiler.  No changes should be needed
to the analysis or optimization passes, aside from adding some clauses
to `record-case' for `the-environment' tree-il nodes, and a new
procedure or two to handle `local-eval'.

I intend to implement this soon.  Comments and suggestions solicited.

     Best,
      Mark


From MAILER-DAEMON Fri Dec 16 03:10:18 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbSry-00054n-Ph
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 03:10:18 -0500
Received: from eggs.gnu.org ([140.186.70.92]:48897)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbSrw-00054h-MB
	for guile-devel@gnu.org; Fri, 16 Dec 2011 03:10:17 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbSrv-0005Na-BR
	for guile-devel@gnu.org; Fri, 16 Dec 2011 03:10:16 -0500
Received: from world.peace.net ([96.39.62.75]:37202)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbSru-0005N4-I8
	for guile-devel@gnu.org; Fri, 16 Dec 2011 03:10:15 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RbSrn-0007mK-QZ; Fri, 16 Dec 2011 03:10:08 -0500
From: Mark H Weaver <mhw@netris.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: summary: lilypond, lambda, and local-eval
References: <87r506uodd.fsf@pobox.com> <87pqfpj7e3.fsf@netris.org>
Date: Fri, 16 Dec 2011 03:08:35 -0500
In-Reply-To: <87pqfpj7e3.fsf@netris.org> (Mark H. Weaver's message of "Fri, 16
	Dec 2011 02:35:48 -0500")
Message-ID: <87hb11j5vg.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 08:10:17 -0000

I wrote:
> The <compiler-environment> would include a list of lexical variable
> names (<var> ...), which must exactly correspond to the closure slots of
> the `case-lambda', in order to implement `local-eval'.  We _might_ also
> need to include some information about how those variables are stored,

Sorry, this paragraph should have ended here.  The following unfinished
caveat should have been deleted:

> e.g. a flag telling whether they are boxed.  (Usually they will all be
> boxed, but

I was thinking about an edge case where the result of (the-environment)
never escapes the local block, and thus a clever optimizer might be able
to avoid boxing some of the lexicals.  However, I later realized that
this could only happen if the returned environment was never passed to
`local-eval', in which case none of this matters anyway.

     Mark


From MAILER-DAEMON Fri Dec 16 03:50:55 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbTVH-0000vT-80
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 03:50:55 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52848)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbTVF-0000vI-4w
	for guile-devel@gnu.org; Fri, 16 Dec 2011 03:50:53 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbTV9-000317-JM
	for guile-devel@gnu.org; Fri, 16 Dec 2011 03:50:53 -0500
Received: from world.peace.net ([96.39.62.75]:59181)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbTV9-00030v-6y
	for guile-devel@gnu.org; Fri, 16 Dec 2011 03:50:47 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RbTV3-0007ph-Du; Fri, 16 Dec 2011 03:50:41 -0500
From: Mark H Weaver <mhw@netris.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: summary: lilypond, lambda, and local-eval
References: <87r506uodd.fsf@pobox.com> <87pqfpj7e3.fsf@netris.org>
Date: Fri, 16 Dec 2011 03:49:09 -0500
In-Reply-To: <87pqfpj7e3.fsf@netris.org> (Mark H. Weaver's message of "Fri, 16
	Dec 2011 02:35:48 -0500")
Message-ID: <87aa6skika.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 08:50:54 -0000

I wrote:
> For now, I will describe a method that I suspect would do the right
> thing without any new compiler interfaces, though not as efficiently or
> robustly: Simply compile the same general-purpose dispatcher as before,
> except replace the #f (from the first case-lambda clause) with the
> expanded local expression:

Although this should result in the same set of captured lexicals, it
does not necessarily guarantee that the closure slots will be in the
same order.  This could be perhaps be solved by always sorting the
captured lexicals by name, but that would slow down the compiler.
Depending on how the compiler works, it might be sufficient to move the
<expanded-local-expression> case to end of the case-lambda, but that's
definitely fragile.

So, I guess this all shows that `local-eval' really shouldn't be
implemented this way, but rather by creating a new internal interface to
the compiler that ensures that the closure slots are exactly the same as
before.

> Most passes of the compiler will pretend that (the-environment) is
> replaced by tree-il code corresponding to the following standard scheme
> code:

I should also mention that perhaps, instead of simply "pretending", it
might make sense to actually replace (the-environment) with the standard
scheme code I gave as early as possible, so that later passes will never
even see `the-environment' tree-il nodes.  It need only be late enough
so that the list of visible lexical variable names is known at that
point.

Apologies for sending multiple messages so quickly.
Obviously this is a work-in-progress :)

      Mark


From MAILER-DAEMON Fri Dec 16 04:17:13 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbTuj-0004Gq-EU
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 04:17:13 -0500
Received: from eggs.gnu.org ([140.186.70.92]:42331)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbTub-0004D9-KO
	for guile-devel@gnu.org; Fri, 16 Dec 2011 04:17:11 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbTuX-0008Gk-8b
	for guile-devel@gnu.org; Fri, 16 Dec 2011 04:17:05 -0500
Received: from lo.gmane.org ([80.91.229.12]:38925)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbTuW-0008Ga-VF
	for guile-devel@gnu.org; Fri, 16 Dec 2011 04:17:01 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbTuV-0005Sr-CP
	for guile-devel@gnu.org; Fri, 16 Dec 2011 10:16:59 +0100
Received: from p508edf03.dip.t-dialin.net ([80.142.223.3])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 16 Dec 2011 10:16:59 +0100
Received: from dak by p508edf03.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 16 Dec 2011 10:16:59 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: summary: lilypond, lambda, and local-eval
Date: Fri, 16 Dec 2011 10:16:43 +0100
Organization: Organization?!?
Lines: 56
Message-ID: <87ehw4511g.fsf@fencepost.gnu.org>
References: <87r506uodd.fsf@pobox.com> <87pqfpj7e3.fsf@netris.org>
	<87aa6skika.fsf@netris.org>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508edf03.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:IqBZFOj8Z5jzdRB22u3tjZQA6AA=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 09:17:11 -0000

Mark H Weaver <mhw@netris.org> writes:

> I wrote:
>> For now, I will describe a method that I suspect would do the right
>> thing without any new compiler interfaces, though not as efficiently or
>> robustly: Simply compile the same general-purpose dispatcher as before,
>> except replace the #f (from the first case-lambda clause) with the
>> expanded local expression:
>
> Although this should result in the same set of captured lexicals, it
> does not necessarily guarantee that the closure slots will be in the
> same order.  This could be perhaps be solved by always sorting the
> captured lexicals by name, but that would slow down the compiler.
> Depending on how the compiler works, it might be sufficient to move the
> <expanded-local-expression> case to end of the case-lambda, but that's
> definitely fragile.
>
> So, I guess this all shows that `local-eval' really shouldn't be
> implemented this way, but rather by creating a new internal interface to
> the compiler that ensures that the closure slots are exactly the same as
> before.
>
>> Most passes of the compiler will pretend that (the-environment) is
>> replaced by tree-il code corresponding to the following standard scheme
>> code:
>
> I should also mention that perhaps, instead of simply "pretending", it
> might make sense to actually replace (the-environment) with the standard
> scheme code I gave as early as possible, so that later passes will never
> even see `the-environment' tree-il nodes.  It need only be late enough
> so that the list of visible lexical variable names is known at that
> point.
>
> Apologies for sending multiple messages so quickly.
> Obviously this is a work-in-progress :)

And I consider this _very_ exciting work in progress.  One of the things
that the current development line of GCC markets is "compiler plugins".
Here GUILE has an opportunity to offer similar functionality in a
natural, Scheme-like manner with little complexity exposed to the user
of this feature, and apparently not all that much complexity needed to
get added to the compiler: it is more a matter of factoring the
complexity that has to be there anyway in a proper way.  Which actually
might make the compiler code easier to understand und modify even if you
don't end up using local-eval.

Being able to employ this in Lilypond to simplify things would certainly
be a nice side benefit, but this has the potential to simplify and
facilitate quite more complex scenarios with simple tools.

It would be _much_ _much_ simpler to use than GCC plugins.  And the
better it integrates with the compiler as a whole, the less reason would
be there _not_ to use it whenever it might be useful.

-- 
David Kastrup



From MAILER-DAEMON Fri Dec 16 04:23:22 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbU0g-0005OI-SY
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 04:23:22 -0500
Received: from eggs.gnu.org ([140.186.70.92]:42319)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbU0Y-0005OC-JL
	for guile-devel@gnu.org; Fri, 16 Dec 2011 04:23:20 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbU0R-0000vg-Ur
	for guile-devel@gnu.org; Fri, 16 Dec 2011 04:23:14 -0500
Received: from world.peace.net ([96.39.62.75]:54299)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbU0R-0000vc-Me
	for guile-devel@gnu.org; Fri, 16 Dec 2011 04:23:07 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RbU0J-0007uK-Mc; Fri, 16 Dec 2011 04:23:01 -0500
From: Mark H Weaver <mhw@netris.org>
To: guile-devel@gnu.org
Subject: [PATCH] Implement `the-environment' and `local-eval' in evaluator
References: <87liqtpsl9.fsf@fencepost.gnu.org>
	<87d3bvfo5d.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<877h1zo7xx.fsf_-_@netris.org>
Date: Fri, 16 Dec 2011 04:21:23 -0500
In-Reply-To: <877h1zo7xx.fsf_-_@netris.org> (Mark H. Weaver's message of "Wed, 
	14 Dec 2011 03:48:10 -0500")
Message-ID: <8762hgkh2k.fsf_-_@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="=-=-="
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 09:23:21 -0000

--=-=-=
Content-Type: text/plain

Here's an improved version of the preliminary evaluator-only
implementation of `the-environment' and `local-eval'.  I renamed the
primitives to the Guile 1.8 names, fixed the expansion within
`local-eval' to use `expand' instead of `expand-top-sequence', made the
module handling more robust, and various other minor improvements.

I plan to fully support these primitives in the compiler as well, in a
future version of this patch.

This is still a _preliminary_ patch.  In particular:

* The compiler currently fails ungracefully if it encounters
  (the-environment).

* The lexical environment object is currently non-opaque list structure.

* I still wouldn't be surprised if `local-eval' does the wrong thing if
  (current-module) is different from what it was when the associated
  `primitive-eval' was called.

* I manually removed the psyntax-pp.scm patch from the output of
  git-format-patch (though the header change summary still mentions it),
  since it was so huge.  I guess you'll need to manually regenerate that
  file yourself, since the Makefiles don't do it automatically:

     cd guile/module; make ice-9/psyntax-pp.scm.gen

Here's an example session:

  mhw:~/guile$ meta/guile
  GNU Guile 2.0.3.72-c6748
  Copyright (C) 1995-2011 Free Software Foundation, Inc.
  
  Guile comes with ABSOLUTELY NO WARRANTY; for details type `,show w'.
  This program is free software, and you are welcome to redistribute it
  under certain conditions; type `,show c' for details.
  
  Enter `,help' for help.
  scheme@(guile-user)> (define env1 (primitive-eval '(let-syntax ((foo (syntax-rules () ((foo x) (quote x))))) (let ((x 1) (y 2)) (the-environment)))))
  scheme@(guile-user)> (local-eval 'x env1)
  $1 = 1
  scheme@(guile-user)> (local-eval 'y env1)
  $2 = 2
  scheme@(guile-user)> (local-eval '(foo (1 2)) env1)
  $3 = (1 2)
  scheme@(guile-user)> (define env2 (local-eval '(let-syntax ((bar (syntax-rules () ((bar x) (foo x))))) (let ((x 1) (z 3)) (the-environment))) env1))
  scheme@(guile-user)> (local-eval 'x env2)
  $4 = 1
  scheme@(guile-user)> (local-eval '(bar (1 2)) env2)
  $5 = (1 2)
  scheme@(guile-user)> (local-eval '(foo (1 2)) env2)
  $6 = (1 2)
  scheme@(guile-user)> (local-eval 'z env2)
  $7 = 3
  scheme@(guile-user)> (local-eval '(set! x (+ x 10)) env2)
  $8 = 11
  scheme@(guile-user)> (local-eval 'x env1)
  $9 = 1

      Mark



--=-=-=
Content-Type: text/x-patch
Content-Disposition: inline;
 filename=0001-Implement-the-environment-and-local-eval-in-evaluato.patch
Content-Description: Implement `the-environment' and `local-eval' in
 evaluator

>From c6748349a833cd61b380259ca8b9d81d7f14128f Mon Sep 17 00:00:00 2001
From: Mark H Weaver <mhw@netris.org>
Date: Wed, 14 Dec 2011 03:12:43 -0500
Subject: [PATCH] Implement `the-environment' and `local-eval' in evaluator

PRELIMINARY WORK, not ready for commit.
---
 libguile/expand.c           |    5 +
 libguile/expand.h           |   13 +
 libguile/memoize.c          |   18 +
 libguile/memoize.h          |    5 +-
 module/ice-9/eval.scm       |   31 +
 module/ice-9/psyntax-pp.scm |23299 ++++++++++++++++++++++---------------------
 module/ice-9/psyntax.scm    |   26 +-
 module/language/tree-il.scm |    8 +
 8 files changed, 12095 insertions(+), 11310 deletions(-)

diff --git a/module/ice-9/eval.scm b/module/ice-9/eval.scm
index c0fa64c..7d6e6c1 100644
--- a/module/ice-9/eval.scm
+++ b/module/ice-9/eval.scm
@@ -213,6 +213,8 @@
 ;;; `eval' in this order, to put the most frequent cases first.
 ;;;
 
+(define local-eval #f)  ;; This is set! from within the primitive-eval block
+
 (define primitive-eval
   (let ()
     ;; We pre-generate procedures with fixed arities, up to some number of
@@ -357,6 +359,14 @@
                                            ;; Finally, eval the body.
                                            (eval body env)))))))))))))))
 
+    ;; FIXME: make this opaque!!
+    (define (make-lexical-environment module eval-env memoizer-env expander-env)
+      (list '<lexical-environment> module eval-env memoizer-env expander-env))
+    (define lexical-environment:module cadr)
+    (define lexical-environment:eval-env caddr)
+    (define lexical-environment:memoizer-env cadddr)
+    (define (lexical-environment:expander-env env) (car (cddddr env)))
+
     ;; The "engine". EXP is a memoized expression.
     (define (eval exp env)
       (memoized-expression-case exp
@@ -459,6 +469,12 @@
                   (eval exp env)
                   (eval handler env)))
         
+        (('the-environment (memoizer-env . expander-env))
+         (let ((module (capture-env (if (pair? env)
+                                        (cdr (last-pair env))
+                                        env))))
+           (make-lexical-environment module env memoizer-env expander-env)))
+
         (('call/cc proc)
          (call/cc (eval proc env)))
 
@@ -468,6 +484,21 @@
               var-or-spec
               (memoize-variable-access! exp #f))
           (eval x env)))))
+
+    (set! local-eval
+          (lambda (exp env)
+            "Evaluate @var{exp} within the lexical environment @var{env}."
+            (let ((module (lexical-environment:module env))
+                  (eval-env (lexical-environment:eval-env env))
+                  (memoizer-env (lexical-environment:memoizer-env env))
+                  (expander-env (lexical-environment:expander-env env)))
+              (eval (memoize-local-expression
+                     (if (macroexpanded? exp)
+                         exp
+                         ((module-transformer module)
+                          exp #:env expander-env))
+                     memoizer-env)
+                    eval-env))))
   
     ;; primitive-eval
     (lambda (exp)
diff --git a/libguile/memoize.h b/libguile/memoize.h
index 26bd5b1..f012d3a 100644
--- a/libguile/memoize.h
+++ b/libguile/memoize.h
@@ -44,6 +44,7 @@ SCM_API SCM scm_sym_quote;
 SCM_API SCM scm_sym_quasiquote;
 SCM_API SCM scm_sym_unquote;
 SCM_API SCM scm_sym_uq_splicing;
+SCM_API SCM scm_sym_the_environment;
 SCM_API SCM scm_sym_with_fluids;
 
 SCM_API SCM scm_sym_at;
@@ -90,13 +91,15 @@ enum
     SCM_M_TOPLEVEL_SET,
     SCM_M_MODULE_REF,
     SCM_M_MODULE_SET,
-    SCM_M_PROMPT
+    SCM_M_PROMPT,
+    SCM_M_THE_ENVIRONMENT
   };
 
 
 
 
 SCM_INTERNAL SCM scm_memoize_expression (SCM exp);
+SCM_INTERNAL SCM scm_memoize_local_expression (SCM exp, SCM memoizer_env);
 SCM_INTERNAL SCM scm_unmemoize_expression (SCM memoized);
 SCM_INTERNAL SCM scm_memoized_expression_typecode (SCM memoized);
 SCM_INTERNAL SCM scm_memoized_expression_data (SCM memoized);
diff --git a/libguile/memoize.c b/libguile/memoize.c
index 911d972..f7be46e 100644
--- a/libguile/memoize.c
+++ b/libguile/memoize.c
@@ -112,6 +112,8 @@ scm_t_bits scm_tc16_memoized;
   MAKMEMO (SCM_M_MODULE_SET, scm_cons (val, scm_cons (mod, scm_cons (var, public))))
 #define MAKMEMO_PROMPT(tag, exp, handler) \
   MAKMEMO (SCM_M_PROMPT, scm_cons (tag, scm_cons (exp, handler)))
+#define MAKMEMO_THE_ENVIRONMENT(memoizer_env, expander_env)	\
+  MAKMEMO (SCM_M_THE_ENVIRONMENT, scm_cons(memoizer_env, expander_env))
 
 
 /* Primitives for the evaluator */
@@ -143,6 +145,7 @@ static const char *const memoized_tags[] =
   "module-ref",
   "module-set!",
   "prompt",
+  "the-environment",
 };
 
 static int
@@ -426,6 +429,9 @@ memoize (SCM exp, SCM env)
                                   memoize_exps (REF (exp, DYNLET, VALS), env),
                                   memoize (REF (exp, DYNLET, BODY), env));
 
+    case SCM_EXPANDED_THE_ENVIRONMENT:
+      return MAKMEMO_THE_ENVIRONMENT (env, REF (exp, THE_ENVIRONMENT, EXPANDER_ENV));
+
     default:
       abort ();
     }
@@ -444,6 +450,16 @@ SCM_DEFINE (scm_memoize_expression, "memoize-expression", 1, 0, 0,
 }
 #undef FUNC_NAME
 
+SCM_DEFINE (scm_memoize_local_expression, "memoize-local-expression", 2, 0, 0,
+            (SCM exp, SCM memoizer_env),
+	    "Memoize the expression @var{exp} within @var{memoizer_env}.")
+#define FUNC_NAME s_scm_memoize_local_expression
+{
+  SCM_ASSERT_TYPE (SCM_EXPANDED_P (exp), exp, 1, FUNC_NAME, "expanded");
+  return memoize (exp, memoizer_env);
+}
+#undef FUNC_NAME
+
 
 
 
@@ -706,6 +722,8 @@ unmemoize (const SCM expr)
                          unmemoize (CAR (args)),
                          unmemoize (CADR (args)),
                          unmemoize (CDDR (args)));
+    case SCM_M_THE_ENVIRONMENT:
+      return scm_list_3 (scm_sym_the_environment, CAR (args), CDR (args));
     default:
       abort ();
     }
diff --git a/libguile/expand.h b/libguile/expand.h
index 02e6e17..b150058 100644
--- a/libguile/expand.h
+++ b/libguile/expand.h
@@ -54,6 +54,7 @@ typedef enum
     SCM_EXPANDED_LET,
     SCM_EXPANDED_LETREC,
     SCM_EXPANDED_DYNLET,
+    SCM_EXPANDED_THE_ENVIRONMENT,
     SCM_NUM_EXPANDED_TYPES,
   } scm_t_expanded_type;
 
@@ -330,6 +331,18 @@ enum
 #define SCM_MAKE_EXPANDED_DYNLET(src, fluids, vals, body) \
   scm_c_make_struct (exp_vtables[SCM_EXPANDED_DYNLET], 0, SCM_NUM_EXPANDED_DYNLET_FIELDS, SCM_UNPACK (src), SCM_UNPACK (fluids), SCM_UNPACK (vals), SCM_UNPACK (body))
 
+#define SCM_EXPANDED_THE_ENVIRONMENT_TYPE_NAME "the-environment"
+#define SCM_EXPANDED_THE_ENVIRONMENT_FIELD_NAMES  \
+  { "src", "expander-env", }
+enum
+  {
+    SCM_EXPANDED_THE_ENVIRONMENT_SRC,
+    SCM_EXPANDED_THE_ENVIRONMENT_EXPANDER_ENV,
+    SCM_NUM_EXPANDED_THE_ENVIRONMENT_FIELDS,
+  };
+#define SCM_MAKE_EXPANDED_THE_ENVIRONMENT(src, expander_env)		\
+  scm_c_make_struct (exp_vtables[SCM_EXPANDED_THE_ENVIRONMENT], 0, SCM_NUM_EXPANDED_THE_ENVIRONMENT_FIELDS, SCM_UNPACK (src), SCM_UNPACK (expander_env))
+
 #endif /* BUILDING_LIBGUILE */
 
 
diff --git a/libguile/expand.c b/libguile/expand.c
index bdecd80..18d9e40 100644
--- a/libguile/expand.c
+++ b/libguile/expand.c
@@ -85,6 +85,8 @@ static const char** exp_field_names[SCM_NUM_EXPANDED_TYPES];
   SCM_MAKE_EXPANDED_LETREC(src, in_order_p, names, gensyms, vals, body)
 #define DYNLET(src, fluids, vals, body) \
   SCM_MAKE_EXPANDED_DYNLET(src, fluids, vals, body)
+#define THE_ENVIRONMENT(src, expander_env)	\
+  SCM_MAKE_EXPANDED_THE_ENVIRONMENT(src, expander_env)
 
 #define CAR(x)   SCM_CAR(x)
 #define CDR(x)   SCM_CDR(x)
@@ -203,6 +205,8 @@ SCM_GLOBAL_SYMBOL (scm_sym_unquote, "unquote");
 SCM_GLOBAL_SYMBOL (scm_sym_quasiquote, "quasiquote");
 SCM_GLOBAL_SYMBOL (scm_sym_uq_splicing, "unquote-splicing");
 
+SCM_GLOBAL_SYMBOL (scm_sym_the_environment, "the-environment");
+
 SCM_KEYWORD (kw_allow_other_keys, "allow-other-keys");
 SCM_KEYWORD (kw_optional, "optional");
 SCM_KEYWORD (kw_key, "key");
@@ -1250,6 +1254,7 @@ scm_init_expand ()
   DEFINE_NAMES (LET);
   DEFINE_NAMES (LETREC);
   DEFINE_NAMES (DYNLET);
+  DEFINE_NAMES (THE_ENVIRONMENT);
 
   scm_exp_vtable_vtable =
     scm_make_vtable (scm_from_locale_string (SCM_VTABLE_BASE_LAYOUT "pwuwpw"),
diff --git a/module/language/tree-il.scm b/module/language/tree-il.scm
index 1d391c4..907cc82 100644
--- a/module/language/tree-il.scm
+++ b/module/language/tree-il.scm
@@ -49,6 +49,7 @@
             <dynlet> dynlet? make-dynlet dynlet-src dynlet-fluids dynlet-vals dynlet-body
             <dynref> dynref? make-dynref dynref-src dynref-fluid
             <dynset> dynset? make-dynset dynset-src dynset-fluid dynset-exp
+            <the-environment> the-environment? make-the-environment the-environment-src the-environment-expander-env
             <prompt> prompt? make-prompt prompt-src prompt-tag prompt-body prompt-handler
             <abort> abort? make-abort abort-src abort-tag abort-args abort-tail
 
@@ -125,6 +126,7 @@
   ;; (<let> names gensyms vals body)
   ;; (<letrec> in-order? names gensyms vals body)
   ;; (<dynlet> fluids vals body)
+  ;; (<the-environment> expander-env)
 
 (define-type (<tree-il> #:common-slots (src) #:printer print-tree-il)
   (<fix> names gensyms vals body)
@@ -324,6 +326,9 @@
     ((<dynset> fluid exp)
      `(dynset ,(unparse-tree-il fluid) ,(unparse-tree-il exp)))
 
+    ((<the-environment> expander-env)
+     `(the-environment ,expander-env))
+
     ((<prompt> tag body handler)
      `(prompt ,(unparse-tree-il tag) ,(unparse-tree-il body) ,(unparse-tree-il handler)))
 
@@ -470,6 +475,9 @@
     ((<dynset> fluid exp)
      `(fluid-set! ,(tree-il->scheme fluid) ,(tree-il->scheme exp)))
 
+    ((<the-environment>)
+     '(the-environment))
+
     ((<prompt> tag body handler)
      `(call-with-prompt
        ,(tree-il->scheme tag)
diff --git a/module/ice-9/psyntax.scm b/module/ice-9/psyntax.scm
index e522f54..292f932 100644
--- a/module/ice-9/psyntax.scm
+++ b/module/ice-9/psyntax.scm
@@ -307,6 +307,14 @@
             (if (not (assq 'name meta))
                 (set-lambda-meta! val (acons 'name name meta))))))
 
+    ;; data type for exporting the compile-type environment
+    ;; FIXME: make this opaque!
+    (define (make-psyntax-env r w mod)
+      (list '<psyntax-env> r w mod))
+    (define psyntax-env:r cadr)
+    (define psyntax-env:w caddr)
+    (define psyntax-env:mod cadddr)
+
     ;; output constructors
     (define build-void
       (lambda (source)
@@ -410,6 +418,9 @@
     (define (build-data src exp)
       (make-const src exp))
 
+    (define (build-the-environment src expander-env)
+      (make-the-environment src expander-env))
+
     (define build-sequence
       (lambda (src exps)
         (if (null? (cdr exps))
@@ -1786,6 +1797,13 @@
                        (_ (syntax-violation 'quote "bad syntax"
                                             (source-wrap e w s mod))))))
 
+    (global-extend 'core 'the-environment
+                   (lambda (e r w s mod)
+                     (syntax-case e ()
+                       ((_) (build-the-environment s (make-psyntax-env r w mod)))
+                       (_ (syntax-violation 'quote "bad syntax"
+                                            (source-wrap e w s mod))))))
+
     (global-extend 'core 'syntax
                    (let ()
                      (define gen-syntax
@@ -2395,9 +2413,11 @@
     ;; expanded, and the expanded definitions are also residualized into
     ;; the object file if we are compiling a file.
     (set! macroexpand
-          (lambda* (x #:optional (m 'e) (esew '(eval)))
-            (expand-top-sequence (list x) null-env top-wrap #f m esew
-                                 (cons 'hygiene (module-name (current-module))))))
+          (lambda* (x #:optional (m 'e) (esew '(eval)) #:key env)
+            (if env
+                (expand x (psyntax-env:r env) (psyntax-env:w env) (psyntax-env:mod env))
+                (expand-top-sequence (list x) null-env top-wrap #f m esew
+                                     (cons 'hygiene (module-name (current-module)))))))
 
     (set! identifier?
           (lambda (x)
-- 
1.7.5.4


--=-=-=--


From MAILER-DAEMON Fri Dec 16 04:28:57 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbU65-0001nZ-8b
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 04:28:57 -0500
Received: from eggs.gnu.org ([140.186.70.92]:60233)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RbU5z-0001nJ-2v
	for guile-devel@gnu.org; Fri, 16 Dec 2011 04:28:55 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RbU5q-0002B1-Ly
	for guile-devel@gnu.org; Fri, 16 Dec 2011 04:28:51 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:48139
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RbU5q-0002Ah-91
	for guile-devel@gnu.org; Fri, 16 Dec 2011 04:28:42 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 00C3064FC;
	Fri, 16 Dec 2011 04:28:41 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=KaGqhXVp/+sUnLoHsYrV+lqhgKI=; b=yXUM/j
	p80R0KA14I6CIvNCyaNb5rGG1jNoUJd6E0QdmVOohqBo0Sf3/RJw/hBSGC5FHzMd
	Citzfot7/fQ55Q116xIVrEL6Fh9XoYRtTzRKxCcq3RE9IZicIzNaprHuPbhc1pkK
	BcDzc2oGvmaf7YAYrZVfk5jY81p3pCkhZSz30=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=erHiEjcXe92QYHKN90ujCLoedTIZPTIv
	rOXSaDKhvRdJUaMgnv/tVNq0TuXVNcJN51b1Jmsf7pEWqr4P2Yn7Hvt6kw//+z1d
	YBU/1VGY7g8NNy8UVF2hSfggnRLR3VvMtppBLJdcrF8yj6V3vXk8SeyGI13vk/Pi
	K4wUR9MUZZk=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id E750764FB;
	Fri, 16 Dec 2011 04:28:40 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id F278864FA;
	Fri, 16 Dec 2011 04:28:39 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Mark H Weaver <mhw@netris.org>
Subject: Re: summary: lilypond, lambda, and local-eval
References: <87r506uodd.fsf@pobox.com> <87pqfpj7e3.fsf@netris.org>
Date: Fri, 16 Dec 2011 10:28:36 +0100
In-Reply-To: <87pqfpj7e3.fsf@netris.org> (Mark H. Weaver's message of "Fri,
	16 Dec 2011 02:35:48 -0500")
Message-ID: <87liqcamrf.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 56D26F76-27C8-11E1-B41C-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 09:28:55 -0000

Hi Mark,

This is an interesting plan.  I still have some doubts, but perhaps you
can make it work.

First, a couple of notes:

On Fri 16 Dec 2011 08:35, Mark H Weaver <mhw@netris.org> writes:

>     (quote <compiler-environment>)  ;; simple list structure
>     (quote <expander-environment>)  ;; simple list structure

Perhaps syntax-objects can give you what you need here. 

>     <module>)  ;; XXX not sure how best to represent this

The expander needs to serialize representations of modules in syntax
objects, and for that purpose it uses the module name.  "Anonymous"
modules actually have generated names, lazily.  Use `module-name'.

I like the "modeling the-environment as a scheme expression" approach;
it gives `the-environment' some semantics.  I used to ignore people who
yammered on about semantics and languages, but I have grown to respect
that approach to language development.  So thank you there.

Also, note that forms that `set!' all bound lexicals in the
`the-environment' will cause them all to be boxed, so there is no boxed
bitvector needed.

> How to implement `local-eval'
> =============================
>
> When `local-eval' is called on a lexical environment that was created by
> compiled code, it will do the following:
>
> * Macroexpand the local expression within <expander-environment>.
>
> * Compile the expanded expression within <compiler-environment>.
>   (I'll explain how to do this below)
>
> * Make a copy of the closure from the lexical environment object, but
>   replace its code (the dispatcher) with the newly compiled code.
>
> * Call the newly created closure.

We are really far from considering efficiency here :)  Would you always
use the compiler for this task?  (I think I would.)  But otherwise, this
sounds sensible, with a caveat:: hygiene, nested definitions, and the
macro expander.

What does local-eval really mean?

What are the meanings of these expressions:

  ;; Toplevel
  (local-eval '(define foo 42) (the-environment))

  ;; Lexical, tail context
  (local-eval '(define foo 42) (let ((x 100)) (the-environment)))

  ;; Lexical, tail context -- but with a definition
  (local-eval '(begin (define foo 42) foo) (let ((x 100)) (the-environment)))

  ;; Lexical, tail context -- but with a definition, and nested reference
  (local-eval '(begin (define foo 42) (bar))
              (let ((x 100)) (define (bar) foo) (the-environment)))

  ;; Lexical, not a definition context
  (local-eval '(define foo 42) (let ((x 100)) not-a-definition (the-environment)))
  
What about this one:

  ;; Keeping in mind that `or' expands to (let ((t ...)) (if t t ...)),
  ;; hygienically
  (local-eval 't '(let ((t 42)) (or #f (the-environment)))) 

Can you pass syntax objects into `local-eval'?

Are let-syntax / letrec-syntax / nested define-syntax forms present in a
local environment?  Currently these things never leave the expander.  I
suppose as long as they are understood to be opaque, it would be OK.

That's all I really wanted to write about local-eval, I think, so no
promised other mail.  Thanks for thinking about these things :)

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Fri Dec 16 04:32:58 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbU9y-0002M4-EM
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 04:32:58 -0500
Received: from eggs.gnu.org ([140.186.70.92]:48474)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbU9r-0002Ll-R7
	for guile-devel@gnu.org; Fri, 16 Dec 2011 04:32:57 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbU9q-0002kR-VU
	for guile-devel@gnu.org; Fri, 16 Dec 2011 04:32:51 -0500
Received: from lo.gmane.org ([80.91.229.12]:52376)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbU9q-0002kG-QR
	for guile-devel@gnu.org; Fri, 16 Dec 2011 04:32:50 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbU9l-00030L-Pb
	for guile-devel@gnu.org; Fri, 16 Dec 2011 10:32:45 +0100
Received: from p508edf03.dip.t-dialin.net ([80.142.223.3])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 16 Dec 2011 10:32:45 +0100
Received: from dak by p508edf03.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 16 Dec 2011 10:32:45 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: [PATCH] Implement `the-environment' and `local-eval' in evaluator
Date: Fri, 16 Dec 2011 10:32:32 +0100
Organization: Organization?!?
Lines: 33
Message-ID: <8762hg50b3.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <871usaicvi.fsf@netris.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<877h1zo7xx.fsf_-_@netris.org> <8762hgkh2k.fsf_-_@netris.org>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508edf03.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:UZl1Rz6ZoiMsg5A0ZAP9nUI+M8c=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 09:32:57 -0000

Mark H Weaver <mhw@netris.org> writes:

> Here's an improved version of the preliminary evaluator-only
> implementation of `the-environment' and `local-eval'.  I renamed the
> primitives to the Guile 1.8 names, fixed the expansion within
> `local-eval' to use `expand' instead of `expand-top-sequence', made the
> module handling more robust, and various other minor improvements.
>
> I plan to fully support these primitives in the compiler as well, in a
> future version of this patch.
>
> This is still a _preliminary_ patch.  In particular:
>
> * The compiler currently fails ungracefully if it encounters
>   (the-environment).
>
> * The lexical environment object is currently non-opaque list structure.
>
> * I still wouldn't be surprised if `local-eval' does the wrong thing if
>   (current-module) is different from what it was when the associated
>   `primitive-eval' was called.

Before anyone even _defines_ what the "right thing" would be, there is
little point in worrying about this.  I don't think that `local-eval'
1.8 documented any behavior for this case (well, it did not document any
behavior for a lot of cases).

So it probably makes sense to look afterwards what will happen without
special precautions, and unless that is spectacularly useless or
inconsistent, call it the "right thing" by definition.

-- 
David Kastrup



From MAILER-DAEMON Fri Dec 16 05:00:10 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbUaI-0001bw-Dv
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 05:00:10 -0500
Received: from eggs.gnu.org ([140.186.70.92]:36502)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbUaG-0001Zn-AX
	for guile-devel@gnu.org; Fri, 16 Dec 2011 05:00:09 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbUaB-0007Ws-FB
	for guile-devel@gnu.org; Fri, 16 Dec 2011 05:00:08 -0500
Received: from lo.gmane.org ([80.91.229.12]:43488)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbUaB-0007WX-2H
	for guile-devel@gnu.org; Fri, 16 Dec 2011 05:00:03 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbUaA-0005Qg-50
	for guile-devel@gnu.org; Fri, 16 Dec 2011 11:00:02 +0100
Received: from p508edf03.dip.t-dialin.net ([80.142.223.3])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 16 Dec 2011 11:00:02 +0100
Received: from dak by p508edf03.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 16 Dec 2011 11:00:02 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: summary: lilypond, lambda, and local-eval
Date: Fri, 16 Dec 2011 10:59:44 +0100
Organization: Organization?!?
Lines: 116
Message-ID: <871us44z1r.fsf@fencepost.gnu.org>
References: <87r506uodd.fsf@pobox.com> <87pqfpj7e3.fsf@netris.org>
	<87liqcamrf.fsf@pobox.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508edf03.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:AqPDudPJgiP0ysta0f1XqROhPEk=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 10:00:09 -0000

Andy Wingo <wingo@pobox.com> writes:

> What are the meanings of these expressions:

I found it amusing to see what my definitions using
with-current-continuation will produce here.

>   ;; Toplevel
>   (local-eval '(define foo 42) (the-environment))

guile> (my-eval '(define foo 42) (my-env))
guile> foo
42

>   ;; Lexical, tail context
>   (local-eval '(define foo 42) (let ((x 100)) (the-environment)))

guile> (my-eval '(define foo 42) (let ((x 100)) (my-env)))

Backtrace:
In standard input:
   1: 0* [my-eval (define foo 42) ...
   1: 1*  (let* ((x 100)) (#<continuation 1401 @ 9253970> (define foo 42)))
   1: 2   (begin #<continuation 1581 @ 9252000>)
   1: 3   [#<continuation 1401 @ 9253970> ...
   1: 4*   (define foo 42)

standard input:1:11: In procedure memoization in expression (define foo 42):
standard input:1:11: In file "standard input", line 0: Bad define placement (define foo 42).
ABORT: (syntax-error)
guile> 

>   ;; Lexical, tail context -- but with a definition
>   (local-eval '(begin (define foo 42) foo) (let ((x 100)) (the-environment)))

guile> (my-eval '(begin (define foo 42) foo) (let ((x 100)) (my-env)))

Backtrace:
In standard input:
   6: 0* [my-eval (begin (define foo 42) foo) ...
   6: 1*  (let* ((x 100)) (#<continuation 1401 @ 9219b38> (begin # foo)))
   6: 2   (begin #<continuation 1581 @ 9259a80>)
   6: 3   [#<continuation 1401 @ 9219b38> ...
   6: 4*   (begin (define foo 42) foo)
   6: 5*   (define foo 42)

standard input:6:18: In procedure memoization in expression (define foo 42):
standard input:6:18: In file "standard input", line 5: Bad define placement (define foo 42).
ABORT: (syntax-error)
guile> 

>   ;; Lexical, tail context -- but with a definition, and nested reference
>   (local-eval '(begin (define foo 42) (bar))
>               (let ((x 100)) (define (bar) foo) (the-environment)))

guile> (my-eval '(begin (define foo 42) (bar)) (let ((x 100)) (define (bar) foo) (my-env)))

Backtrace:
In standard input:
  13: 0* [my-eval (begin (define foo 42) (bar)) ...
  13: 1*  (let* ((x 100)) (letrec (#) (# #)))
In unknown file:
   ?: 2   (letrec ((bar #)) (#<continuation 1401 @ 925e7c0> (begin # #)))
In standard input:
    ...
  13: 3   [#<continuation 1401 @ 925e7c0> ...
  13: 4*   (begin (define foo 42) (bar))
  13: 5*   (define foo 42)

standard input:13:18: In procedure memoization in expression (define foo 42):
standard input:13:18: In file "standard input", line 12: Bad define placement (define foo 42).
ABORT: (syntax-error)

>   ;; Lexical, not a definition context
>   (local-eval '(define foo 42) (let ((x 100)) not-a-definition (the-environment)))

guile> (my-eval '(define foo 42) (let ((x 100)) "hello" (my-env)))

Backtrace:
In standard input:
  12: 0* [my-eval (define foo 42) ...
  12: 1*  (let* ((x 100)) "hello" (#<continuation 1401 @ 9253970> (define foo 42)))
  12: 2   (begin #<continuation 1581 @ 9252000>)
  12: 3   [#<continuation 1401 @ 9253970> ...
  12: 4*   (define foo 42)

standard input:12:11: In procedure memoization in expression (define foo 42):
standard input:12:11: In file "standard input", line 11: Bad define placement (define foo 42).
ABORT: (syntax-error)
guile> 

> What about this one:
>
>   ;; Keeping in mind that `or' expands to (let ((t ...)) (if t t ...)),
>   ;; hygienically
>   (local-eval 't '(let ((t 42)) (or #f (the-environment)))) 

Assuming that the second quote mark is a typo.

guile> (my-eval 't (let ((t 42)) (or #f (my-env))))
42
guile> 

Now of course, the continuation based approach that just hijacks the
expander and jumps in and out of it is not really a measure of how
things should work.  But it makes clear that (the-environment) is a bit
of a chimera: it captures content at a level conceptually relevant for
(define), but returns a value and has to be placed accordingly, like in
a function call or at the providing side of a binding construct.

If those different syntactic aspects prove to be too hard to conciliate,
it might help to look at the kind of interface that some other chimeras
like call-with-values or call-with-current-continuation have taken.

-- 
David Kastrup



From MAILER-DAEMON Fri Dec 16 05:34:59 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbV7z-0001dS-K1
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 05:34:59 -0500
Received: from eggs.gnu.org ([140.186.70.92]:46051)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbV7s-0001dJ-NM
	for guile-devel@gnu.org; Fri, 16 Dec 2011 05:34:58 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbV7r-0005b8-7l
	for guile-devel@gnu.org; Fri, 16 Dec 2011 05:34:52 -0500
Received: from world.peace.net ([96.39.62.75]:40096)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbV7q-0005aW-Qt
	for guile-devel@gnu.org; Fri, 16 Dec 2011 05:34:51 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RbV7h-00082y-My; Fri, 16 Dec 2011 05:34:42 -0500
From: Mark H Weaver <mhw@netris.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: summary: lilypond, lambda, and local-eval
References: <87r506uodd.fsf@pobox.com> <87pqfpj7e3.fsf@netris.org>
	<87liqcamrf.fsf@pobox.com>
Date: Fri, 16 Dec 2011 05:33:09 -0500
In-Reply-To: <87liqcamrf.fsf@pobox.com> (Andy Wingo's message of "Fri, 16 Dec
	2011 10:28:36 +0100")
Message-ID: <871us4kdqy.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 10:34:58 -0000

Hi Andy, thanks for the quick feedback.  I'll respond to the rest of
your email later, but just a few quick notes for now:

> What are the meanings of these expressions:
>
>   ;; Toplevel
>   (local-eval '(define foo 42) (the-environment))
>
>   ;; Lexical, tail context
>   (local-eval '(define foo 42) (let ((x 100)) (the-environment)))
>
>   ;; Lexical, tail context -- but with a definition
>   (local-eval '(begin (define foo 42) foo) (let ((x 100)) (the-environment)))
>
>   ;; Lexical, tail context -- but with a definition, and nested reference
>   (local-eval '(begin (define foo 42) (bar))
>               (let ((x 100)) (define (bar) foo) (the-environment)))
>
>   ;; Lexical, not a definition context
>   (local-eval '(define foo 42) (let ((x 100)) not-a-definition (the-environment)))

All of these will raise errors, because my current implementation of
`local-eval' (I just posted a new version of the evaluator-only patch)
uses `expand' instead of `expand-top-sequence' to expand the local
expression, therefore definitions are not allowed.

> What about this one:
>
>   ;; Keeping in mind that `or' expands to (let ((t ...)) (if t t ...)),
>   ;; hygienically
>   (local-eval 't '(let ((t 42)) (or #f (the-environment))))

Yes, even my first patch handles this properly (though you must use
`primitive-eval', since the compiler currently barfs if it encounters
`the-environment'):

scheme@(guile-user)> (local-eval 't (primitive-eval '(let ((t 42)) (or #f (the-environment)))))
$1 = 42

> Can you pass syntax objects into `local-eval'?

I believe so, but I haven't verified that this works as it should.
I don't have much experience using syntax-case.

The expression passed to `local-eval' simply gets passed along to
`expand' within psyntax.scm, using the saved "expander environment":
i.e. the values of the `r', `w', and `mod' in psyntax, at the point
where (the-environment) was expanded.  This "expander environment" is
stored in the tree-il representation of (the-environment).

Here's what I currently see:

scheme@(guile-user)> (local-eval #'t (primitive-eval '(let ((t 42)) (or #f (the-environment)))))
ERROR: In procedure memoize-variable-access!:
ERROR: Unbound variable: t

This is the correct behavior, no?

> Are let-syntax / letrec-syntax / nested define-syntax forms present in a
> local environment?

Yes:

scheme@(guile-user)> (define env1 (primitive-eval '(let-syntax ((foo (syntax-rules () ((foo x) (quote x))))) (let ((x 1) (y 2)) (the-environment)))))
scheme@(guile-user)> (local-eval '(foo (1 2)) env1)
$3 = (1 2)
scheme@(guile-user)> (define env2 (local-eval '(let-syntax ((bar (syntax-rules () ((bar x) (foo x))))) (let ((x 1) (z 3)) (the-environment))) env1))
scheme@(guile-user)> (local-eval '(bar (1 2)) env2)
$5 = (1 2)
scheme@(guile-user)> (local-eval '(foo (1 2)) env2)
$6 = (1 2)

> Currently these things never leave the expander.  I suppose as long as
> they are understood to be opaque, it would be OK.

Agreed.  However, it should be noted that if we compile a form
containing (the-environment) into a .go file, the "expander environment"
will have to be stored within the .go file as an embedded constant.
This means that if the representations of r, w, or mod within psyntax
changes, any .go files containing uses of (the-environment) will have to
be recompiled, or else `local-eval' could fail ungracefully.

This is indeed an unpleasant complication.  Automatic recompilation
could be achieved using a versioning scheme, using a separate
expander-environment-version number.  With some care, we could perhaps
avoid needless recompilation of .go files that do not use
(the-environment) when the expander environment version changes, though
it might be a bit of a pain to do the necessary bookkeeping to determine
whether a .go file contains any expander environments.  I'll have to
think more about this.

     Mark


From MAILER-DAEMON Fri Dec 16 05:57:33 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbVTp-0006GS-5B
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 05:57:33 -0500
Received: from eggs.gnu.org ([140.186.70.92]:57744)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbVTh-0006Ft-Va
	for guile-devel@gnu.org; Fri, 16 Dec 2011 05:57:31 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbVTb-0001Fz-Ua
	for guile-devel@gnu.org; Fri, 16 Dec 2011 05:57:25 -0500
Received: from lo.gmane.org ([80.91.229.12]:37414)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbVTb-0001Fu-OG
	for guile-devel@gnu.org; Fri, 16 Dec 2011 05:57:19 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbVTa-00063K-Io
	for guile-devel@gnu.org; Fri, 16 Dec 2011 11:57:18 +0100
Received: from host31-52-247-217.range31-52.btcentralplus.com ([31.52.247.217])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 16 Dec 2011 11:57:18 +0100
Received: from ianprice90 by host31-52-247-217.range31-52.btcentralplus.com
	with local (Gmexim 0.1 (Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 16 Dec 2011 11:57:18 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: Ian Price <ianprice90@googlemail.com>
Subject: SXML documentation
Date: Fri, 16 Dec 2011 10:52:57 +0000
Lines: 19
Message-ID: <8739cku6t2.fsf@Kagami.home>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: host31-52-247-217.range31-52.btcentralplus.com
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
Cancel-Lock: sha1:W+av0huSjoqdjHZplZI2vHK2JgQ=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 10:57:31 -0000


Hi guilers,

The documentation for this in the manual is pretty sparse. Is it
possible to lift the documentation for the procedures in the source up
to the manual where people who don't read the source can find it?

As an example, the function 'find-string-from-port?' in (sxml ssax
input-parse) has the signature
  find-string-from-port? _ _ . _ 
which is not particularly meaningful. Or how would I know what the
'ssax:xml->sxml' argument 'namespace-prefix-assig' is if I didn't know
already?

-- 
Ian Price

"Programming is like pinball. The reward for doing it well is
the opportunity to do it again" - from "The Wizardy Compiled"



From MAILER-DAEMON Fri Dec 16 07:14:52 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbWge-0003SQ-4k
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 07:14:52 -0500
Received: from eggs.gnu.org ([140.186.70.92]:36938)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <haberg-1@telia.com>) id 1RbWgY-0003S9-6z
	for guile-devel@gnu.org; Fri, 16 Dec 2011 07:14:50 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <haberg-1@telia.com>) id 1RbWgT-0000ge-W7
	for guile-devel@gnu.org; Fri, 16 Dec 2011 07:14:46 -0500
Received: from smtp-out21.han.skanova.net ([195.67.226.208]:35311)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <haberg-1@telia.com>)
	id 1RbWgT-0000ga-Kd; Fri, 16 Dec 2011 07:14:41 -0500
Received: from [10.0.1.2] (217.210.127.13) by smtp-out21.han.skanova.net
	(8.5.133) (authenticated as u26619196)
	id 4EC0B93A00D4BB52; Fri, 16 Dec 2011 13:13:41 +0100
Subject: Re: summary: lilypond, lambda, and local-eval
Mime-Version: 1.0 (Apple Message framework v1251.1)
Content-Type: text/plain; charset=us-ascii
From: Hans Aberg <haberg-1@telia.com>
In-Reply-To: <871us4kdqy.fsf@netris.org>
Date: Fri, 16 Dec 2011 13:13:38 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <D1C9681B-85CC-4E37-8674-3F622EB7B046@telia.com>
References: <87r506uodd.fsf@pobox.com> <87pqfpj7e3.fsf@netris.org>
	<87liqcamrf.fsf@pobox.com> <871us4kdqy.fsf@netris.org>
To: Mark H Weaver <mhw@netris.org>
X-Mailer: Apple Mail (2.1251.1)
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 195.67.226.208
Cc: Andy Wingo <wingo@pobox.com>, David Kastrup <dak@gnu.org>,
	guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 12:14:50 -0000

On 16 Dec 2011, at 11:33, Mark H Weaver wrote:

> Here's what I currently see:
>=20
> scheme@(guile-user)> (local-eval #'t (primitive-eval '(let ((t 42)) =
(or #f (the-environment)))))
> ERROR: In procedure memoize-variable-access!:
> ERROR: Unbound variable: t
>=20
> This is the correct behavior, no?

This is what I get when I play around with the following variation of =
David's code in Guile 2.0.3:
(define (xxx)
  (let* ((x 2))
    (set! x (+ x 3))
    (interaction-environment)))

(eval '(begin (set! x (+ x 5)) x) (xxx))

My guess (correct?) is that one wants some variation of =
(interaction-environment) that can cause x in the eval expression to =
bind to the environment returned by (xxx).

Might eval be changed to accommodate for that (without introducing the =
name local-eval)?

Hans




From MAILER-DAEMON Fri Dec 16 07:43:38 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbX8U-0001YN-4s
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 07:43:38 -0500
Received: from eggs.gnu.org ([140.186.70.92]:54026)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbX8N-0001W5-K8
	for guile-devel@gnu.org; Fri, 16 Dec 2011 07:43:37 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbX8F-0005Qo-SS
	for guile-devel@gnu.org; Fri, 16 Dec 2011 07:43:31 -0500
Received: from lo.gmane.org ([80.91.229.12]:37802)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbX8F-0005Qb-JE
	for guile-devel@gnu.org; Fri, 16 Dec 2011 07:43:23 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbX8E-0003N8-0k
	for guile-devel@gnu.org; Fri, 16 Dec 2011 13:43:22 +0100
Received: from p508edf03.dip.t-dialin.net ([80.142.223.3])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 16 Dec 2011 13:43:22 +0100
Received: from dak by p508edf03.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 16 Dec 2011 13:43:22 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: summary: lilypond, lambda, and local-eval
Date: Fri, 16 Dec 2011 13:43:08 +0100
Organization: Organization?!?
Lines: 38
Message-ID: <87k45w3cwz.fsf@fencepost.gnu.org>
References: <87r506uodd.fsf@pobox.com> <87pqfpj7e3.fsf@netris.org>
	<87liqcamrf.fsf@pobox.com> <871us4kdqy.fsf@netris.org>
	<D1C9681B-85CC-4E37-8674-3F622EB7B046@telia.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508edf03.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:nqPE06y5FEHVHBd+N2tPmLzLzVM=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 12:43:37 -0000

Hans Aberg <haberg-1@telia.com> writes:

> On 16 Dec 2011, at 11:33, Mark H Weaver wrote:
>
>> Here's what I currently see:
>> 
>> scheme@(guile-user)> (local-eval #'t (primitive-eval '(let ((t 42))
>> (or #f (the-environment)))))
>> ERROR: In procedure memoize-variable-access!:
>> ERROR: Unbound variable: t
>> 
>> This is the correct behavior, no?
>
> This is what I get when I play around with the following variation of David's code in Guile 2.0.3:
> (define (xxx)
>   (let* ((x 2))
>     (set! x (+ x 3))
>     (interaction-environment)))
>
> (eval '(begin (set! x (+ x 5)) x) (xxx))
>
> My guess (correct?) is that one wants some variation of
> (interaction-environment) that can cause x in the eval expression to
> bind to the environment returned by (xxx).
>
> Might eval be changed to accommodate for that (without introducing the
> name local-eval)?

It would likely help with unasking the question of what to do when
(current-module) is different at the time of local-eval.  I don't know,
however, what the _lexical_ effects of switching the current module are
supposed to be.  If it is supposed to be a noop, then lexical
environments and modules are presumably orthogonal, and eval should
likely be allowed to take both (currently, local-eval is like taking a
lexical environment and using primitive-eval in it).

-- 
David Kastrup



From MAILER-DAEMON Fri Dec 16 09:01:20 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbYLf-0008K9-VT
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 09:01:19 -0500
Received: from eggs.gnu.org ([140.186.70.92]:51931)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbYLX-0008Aq-OF
	for guile-devel@gnu.org; Fri, 16 Dec 2011 09:01:18 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbYLR-00036M-OK
	for guile-devel@gnu.org; Fri, 16 Dec 2011 09:01:11 -0500
Received: from lo.gmane.org ([80.91.229.12]:48500)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbYLR-000368-Ia
	for guile-devel@gnu.org; Fri, 16 Dec 2011 09:01:05 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbYLQ-0004DA-0t
	for guile-devel@gnu.org; Fri, 16 Dec 2011 15:01:04 +0100
Received: from 131.227.8.61 ([131.227.8.61])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 16 Dec 2011 15:01:03 +0100
Received: from peter by 131.227.8.61 with local (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 16 Dec 2011 15:01:03 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: Peter TB Brett <peter@peter-b.co.uk>
Subject: Re: [PATCH] Implement `the-environment' and `local-eval' in evaluator
Date: Fri, 16 Dec 2011 14:00:46 +0000
Organization: University of Surrey, Guildford, England
Lines: 25
Message-ID: <we1mehw4pqep.fsf@ssclt001.ee.surrey.ac.uk>
References: <87liqtpsl9.fsf@fencepost.gnu.org>
	<87mxaycmlx.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<877h1zo7xx.fsf_-_@netris.org> <8762hgkh2k.fsf_-_@netris.org>
	<8762hg50b3.fsf@fencepost.gnu.org>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: 131.227.8.61
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.1 (gnu/linux)
Cancel-Lock: sha1:eASejI7vd6tw00HO1BlwWwr39m8=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 14:01:18 -0000


David Kastrup <dak@gnu.org> writes:

>> * I still wouldn't be surprised if `local-eval' does the wrong thing if
>>   (current-module) is different from what it was when the associated
>>   `primitive-eval' was called.
>
> Before anyone even _defines_ what the "right thing" would be, there is
> little point in worrying about this.  I don't think that `local-eval'
> 1.8 documented any behavior for this case (well, it did not document any
> behavior for a lot of cases).
>
> So it probably makes sense to look afterwards what will happen without
> special precautions, and unless that is spectacularly useless or
> inconsistent, call it the "right thing" by definition.

Maybe it makes even more sense (at this stage) to state that the
behaviour in this case is undefined?

                               Peter

-- 
Peter Brett <peter@peter-b.co.uk>
Remote Sensing Research Group
Surrey Space Centre



From MAILER-DAEMON Fri Dec 16 09:26:58 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbYkU-0001SU-03
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 09:26:58 -0500
Received: from eggs.gnu.org ([140.186.70.92]:39967)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbYkR-0001RY-C0
	for guile-devel@gnu.org; Fri, 16 Dec 2011 09:26:56 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbYkK-0007p9-Pt
	for guile-devel@gnu.org; Fri, 16 Dec 2011 09:26:55 -0500
Received: from lo.gmane.org ([80.91.229.12]:50699)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbYkK-0007ow-H7
	for guile-devel@gnu.org; Fri, 16 Dec 2011 09:26:48 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RbYkE-0007Cq-Ul
	for guile-devel@gnu.org; Fri, 16 Dec 2011 15:26:42 +0100
Received: from p508edf03.dip.t-dialin.net ([80.142.223.3])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 16 Dec 2011 15:26:42 +0100
Received: from dak by p508edf03.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Fri, 16 Dec 2011 15:26:42 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: [PATCH] Implement `the-environment' and `local-eval' in evaluator
Date: Fri, 16 Dec 2011 15:26:26 +0100
Organization: Organization?!?
Lines: 27
Message-ID: <87fwgk384t.fsf@fencepost.gnu.org>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<877h1zo7xx.fsf_-_@netris.org> <8762hgkh2k.fsf_-_@netris.org>
	<8762hg50b3.fsf@fencepost.gnu.org>
	<we1mehw4pqep.fsf@ssclt001.ee.surrey.ac.uk>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508edf03.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:apti//IYNcAgYZAa8FaeK5ckA0Q=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 14:26:56 -0000

Peter TB Brett <peter@peter-b.co.uk> writes:

> David Kastrup <dak@gnu.org> writes:
>
>>> * I still wouldn't be surprised if `local-eval' does the wrong thing if
>>>   (current-module) is different from what it was when the associated
>>>   `primitive-eval' was called.
>>
>> Before anyone even _defines_ what the "right thing" would be, there is
>> little point in worrying about this.  I don't think that `local-eval'
>> 1.8 documented any behavior for this case (well, it did not document any
>> behavior for a lot of cases).
>>
>> So it probably makes sense to look afterwards what will happen without
>> special precautions, and unless that is spectacularly useless or
>> inconsistent, call it the "right thing" by definition.
>
> Maybe it makes even more sense (at this stage) to state that the
> behaviour in this case is undefined?

In my opinion it does not make sense at this stage to state anything.
Declaring the behavior as being undefined is premature when further work
might discover that it makes eminent sense to define it in a particular
way.

-- 
David Kastrup



From MAILER-DAEMON Fri Dec 16 09:42:11 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbYzD-0005BR-Ew
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 09:42:11 -0500
Received: from eggs.gnu.org ([140.186.70.92]:43336)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RbYz7-0005BG-NR
	for guile-devel@gnu.org; Fri, 16 Dec 2011 09:42:09 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RbYz1-0002Oy-Ui
	for guile-devel@gnu.org; Fri, 16 Dec 2011 09:42:05 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:45913
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RbYz1-0002Op-Qu
	for guile-devel@gnu.org; Fri, 16 Dec 2011 09:41:59 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 486577958;
	Fri, 16 Dec 2011 09:33:27 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=RqftRB7Gy8moPzBIlP1rVK2/d5Y=; b=d5w014
	RO7Ns6NrtLtEmPthjaLnUho/gq8t79wpYmb2BgZYoMvnhQLa2VnfSB810nFejBjp
	N1wSQRHG/0OPfZoAqDI08KzaXuo+whDkPrOuG6ehKxujS21ekLLmybUlLzv4h1j8
	8J6YdnUIAKW5TR8PTGoasTUamET9NgA0r4uhs=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=KZmyqBBlfm1T0etm6WhTdjAF9BbD8kfR
	ZAgegGNaZlNZknZpZQn22r4APtfdTUjkkpyOCAESGFzdH6sG5ho20kTRLiV1Jmgj
	DWJ+wfX5iGrjscSCtO6xOOJ3jrFA6q7OLTowXK5u7LGXmwTplMM3658jrG2hC0hH
	4OpiSVN9rAM=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 4232E7957;
	Fri, 16 Dec 2011 09:33:27 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id A92087955;
	Fri, 16 Dec 2011 09:33:26 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Ian Price <ianprice90@googlemail.com>
Subject: Re: SXML documentation
References: <8739cku6t2.fsf@Kagami.home>
Date: Fri, 16 Dec 2011 15:33:22 +0100
In-Reply-To: <8739cku6t2.fsf@Kagami.home> (Ian Price's message of "Fri, 16
	Dec 2011 10:52:57 +0000")
Message-ID: <87zkes8u31.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: EA8BBCE8-27F2-11E1-8C91-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 14:42:09 -0000

On Fri 16 Dec 2011 11:52, Ian Price <ianprice90@googlemail.com> writes:

> Hi guilers,
>
> The documentation for this in the manual is pretty sparse. Is it
> possible to lift the documentation for the procedures in the source up
> to the manual where people who don't read the source can find it?
>
> As an example, the function 'find-string-from-port?' in (sxml ssax
> input-parse) has the signature
>   find-string-from-port? _ _ . _ 
> which is not particularly meaningful. Or how would I know what the
> 'ssax:xml->sxml' argument 'namespace-prefix-assig' is if I didn't know
> already?

It probably needs to be rewritten.  It was part of an experiment to do
literate documentation, and it's pretty illiterate in the end.

Any patches to improve this situation are most welcome.

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Fri Dec 16 09:57:42 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbZEE-0004si-Of
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 09:57:42 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59505)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <haberg-1@telia.com>) id 1RbZE9-0004sZ-4q
	for guile-devel@gnu.org; Fri, 16 Dec 2011 09:57:41 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <haberg-1@telia.com>) id 1RbZE3-0005dC-D7
	for guile-devel@gnu.org; Fri, 16 Dec 2011 09:57:37 -0500
Received: from smtp-out21.han.skanova.net ([195.67.226.208]:55986)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <haberg-1@telia.com>)
	id 1RbZDz-0005cd-Ev; Fri, 16 Dec 2011 09:57:27 -0500
Received: from [10.0.1.2] (217.210.127.13) by smtp-out21.han.skanova.net
	(8.5.133) (authenticated as u26619196)
	id 4EC0B93A00D602DF; Fri, 16 Dec 2011 15:57:25 +0100
Subject: Re: summary: lilypond, lambda, and local-eval
Mime-Version: 1.0 (Apple Message framework v1251.1)
Content-Type: text/plain; charset=us-ascii
From: Hans Aberg <haberg-1@telia.com>
In-Reply-To: <87k45w3cwz.fsf@fencepost.gnu.org>
Date: Fri, 16 Dec 2011 15:57:26 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <D31F8B2A-FE08-4155-9F8A-097D8A15B76E@telia.com>
References: <87r506uodd.fsf@pobox.com> <87pqfpj7e3.fsf@netris.org>
	<87liqcamrf.fsf@pobox.com> <871us4kdqy.fsf@netris.org>
	<D1C9681B-85CC-4E37-8674-3F622EB7B046@telia.com>
	<87k45w3cwz.fsf@fencepost.gnu.org>
To: David Kastrup <dak@gnu.org>
X-Mailer: Apple Mail (2.1251.1)
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 195.67.226.208
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 14:57:41 -0000

On 16 Dec 2011, at 13:43, David Kastrup wrote:

>>> Here's what I currently see:
>>>=20
>>> scheme@(guile-user)> (local-eval #'t (primitive-eval '(let ((t 42))
>>> (or #f (the-environment)))))
>>> ERROR: In procedure memoize-variable-access!:
>>> ERROR: Unbound variable: t
>>>=20
>>> This is the correct behavior, no?
>>=20
>> This is what I get when I play around with the following variation of =
David's code in Guile 2.0.3:
>> (define (xxx)
>>  (let* ((x 2))
>>    (set! x (+ x 3))
>>    (interaction-environment)))
>>=20
>> (eval '(begin (set! x (+ x 5)) x) (xxx))
>>=20
>> My guess (correct?) is that one wants some variation of
>> (interaction-environment) that can cause x in the eval expression to
>> bind to the environment returned by (xxx).
>>=20
>> Might eval be changed to accommodate for that (without introducing =
the
>> name local-eval)?
>=20
> It would likely help with unasking the question of what to do when
> (current-module) is different at the time of local-eval.  I don't =
know,
> however, what the _lexical_ effects of switching the current module =
are
> supposed to be.  If it is supposed to be a noop, then lexical
> environments and modules are presumably orthogonal, and eval should
> likely be allowed to take both (currently, local-eval is like taking a
> lexical environment and using primitive-eval in it).

Would you not it work as though you inserted code in the place where =
then environment? - Then the syntactical rules should be captured as =
well.

In addition, there should be a way to communicate with the surrounding =
environment, wherefrom the code is inserted. The only truly safe way =
would be to make that explicit somehow, if not merely returning a value =
suffices.

Hans




From MAILER-DAEMON Fri Dec 16 10:29:36 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbZj6-0004Cb-37
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 10:29:36 -0500
Received: from eggs.gnu.org ([140.186.70.92]:54707)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbZiy-0004CM-NR
	for guile-devel@gnu.org; Fri, 16 Dec 2011 10:29:34 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbZiu-0003yR-ID
	for guile-devel@gnu.org; Fri, 16 Dec 2011 10:29:28 -0500
Received: from world.peace.net ([96.39.62.75]:57906)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbZiu-0003yD-Fh
	for guile-devel@gnu.org; Fri, 16 Dec 2011 10:29:24 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RbZim-0000Xf-GV; Fri, 16 Dec 2011 10:29:18 -0500
From: Mark H Weaver <mhw@netris.org>
To: Peter TB Brett <peter@peter-b.co.uk>
Subject: Re: [PATCH] Implement `the-environment' and `local-eval' in evaluator
References: <87liqtpsl9.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<877h1zo7xx.fsf_-_@netris.org> <8762hgkh2k.fsf_-_@netris.org>
	<8762hg50b3.fsf@fencepost.gnu.org>
	<we1mehw4pqep.fsf@ssclt001.ee.surrey.ac.uk>
Date: Fri, 16 Dec 2011 10:27:36 -0500
In-Reply-To: <we1mehw4pqep.fsf@ssclt001.ee.surrey.ac.uk> (Peter TB Brett's
	message of "Fri, 16 Dec 2011 14:00:46 +0000")
Message-ID: <87obv8iljr.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 15:29:34 -0000

Peter TB Brett <peter@peter-b.co.uk> writes:

> David Kastrup <dak@gnu.org> writes:
>
>>> * I still wouldn't be surprised if `local-eval' does the wrong thing if
>>>   (current-module) is different from what it was when the associated
>>>   `primitive-eval' was called.
>>
>> Before anyone even _defines_ what the "right thing" would be, there is
>> little point in worrying about this.  I don't think that `local-eval'
>> 1.8 documented any behavior for this case (well, it did not document any
>> behavior for a lot of cases).
>>
>> So it probably makes sense to look afterwards what will happen without
>> special precautions, and unless that is spectacularly useless or
>> inconsistent, call it the "right thing" by definition.
>
> Maybe it makes even more sense (at this stage) to state that the
> behaviour in this case is undefined?

To my mind, top-level (module) variables are conceptually part of every
lexical environment placed within that module.  For example, code like
this:

(define (factorial x)
  (if (zero? x) 1
      (* x (factorial (- x 1)))))

should act as one would naturally expect (assuming that factorial is not
later set!), whether it is placed within a local block or placed at the
top-level of some module.

It would be crazy for any lexical environment "search path" starting
from within factorial's definition block to lead to a different module
than the one where `factorial' was defined.

In other words, in the following example, any variable lookup that would
lead to `foo2' should also lead to the `foo1' (assuming it's not
shadowed by a lexical binding).

(define foo1 #f)
(let ((foo2 #f))
   <insert any code here>)

As an interesting case, suppose that you define the following macro in
module A:

(define foo 'module-a)
(define-syntax alt-environment
  (syntax-rules ()
    ((_) (the-environment))))

and then evaluate the following within module B:

(define foo 'module-b)
(local-eval 'foo (alt-environment))

What should the result be?

My guess is that it should return 'module-a, because I think
conceptually it should act as though the local-expression passed to
`local-eval' were put in place of (the-environment), wherever that
might be.

Thoughts?

       Mark


From MAILER-DAEMON Fri Dec 16 11:01:39 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbaE7-0001ZG-0M
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 11:01:39 -0500
Received: from eggs.gnu.org ([140.186.70.92]:43831)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RbaDw-0001Y0-Al
	for guile-devel@gnu.org; Fri, 16 Dec 2011 11:01:37 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RbaDr-0002YZ-9U
	for guile-devel@gnu.org; Fri, 16 Dec 2011 11:01:28 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:63136
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RbaDr-0002YT-72
	for guile-devel@gnu.org; Fri, 16 Dec 2011 11:01:23 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 635BB848A;
	Fri, 16 Dec 2011 11:01:22 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=74UbgpKbwgB1+GEgmYyUXNIPu5E=; b=bnQBYK
	ATTC1nnkdtDyUkunM6k/fiJXwjyAQ0yCazeXHxSHUeZCrKOoWr3spInB+FIrV4op
	0GvyH5PiCFPvTvV3lE1Zt+8znmCfdeceIhDsY3O9Pj7Nhno64BtUmciGs6Vp51ny
	BHJ+axL/gTzdnxwpHw0JGXf6fVRBB068RC0fg=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=bbrLDSdDH2RVf4jXAY4f2fSef2tOItwU
	PIjmfNfI+KIkqMJxczrbrgRXIHzdxjWA9z4zusqadMqkPQuVHpLHZghLTWZ4aSKt
	KxARlK5K0zub3pYOyshEgBENBolTAaibDyybBQFf1vtevwsSzb9eou3M+MES2JYl
	KYl4bSxOWMU=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 3C2FB8489;
	Fri, 16 Dec 2011 11:01:22 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 614E48488;
	Fri, 16 Dec 2011 11:01:21 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Mark H Weaver <mhw@netris.org>
Subject: Re: [PATCH] Implement `the-environment' and `local-eval' in evaluator
References: <87liqtpsl9.fsf@fencepost.gnu.org> <87mxaxihnw.fsf@pobox.com>
	<87obvclu92.fsf@fencepost.gnu.org> <87aa6wbp0w.fsf@pobox.com>
	<87fwgolgm5.fsf@fencepost.gnu.org> <8762hkbkwi.fsf@pobox.com>
	<87borclcem.fsf@fencepost.gnu.org> <87zkewa2vy.fsf@pobox.com>
	<87zkewjvyz.fsf@fencepost.gnu.org> <87vcpka13n.fsf@pobox.com>
	<87zkewnzy7.fsf@netris.org> <87r5089ui3.fsf@pobox.com>
	<87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<877h1zo7xx.fsf_-_@netris.org> <8762hgkh2k.fsf_-_@netris.org>
	<8762hg50b3.fsf@fencepost.gnu.org>
	<we1mehw4pqep.fsf@ssclt001.ee.surrey.ac.uk> <87obv8iljr.fsf@netris.org>
Date: Fri, 16 Dec 2011 17:01:17 +0100
In-Reply-To: <87obv8iljr.fsf@netris.org> (Mark H. Weaver's message of "Fri,
	16 Dec 2011 10:27:36 -0500")
Message-ID: <87obv88q0i.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 32836BA2-27FF-11E1-A8E7-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: Peter TB Brett <peter@peter-b.co.uk>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 16:01:37 -0000

On Fri 16 Dec 2011 16:27, Mark H Weaver <mhw@netris.org> writes:

> To my mind, top-level (module) variables are conceptually part of every
> lexical environment placed within that module.

Agreed.

> (define foo 'module-a)
> (define-syntax alt-environment
>   (syntax-rules ()
>     ((_) (the-environment))))

> and then evaluate the following within module B:

> (define foo 'module-b)
> (local-eval 'foo (alt-environment))

> What should the result be?

> My guess is that it should return 'module-a, because I think
> conceptually it should act as though the local-expression passed to
> `local-eval' were put in place of (the-environment), wherever that

Dunno, I could make an argument either way :)  Another question is how
would local environments relate to procedural macros.

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Fri Dec 16 11:59:41 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rbb8H-0005Kn-Ic
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 11:59:41 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59710)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <haberg-1@telia.com>) id 1Rbb8A-0005I9-PH
	for guile-devel@gnu.org; Fri, 16 Dec 2011 11:59:38 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <haberg-1@telia.com>) id 1Rbb85-0006YV-5I
	for guile-devel@gnu.org; Fri, 16 Dec 2011 11:59:34 -0500
Received: from smtp-out12.han.skanova.net ([195.67.226.212]:58504)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <haberg-1@telia.com>) id 1Rbb84-0006YA-Mw
	for guile-devel@gnu.org; Fri, 16 Dec 2011 11:59:29 -0500
Received: from [10.0.1.2] (217.210.127.13) by smtp-out12.han.skanova.net
	(8.5.133) (authenticated as u26619196)
	id 4ECF62B40063FABC; Fri, 16 Dec 2011 17:59:14 +0100
Subject: Re: [PATCH] Implement `the-environment' and `local-eval' in evaluator
Mime-Version: 1.0 (Apple Message framework v1251.1)
Content-Type: text/plain; charset=us-ascii
From: Hans Aberg <haberg-1@telia.com>
In-Reply-To: <87obv8iljr.fsf@netris.org>
Date: Fri, 16 Dec 2011 17:59:13 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <748F1A2B-B0AF-4646-B982-664014995E88@telia.com>
References: <87liqtpsl9.fsf@fencepost.gnu.org> <87wra1hcek.fsf@netris.org>
	<87mxaxihnw.fsf@pobox.com> <87obvclu92.fsf@fencepost.gnu.org>
	<87aa6wbp0w.fsf@pobox.com> <87fwgolgm5.fsf@fencepost.gnu.org>
	<8762hkbkwi.fsf@pobox.com> <87borclcem.fsf@fencepost.gnu.org>
	<87zkewa2vy.fsf@pobox.com> <87zkewjvyz.fsf@fencepost.gnu.org>
	<87vcpka13n.fsf@pobox.com> <87zkewnzy7.fsf@netris.org>
	<87r5089ui3.fsf@pobox.com> <87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<877h1zo7xx.fsf_-_@netris.org> <8762hgkh2k.fsf_-_@netris.org>
	<8762hg50b3.fsf@fencepost.gnu.org>
	<we1mehw4pqep.fsf@ssclt001.ee.surrey.ac.uk>
	<87obv8iljr.fsf@netris.org>
To: Mark H Weaver <mhw@netris.org>
X-Mailer: Apple Mail (2.1251.1)
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 195.67.226.212
Cc: Peter TB Brett <peter@peter-b.co.uk>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 16:59:38 -0000

On 16 Dec 2011, at 16:27, Mark H Weaver wrote:

> As an interesting case, suppose that you define the following macro in
> module A:
>=20
> (define foo 'module-a)
> (define-syntax alt-environment
>  (syntax-rules ()
>    ((_) (the-environment))))
>=20
> and then evaluate the following within module B:
>=20
> (define foo 'module-b)
> (local-eval 'foo (alt-environment))
>=20
> What should the result be?
>=20
> My guess is that it should return 'module-a, because I think
> conceptually it should act as though the local-expression passed to
> `local-eval' were put in place of (the-environment), wherever that
> might be.
>=20
> Thoughts?

I thought it should be a way to capture the environment when =
(the-environment) is evaluated, returning a reference to it. So
  (define foo 'module-a)
  (define bar (the-environment))  ; Capture environment, and save =
reference in bar.
Now in
  (define foo 'module-b)
  (local-eval 'foo bar)
bar refers to the captured environment and 'foo is inserted into that; =
that is 'module-a.

It would need to capture all dynamic syntactic rules as well, otherwise =
the code cannot be run safely.

Hans




From MAILER-DAEMON Fri Dec 16 12:46:15 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbbrL-00070d-D9
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 12:46:15 -0500
Received: from eggs.gnu.org ([140.186.70.92]:50897)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbbrJ-00070X-4G
	for guile-devel@gnu.org; Fri, 16 Dec 2011 12:46:14 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbbrH-00068M-MV
	for guile-devel@gnu.org; Fri, 16 Dec 2011 12:46:13 -0500
Received: from world.peace.net ([96.39.62.75]:53787)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbbrH-00068G-Gl
	for guile-devel@gnu.org; Fri, 16 Dec 2011 12:46:11 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RbbrB-00011J-VZ; Fri, 16 Dec 2011 12:46:06 -0500
From: Mark H Weaver <mhw@netris.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: [PATCH] Implement `the-environment' and `local-eval' in evaluator
References: <87liqtpsl9.fsf@fencepost.gnu.org>
	<87obvclu92.fsf@fencepost.gnu.org> <87aa6wbp0w.fsf@pobox.com>
	<87fwgolgm5.fsf@fencepost.gnu.org> <8762hkbkwi.fsf@pobox.com>
	<87borclcem.fsf@fencepost.gnu.org> <87zkewa2vy.fsf@pobox.com>
	<87zkewjvyz.fsf@fencepost.gnu.org> <87vcpka13n.fsf@pobox.com>
	<87zkewnzy7.fsf@netris.org> <87r5089ui3.fsf@pobox.com>
	<87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<877h1zo7xx.fsf_-_@netris.org> <8762hgkh2k.fsf_-_@netris.org>
	<8762hg50b3.fsf@fencepost.gnu.org>
	<we1mehw4pqep.fsf@ssclt001.ee.surrey.ac.uk>
	<87obv8iljr.fsf@netris.org> <87obv88q0i.fsf@pobox.com>
Date: Fri, 16 Dec 2011 12:44:30 -0500
In-Reply-To: <87obv88q0i.fsf@pobox.com> (Andy Wingo's message of "Fri, 16 Dec
	2011 17:01:17 +0100")
Message-ID: <87k45wif7l.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: Peter TB Brett <peter@peter-b.co.uk>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 17:46:14 -0000

Andy Wingo <wingo@pobox.com> writes:
>> (define foo 'module-a)
>> (define-syntax alt-environment
>>   (syntax-rules ()
>>     ((_) (the-environment))))
>
>> and then evaluate the following within module B:
>
>> (define foo 'module-b)
>> (local-eval 'foo (alt-environment))
>
>> What should the result be?
>
>> My guess is that it should return 'module-a, because I think
>> conceptually it should act as though the local-expression passed to
>> `local-eval' were put in place of (the-environment), wherever that
>
> Dunno, I could make an argument either way :)

Having thought more about this, I'm fully convinced that 'module-a
should be the answer.

The real reason is that we need to macroexpand the new local expression
within the expander-environment captured by (the-environment), and this
expander-environment really determines the lexical environment that
symbols are looked up in, in the same way that free variable references
from a macro definition are resolved in the lexical environment of the
macro definition instead of the place where the macro is used.

If we don't use the expander-environment captured by (the-environment),
what other expander-environment would we use, and how would we capture
this other environment?

I guess the other option would be that, if (the-environment) is found
within a macro definition, then we should instead use the expander
environment from where the currently-expanding macro was _used_.  But
what if that use is itself within another macro definition?  I don't
think it makes sense to just go up one level, that seems very inelegant.
No, it should be one extreme or the other, so the other logical choice
would be to go all the way up the macro expansion stack to the top,
where the use of the _initial_ macro was found.

But regardless of whether we go up one level or all the way to the top,
this other option would cause serious problems.  In the general case,
(the-environment) could be nested quite deeply within `let's,
`let-syntax's, and worse of all, `lambda's!

For example, consider the following example:

(define-syntax blah
  (syntax-rules ()
    ((_) (lambda ()
           (let-syntax (...)
             (let (<lots of variable definitions>)
               <lots of code>
               (the-environment)))))))

If we were to use this crazy alternate rule, then `local-eval' should
evaluate its expression in the environment where the above macro was
used, i.e. where the procedure was _defined_.  I hope we can all agree
that this would be madness.

No, the only sane option is to do the straightforward thing: we use the
expander environment captured by (the-environment), even if that's found
within a macro.  And that also means that the module used by
`local-eval' should be the module found within the expander environment,
i.e. the module where the macro containing (the-environment) was
_defined_.

Does this make sense?

      Best,
       Mark


From MAILER-DAEMON Fri Dec 16 14:14:17 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbdEX-00019Q-PS
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 14:14:17 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59970)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbdEV-00018h-FK
	for guile-devel@gnu.org; Fri, 16 Dec 2011 14:14:16 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbdET-0003sT-Ub
	for guile-devel@gnu.org; Fri, 16 Dec 2011 14:14:15 -0500
Received: from world.peace.net ([96.39.62.75]:50367)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RbdET-0003rY-Qz
	for guile-devel@gnu.org; Fri, 16 Dec 2011 14:14:13 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RbdEE-0001FD-Bs; Fri, 16 Dec 2011 14:13:58 -0500
From: Mark H Weaver <mhw@netris.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: [PATCH] Implement `the-environment' and `local-eval' in evaluator
References: <87liqtpsl9.fsf@fencepost.gnu.org> <87aa6wbp0w.fsf@pobox.com>
	<87fwgolgm5.fsf@fencepost.gnu.org> <8762hkbkwi.fsf@pobox.com>
	<87borclcem.fsf@fencepost.gnu.org> <87zkewa2vy.fsf@pobox.com>
	<87zkewjvyz.fsf@fencepost.gnu.org> <87vcpka13n.fsf@pobox.com>
	<87zkewnzy7.fsf@netris.org> <87r5089ui3.fsf@pobox.com>
	<87r508nv0o.fsf@netris.org>
	<CA+U71=OpKbYFNt0wLqJLnb3n4v-RDerGXw80KRnvrt8KVLg1rg@mail.gmail.com>
	<87fwgondme.fsf@netris.org> <87borboalb.fsf@netris.org>
	<877h1zo7xx.fsf_-_@netris.org> <8762hgkh2k.fsf_-_@netris.org>
	<8762hg50b3.fsf@fencepost.gnu.org>
	<we1mehw4pqep.fsf@ssclt001.ee.surrey.ac.uk>
	<87obv8iljr.fsf@netris.org> <87obv88q0i.fsf@pobox.com>
	<87k45wif7l.fsf@netris.org>
Date: Fri, 16 Dec 2011 14:12:24 -0500
In-Reply-To: <87k45wif7l.fsf@netris.org> (Mark H. Weaver's message of "Fri, 16
	Dec 2011 12:44:30 -0500")
Message-ID: <87fwgkib53.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: Peter TB Brett <peter@peter-b.co.uk>, guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 19:14:16 -0000

I wrote:
> Having thought more about this, I'm fully convinced that 'module-a
> should be the answer.

On second thought, I don't think my argument was very solid.  My nephew
demanded my attention while I was working on that email, and so I rushed
it out when I should have put it aside and pondered some more.

So, in cases where (the-environment) is found within a macro template,
I guess I'm still undecided about whether the captured expander
environment should be at the point of (the-environment), or whether it
should be at the point of the initial macro use that led to that
expansion.

However, I'm fairly sure that those are the only two sane options, and I
feel quite certain that the module used by `local-eval' should be taken
from the captured expander environment, whatever that may be.

Do people agree with that those are the two sane options?
Any thoughts on which one is more useful?

I guess we should try to come up with examples of useful macros that use
(the-environment), and hope that these examples point to a clear winner.

For that matter, in the unlikely case that both options seem genuinely
useful, it wouldn't be hard to implement both, since they would both
translate to the same `tree-il' type.  The only difference would be in
the expander, since it puts the <expander-environment> into the tree-il
node, and that piece of code is only a few lines.

Thoughts?

     Best,
      Mark


From MAILER-DAEMON Fri Dec 16 18:02:32 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbgnQ-0002Fk-36
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 18:02:32 -0500
Received: from eggs.gnu.org ([140.186.70.92]:44545)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RbgnN-0002Ek-EQ
	for guile-devel@gnu.org; Fri, 16 Dec 2011 18:02:30 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RbgnM-0000v2-Da
	for guile-devel@gnu.org; Fri, 16 Dec 2011 18:02:29 -0500
Received: from mail4-relais-sop.national.inria.fr ([192.134.164.105]:7590)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <ludo@gnu.org>)
	id 1RbgnM-0000uw-7U
	for guile-devel@gnu.org; Fri, 16 Dec 2011 18:02:28 -0500
X-IronPort-AV: E=Sophos;i="4.71,365,1320620400"; d="scan'208";a="123709464"
Received: from reverse-83.fdn.fr (HELO pluto) ([80.67.176.83])
	by mail4-relais-sop.national.inria.fr with ESMTP/TLS/DHE-RSA-AES128-SHA;
	17 Dec 2011 00:02:26 +0100
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
To: Nala Ginrut <nalaginrut@gmail.com>
Subject: Re: "exec" procedures don't handle the optional parameters unbounded
	situation?
References: <CAPjoZocbzu__+KOmvZf1h9P854HxbAawdR=poM0nHNa9RSi1jg@mail.gmail.com>
	<877h1xej7s.fsf@gnu.org>
	<CAPjoZoemjo7HArNgsBGFb2SUF+3RMtVm1XOoU+UF-ryh92fQnQ@mail.gmail.com>
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 27 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
Date: Sat, 17 Dec 2011 00:02:18 +0100
In-Reply-To: <CAPjoZoemjo7HArNgsBGFb2SUF+3RMtVm1XOoU+UF-ryh92fQnQ@mail.gmail.com>
	(Nala Ginrut's message of "Fri, 16 Dec 2011 12:03:50 +0800")
Message-ID: <87r504unlx.fsf@gnu.org>
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 192.134.164.105
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 16 Dec 2011 23:02:30 -0000

Hello!

Nala Ginrut <nalaginrut@gmail.com> skribis:

> Since Guile provides flexible optional arguments handling, why we can not
> do this:
> let (execlp "ls")  equal to (execlp "ls" "") if the second argument is
> unbounded?

Because it would differ from what the underlying system call allows, and
would also be an incompatible change.

Thanks,
Ludo=E2=80=99.


From MAILER-DAEMON Fri Dec 16 23:35:02 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RblzC-0004Gw-7T
	for mharc-guile-devel@gnu.org; Fri, 16 Dec 2011 23:35:02 -0500
Received: from eggs.gnu.org ([140.186.70.92]:53293)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rblz9-0004Fx-Nh
	for guile-devel@gnu.org; Fri, 16 Dec 2011 23:35:00 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rblz8-0004pm-L7
	for guile-devel@gnu.org; Fri, 16 Dec 2011 23:34:59 -0500
Received: from lo.gmane.org ([80.91.229.12]:35773)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rblz8-0004pg-G8
	for guile-devel@gnu.org; Fri, 16 Dec 2011 23:34:58 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rblz6-0007s9-SN
	for guile-devel@gnu.org; Sat, 17 Dec 2011 05:34:56 +0100
Received: from p508ec133.dip.t-dialin.net ([80.142.193.51])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sat, 17 Dec 2011 05:34:56 +0100
Received: from dak by p508ec133.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sat, 17 Dec 2011 05:34:56 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: "exec" procedures don't handle the optional parameters unbounded
	situation?
Date: Sat, 17 Dec 2011 05:34:44 +0100
Organization: Organization?!?
Lines: 20
Message-ID: <8739cj24uz.fsf@fencepost.gnu.org>
References: <CAPjoZocbzu__+KOmvZf1h9P854HxbAawdR=poM0nHNa9RSi1jg@mail.gmail.com>
	<877h1xej7s.fsf@gnu.org>
	<CAPjoZoemjo7HArNgsBGFb2SUF+3RMtVm1XOoU+UF-ryh92fQnQ@mail.gmail.com>
	<87r504unlx.fsf@gnu.org>
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ec133.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:rHS1zTGACs2TgW7iwU8Iztp9okg=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sat, 17 Dec 2011 04:35:00 -0000

ludo@gnu.org (Ludovic Courts) writes:

> Hello!
>
> Nala Ginrut <nalaginrut@gmail.com> skribis:
>
>> Since Guile provides flexible optional arguments handling, why we can not
>> do this:
>> let (execlp "ls")  equal to (execlp "ls" "") if the second argument is
>> unbounded?
>
> Because it would differ from what the underlying system call allows, and
> would also be an incompatible change.

Incompatible?  You really think there are programs relying on this being
an error?  I agree that a system call wrapper should not be too clever,
but compatibility is hardly a concern here.

-- 
David Kastrup



From MAILER-DAEMON Sat Dec 17 10:07:40 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbvrQ-0004MU-0V
	for mharc-guile-devel@gnu.org; Sat, 17 Dec 2011 10:07:40 -0500
Received: from eggs.gnu.org ([140.186.70.92]:39095)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RbvrO-0004MA-7S
	for guile-devel@gnu.org; Sat, 17 Dec 2011 10:07:38 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RbvrN-0003ru-BI
	for guile-devel@gnu.org; Sat, 17 Dec 2011 10:07:38 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:55991)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RbvrN-0003rk-8C
	for guile-devel@gnu.org; Sat, 17 Dec 2011 10:07:37 -0500
Received: by iacb35 with SMTP id b35so5018965iac.0
	for <guile-devel@gnu.org>; Sat, 17 Dec 2011 07:07:35 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:date:message-id:subject:from:to:content-type;
	bh=1To8mDo1nvcrrk5I8X00J253Ad99/RsZi4SWOVEUWq0=;
	b=PaAcdmb379WqE2mIJUVK9rUhljOM4OoU8zLVZubxJ0vJf0ye5THeF+UUkIArshzuFO
	MGohzck/gEQ9dH8azUQgz9M1B31X92v3xqv5CV0sN7mq4EjtrFZBb7IOdLknwN0Hp/Dk
	98rIHG4hEgEZxHD/6wzwr7AQwahNN84sd3HR8=
MIME-Version: 1.0
Received: by 10.50.159.161 with SMTP id xd1mr16785161igb.12.1324134455860;
	Sat, 17 Dec 2011 07:07:35 -0800 (PST)
Received: by 10.42.217.6 with HTTP; Sat, 17 Dec 2011 07:07:35 -0800 (PST)
Date: Sat, 17 Dec 2011 10:07:35 -0500
Message-ID: <CA+U71=O_UCAFBmTeZiBr6eGeVDQOxh6MQGR-R++8Y-DRsqSXPg@mail.gmail.com>
Subject: Testing Functions Internal to a Module
From: Noah Lavine <noah549@gmail.com>
To: guile-devel <guile-devel@gnu.org>
Content-Type: text/plain; charset=ISO-8859-1
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sat, 17 Dec 2011 15:07:39 -0000

Hello Guile developers,

I have recently hit an issue and I wish I knew a standard way to handle it.

I want to write tests for a module of mine. Because I like being
paranoid, I'd like to test almost every function in the module. But a
lot of these functions are internal to the module - there's no reason
to export them, except that my test suite needs access to them. So my
choices are to export functions that I don't really want to export, or
to put a bunch of internal module references at the top of my test
program.

Is there a standard way of handling this?

This seems like a place where perhaps a helper procedure would be
useful, because lots of test suites will face this issue. Something
like "import all of this module's private definitions". What does
everyone else do in this situation?

Thanks,
Noah


From MAILER-DAEMON Sat Dec 17 10:35:52 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RbwIi-0001H8-VA
	for mharc-guile-devel@gnu.org; Sat, 17 Dec 2011 10:35:52 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55221)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ianprice90@googlemail.com>) id 1RbwIg-0001FR-Ft
	for guile-devel@gnu.org; Sat, 17 Dec 2011 10:35:51 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ianprice90@googlemail.com>) id 1RbwIf-0007QL-F3
	for guile-devel@gnu.org; Sat, 17 Dec 2011 10:35:50 -0500
Received: from mail-ww0-f49.google.com ([74.125.82.49]:44425)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ianprice90@googlemail.com>) id 1RbwIf-0007QH-Ac
	for guile-devel@gnu.org; Sat, 17 Dec 2011 10:35:49 -0500
Received: by wgbdt11 with SMTP id dt11so6599355wgb.30
	for <guile-devel@gnu.org>; Sat, 17 Dec 2011 07:35:47 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
	d=googlemail.com; s=gamma;
	h=from:to:cc:subject:references:date:in-reply-to:message-id
	:user-agent:mime-version:content-type;
	bh=R9CUhF00GzC/09Y30+epws/DWbiL3m04PmBcapKxpKg=;
	b=b9KnWFuVxlUfO9VPJ35oxkrFDzJHitQdh0YnxGjs7eqtVsWRdDVjciPCEXKwZnhptP
	gu00EUiT00gJ2vyBlW8rKcxhHyXBkjAExoWQlnjltEfKP4AcjsUBuyDd1riKCmOwqKnB
	iNpkzlm77XDIwGU+AEc8d6v/5Ag5SwzCGSYOM=
Received: by 10.227.206.76 with SMTP id ft12mr8202378wbb.1.1324136147842;
	Sat, 17 Dec 2011 07:35:47 -0800 (PST)
Received: from Kagami.home (host109-154-207-250.range109-154.btcentralplus.com.
	[109.154.207.250])
	by mx.google.com with ESMTPS id m5sm17806168wie.2.2011.12.17.07.35.44
	(version=TLSv1/SSLv3 cipher=OTHER);
	Sat, 17 Dec 2011 07:35:45 -0800 (PST)
From: Ian Price <ianprice90@googlemail.com>
To: Noah Lavine <noah549@gmail.com>
Subject: Re: Testing Functions Internal to a Module
References: <CA+U71=O_UCAFBmTeZiBr6eGeVDQOxh6MQGR-R++8Y-DRsqSXPg@mail.gmail.com>
Date: Sat, 17 Dec 2011 15:31:26 +0000
In-Reply-To: <CA+U71=O_UCAFBmTeZiBr6eGeVDQOxh6MQGR-R++8Y-DRsqSXPg@mail.gmail.com>
	(Noah Lavine's message of "Sat, 17 Dec 2011 10:07:35 -0500")
Message-ID: <87y5ubrz8x.fsf@Kagami.home>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 74.125.82.49
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sat, 17 Dec 2011 15:35:51 -0000

Noah Lavine <noah549@gmail.com> writes:

> Is there a standard way of handling this?
>
> This seems like a place where perhaps a helper procedure would be
> useful, because lots of test suites will face this issue. Something
> like "import all of this module's private definitions". What does
> everyone else do in this situation?
When testing at the repl, I've used ,m to great effect, and presumably
you could use set-current-module and co. in a similar way.

Alternatively, you could use (@@ (module name) procedure-name) to access
a private function. Maybe with a helper like

(define-syntax-rule (use-privates module proc-name ...)
  (begin (define proc-name (@@ module proc-name)) ...))

-- 
Ian Price

"Programming is like pinball. The reward for doing it well is
the opportunity to do it again" - from "The Wizardy Compiled"


From MAILER-DAEMON Sun Dec 18 02:13:41 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RcAwH-0004OP-0z
	for mharc-guile-devel@gnu.org; Sun, 18 Dec 2011 02:13:41 -0500
Received: from eggs.gnu.org ([140.186.70.92]:50272)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RcAwE-0004Nz-GJ
	for guile-devel@gnu.org; Sun, 18 Dec 2011 02:13:39 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RcAwA-00076S-Mi
	for guile-devel@gnu.org; Sun, 18 Dec 2011 02:13:38 -0500
Received: from world.peace.net ([96.39.62.75]:55895)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RcAwA-0006x6-IO
	for guile-devel@gnu.org; Sun, 18 Dec 2011 02:13:34 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RcAvt-00053V-E1; Sun, 18 Dec 2011 02:13:17 -0500
From: Mark H Weaver <mhw@netris.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: summary: lilypond, lambda, and local-eval
References: <87r506uodd.fsf@pobox.com> <87pqfpj7e3.fsf@netris.org>
	<87aa6skika.fsf@netris.org>
Date: Sun, 18 Dec 2011 02:11:41 -0500
In-Reply-To: <87aa6skika.fsf@netris.org> (Mark H. Weaver's message of "Fri, 16
	Dec 2011 03:49:09 -0500")
Message-ID: <878vmaicb6.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sun, 18 Dec 2011 07:13:39 -0000

I wrote:
>> Most passes of the compiler will pretend that (the-environment) is
>> replaced by tree-il code corresponding to the following standard scheme
>> code:
>
> I should also mention that perhaps, instead of simply "pretending", it
> might make sense to actually replace (the-environment) with the standard
> scheme code I gave as early as possible, so that later passes will never
> even see `the-environment' tree-il nodes.  It need only be late enough
> so that the list of visible lexical variable names is known at that
> point.

So, it turns out that the best place to transform (the-environment) into
standard scheme code is in the macro expander itself.  Indeed, only the
macro expander has enough information to generate an optimal list of
"reachable lexicals", i.e. lexical variables that are accessible using
normal symbols (as opposed to syntax objects) [more on this below].

This is great news, because it means that `the-environment' will no
longer require its own tree-il type, and the compiler will only see the
standard scheme code that it expands into.

However, we will need a robust way to either (A) specify, (B) discover,
or (C) predict the order of the captured lexicals in a closure.

Option A would be ideal, because it would allow `local-eval' to easily
and robustly create a new closure that is "compatible" with the
general-dispatcher closure created by (the-environment), using only
standard compiler interfaces.  By "compatible", I mean that their
captured lexicals have the same names and are stored in the same order
in the closure, so that code from the new closure can be spliced into
the existing general-dispatcher closure.

Option B would require `local-eval' to use a special interface to the
compiler to compile new code that is compatible with the existing
general-dispatcher closure.

Option C is similar to option B but probably more fragile, because
future changes to the compiler might invalidate the predictions and thus
break `local-eval'.  However, this fragility could perhaps be mitigated
by prominent warnings in the comments of the code that determines
closure slot order.

I have yet to decide which option to take.  Suggestions welcome.

* * * * *

There's also another issue that has come to my attention.  If we must
support arbitrary syntax-objects to be passed to `local-eval', in many
(most?) cases this will greatly increase the number of lexicals that
must be captured, and thus boxed, by (the-environment).

Consider the following example:

(let* ((t 42)
       (t (1+ t))
       (t (1+ t))
       (t (1+ t)))
  (or #f (the-environment))))

If syntax-objects are never passed to `local-eval', then only one
lexical variable is reachable from (the-environment), namely the last
`t' in the `let*', and therefore that's the only variable that must be
boxed.

However, if we must support arbitrary syntax-objects, then not only are
all four of the above `t's reachable, but the hidden `t' from the
expansion of the `or' is reachable as well!  (or at least I see no way
for the implementation of `the-environment' to prove that the user does
not possess such syntax-objects, given the way psyntax is implemented).

It would be a shame to force all of these shadowed and hidden variables
to be boxed.  If we can minimize the number of captured variables, we
can reduce the performance impact of `the-environment'.

So, I'm thinking that (the-environment) should only capture lexical
variables that are reachable using normal symbols.  I've already written
code for psyntax that generates this list of reachable lexicals.  This
should suffice in the overwhelming majority of cases.

If needed, we could easily support a variant: (the-full-environment) or
(the-environment #:full), that captures _all_ lexicals reachable using
arbitrary syntax-objects.

What do you think?

    Mark


From MAILER-DAEMON Sun Dec 18 06:27:51 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RcEuF-00053G-Me
	for mharc-guile-devel@gnu.org; Sun, 18 Dec 2011 06:27:51 -0500
Received: from eggs.gnu.org ([140.186.70.92]:47866)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RcEuC-000539-V6
	for guile-devel@gnu.org; Sun, 18 Dec 2011 06:27:50 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RcEuB-00022B-Ga
	for guile-devel@gnu.org; Sun, 18 Dec 2011 06:27:48 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:51277
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RcEuB-000225-DU
	for guile-devel@gnu.org; Sun, 18 Dec 2011 06:27:47 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 6C788705F;
	Sun, 18 Dec 2011 06:27:46 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=MYHR2bGZivP7nO9CeYlVXBCRVq0=; b=ElD7hj
	2EX0X8xW6xhLiWEmZxMDMqIzmTMP5zpjs4LkzJIQXZAIR1xqsZ9unMk6s4Aaahna
	yvGKuGwHAcNARKaNLyTnY1Cvx4XHXvcztkIQU2gl0EovV5K8EAxd0vnhjyLiOjYJ
	p7vwmXMEZ3a7SYiqIgGgWaGPLXXraWlOS3SMM=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=jDexrkL5eBe+k38/s5YeF3Jw998jpBYY
	GhBvza52DATXETK/oWL+d4mUqYqsjvW4XP7aaTpX7HGD5rSuIqdUQbxhF6WhSK1p
	RkHyJLjOe8m+rFmNbuFAlKrE9ZgNDb/AGosrmU1ajwpIpwtYyJiVOuP39NjlDyNP
	yIsgEPy3gtA=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 65C4B705E;
	Sun, 18 Dec 2011 06:27:46 -0500 (EST)
Received: from badger (unknown [90.164.198.39]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id A92F4705D;
	Sun, 18 Dec 2011 06:27:45 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Mark H Weaver <mhw@netris.org>
Subject: Re: summary: lilypond, lambda, and local-eval
References: <87r506uodd.fsf@pobox.com> <87pqfpj7e3.fsf@netris.org>
	<87aa6skika.fsf@netris.org> <878vmaicb6.fsf@netris.org>
Date: Sun, 18 Dec 2011 12:27:42 +0100
In-Reply-To: <878vmaicb6.fsf@netris.org> (Mark H. Weaver's message of "Sun,
	18 Dec 2011 02:11:41 -0500")
Message-ID: <87vcperufl.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 4ED169B8-296B-11E1-98BA-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sun, 18 Dec 2011 11:27:50 -0000

On Sun 18 Dec 2011 08:11, Mark H Weaver <mhw@netris.org> writes:

> So, it turns out that the best place to transform (the-environment) into
> standard scheme code is in the macro expander itself.

Are you certain that it is desirable to transform it into standard
Scheme code?

The statement that the-environment acts "as if it were the expression,
(case-lambda ....)" doesn't mean that you have to implement it that
way.

> Indeed, only the macro expander has enough information to generate an
> optimal list of "reachable lexicals", i.e. lexical variables that are
> accessible using normal symbols (as opposed to syntax objects) [more
> on this below].

Are you certain that you want to restrict the set of identifiers?

To me it sounds like an optimization, perhaps premature.

What do you think about having a <the-environment> tree-il form have a
field for the names and a field for the gensyms of captured lexicals?

> This is great news, because it means that `the-environment' will no
> longer require its own tree-il type, and the compiler will only see the
> standard scheme code that it expands into.
>
> However, we will need a robust way to either (A) specify, (B) discover,
> or (C) predict the order of the captured lexicals in a closure.

We could compile `the-environment' so that at runtime it yields a record
containing a vector of syntax objects and a vector of corresponding
variable objects.  (When the compiler boxes a variable, it does so in a
variable object, as from make-variable.)  Then you don't introduce
cross-cutting assumptions to the compiler and runtime.

> I have yet to decide which option to take.  Suggestions welcome.

WDYT about mine? :)

> There's also another issue that has come to my attention.  If we must
> support arbitrary syntax-objects to be passed to `local-eval', in many
> (most?) cases this will greatly increase the number of lexicals that
> must be captured, and thus boxed, by (the-environment).

If a tree-il `the-environment' form takes a list of names and gensyms,
then we can provide the possibility in the future to limit the set of
captured bindings.

> So, I'm thinking that (the-environment) should only capture lexical
> variables that are reachable using normal symbols.

I think I disagree here.  It is strictly less useful to capture a subset
of bindings, and it would only be done for efficiency, and it probably
doesn't matter.

So yeah, I guess my arguments here depend on a tree-il the-environment
form.  I wonder if that is the right thing, though; maybe there is a
lower-level concept at work.  The only thing that you need that tree-il
doesn't give you right now is the ability to declare a variable as
boxed, and to capture its identity.

Maybe what we need is a <lexical-capture> form that evaluates to the
variable corresponding to a bound lexical.  Then `the-environment' could
expand out to

   (make-struct/no-tail <lexical-environment>
                        '(name ...)
                        (list (capture-lexical name) ...))

You would still need support from the expander to get the set of
currently-bound names, but maybe that is a new primitive that we could
add.

Could we do it all with two new low-level primitives?  And then, could
we actually put `the-environment', environment accessors, and everything
else into a module?

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Sun Dec 18 10:32:21 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RcIir-0002dj-Ex
	for mharc-guile-devel@gnu.org; Sun, 18 Dec 2011 10:32:21 -0500
Received: from eggs.gnu.org ([140.186.70.92]:36774)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RcIio-0002ZR-66
	for guile-devel@gnu.org; Sun, 18 Dec 2011 10:32:19 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RcIin-00035b-90
	for guile-devel@gnu.org; Sun, 18 Dec 2011 10:32:18 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:45597)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RcIin-00035M-5v
	for guile-devel@gnu.org; Sun, 18 Dec 2011 10:32:17 -0500
Received: by iacb35 with SMTP id b35so6347545iac.0
	for <guile-devel@gnu.org>; Sun, 18 Dec 2011 07:32:15 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:sender:in-reply-to:references:date
	:x-google-sender-auth:message-id:subject:from:to:cc:content-type;
	bh=Jr2kNskt27kuoV80wBfFNIPXPe5KuNZ4HJPl6j77F6U=;
	b=ObIYoA3/CckJPMVurDgULiX2d9cRV+lrJBJo5XMocNS6W8b5afep1aTA5WGky8/Bzo
	zDB5o0OmiTfHCXudP+zGIhpxwDth/1g39Au0wWcZCj964GtvOcuVi+/bPGJZimzerTAu
	4y/cDvgiqgcVfZvD3o7ywW6temQbL95sR/gz4=
MIME-Version: 1.0
Received: by 10.50.159.161 with SMTP id xd1mr23011945igb.12.1324222335863;
	Sun, 18 Dec 2011 07:32:15 -0800 (PST)
Sender: noah549@gmail.com
Received: by 10.42.217.6 with HTTP; Sun, 18 Dec 2011 07:32:15 -0800 (PST)
In-Reply-To: <87vcperufl.fsf@pobox.com>
References: <87r506uodd.fsf@pobox.com> <87pqfpj7e3.fsf@netris.org>
	<87aa6skika.fsf@netris.org> <878vmaicb6.fsf@netris.org>
	<87vcperufl.fsf@pobox.com>
Date: Sun, 18 Dec 2011 10:32:15 -0500
X-Google-Sender-Auth: m95t7PTEX5oGhj0NcTkY-aKp9N0
Message-ID: <CA+U71=M3zg9rRTE-5joXLZuqHcSPXnBMTx53eD2kX7+ivreEPQ@mail.gmail.com>
Subject: Re: summary: lilypond, lambda, and local-eval
From: Noah Lavine <noah.b.lavine@gmail.com>
To: Andy Wingo <wingo@pobox.com>
Content-Type: text/plain; charset=ISO-8859-1
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
Cc: Mark H Weaver <mhw@netris.org>, guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sun, 18 Dec 2011 15:32:19 -0000

Hello,

>> Indeed, only the macro expander has enough information to generate an
>> optimal list of "reachable lexicals", i.e. lexical variables that are
>> accessible using normal symbols (as opposed to syntax objects) [more
>> on this below].
>
> Are you certain that you want to restrict the set of identifiers?
>
> To me it sounds like an optimization, perhaps premature.

If I understand correctly, Mark wants to restrict the set of variables
you can access to those you could access through normal Scheme code.
This is an issue because psyntax happens to provide a way to access
more variables than standard Scheme. If this is the case, I think we
should absolutely restrict it to standard Scheme, because letting you
access everything psyntax can access a) is not Scheme and b) restricts
our future implementation choices.

> What do you think about having a <the-environment> tree-il form have a
> field for the names and a field for the gensyms of captured lexicals?
>
>> This is great news, because it means that `the-environment' will no
>> longer require its own tree-il type, and the compiler will only see the
>> standard scheme code that it expands into.

This actually seems bad to me, although I'm just guessing. Because the
thing is, it's not *really* that Scheme code that you wrote, and so
the compiler is seeing something wrong. It has the same
variable-capture properties as that code, but it's not actually that.
My instinct is that compiling non-accurate code is going to be more
trouble than it's worth, but that's just a guess.

In general, this thread has been very, very impressive. Thanks a lot
to everyone who has been working so hard on this.

Noah


From MAILER-DAEMON Sun Dec 18 11:19:56 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RcJSu-0005TQ-GG
	for mharc-guile-devel@gnu.org; Sun, 18 Dec 2011 11:19:56 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52726)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RcJSs-0005SN-0a
	for guile-devel@gnu.org; Sun, 18 Dec 2011 11:19:54 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RcJSr-0008Ux-0R
	for guile-devel@gnu.org; Sun, 18 Dec 2011 11:19:53 -0500
Received: from lo.gmane.org ([80.91.229.12]:59807)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RcJSq-0008Ur-N4
	for guile-devel@gnu.org; Sun, 18 Dec 2011 11:19:52 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RcJSo-0001dD-Q8
	for guile-devel@gnu.org; Sun, 18 Dec 2011 17:19:50 +0100
Received: from p508e9bc1.dip.t-dialin.net ([80.142.155.193])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sun, 18 Dec 2011 17:19:50 +0100
Received: from dak by p508e9bc1.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sun, 18 Dec 2011 17:19:50 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: summary: lilypond, lambda, and local-eval
Date: Sun, 18 Dec 2011 17:19:34 +0100
Organization: Organization?!?
Lines: 38
Message-ID: <871us1x36x.fsf@fencepost.gnu.org>
References: <87r506uodd.fsf@pobox.com> <87pqfpj7e3.fsf@netris.org>
	<87aa6skika.fsf@netris.org> <878vmaicb6.fsf@netris.org>
	<87vcperufl.fsf@pobox.com>
	<CA+U71=M3zg9rRTE-5joXLZuqHcSPXnBMTx53eD2kX7+ivreEPQ@mail.gmail.com>
Mime-Version: 1.0
Content-Type: text/plain
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508e9bc1.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:8ryFW8t2GyHgAn9sHMpWu/zX71c=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sun, 18 Dec 2011 16:19:54 -0000


Let me first state that this thread is arguing at a depth where the only
contributions that remain for me to make are syllogisms without an
actual knowledge of what I am talking about.

In order not to appear ungrateful, I will do that, but there will be
little point in expecting me to be of assistance in judging their merit.

Noah Lavine <noah.b.lavine@gmail.com> writes:

> If I understand correctly, Mark wants to restrict the set of variables
> you can access to those you could access through normal Scheme code.
> This is an issue because psyntax happens to provide a way to access
> more variables than standard Scheme. If this is the case, I think we
> should absolutely restrict it to standard Scheme, because letting you
> access everything psyntax can access a) is not Scheme and b) restricts
> our future implementation choices.

If psyntax accesses more than Scheme can access while doing a task that
is worth doing, what chance would there be in giving Scheme the power to
access what psyntax can?

If exporting enough of the compiler environment to be useful for
implementing multiple compilation units sharing lexical environments is
feasible, what are the implications for splitting a compilation into
separate units when the extent of psyntax is not similarly involved?

In short: where should one draw the line in a way that makes best use of
already done compilations without having to redo too much to be of
practical use?

> In general, this thread has been very, very impressive.  Thanks a lot
> to everyone who has been working so hard on this.

Agreed.

-- 
David Kastrup



From MAILER-DAEMON Sun Dec 18 15:31:13 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RcNO5-0004ah-NI
	for mharc-guile-devel@gnu.org; Sun, 18 Dec 2011 15:31:13 -0500
Received: from eggs.gnu.org ([140.186.70.92]:44668)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RcNO2-0004XW-Rz
	for guile-devel@gnu.org; Sun, 18 Dec 2011 15:31:11 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RcNO1-00069P-0Q
	for guile-devel@gnu.org; Sun, 18 Dec 2011 15:31:10 -0500
Received: from lo.gmane.org ([80.91.229.12]:32818)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RcNO0-00069D-Ch
	for guile-devel@gnu.org; Sun, 18 Dec 2011 15:31:08 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RcNNy-000206-6J
	for guile-devel@gnu.org; Sun, 18 Dec 2011 21:31:06 +0100
Received: from reverse-83.fdn.fr ([80.67.176.83])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sun, 18 Dec 2011 21:31:06 +0100
Received: from ludo by reverse-83.fdn.fr with local (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sun, 18 Dec 2011 21:31:06 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
Subject: Re: [PATCH] Add "scandir" procedure
Date: Sun, 18 Dec 2011 21:30:50 +0100
Lines: 10
Message-ID: <87ty4xmxl1.fsf@gnu.org>
References: <1314475521.3143.47.camel@Renee-desktop>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: reverse-83.fdn.fr
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 28 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:fVvrIfWDdRmPo/EShtdGg6RwRPc=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sun, 18 Dec 2011 20:31:12 -0000

Hi Nala!

I just added a ‘scandir’ implementation in terms of ‘file-system-fold’:

  http://git.sv.gnu.org/cgit/guile.git/commit/?h=stable-2.0&id=1629429d63170b1c5a19e72e838cab331c7eba8b

Please let me know what you think of it!

Thanks,
Ludo’.



From MAILER-DAEMON Sun Dec 18 15:39:32 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RcNW8-0008P5-Sj
	for mharc-guile-devel@gnu.org; Sun, 18 Dec 2011 15:39:32 -0500
Received: from eggs.gnu.org ([140.186.70.92]:33495)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RcNW6-0008Oi-H5
	for guile-devel@gnu.org; Sun, 18 Dec 2011 15:39:31 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RcNW5-0007Ef-D8
	for guile-devel@gnu.org; Sun, 18 Dec 2011 15:39:30 -0500
Received: from lo.gmane.org ([80.91.229.12]:53543)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RcNW4-0007Eb-Vc
	for guile-devel@gnu.org; Sun, 18 Dec 2011 15:39:29 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RcNW4-0004aA-Am
	for guile-devel@gnu.org; Sun, 18 Dec 2011 21:39:28 +0100
Received: from reverse-83.fdn.fr ([80.67.176.83])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sun, 18 Dec 2011 21:39:28 +0100
Received: from ludo by reverse-83.fdn.fr with local (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sun, 18 Dec 2011 21:39:28 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
Subject: Re: Update and Questions
Date: Sun, 18 Dec 2011 21:39:16 +0100
Lines: 41
Message-ID: <87aa6pmx6z.fsf@gnu.org>
References: <CA+U71=MMST=EkYSEgXkaMFpfyvbKnQmKqomJm8XGHeKzpa+Vkg@mail.gmail.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: reverse-83.fdn.fr
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 28 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:onLB/uXk0YR4MkAVYf0FiQz3l+Q=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sun, 18 Dec 2011 20:39:31 -0000

Hi Noah,

And as is more often the case, sorry for the delay!

Noah Lavine <noah.b.lavine@gmail.com> skribis:

> It is a propagation network. Basically you have a graph of Tree-IL
> nodes, where each Tree-IL node is connected to its parent, its
> children, and optionally other nodes (a variable is connected to the
> place it was declared. A primitive function is connected to the error
> continuation it could jump to). The compiler propagates information
> along the edges of this graph, attempting to find the minimum set of
> possible values for each variable and each jump target. It also
> performs partial evaluation as a special case of this.
>
> What I have described also seems to be how Hindley-Milner type
> inference works (although I think we can do a bit better than standard
> Hindley-Milner systems). Does this seem like a good design for the
> static analyzer portion?

I’m not an expert in that area, but it does look sensible to me at first
sight.

> One big oversight that I know of is that this doesn't do any sort of
> specialization.

What if your static analyzer was plugged after the peval run?  I expect
part of it would be redundant with peval, but for a start we could live
with the code redundancy, and look at factorizing it later.  WDYT?

[...]

> And finally, a fun thing. The current best Scheme compiler (that I
> know of) is called Stalin. Therefore, I suggest that our compiler be
> called "Stallman", after our fearless leader (whose name also starts
> with "s"). :-)

Heheh. :-)

Thanks,
Ludo’.



From MAILER-DAEMON Sun Dec 18 15:45:11 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RcNbb-0001MH-BO
	for mharc-guile-devel@gnu.org; Sun, 18 Dec 2011 15:45:11 -0500
Received: from eggs.gnu.org ([140.186.70.92]:54075)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RcNbY-0001J4-Vg
	for guile-devel@gnu.org; Sun, 18 Dec 2011 15:45:09 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RcNbX-0008Hs-Sq
	for guile-devel@gnu.org; Sun, 18 Dec 2011 15:45:08 -0500
Received: from lo.gmane.org ([80.91.229.12]:56316)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RcNbX-0008Hk-LH
	for guile-devel@gnu.org; Sun, 18 Dec 2011 15:45:07 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RcNbW-0006lx-Q3
	for guile-devel@gnu.org; Sun, 18 Dec 2011 21:45:06 +0100
Received: from reverse-83.fdn.fr ([80.67.176.83])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sun, 18 Dec 2011 21:45:06 +0100
Received: from ludo by reverse-83.fdn.fr with local (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Sun, 18 Dec 2011 21:45:06 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
Subject: Re: Compiler Branch
Date: Sun, 18 Dec 2011 21:42:20 +0100
Lines: 11
Message-ID: <87ty4xlihf.fsf@gnu.org>
References: <CA+U71=P0WHV-s4Lce3p3=5tfXswgOrvT6tk1r8hFU0KyTnJSYA@mail.gmail.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: reverse-83.fdn.fr
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 28 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
Cancel-Lock: sha1:1VNos/GtVQ6Jtjnpdi8LIYW18ZM=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sun, 18 Dec 2011 20:45:09 -0000

Hi Noah!

This sounds like exciting work, although there’s not much yet to comment
on I suppose.  ;-)

Please keep informing the list so we can see what you’re up to (even if
we don’t necessary reply in a timely fashion...)

Thanks, and happy compiler hacking!

Ludo’.



From MAILER-DAEMON Sun Dec 18 16:24:59 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RcOE7-0007M0-PX
	for mharc-guile-devel@gnu.org; Sun, 18 Dec 2011 16:24:59 -0500
Received: from eggs.gnu.org ([140.186.70.92]:35958)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RcOE5-0007LH-AI
	for guile-devel@gnu.org; Sun, 18 Dec 2011 16:24:58 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RcOE4-0005oQ-37
	for guile-devel@gnu.org; Sun, 18 Dec 2011 16:24:57 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:56028)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>)
	id 1RcOE2-0005ns-Ep; Sun, 18 Dec 2011 16:24:54 -0500
Received: by iacb35 with SMTP id b35so6717804iac.0
	for <multiple recipients>; Sun, 18 Dec 2011 13:24:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:sender:in-reply-to:references:date
	:x-google-sender-auth:message-id:subject:from:to:cc:content-type;
	bh=JkKz5XUygKFcbD4xSDFKqjp6dmIHkkyxybMhkLwmg4k=;
	b=QwO0n2KE9FtmUqBfmkhKb0VI/Q7LGcIUnXKlkqjrlc/0mHEq4wGreCBvpAC6EvrNn1
	YokP4N2bwidEU8SmzEYMq1zum7dIottrwcgPgEQtz0aIGdazwCpo13Quo5PV/TSdMg+u
	wUJSDHdLiEMbnnlp1i/hbwy+nmOxSM8SHPMCc=
MIME-Version: 1.0
Received: by 10.50.194.197 with SMTP id hy5mr20688632igc.84.1324243493590;
	Sun, 18 Dec 2011 13:24:53 -0800 (PST)
Sender: noah549@gmail.com
Received: by 10.42.217.6 with HTTP; Sun, 18 Dec 2011 13:24:53 -0800 (PST)
In-Reply-To: <871us1x36x.fsf@fencepost.gnu.org>
References: <87r506uodd.fsf@pobox.com> <87pqfpj7e3.fsf@netris.org>
	<87aa6skika.fsf@netris.org> <878vmaicb6.fsf@netris.org>
	<87vcperufl.fsf@pobox.com>
	<CA+U71=M3zg9rRTE-5joXLZuqHcSPXnBMTx53eD2kX7+ivreEPQ@mail.gmail.com>
	<871us1x36x.fsf@fencepost.gnu.org>
Date: Sun, 18 Dec 2011 16:24:53 -0500
X-Google-Sender-Auth: E57hZ8bWlCTRtuhz-ias64OG8I0
Message-ID: <CA+U71=PR4ec3c9z5FqiDfGvMspDspZb9hWnm45_p-6FgT9eY5Q@mail.gmail.com>
Subject: Re: summary: lilypond, lambda, and local-eval
From: Noah Lavine <noah.b.lavine@gmail.com>
To: David Kastrup <dak@gnu.org>
Content-Type: text/plain; charset=ISO-8859-1
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sun, 18 Dec 2011 21:24:58 -0000

Hello,

>> If I understand correctly, Mark wants to restrict the set of variables
>> you can access to those you could access through normal Scheme code.
>> This is an issue because psyntax happens to provide a way to access
>> more variables than standard Scheme. If this is the case, I think we
>> should absolutely restrict it to standard Scheme, because letting you
>> access everything psyntax can access a) is not Scheme and b) restricts
>> our future implementation choices.
>
> If psyntax accesses more than Scheme can access while doing a task that
> is worth doing, what chance would there be in giving Scheme the power to
> access what psyntax can?

Let me explain what I mean more. Here is a code example:

(let ((x 3))
  (let ((x (* x 5)))
    (the-environment)))

At the point of the-environment, there is one Scheme variable around,
'x', and its value is 15. The old value of x is shadowed by the new
one.

But psyntax works by assigning each of these x values a gensym, and
they get different gensyms. So in theory, you could access the outer
value of x (x = 3) if you had a handle on the right gensym.

Supporting this seems weird to me, because I view psyntax as an
implementation detail of Guile, and not something that should affect
programmers. I also think that not supporting it is fine because if
you want to be able to access both values, you can always give your
variables different names. So this isn't giving you more power, but
just a weird way to access it.

> If exporting enough of the compiler environment to be useful for
> implementing multiple compilation units sharing lexical environments is
> feasible, what are the implications for splitting a compilation into
> separate units when the extent of psyntax is not similarly involved?
>
> In short: where should one draw the line in a way that makes best use of
> already done compilations without having to redo too much to be of
> practical use?

I do not know enough to respond to the rest of your email.

Noah


From MAILER-DAEMON Sun Dec 18 18:46:20 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RcQQu-0001oW-9E
	for mharc-guile-devel@gnu.org; Sun, 18 Dec 2011 18:46:20 -0500
Received: from eggs.gnu.org ([140.186.70.92]:46790)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RcQQr-0001oO-Pl
	for guile-devel@gnu.org; Sun, 18 Dec 2011 18:46:18 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RcQQq-0004Je-N6
	for guile-devel@gnu.org; Sun, 18 Dec 2011 18:46:17 -0500
Received: from mail4-relais-sop.national.inria.fr ([192.134.164.105]:20041)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <ludo@gnu.org>)
	id 1RcQQq-0004Ja-Gx
	for guile-devel@gnu.org; Sun, 18 Dec 2011 18:46:16 -0500
X-IronPort-AV: E=Sophos;i="4.71,373,1320620400"; d="scan'208";a="123840424"
Received: from reverse-83.fdn.fr (HELO pluto) ([80.67.176.83])
	by mail4-relais-sop.national.inria.fr with ESMTP/TLS/DHE-RSA-AES128-SHA;
	19 Dec 2011 00:46:15 +0100
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
To: "Noah Lavine" <nlavine@haverford.edu>
Subject: Re: [Guile-commits] GNU Guile branch, wip-compiler,
	updated. v2.1.0-139-gf8a333e
References: <E1Rb2fT-00087o-2c@vcs.savannah.gnu.org>
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 29 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
Date: Mon, 19 Dec 2011 00:46:13 +0100
In-Reply-To: <E1Rb2fT-00087o-2c@vcs.savannah.gnu.org> (Noah Lavine's message
	of "Thu, 15 Dec 2011 04:11:39 +0000")
Message-ID: <87ipldh29m.fsf@gnu.org>
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 192.134.164.105
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sun, 18 Dec 2011 23:46:18 -0000

Hi Noah,

Just a few superficial stylistic comments until I have something more
clever to say: ;-)

"Noah Lavine" <nlavine@haverford.edu> skribis:

>  (define default-environment
> -  `( (cons . ,(value-set-with-values 'cons))
> -     (car  . ,(value-set-with-values 'car))
> -     (cdr  . ,(value-set-with-values 'cdr))
> +  `( (cons . ,(value-set-with-values prim-cons))
> +     (car  . ,(value-set-with-values prim-car ))
> +     (cdr  . ,(value-set-with-values prim-cdr ))
>     ))

Please avoid trailing closing parenthesis.

Also, what about =E2=80=9Cvset=E2=80=9D or just =E2=80=9Cset=E2=80=9D inste=
ad of =E2=80=9Cvalue-set=E2=80=9D?

> +              (set! (a-verify-exps ret)
> +                    (map (lambda (x) (rec ret x env)) args))
> +              ret))

Please privilege a functional style, as much as possible (in some cases
we lack the tools to do better, so that=E2=80=99s fine.)

> +(pass-if "value-set-can-be-anything?"
> +         (value-set-can-be-anything? anything))

In Emacs you can (put 'pass-if 'scheme-indent-function 1) to get the
=E2=80=9Cright=E2=80=9D indentation.

Thanks,
Ludo=E2=80=99.


From MAILER-DAEMON Mon Dec 19 04:15:29 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RcZJh-0003Xr-8m
	for mharc-guile-devel@gnu.org; Mon, 19 Dec 2011 04:15:29 -0500
Received: from eggs.gnu.org ([140.186.70.92]:44133)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RcZJb-0003Xk-GK
	for guile-devel@gnu.org; Mon, 19 Dec 2011 04:15:27 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RcZJZ-0007LL-MR
	for guile-devel@gnu.org; Mon, 19 Dec 2011 04:15:23 -0500
Received: from world.peace.net ([96.39.62.75]:46911)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mhw@netris.org>) id 1RcZJZ-0007Ke-AH
	for guile-devel@gnu.org; Mon, 19 Dec 2011 04:15:21 -0500
Received: from 209-6-91-212.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com
	([209.6.91.212] helo=yeeloong)
	by world.peace.net with esmtpsa (TLS1.0:DHE_RSA_AES_128_CBC_SHA1:16)
	(Exim 4.69) (envelope-from <mhw@netris.org>)
	id 1RcZJI-0008Fw-AH; Mon, 19 Dec 2011 04:15:04 -0500
From: Mark H Weaver <mhw@netris.org>
To: Andy Wingo <wingo@pobox.com>
Subject: Re: summary: lilypond, lambda, and local-eval
References: <87r506uodd.fsf@pobox.com> <87pqfpj7e3.fsf@netris.org>
	<87aa6skika.fsf@netris.org> <878vmaicb6.fsf@netris.org>
	<87vcperufl.fsf@pobox.com>
Date: Mon, 19 Dec 2011 04:13:26 -0500
In-Reply-To: <87vcperufl.fsf@pobox.com> (Andy Wingo's message of "Sun, 18 Dec
	2011 12:27:42 +0100")
Message-ID: <87aa6olya1.fsf@netris.org>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 96.39.62.75
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 19 Dec 2011 09:15:27 -0000

Andy Wingo <wingo@pobox.com> writes:
> Are you certain that it is desirable to transform it into standard
> Scheme code?
>
> The statement that the-environment acts "as if it were the expression,
> (case-lambda ....)" doesn't mean that you have to implement it that
> way.

Yes of course, but nonetheless it was tempting because it would have
made the compiler implementation of `the-environment' and `local-eval'
much simpler.

However, having thought about it some more, I agree that this is the
wrong approach.  It would have worked well with the particular
implementation of closures that we use in the compiler, but I haven't
figured out how to make it work with the evaluator.  Furthermore, I can
imagine more advanced implementations of closures in a native compiler
that would break this approach as well.

>> Indeed, only the macro expander has enough information to generate an
>> optimal list of "reachable lexicals", i.e. lexical variables that are
>> accessible using normal symbols (as opposed to syntax objects) [more
>> on this below].
>
> Are you certain that you want to restrict the set of identifiers?
>
> To me it sounds like an optimization, perhaps premature.

I can certainly believe that it might potentially be useful to capture
the entire environment, in case someone wants to do something clever
using a mixture of syntax-case and `the-environment'.

However, I think that for many (most?) usage scenarios, the expression
passed to `local-eval' will never reference these shadowed or hidden
identifiers, and this could make a noticeable difference in what the
optimizer is able to do.

It's easy to support both modes.  If you feel strongly that the default
(the-environment) should capture everything, I'm probably okay with
that, but I'd like to support the other mode too.

Ideally I'd like to allow the user to specify a precise list of
variables to capture, and perhaps the other two variants should be
implemented in terms of this one.

> What do you think about having a <the-environment> tree-il form have a
> field for the names and a field for the gensyms of captured lexicals?

Yes, I think this is the right approach.  It will need an
<expander-environment> as well, of course.

> We could compile `the-environment' so that at runtime it yields a record
> containing a vector of syntax objects and a vector of corresponding
> variable objects.  (When the compiler boxes a variable, it does so in a
> variable object, as from make-variable.)  Then you don't introduce
> cross-cutting assumptions to the compiler and runtime.

I like the idea of explicitly including vectors of variable objects and
variable names instead of creating a closure.  This decouples the
implementation of `local-eval' from the details of how closures are
represented.

However, I'm not sure about the syntax objects.  What would we use them
for?  The first thing `local-eval' does is to macroexpand the new
expression within the captured <expander-environment>, and henceforth
the compiler will see only gensyms.  So it seems to me that those
gensyms are what we need.

> Maybe what we need is a <lexical-capture> form that evaluates to the
> variable corresponding to a bound lexical.  Then `the-environment' could
> expand out to
>
>    (make-struct/no-tail <lexical-environment>
>                         '(name ...)
>                         (list (capture-lexical name) ...))

This is a very interesting idea.  Note that we'd need to capture the
<expander-environment> as well.  Also, the quoted list of names would
need to be the gensyms created by the expander, not the source names.
(Maybe that's what you meant, but I wasn't sure).

> You would still need support from the expander to get the set of
> currently-bound names, but maybe that is a new primitive that we could
> add.

This is easy enough.  I've already written code for psyntax that
generates a list of lexicals that are reachable using normal symbols.
Creating a list of lexicals reachable by arbitrary syntax objects is
even easier.

> Could we do it all with two new low-level primitives?  And then, could
> we actually put `the-environment', environment accessors, and everything
> else into a module?

This is a very interesting idea.  If we used this approach, we would
also need a third primitive to capture the expander-environment, perhaps
called (the-expander-environment).

This again raises the problem that what to do when (the-environment), or
in this case (the-expander-environment), is found within a macro
definition.  I think I finally have a good answer: do what datum->syntax
does.  Take an extra syntax-object parameter, and use the lexical
context associated with that syntax-object.

(the-expander-environment <for-syntax>) would expand to (quote
<expander-environment>), where <expander-environment> corresponds to the
lexical context of the syntax-object <for-syntax>.

I'm not yet certain, but I think I like the idea of using these
primitives to implement (the-environment).

* * * * *

By the way, two other complications have come to my attention:

First of all, when we compile a file containing (the-environment),
gensym names will be serialized into the .go file as constants.  When
`local-eval' later macroexpands a local expression within an
<expander-environment> that had been serialized from an earlier Guile
session, it needs to ensure that new gensyms do not collide with the
older ones.  An easy solution would be for the local macroexpander (the
one that resumes from a captured <expander-environment>) to first make
sure the gensym counter is larger than any of the gensyms stored in that
environment.

The second complication is that an <expander-environment> captured
within a `let-syntax' form contains the lexically-bound syntax
transformer _procedures_, which are obviously not serializable and
therefore cannot be stored in a .go file.  I guess the simple solution
here would be to document that (the-environment) within `let-syntax',
`letrec-syntax' or equivalent is not fully supported, and currently
cannot be compiled to a .go file.

I'll have to think about whether this limitation could be lifted.  In
theory, it should be possible to serialize syntax-rules macros at least,
though even that might be a pain.  I'm not hopeful that it can be done
for procedural macros in the general case.  However, I don't see this as
a show-stopper in any case.  It's no more serious than the existence of
procedures to the feasibility of `read' and `write'.  We simply document
the limitation.

What do you think?

      Mark


From MAILER-DAEMON Mon Dec 19 14:21:08 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rcilo-0000z7-DC
	for mharc-guile-devel@gnu.org; Mon, 19 Dec 2011 14:21:08 -0500
Received: from eggs.gnu.org ([140.186.70.92]:45765)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rcilh-0000mf-PK
	for guile-devel@gnu.org; Mon, 19 Dec 2011 14:21:05 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rcilg-00067g-EE
	for guile-devel@gnu.org; Mon, 19 Dec 2011 14:21:01 -0500
Received: from mail-vx0-f169.google.com ([209.85.220.169]:59128)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>)
	id 1Rcilg-00067Y-8R; Mon, 19 Dec 2011 14:21:00 -0500
Received: by vcge1 with SMTP id e1so3998184vcg.0
	for <multiple recipients>; Mon, 19 Dec 2011 11:20:59 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=NyQ96Pf7TU0tJqJhlL9MmaN99oEtUVMdjMIFYceW2+Q=;
	b=XTpJVJHk46zEYq/ysqJvnZ64M5u/H2dq7TDWSbpZUJOyxixd0K4Yc1jUBTbeG4hROO
	uzBo7oA3QHonfNEsPqhYaTPQvzOK1KP0+4k8BkySHaLpIs6gGAnx79aHXdzGmcxmQIBO
	LcRc19PMzo/2JBKMY/tF/OhjajUcaFi/mG12k=
MIME-Version: 1.0
Received: by 10.52.26.14 with SMTP id h14mr11965231vdg.132.1324322459208; Mon,
	19 Dec 2011 11:20:59 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Mon, 19 Dec 2011 11:20:59 -0800 (PST)
In-Reply-To: <87ty4xmxl1.fsf@gnu.org>
References: <1314475521.3143.47.camel@Renee-desktop> <87ty4xmxl1.fsf@gnu.org>
Date: Tue, 20 Dec 2011 03:20:59 +0800
Message-ID: <CAPjoZoeA7TUAqH1pTogmLvKu2r4hr7kOq+x1njCO6yXZ-Kbiyw@mail.gmail.com>
Subject: Re: [PATCH] Add "scandir" procedure
From: Nala Ginrut <nalaginrut@gmail.com>
To: =?UTF-8?Q?Ludovic_Court=C3=A8s?= <ludo@gnu.org>
Content-Type: multipart/alternative; boundary=20cf307cffa6bfcafd04b476d962
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.220.169
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 19 Dec 2011 19:21:06 -0000

--20cf307cffa6bfcafd04b476d962
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

hi Ludo, nice job!
And I tested it, it works.
But I did find some problems. Now there're three:
1. I think file-system-fold based scandir tried to traverse the whole
directories include sub-directories. It's rather slow for a deep one if I
just
    want a files list under 0 level directory tree;
2. New scandir will crash while encounters a Chinese file name. This will
be eliminated by using (setlocale LC_ALL "zh_CN.UTF-8").
    I think it's the same problem we faced in another thread. There's
something locale problem in Guile. Of course, we have a temporary solution
in recent commit;
3. It returns weird result. E.g (scandir "mmr")
=3D=3D>  ("." "." "." ".." ".." ".." "aa.c" "exclude" "ml" "myecl")
There're two sub-directories, so two more dot & dot-dot added.

Anyway, I think new scandir's cool. Though it's little slow than my C wrap
version, it's more hackable.
Maybe I'll keep C wrap scandir in my project for a time. But it's
reasonable to change it to the new one in the future but depends on it's
efficiency.



On Mon, Dec 19, 2011 at 4:30 AM, Ludovic Court=C3=A8s <ludo@gnu.org> wrote:

> Hi Nala!
>
> I just added a =E2=80=98scandir=E2=80=99 implementation in terms of =E2=
=80=98file-system-fold=E2=80=99:
>
>
> http://git.sv.gnu.org/cgit/guile.git/commit/?h=3Dstable-2.0&id=3D1629429d=
63170b1c5a19e72e838cab331c7eba8b
>
> Please let me know what you think of it!
>
> Thanks,
> Ludo=E2=80=99.
>
>
>

--20cf307cffa6bfcafd04b476d962
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

hi Ludo, nice job!<div>And I tested it, it works.</div><div>But I did find =
some problems. Now there&#39;re three:</div><div>1. I think file-system-fol=
d based scandir tried to traverse the whole directories include sub-directo=
ries. It&#39;s rather slow for a deep one if I just</div>
<div>=C2=A0 =C2=A0 want a files list under 0 level directory tree;</div><di=
v>2. New scandir will crash while encounters a Chinese file name. This will=
 be eliminated by using (setlocale LC_ALL &quot;zh_CN.UTF-8&quot;).</div><d=
iv>=C2=A0 =C2=A0 I think it&#39;s the same problem we faced in another thre=
ad. There&#39;s something locale problem in Guile. Of course, we have a tem=
porary solution in recent commit;</div>
<div>3. It returns=C2=A0weird result. E.g (scandir &quot;mmr&quot;)</div><d=
iv>=3D=3D&gt; =C2=A0(&quot;.&quot; &quot;.&quot; &quot;.&quot; &quot;..&quo=
t; &quot;..&quot; &quot;..&quot; &quot;aa.c&quot; &quot;exclude&quot; &quot=
;ml&quot; &quot;myecl&quot;)</div>
<div>There&#39;re two sub-directories, so two more dot &amp; dot-dot added.=
</div><div><br></div><div>Anyway, I think new scandir&#39;s cool. Though it=
&#39;s little slow than my C wrap version, it&#39;s more hackable.=C2=A0</d=
iv>
<div>Maybe I&#39;ll keep C wrap scandir in my project for a time. But it&#3=
9;s reasonable to change it to the new one in the future but depends on it&=
#39;s efficiency.</div><div><br></div><div><br></div><div><br><div class=3D=
"gmail_quote">
On Mon, Dec 19, 2011 at 4:30 AM, Ludovic Court=C3=A8s <span dir=3D"ltr">&lt=
;<a href=3D"mailto:ludo@gnu.org">ludo@gnu.org</a>&gt;</span> wrote:<br><blo=
ckquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #c=
cc solid;padding-left:1ex">
Hi Nala!<br>
<br>
I just added a =E2=80=98scandir=E2=80=99 implementation in terms of =E2=80=
=98file-system-fold=E2=80=99:<br>
<br>
 =C2=A0<a href=3D"http://git.sv.gnu.org/cgit/guile.git/commit/?h=3Dstable-2=
.0&amp;id=3D1629429d63170b1c5a19e72e838cab331c7eba8b" target=3D"_blank">htt=
p://git.sv.gnu.org/cgit/guile.git/commit/?h=3Dstable-2.0&amp;id=3D1629429d6=
3170b1c5a19e72e838cab331c7eba8b</a><br>

<br>
Please let me know what you think of it!<br>
<br>
Thanks,<br>
Ludo=E2=80=99.<br>
<br>
<br>
</blockquote></div><br></div>

--20cf307cffa6bfcafd04b476d962--


From MAILER-DAEMON Mon Dec 19 15:36:24 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rcjwe-0002Ar-PQ
	for mharc-guile-devel@gnu.org; Mon, 19 Dec 2011 15:36:24 -0500
Received: from eggs.gnu.org ([140.186.70.92]:48069)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <spk121@yahoo.com>) id 1Rcjwc-0002AW-8o
	for guile-devel@gnu.org; Mon, 19 Dec 2011 15:36:23 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <spk121@yahoo.com>) id 1RcjwW-0002gL-HZ
	for guile-devel@gnu.org; Mon, 19 Dec 2011 15:36:22 -0500
Received: from nm10-vm0.bullet.mail.sp2.yahoo.com ([98.139.91.198]:25178)
	by eggs.gnu.org with smtp (Exim 4.71)
	(envelope-from <spk121@yahoo.com>) id 1RcjwW-0002g6-4U
	for guile-devel@gnu.org; Mon, 19 Dec 2011 15:36:16 -0500
Received: from [98.139.91.66] by nm10.bullet.mail.sp2.yahoo.com with NNFMP;
	19 Dec 2011 20:36:12 -0000
Received: from [72.30.22.38] by tm6.bullet.mail.sp2.yahoo.com with NNFMP;
	19 Dec 2011 20:35:22 -0000
Received: from [127.0.0.1] by omp1068.mail.sp2.yahoo.com with NNFMP;
	19 Dec 2011 20:35:21 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 982152.32042.bm@omp1068.mail.sp2.yahoo.com
Received: (qmail 23370 invoked by uid 60001); 19 Dec 2011 20:35:21 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024;
	t=1324326921; bh=oG3/5ZwL94KIBgY7RUT1+FJ5bEGn/ZV6unPqjRsg9SM=;
	h=X-YMail-OSG:Received:X-Mailer:References:Message-ID:Date:From:Reply-To:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding;
	b=DRy438hDiGKohMQ7knVjxmdXgBnGJy9Je2ghBqzxb3k+KHMxlIQ1w+nbHa2LNwCYK0etgEUc7q75VDAuaasSIFkU0uy+Hnl+9ty1qchXKCG5bfX/+9aWE52ZLvSB0yvil/BK8k8Cim/3krXgtph23P6C6WjHyNlZ38bFghHNmlg=
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws; s=s1024; d=yahoo.com;
	h=X-YMail-OSG:Received:X-Mailer:References:Message-ID:Date:From:Reply-To:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding;
	b=Pq0zzIQXEOVe3yhH8Jr9B9hhXssUTpe8qvna4YRAz/2Dsck/SW6Ie4/PxKiVlNacveogbk85sF31kpyRQtDBWm+QJoaPxW9z+n8rGGcyE1VQcej5xcJGzWfTLGwvtlkS7u4jwkhqAQlPi8XSwYLHxkn0k/RX3HT9jO8z9qHLZp4=;
X-YMail-OSG: Ywn5VewVM1n0tBCd_lJe92.9GIaacecVb0rada.xkl5r08e
	xyvgjRMvv16qmrF1sQQsNPPmL9YrdapKaIMNzyAteYW_gZBhd5rIB7m0shwZ
	0h9Sp7vRUtpFKfJwdldAkDwIUq3lQg4MgR7ezfk9fJ.7YUwE9DF6Vuw1aVG2
	ERD3VNlhL1ksOJETsLh2Ofmi6o6bUIIZLXY4sbYucAHwHrHscvRijFtdI8qZ
	2bt1BZ0JxTkjfmIp2SsPkHa4bGOJMtI7EW3ZhEkI_1hIKGvQq7sr_XPtnQwp
	h_vogfBQDUv3G0A2OcNRE8IY1.oZEdebsCdAIoY.izKJO_IHaZexnJ1nHVL_
	.33gDqd4IPES8zRi.43lOMhD6tpIwgsx32Fvek7WahGoMN3nLlvqa3H2lUwd
	xc59zCGgDCgGWCVf7UQgyvtb3BbSbYEARX1s7xaVQuROB0X.3DKg7akFD
Received: from [66.80.183.50] by web37905.mail.mud.yahoo.com via HTTP;
	Mon, 19 Dec 2011 12:35:21 PST
X-Mailer: YahooMailWebService/0.8.115.331698
References: 
Message-ID: <1324326921.17612.YahooMailNeo@web37905.mail.mud.yahoo.com>
Date: Mon, 19 Dec 2011 12:35:21 -0800 (PST)
From: Mike Gran <spk121@yahoo.com>
Subject: Minimal Guile
To: guile-devel <guile-devel@gnu.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 98.139.91.198
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
Reply-To: Mike Gran <spk121@yahoo.com>
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 19 Dec 2011 20:36:23 -0000

Hi-=0A=0AI've been keeping up with some of the discussion on other gnu list=
s.=0A=0AOne of the criticisms at the moment is that Guile is=0A=A0=0A1. blo=
ated=0A2. hard to distribute.=0A=A0=0ARe point 2: hard to distribute.=0A=A0=
=0AA while ago I was looking at the idea of minimizing the number of=0Afile=
s needed to ship Guile as a dependency.  At the time, I thought=0Athat one =
could retool the build so that it produced=0A- a tar.gz of the distributabl=
e header files=0A- libguile=A0as a monolithic .so or .dll with no dependenc=
ies.=0A=A0 Dependencies would be wrapped into the monolithic .so or .dll.=
=0A- all the compiled .go files as a tar file=0A- and a Guile executable th=
at used both of the above=0A=A0=0AGuile and libguile=A0would read the .go w=
ithout unpacking the tar file=0Aby using libtar.=0A=A0=0AThere's no real ad=
vantage in this for the GNU system, but, it would=0Amake it easier to make =
a distributable cross-build for non-GNU=0Asystems.=A0 This would make it ea=
sier to set up a download repository=0Aof prebuilt .so, .dll, and go-lib ta=
r files.=0A=A0=0ARe point 1: bloated=0A=A0=0AOnce=A0the infrastructure for =
the above is in place, one could set=0Aup an alternate cross-build system t=
hat produced a version of=0AGuile that is=0A=A0=0A- ASCII only, "C" locale =
only=0A- Fixnum integers only=0A- No ability to load ltdl or ffi=0A- no abi=
lity to use whatever=A0libcrypt is used for=0A=A0=0AThis would be for the p=
urpose of being a minimalist extension=0Aengine.=0A=A0=0AWhat do you think?=
=0A=A0=0A-Mike Gran


From MAILER-DAEMON Mon Dec 19 16:39:00 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RckvE-0002Zt-7L
	for mharc-guile-devel@gnu.org; Mon, 19 Dec 2011 16:39:00 -0500
Received: from eggs.gnu.org ([140.186.70.92]:47311)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RckvC-0002ZY-As
	for guile-devel@gnu.org; Mon, 19 Dec 2011 16:38:59 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RckvB-0006x0-4V
	for guile-devel@gnu.org; Mon, 19 Dec 2011 16:38:58 -0500
Received: from mail4-relais-sop.national.inria.fr ([192.134.164.105]:9053)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <ludo@gnu.org>)
	id 1RckvA-0006wh-W2
	for guile-devel@gnu.org; Mon, 19 Dec 2011 16:38:57 -0500
X-IronPort-AV: E=Sophos;i="4.71,378,1320620400"; d="scan'208";a="123963125"
Received: from reverse-83.fdn.fr (HELO pluto) ([80.67.176.83])
	by mail4-relais-sop.national.inria.fr with ESMTP/TLS/DHE-RSA-AES128-SHA;
	19 Dec 2011 22:38:54 +0100
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
To: Nala Ginrut <nalaginrut@gmail.com>
Subject: Re: [PATCH] Add "scandir" procedure
References: <1314475521.3143.47.camel@Renee-desktop> <87ty4xmxl1.fsf@gnu.org>
	<CAPjoZoeA7TUAqH1pTogmLvKu2r4hr7kOq+x1njCO6yXZ-Kbiyw@mail.gmail.com>
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 29 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
Date: Mon, 19 Dec 2011 22:38:48 +0100
In-Reply-To: <CAPjoZoeA7TUAqH1pTogmLvKu2r4hr7kOq+x1njCO6yXZ-Kbiyw@mail.gmail.com>
	(Nala Ginrut's message of "Tue, 20 Dec 2011 03:20:59 +0800")
Message-ID: <87r500tf6f.fsf@gnu.org>
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 192.134.164.105
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 19 Dec 2011 21:38:59 -0000

Hi Nala!

Thanks for testing!

Nala Ginrut <nalaginrut@gmail.com> skribis:

> 1. I think file-system-fold based scandir tried to traverse the whole
> directories include sub-directories. It's rather slow for a deep one if I
> just
>     want a files list under 0 level directory tree;

The code had initially approximately 1 typo per line, and I think I=E2=80=
=99ve
fixed most of them now.  ;-)

So =E2=80=98scandir=E2=80=99 does not enter sub-directories.  If it does, t=
hat=E2=80=99s another
bug.  :-)

> 2. New scandir will crash while encounters a Chinese file name. This will
> be eliminated by using (setlocale LC_ALL "zh_CN.UTF-8").
>     I think it's the same problem we faced in another thread. There's
> something locale problem in Guile. Of course, we have a temporary solution
> in recent commit;

Yes, Guile views file names as strings and decodes them from the current
locale encoding.  So if there are file names encoded differently, then
scm_from_locale_string, called by =E2=80=98readdir=E2=80=99, throws a decod=
ing-error.

That=E2=80=99s unfortunate, I=E2=80=99m not sure what to do.  I think GLib/=
GIO issues a
warning in such cases, while still being able to handle the file.  We
could imagine =E2=80=98readdir=E2=80=99 returning a raw bytevector when dec=
oding fails,
and =E2=80=98open-file=E2=80=99 & co. could accept it as input.  But that=
=E2=80=99s really ugly.

I think Mark had some ideas about it, which would be worth checking.

> 3. It returns weird result. E.g (scandir "mmr")
> =3D=3D>  ("." "." "." ".." ".." ".." "aa.c" "exclude" "ml" "myecl")

One of the typos that got fixed, hopefully.  :-)

Can you check again?

> Anyway, I think new scandir's cool. Though it's little slow than my C wrap
> version

Because it uses =E2=80=98file-system-fold=E2=80=99, it does one =E2=80=98st=
at=E2=80=99 call for each
file, which the C version doesn=E2=80=99t do.  That should be the only
efficiency difference.

Maybe we could change our =E2=80=98scandir=E2=80=99 to return a list of fil=
e name/stat
pairs since we have the info anyway?

Thanks,
Ludo=E2=80=99.


From MAILER-DAEMON Mon Dec 19 17:32:09 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rclkf-0000mu-Q3
	for mharc-guile-devel@gnu.org; Mon, 19 Dec 2011 17:32:09 -0500
Received: from eggs.gnu.org ([140.186.70.92]:38609)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1Rclkd-0000lz-Ga
	for guile-devel@gnu.org; Mon, 19 Dec 2011 17:32:08 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1Rclkc-0007nK-Bu
	for guile-devel@gnu.org; Mon, 19 Dec 2011 17:32:07 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:39424)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1Rclkc-0007nG-3h
	for guile-devel@gnu.org; Mon, 19 Dec 2011 17:32:06 -0500
Received: by iacb35 with SMTP id b35so8707355iac.0
	for <guile-devel@gnu.org>; Mon, 19 Dec 2011 14:32:05 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:sender:in-reply-to:references:date
	:x-google-sender-auth:message-id:subject:from:to:cc:content-type
	:content-transfer-encoding;
	bh=E26K7XO/hlmhV3xJQeI09uSf/UZUaOHtqIoOgHCe59E=;
	b=Av8tqMrfGMwKslJ30twb1k+4Djict4KvB/NlBM6U/HV/fk+ri6R465lO2ZbzSvpKDQ
	50mH1Gr7MRzJV/D7PQLvVYxSq2zC5zETxt7c9PBBQJqvqmylBaGPObvo76AWSIIN5LNG
	RHNpdSpXi4ZmlECrpYF4UfG/uBEGWYu3K1Ym0=
MIME-Version: 1.0
Received: by 10.50.217.199 with SMTP id pa7mr30367529igc.48.1324333924910;
	Mon, 19 Dec 2011 14:32:04 -0800 (PST)
Sender: noah549@gmail.com
Received: by 10.42.217.6 with HTTP; Mon, 19 Dec 2011 14:32:04 -0800 (PST)
In-Reply-To: <1324326921.17612.YahooMailNeo@web37905.mail.mud.yahoo.com>
References: <1324326921.17612.YahooMailNeo@web37905.mail.mud.yahoo.com>
Date: Mon, 19 Dec 2011 17:32:04 -0500
X-Google-Sender-Auth: NV_zXwWIMqL14ZCJ_s67AJ9oUmw
Message-ID: <CA+U71=PEUpDHC76UPkSeSESfV+V7enxWwMJNWwfdbKjLTvSWMQ@mail.gmail.com>
Subject: Re: Minimal Guile
From: Noah Lavine <noah.b.lavine@gmail.com>
To: Mike Gran <spk121@yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Mon, 19 Dec 2011 22:32:08 -0000

This is an interesting point.

I was thinking about it though, and I think there is another thing
that is causing a lot of this "bloat": all of the Scheme modules we
are adding.

There is a tension here, because having lots of modules is very
important for using Guile as a language to write programs in. But when
it is used as an extension to other languages, most of them are not
useful. So if I were dreaming and not thinking about how hard it is to
write code, I would get a system that lets me pick which modules I
want to distribute and bundle them up with libguile into a package
that can be distributed and built on its own.

This would also end up addressing some of your examples, if this
hypothetical packager grew the ability to know about C as well as
Scheme modules. Then it could automatically remove the C code that
implements functions that were not wanted.

This is just an idea, though. This seems like a huge pain to code.

Noah

On Mon, Dec 19, 2011 at 3:35 PM, Mike Gran <spk121@yahoo.com> wrote:
> Hi-
>
> I've been keeping up with some of the discussion on other gnu lists.
>
> One of the criticisms at the moment is that Guile is
>
> 1. bloated
> 2. hard to distribute.
>
> Re point 2: hard to distribute.
>
> A while ago I was looking at the idea of minimizing the number of
> files needed to ship Guile as a dependency. =A0At the time, I thought
> that one could retool the build so that it produced
> - a tar.gz of the distributable header files
> - libguile=A0as a monolithic .so or .dll with no dependencies.
> =A0 Dependencies would be wrapped into the monolithic .so or .dll.
> - all the compiled .go files as a tar file
> - and a Guile executable that used both of the above
>
> Guile and libguile=A0would read the .go without unpacking the tar file
> by using libtar.
>
> There's no real advantage in this for the GNU system, but, it would
> make it easier to make a distributable cross-build for non-GNU
> systems.=A0 This would make it easier to set up a download repository
> of prebuilt .so, .dll, and go-lib tar files.
>
> Re point 1: bloated
>
> Once=A0the infrastructure for the above is in place, one could set
> up an alternate cross-build system that produced a version of
> Guile that is
>
> - ASCII only, "C" locale only
> - Fixnum integers only
> - No ability to load ltdl or ffi
> - no ability to use whatever=A0libcrypt is used for
>
> This would be for the purpose of being a minimalist extension
> engine.
>
> What do you think?
>
> -Mike Gran
>


From MAILER-DAEMON Mon Dec 19 22:23:53 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RcqIz-0001jl-Rh
	for mharc-guile-devel@gnu.org; Mon, 19 Dec 2011 22:23:53 -0500
Received: from eggs.gnu.org ([140.186.70.92]:45013)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RcqIx-0001jf-0w
	for guile-devel@gnu.org; Mon, 19 Dec 2011 22:23:52 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RcqIv-00031a-EC
	for guile-devel@gnu.org; Mon, 19 Dec 2011 22:23:50 -0500
Received: from mail-vx0-f169.google.com ([209.85.220.169]:37423)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>)
	id 1RcqIu-00031L-Uc; Mon, 19 Dec 2011 22:23:49 -0500
Received: by vcge1 with SMTP id e1so4323283vcg.0
	for <multiple recipients>; Mon, 19 Dec 2011 19:23:48 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=DWG2Bbm2+aHXgtbegAlGUEKjdTeTl3nGMlIR1hC4or8=;
	b=Y73AuPAbn3PNJMDJoQKi5hJIPdGcG/5XBlfdGbAj2w1IKYY7oydGrAggE/+HfywJwA
	m61q0pog4stKtVvVwDOiLKkNMpwdtDpkOxXfq4TUTfgSavZubfd4oNjjOLvDNOy5bPpT
	9iwicvgc5PkskfSZc8Vqvp2Z6abv3e0XY+ZGo=
MIME-Version: 1.0
Received: by 10.220.151.136 with SMTP id c8mr173936vcw.47.1324351428197; Mon,
	19 Dec 2011 19:23:48 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Mon, 19 Dec 2011 19:23:48 -0800 (PST)
In-Reply-To: <87r500tf6f.fsf@gnu.org>
References: <1314475521.3143.47.camel@Renee-desktop> <87ty4xmxl1.fsf@gnu.org>
	<CAPjoZoeA7TUAqH1pTogmLvKu2r4hr7kOq+x1njCO6yXZ-Kbiyw@mail.gmail.com>
	<87r500tf6f.fsf@gnu.org>
Date: Tue, 20 Dec 2011 11:23:48 +0800
Message-ID: <CAPjoZodEGEyTL0A6b8eGyVFQeMTqK9sYY5HRrvAitEXc_Uypjg@mail.gmail.com>
Subject: Re: [PATCH] Add "scandir" procedure
From: Nala Ginrut <nalaginrut@gmail.com>
To: =?UTF-8?Q?Ludovic_Court=C3=A8s?= <ludo@gnu.org>
Content-Type: multipart/alternative; boundary=f46d043bdf046f7b3104b47d9818
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.220.169
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 20 Dec 2011 03:23:52 -0000

--f46d043bdf046f7b3104b47d9818
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Tue, Dec 20, 2011 at 5:38 AM, Ludovic Court=C3=A8s <ludo@gnu.org> wrote:

> Hi Nala!
>
> Thanks for testing!
>
> Nala Ginrut <nalaginrut@gmail.com> skribis:
>
> > 1. I think file-system-fold based scandir tried to traverse the whole
> > directories include sub-directories. It's rather slow for a deep one if=
 I
> > just
> >     want a files list under 0 level directory tree;
>
> The code had initially approximately 1 typo per line, and I think I=E2=80=
=99ve
> fixed most of them now.  ;-)
>
> So =E2=80=98scandir=E2=80=99 does not enter sub-directories.  If it does,=
 that=E2=80=99s another
> bug.  :-)
>
> > 2. New scandir will crash while encounters a Chinese file name. This wi=
ll
> > be eliminated by using (setlocale LC_ALL "zh_CN.UTF-8").
> >     I think it's the same problem we faced in another thread. There's
> > something locale problem in Guile. Of course, we have a temporary
> solution
> > in recent commit;
>
> Yes, Guile views file names as strings and decodes them from the current
> locale encoding.  So if there are file names encoded differently, then
> scm_from_locale_string, called by =E2=80=98readdir=E2=80=99, throws a dec=
oding-error.
>
> That=E2=80=99s unfortunate, I=E2=80=99m not sure what to do.  I think GLi=
b/GIO issues a
> warning in such cases, while still being able to handle the file.  We
> could imagine =E2=80=98readdir=E2=80=99 returning a raw bytevector when d=
ecoding fails,
> and =E2=80=98open-file=E2=80=99 & co. could accept it as input.  But that=
=E2=80=99s really ugly.
>
> I think Mark had some ideas about it, which would be worth checking.
>
> > 3. It returns weird result. E.g (scandir "mmr")
> > =3D=3D>  ("." "." "." ".." ".." ".." "aa.c" "exclude" "ml" "myecl")
>
> One of the typos that got fixed, hopefully.  :-)
>
> Can you check again?
>
> > Anyway, I think new scandir's cool. Though it's little slow than my C
> wrap
> > version
>
> Because it uses =E2=80=98file-system-fold=E2=80=99, it does one =E2=80=98=
stat=E2=80=99 call for each
> file, which the C version doesn=E2=80=99t do.  That should be the only
> efficiency difference.
>
> Maybe we could change our =E2=80=98scandir=E2=80=99 to return a list of f=
ile name/stat
> pairs since we have the info anyway?
>
>
Well~it's a good idea I never thought about. And I've tested new commit,
it's wonderful.
Maybe you should consider this name/stat, now the new scandir is almost 4
times slower than C wrapper version.
Anyway, name/stat list would be a smart and easy solution. ;-)

--f46d043bdf046f7b3104b47d9818
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<br><br><div class=3D"gmail_quote">On Tue, Dec 20, 2011 at 5:38 AM, Ludovic=
 Court=C3=A8s <span dir=3D"ltr">&lt;<a href=3D"mailto:ludo@gnu.org">ludo@gn=
u.org</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"m=
argin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
Hi Nala!<br>
<br>
Thanks for testing!<br>
<br>
Nala Ginrut &lt;<a href=3D"mailto:nalaginrut@gmail.com">nalaginrut@gmail.co=
m</a>&gt; skribis:<br>
<div class=3D"im"><br>
&gt; 1. I think file-system-fold based scandir tried to traverse the whole<=
br>
&gt; directories include sub-directories. It&#39;s rather slow for a deep o=
ne if I<br>
&gt; just<br>
&gt; =C2=A0 =C2=A0 want a files list under 0 level directory tree;<br>
<br>
</div>The code had initially approximately 1 typo per line, and I think I=
=E2=80=99ve<br>
fixed most of them now. =C2=A0;-)<br>
<br>
So =E2=80=98scandir=E2=80=99 does not enter sub-directories. =C2=A0If it do=
es, that=E2=80=99s another<br>
bug. =C2=A0:-)<br>
<div class=3D"im"><br>
&gt; 2. New scandir will crash while encounters a Chinese file name. This w=
ill<br>
&gt; be eliminated by using (setlocale LC_ALL &quot;zh_CN.UTF-8&quot;).<br>
&gt; =C2=A0 =C2=A0 I think it&#39;s the same problem we faced in another th=
read. There&#39;s<br>
&gt; something locale problem in Guile. Of course, we have a temporary solu=
tion<br>
&gt; in recent commit;<br>
<br>
</div>Yes, Guile views file names as strings and decodes them from the curr=
ent<br>
locale encoding. =C2=A0So if there are file names encoded differently, then=
<br>
scm_from_locale_string, called by =E2=80=98readdir=E2=80=99, throws a decod=
ing-error.<br>
<br>
That=E2=80=99s unfortunate, I=E2=80=99m not sure what to do. =C2=A0I think =
GLib/GIO issues a<br>
warning in such cases, while still being able to handle the file. =C2=A0We<=
br>
could imagine =E2=80=98readdir=E2=80=99 returning a raw bytevector when dec=
oding fails,<br>
and =E2=80=98open-file=E2=80=99 &amp; co. could accept it as input. =C2=A0B=
ut that=E2=80=99s really ugly.<br>
<br>
I think Mark had some ideas about it, which would be worth checking.<br>
<div class=3D"im"><br>
&gt; 3. It returns weird result. E.g (scandir &quot;mmr&quot;)<br>
&gt; =3D=3D&gt; =C2=A0(&quot;.&quot; &quot;.&quot; &quot;.&quot; &quot;..&q=
uot; &quot;..&quot; &quot;..&quot; &quot;aa.c&quot; &quot;exclude&quot; &qu=
ot;ml&quot; &quot;myecl&quot;)<br>
<br>
</div>One of the typos that got fixed, hopefully. =C2=A0:-)<br>
<br>
Can you check again?<br>
<div class=3D"im"><br>
&gt; Anyway, I think new scandir&#39;s cool. Though it&#39;s little slow th=
an my C wrap<br>
&gt; version<br>
<br>
</div>Because it uses =E2=80=98file-system-fold=E2=80=99, it does one =E2=
=80=98stat=E2=80=99 call for each<br>
file, which the C version doesn=E2=80=99t do. =C2=A0That should be the only=
<br>
efficiency difference.<br>
<br>
Maybe we could change our =E2=80=98scandir=E2=80=99 to return a list of fil=
e name/stat<br>
pairs since we have the info anyway?<br>
<br></blockquote><div><br></div><div>Well~it&#39;s a good idea I never thou=
ght about. And I&#39;ve tested new commit, it&#39;s wonderful.</div><div>Ma=
ybe you should consider this name/stat, now the new scandir is almost 4 tim=
es slower than C wrapper version.</div>
<div>Anyway, name/stat list would be a smart and easy solution. ;-)=C2=A0</=
div></div><br>

--f46d043bdf046f7b3104b47d9818--


From MAILER-DAEMON Mon Dec 19 22:25:34 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RcqKc-0001u0-0v
	for mharc-guile-devel@gnu.org; Mon, 19 Dec 2011 22:25:34 -0500
Received: from eggs.gnu.org ([140.186.70.92]:57780)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RcqKZ-0001tu-1L
	for guile-devel@gnu.org; Mon, 19 Dec 2011 22:25:32 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RcqKX-0003Eg-SI
	for guile-devel@gnu.org; Mon, 19 Dec 2011 22:25:31 -0500
Received: from mail-vx0-f169.google.com ([209.85.220.169]:59255)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>)
	id 1RcqKX-0003Ec-LW; Mon, 19 Dec 2011 22:25:29 -0500
Received: by vcge1 with SMTP id e1so4324024vcg.0
	for <multiple recipients>; Mon, 19 Dec 2011 19:25:29 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=BNaId/5aLW3cy0+q51mOLm0LIg+1yxJUPM7ye1xYXXk=;
	b=CcjDTDUvz026uZGefxfGxEoR/x68VxjcjTRTuOQHvIt2e8ASWvKb8bbqP86NTbxldR
	pKE7FyxQHDi3S8708NWmG7TpzB//vUN9ZkkxbbAYL+R38rz7pGGqA020nkqSit+U4olz
	SDGIzuzqpyZIlAbVINPCWD1UNGygOVNQQJlr0=
MIME-Version: 1.0
Received: by 10.220.66.70 with SMTP id m6mr163626vci.57.1324351529302; Mon, 19
	Dec 2011 19:25:29 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Mon, 19 Dec 2011 19:25:29 -0800 (PST)
In-Reply-To: <CAPjoZodEGEyTL0A6b8eGyVFQeMTqK9sYY5HRrvAitEXc_Uypjg@mail.gmail.com>
References: <1314475521.3143.47.camel@Renee-desktop> <87ty4xmxl1.fsf@gnu.org>
	<CAPjoZoeA7TUAqH1pTogmLvKu2r4hr7kOq+x1njCO6yXZ-Kbiyw@mail.gmail.com>
	<87r500tf6f.fsf@gnu.org>
	<CAPjoZodEGEyTL0A6b8eGyVFQeMTqK9sYY5HRrvAitEXc_Uypjg@mail.gmail.com>
Date: Tue, 20 Dec 2011 11:25:29 +0800
Message-ID: <CAPjoZoc4y9bADeWCnqK+wxyR5x=iZhJ07Kz+GG6wZOXdo9mUZw@mail.gmail.com>
Subject: Re: [PATCH] Add "scandir" procedure
From: Nala Ginrut <nalaginrut@gmail.com>
To: =?UTF-8?Q?Ludovic_Court=C3=A8s?= <ludo@gnu.org>
Content-Type: multipart/alternative; boundary=14dae9cdc89d76433e04b47d9e3e
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.220.169
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 20 Dec 2011 03:25:32 -0000

--14dae9cdc89d76433e04b47d9e3e
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Oh, I forget to tell that C wrapper version doesn't have locale problem.
And according to the commit log, seems we may expect it completely fixed in
2.0.4?

On Tue, Dec 20, 2011 at 11:23 AM, Nala Ginrut <nalaginrut@gmail.com> wrote:

>
>
> On Tue, Dec 20, 2011 at 5:38 AM, Ludovic Court=C3=A8s <ludo@gnu.org> wrot=
e:
>
>> Hi Nala!
>>
>> Thanks for testing!
>>
>> Nala Ginrut <nalaginrut@gmail.com> skribis:
>>
>> > 1. I think file-system-fold based scandir tried to traverse the whole
>> > directories include sub-directories. It's rather slow for a deep one i=
f
>> I
>> > just
>> >     want a files list under 0 level directory tree;
>>
>> The code had initially approximately 1 typo per line, and I think I=E2=
=80=99ve
>> fixed most of them now.  ;-)
>>
>> So =E2=80=98scandir=E2=80=99 does not enter sub-directories.  If it does=
, that=E2=80=99s another
>> bug.  :-)
>>
>> > 2. New scandir will crash while encounters a Chinese file name. This
>> will
>> > be eliminated by using (setlocale LC_ALL "zh_CN.UTF-8").
>> >     I think it's the same problem we faced in another thread. There's
>> > something locale problem in Guile. Of course, we have a temporary
>> solution
>> > in recent commit;
>>
>> Yes, Guile views file names as strings and decodes them from the current
>> locale encoding.  So if there are file names encoded differently, then
>> scm_from_locale_string, called by =E2=80=98readdir=E2=80=99, throws a de=
coding-error.
>>
>> That=E2=80=99s unfortunate, I=E2=80=99m not sure what to do.  I think GL=
ib/GIO issues a
>> warning in such cases, while still being able to handle the file.  We
>> could imagine =E2=80=98readdir=E2=80=99 returning a raw bytevector when =
decoding fails,
>> and =E2=80=98open-file=E2=80=99 & co. could accept it as input.  But tha=
t=E2=80=99s really ugly.
>>
>> I think Mark had some ideas about it, which would be worth checking.
>>
>> > 3. It returns weird result. E.g (scandir "mmr")
>> > =3D=3D>  ("." "." "." ".." ".." ".." "aa.c" "exclude" "ml" "myecl")
>>
>> One of the typos that got fixed, hopefully.  :-)
>>
>> Can you check again?
>>
>> > Anyway, I think new scandir's cool. Though it's little slow than my C
>> wrap
>> > version
>>
>> Because it uses =E2=80=98file-system-fold=E2=80=99, it does one =E2=80=
=98stat=E2=80=99 call for each
>> file, which the C version doesn=E2=80=99t do.  That should be the only
>> efficiency difference.
>>
>> Maybe we could change our =E2=80=98scandir=E2=80=99 to return a list of =
file name/stat
>> pairs since we have the info anyway?
>>
>>
> Well~it's a good idea I never thought about. And I've tested new commit,
> it's wonderful.
> Maybe you should consider this name/stat, now the new scandir is almost 4
> times slower than C wrapper version.
> Anyway, name/stat list would be a smart and easy solution. ;-)
>
>

--14dae9cdc89d76433e04b47d9e3e
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Oh, I forget to tell that C wrapper version doesn&#39;t have locale problem=
.<div>And according to the commit log, seems we may expect it=C2=A0complete=
ly=C2=A0fixed in 2.0.4?<br><br><div class=3D"gmail_quote">On Tue, Dec 20, 2=
011 at 11:23 AM, Nala Ginrut <span dir=3D"ltr">&lt;<a href=3D"mailto:nalagi=
nrut@gmail.com">nalaginrut@gmail.com</a>&gt;</span> wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex"><br><br><div class=3D"gmail_quote"><div><div=
 class=3D"h5">On Tue, Dec 20, 2011 at 5:38 AM, Ludovic Court=C3=A8s <span d=
ir=3D"ltr">&lt;<a href=3D"mailto:ludo@gnu.org" target=3D"_blank">ludo@gnu.o=
rg</a>&gt;</span> wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
Hi Nala!<br>
<br>
Thanks for testing!<br>
<br>
Nala Ginrut &lt;<a href=3D"mailto:nalaginrut@gmail.com" target=3D"_blank">n=
alaginrut@gmail.com</a>&gt; skribis:<br>
<div><br>
&gt; 1. I think file-system-fold based scandir tried to traverse the whole<=
br>
&gt; directories include sub-directories. It&#39;s rather slow for a deep o=
ne if I<br>
&gt; just<br>
&gt; =C2=A0 =C2=A0 want a files list under 0 level directory tree;<br>
<br>
</div>The code had initially approximately 1 typo per line, and I think I=
=E2=80=99ve<br>
fixed most of them now. =C2=A0;-)<br>
<br>
So =E2=80=98scandir=E2=80=99 does not enter sub-directories. =C2=A0If it do=
es, that=E2=80=99s another<br>
bug. =C2=A0:-)<br>
<div><br>
&gt; 2. New scandir will crash while encounters a Chinese file name. This w=
ill<br>
&gt; be eliminated by using (setlocale LC_ALL &quot;zh_CN.UTF-8&quot;).<br>
&gt; =C2=A0 =C2=A0 I think it&#39;s the same problem we faced in another th=
read. There&#39;s<br>
&gt; something locale problem in Guile. Of course, we have a temporary solu=
tion<br>
&gt; in recent commit;<br>
<br>
</div>Yes, Guile views file names as strings and decodes them from the curr=
ent<br>
locale encoding. =C2=A0So if there are file names encoded differently, then=
<br>
scm_from_locale_string, called by =E2=80=98readdir=E2=80=99, throws a decod=
ing-error.<br>
<br>
That=E2=80=99s unfortunate, I=E2=80=99m not sure what to do. =C2=A0I think =
GLib/GIO issues a<br>
warning in such cases, while still being able to handle the file. =C2=A0We<=
br>
could imagine =E2=80=98readdir=E2=80=99 returning a raw bytevector when dec=
oding fails,<br>
and =E2=80=98open-file=E2=80=99 &amp; co. could accept it as input. =C2=A0B=
ut that=E2=80=99s really ugly.<br>
<br>
I think Mark had some ideas about it, which would be worth checking.<br>
<div><br>
&gt; 3. It returns weird result. E.g (scandir &quot;mmr&quot;)<br>
&gt; =3D=3D&gt; =C2=A0(&quot;.&quot; &quot;.&quot; &quot;.&quot; &quot;..&q=
uot; &quot;..&quot; &quot;..&quot; &quot;aa.c&quot; &quot;exclude&quot; &qu=
ot;ml&quot; &quot;myecl&quot;)<br>
<br>
</div>One of the typos that got fixed, hopefully. =C2=A0:-)<br>
<br>
Can you check again?<br>
<div><br>
&gt; Anyway, I think new scandir&#39;s cool. Though it&#39;s little slow th=
an my C wrap<br>
&gt; version<br>
<br>
</div>Because it uses =E2=80=98file-system-fold=E2=80=99, it does one =E2=
=80=98stat=E2=80=99 call for each<br>
file, which the C version doesn=E2=80=99t do. =C2=A0That should be the only=
<br>
efficiency difference.<br>
<br>
Maybe we could change our =E2=80=98scandir=E2=80=99 to return a list of fil=
e name/stat<br>
pairs since we have the info anyway?<br>
<br></blockquote><div><br></div></div></div><div>Well~it&#39;s a good idea =
I never thought about. And I&#39;ve tested new commit, it&#39;s wonderful.<=
/div><div>Maybe you should consider this name/stat, now the new scandir is =
almost 4 times slower than C wrapper version.</div>

<div>Anyway, name/stat list would be a smart and easy solution. ;-)=C2=A0</=
div></div><br>
</blockquote></div><br></div>

--14dae9cdc89d76433e04b47d9e3e--


From MAILER-DAEMON Tue Dec 20 07:03:21 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RcyPh-00073E-PC
	for mharc-guile-devel@gnu.org; Tue, 20 Dec 2011 07:03:21 -0500
Received: from eggs.gnu.org ([140.186.70.92]:43691)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RcyPW-0006xE-TP
	for guile-devel@gnu.org; Tue, 20 Dec 2011 07:03:18 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ludo@gnu.org>) id 1RcyPR-0007uN-8y
	for guile-devel@gnu.org; Tue, 20 Dec 2011 07:03:10 -0500
Received: from mail1-relais-roc.national.inria.fr ([192.134.164.82]:20820)
	by eggs.gnu.org with esmtp (Exim 4.71) (envelope-from <ludo@gnu.org>)
	id 1RcyPR-0007tx-4S
	for guile-devel@gnu.org; Tue, 20 Dec 2011 07:03:05 -0500
X-IronPort-AV: E=Sophos;i="4.71,381,1320620400"; d="scan'208";a="136155838"
Received: from reverse-83.fdn.fr (HELO pluto) ([80.67.176.83])
	by mail1-relais-roc.national.inria.fr with ESMTP/TLS/DHE-RSA-AES128-SHA;
	20 Dec 2011 13:03:03 +0100
From: ludo@gnu.org (Ludovic =?iso-8859-1?Q?Court=E8s?=)
To: Nala Ginrut <nalaginrut@gmail.com>
Subject: Re: [PATCH] Add "scandir" procedure
References: <1314475521.3143.47.camel@Renee-desktop> <87ty4xmxl1.fsf@gnu.org>
	<CAPjoZoeA7TUAqH1pTogmLvKu2r4hr7kOq+x1njCO6yXZ-Kbiyw@mail.gmail.com>
	<87r500tf6f.fsf@gnu.org>
	<CAPjoZodEGEyTL0A6b8eGyVFQeMTqK9sYY5HRrvAitEXc_Uypjg@mail.gmail.com>
	<CAPjoZoc4y9bADeWCnqK+wxyR5x=iZhJ07Kz+GG6wZOXdo9mUZw@mail.gmail.com>
X-URL: http://www.fdn.fr/~lcourtes/
X-Revolutionary-Date: 30 Frimaire an 220 de la =?iso-8859-1?Q?R=E9volution?=
X-PGP-Key-ID: 0xEA52ECF4
X-PGP-Key: http://www.fdn.fr/~lcourtes/ludovic.asc
X-PGP-Fingerprint: 83C4 F8E5 10A3 3B4C 5BEA  D15D 77DD 95E2 EA52 ECF4
X-OS: x86_64-unknown-linux-gnu
Date: Tue, 20 Dec 2011 13:03:02 +0100
In-Reply-To: <CAPjoZoc4y9bADeWCnqK+wxyR5x=iZhJ07Kz+GG6wZOXdo9mUZw@mail.gmail.com>
	(Nala Ginrut's message of "Tue, 20 Dec 2011 11:25:29 +0800")
Message-ID: <87aa6nlabt.fsf@gnu.org>
User-Agent: Gnus/5.110018 (No Gnus v0.18) Emacs/24.0.90 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 192.134.164.82
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 20 Dec 2011 12:03:18 -0000

Nala Ginrut <nalaginrut@gmail.com> skribis:

> Oh, I forget to tell that C wrapper version doesn't have locale problem.

That=E2=80=99s because the C version, in particular alphasort/strcoll, sile=
ntly
ignores locale decoding errors.

Thanks,
Ludo=E2=80=99.


From MAILER-DAEMON Tue Dec 20 16:09:25 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rd6w9-0004QY-Pp
	for mharc-guile-devel@gnu.org; Tue, 20 Dec 2011 16:09:25 -0500
Received: from eggs.gnu.org ([140.186.70.92]:53922)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dsmich@roadrunner.com>) id 1Rd6w7-0004Q7-KR
	for guile-devel@gnu.org; Tue, 20 Dec 2011 16:09:24 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dsmich@roadrunner.com>) id 1Rd6w6-0005Qo-S8
	for guile-devel@gnu.org; Tue, 20 Dec 2011 16:09:23 -0500
Received: from cdptpa-omtalb.mail.rr.com ([75.180.132.120]:23567)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dsmich@roadrunner.com>) id 1Rd6w6-0005QS-PH
	for guile-devel@gnu.org; Tue, 20 Dec 2011 16:09:22 -0500
Authentication-Results: cdptpa-omtalb.mail.rr.com
	smtp.user=dsmich@roadrunner.com; auth=pass (LOGIN)
X-Authority-Analysis: v=2.0 cv=ePqRfQV1 c=1 sm=0 a=zTVDa7HKqxcA:10
	a=IkcTkHD0fZMA:10 a=mDV3o1hIAAAA:8 a=2J8e8tRjKu9QrBsWSRoA:9
	a=QEXdDO2ut3YA:10 a=ii61gXl28gQA:10
	a=7nDCL72HGsb2dj+Zm/Mhmw==:117
X-Cloudmark-Score: 0
Received: from [10.127.132.165] ([10.127.132.165:61496] helo=cdptpa-web14-z02)
	by cdptpa-oedge01.mail.rr.com (envelope-from <dsmich@roadrunner.com>)
	(ecelerity 2.2.3.46 r()) with ESMTPA
	id 3E/89-17351-F79F0FE4; Tue, 20 Dec 2011 21:09:19 +0000
Message-ID: <20111220210919.0YNV7.4169.root@cdptpa-web14-z02>
Date: Tue, 20 Dec 2011 16:09:19 -0500
From: <dsmich@roadrunner.com>
To: guile-devel@gnu.org, =?utf-8?Q?Ludovic_Court=C3=A8s?= <ludo@gnu.org>
Subject: Re: Holidays vs. release
In-Reply-To: <87mxaofpu4.fsf@gnu.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Originating-IP: 
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 75.180.132.120
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 20 Dec 2011 21:09:24 -0000


---- "Ludovic Court=C3=A8s" <ludo@gnu.org> wrote:=20
> Hello Guilers!
>=20
> I initially thought it would be great to push a 2.0.4 tarball by the end
> of the year, but since I=E2=80=99ll be on holidays starting from tomorrow=
 until
> Jan. 3rd, I won=E2=80=99t be able to make it.  Sorry about that!

I'm still getting that one failure in make check.  Something about gc a lex=
icals?  (Sorry I'm not at that machine.)  Probably would be a good idea to =
tune that up before release anyway.

I'll post details when I can.


> Anyway, happy holidays for those of you planning to be on holidays!

Indeed!

  -Dale



From MAILER-DAEMON Tue Dec 20 16:54:09 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rd7dR-0000s5-Dy
	for mharc-guile-devel@gnu.org; Tue, 20 Dec 2011 16:54:09 -0500
Received: from eggs.gnu.org ([140.186.70.92]:48571)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <bruno@clisp.org>) id 1Rd7dP-0000rv-4k
	for guile-devel@gnu.org; Tue, 20 Dec 2011 16:54:08 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <bruno@clisp.org>) id 1Rd7dN-0004XM-PB
	for guile-devel@gnu.org; Tue, 20 Dec 2011 16:54:07 -0500
Received: from mo-p00-ob.rzone.de ([81.169.146.161]:64197)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <bruno@clisp.org>) id 1Rd7dN-0004X4-5P
	for guile-devel@gnu.org; Tue, 20 Dec 2011 16:54:05 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; t=1324418043; l=649;
	s=domk; d=haible.de;
	h=Content-Transfer-Encoding:Content-Type:MIME-Version:Date:Subject:To:
	From:X-RZG-CLASS-ID:X-RZG-AUTH;
	bh=fC5n0A4G2PtSu0+Tnm9mH0/mqNQ=;
	b=c3aK6EE/biX7Doq5Cf/BWMIYtnrqjpKOsSB3Srn8RsxYwbPhrWb3XpI51a9XDGgjklu
	k23Vu/n+GYT4ohpDOolt97KcZePIhjkySCgDyIV0pb5Ox9AdB5fjhf1yRPV7fyzMd6B08
	1avLXqWfQ3Zj/R20v5uvaaBNUQs7gRJWz5Y=
X-RZG-AUTH: :Ln4Re0+Ic/6oZXR1YgKryK8brksyK8dozXDwHXjf9hj/zDNRb/I44MGPMw==
X-RZG-CLASS-ID: mo00
Received: from linuix.haible.de
	(dslb-088-068-064-201.pools.arcor-ip.net [88.68.64.201])
	by smtp.strato.de (fruni mo39) (RZmta 26.15 DYNA|AUTH)
	with ESMTPA id q0467bnBKJbVRU ; Tue, 20 Dec 2011 22:53:57 +0100 (MET)
From: Bruno Haible <bruno@clisp.org>
To: guile-devel@gnu.org
Subject: goops web page
Date: Tue, 20 Dec 2011 22:53:56 +0100
User-Agent: KMail/1.13.6 (Linux/2.6.37.6-0.5-desktop; KDE/4.6.0; x86_64; ; )
MIME-Version: 1.0
Content-Type: Text/Plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Message-Id: <201112202253.56464.bruno@clisp.org>
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 81.169.146.161
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 20 Dec 2011 21:54:08 -0000

Hi,

A web search for guile-oop pointed me to
  http://www.gnu.org/software/goops/
It says:

  "There are plans to merge GOOPS into the Guile distribution."

  "Latest released version is 1.0"

  "Version 1.0 of GOOPS is now available via anonymous FTP as
   http://ftp.gnu.org/gnu/guile/guile-oops-1.0.tar.gz."

  "This release mostly contains adaptations to guile-1.4 and bug fixes."

  "The bleeding edge of development is available via anonymous CVS."

goops is part of the guile 2.0 distribution. This web page appears to be
hopelessly out of date. Why not replace it with a forward to
http://www.gnu.org/software/guile/ ?

Bruno


From MAILER-DAEMON Tue Dec 20 16:54:25 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rd7dh-0000zG-Kv
	for mharc-guile-devel@gnu.org; Tue, 20 Dec 2011 16:54:25 -0500
Received: from eggs.gnu.org ([140.186.70.92]:45076)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <bruno@clisp.org>) id 1Rd7df-0000x0-4o
	for guile-devel@gnu.org; Tue, 20 Dec 2011 16:54:24 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <bruno@clisp.org>) id 1Rd7de-0004bL-99
	for guile-devel@gnu.org; Tue, 20 Dec 2011 16:54:23 -0500
Received: from mo-p00-ob.rzone.de ([81.169.146.162]:64394)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <bruno@clisp.org>) id 1Rd7de-0004b9-3T
	for guile-devel@gnu.org; Tue, 20 Dec 2011 16:54:22 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; t=1324418061; l=272;
	s=domk; d=haible.de;
	h=Content-Transfer-Encoding:Content-Type:MIME-Version:Date:Subject:To:
	From:X-RZG-CLASS-ID:X-RZG-AUTH;
	bh=qDOPh5d9grrFR/AUSn5Wst0gvJw=;
	b=wf/jOBvbeoJlbhIJXdJoWdEFUezYY2h1SdMXhOsQGhnAEfpSEjRVgd9v0GpCJkbhcCf
	5WiKBUcEK2Qj/S6pXQ/ANcYBFqhzcjaAiRICOGtM20lohau4AfYTKicgl86YnGpJ+3XhU
	/8GQAf5V+jSucL8H6Fzhh3du+AvKaRIIzcw=
X-RZG-AUTH: :Ln4Re0+Ic/6oZXR1YgKryK8brksyK8dozXDwHXjf9hj/zDNRb/I44MGPMw==
X-RZG-CLASS-ID: mo00
Received: from linuix.haible.de
	(dslb-088-068-064-201.pools.arcor-ip.net [88.68.64.201])
	by smtp.strato.de (fruni mo2) (RZmta 26.15 DYNA|AUTH)
	with ESMTPA id Z0386cnBKJHm0P ; Tue, 20 Dec 2011 22:54:00 +0100 (MET)
From: Bruno Haible <bruno@clisp.org>
To: guile-devel@gnu.org
Subject: a stale link
Date: Tue, 20 Dec 2011 22:53:58 +0100
User-Agent: KMail/1.13.6 (Linux/2.6.37.6-0.5-desktop; KDE/4.6.0; x86_64; ; )
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Message-Id: <201112202253.58995.bruno@clisp.org>
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 81.169.146.162
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 20 Dec 2011 21:54:24 -0000

Hi,

http://www.gnu.org/software/guile/anon-cvs.html contains a hyperlink
"read this page" to http://www.gnu.org/software/guile/repository.html
which doesn't exist.

I think it ought to be replaced with
http://www.gnu.org/software/guile/download.html#git

Bruno


From MAILER-DAEMON Tue Dec 20 19:59:40 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RdAWy-00030B-CL
	for mharc-guile-devel@gnu.org; Tue, 20 Dec 2011 19:59:40 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52635)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dsmich@roadrunner.com>) id 1RdAWv-0002zz-OA
	for guile-devel@gnu.org; Tue, 20 Dec 2011 19:59:38 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <dsmich@roadrunner.com>) id 1RdAWu-0004Ev-3J
	for guile-devel@gnu.org; Tue, 20 Dec 2011 19:59:37 -0500
Received: from cdptpa-omtalb.mail.rr.com ([75.180.132.120]:10775)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <dsmich@roadrunner.com>) id 1RdAWt-0004Ek-Sm
	for guile-devel@gnu.org; Tue, 20 Dec 2011 19:59:36 -0500
Authentication-Results: cdptpa-omtalb.mail.rr.com
	smtp.user=dsmich@roadrunner.com; auth=pass (LOGIN)
X-Authority-Analysis: v=2.0 cv=APbyNIPv c=1 sm=0 a=zTVDa7HKqxcA:10
	a=IkcTkHD0fZMA:10 a=doupyKFmAAAA:8 a=mDV3o1hIAAAA:8
	a=xGcgWY__ISYfmqExNpEA:9 a=QEXdDO2ut3YA:10 a=0vUscowIxtUA:10
	a=ii61gXl28gQA:10 a=KP/YX84if8whyb+LKdk8pQ==:117
X-Cloudmark-Score: 0
Received: from [10.127.132.106] ([10.127.132.106:40500] helo=cdptpa-web15-z01)
	by cdptpa-oedge02.mail.rr.com (envelope-from <dsmich@roadrunner.com>)
	(ecelerity 2.2.3.46 r()) with ESMTPA
	id BC/96-19251-67F21FE4; Wed, 21 Dec 2011 00:59:34 +0000
Message-ID: <20111221005934.KW79Q.70655.root@cdptpa-web15-z01>
Date: Tue, 20 Dec 2011 19:59:34 -0500
From: <dsmich@roadrunner.com>
To: guile-devel@gnu.org, =?utf-8?Q?Ludovic_Court=C3=A8s?= <ludo@gnu.org>, 
	dsmich@roadrunner.com, bug-guile@gnu.org
Subject: Re: Holidays vs. release
In-Reply-To: <20111220210919.0YNV7.4169.root@cdptpa-web14-z02>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Originating-IP: 
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 75.180.132.120
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 21 Dec 2011 00:59:38 -0000


---- dsmich@roadrunner.com wrote:=20
>=20
> ---- "Ludovic Court=C3=A8s" <ludo@gnu.org> wrote:=20
> > Hello Guilers!
> >=20
> > I initially thought it would be great to push a 2.0.4 tarball by the en=
d
> > of the year, but since I=E2=80=99ll be on holidays starting from tomorr=
ow until
> > Jan. 3rd, I won=E2=80=99t be able to make it.  Sorry about that!
>=20
> I'm still getting that one failure in make check.  Something about gc a l=
exicals?  (Sorry I'm not at that machine.)  Probably would be a good idea t=
o tune that up before release anyway.
>=20
> I'll post details when I can.

I'm on a 32bit Debian intel system.  libgc is 7.2alpha4

git describe is
v2.0.3-82-ga2c6601

The single failure running make check is

Running gc.test
FAIL: gc.test: gc: Lexical vars are collectable


-Dale



From MAILER-DAEMON Wed Dec 21 01:52:33 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RdG2T-000505-In
	for mharc-guile-devel@gnu.org; Wed, 21 Dec 2011 01:52:33 -0500
Received: from eggs.gnu.org ([140.186.70.92]:48523)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RdG2Q-0004zc-7I
	for guile-devel@gnu.org; Wed, 21 Dec 2011 01:52:31 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RdG2O-0002H2-Ox
	for guile-devel@gnu.org; Wed, 21 Dec 2011 01:52:30 -0500
Received: from mail-vw0-f41.google.com ([209.85.212.41]:45666)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RdG2O-0002Gw-Kz
	for guile-devel@gnu.org; Wed, 21 Dec 2011 01:52:28 -0500
Received: by vbbfn1 with SMTP id fn1so6558539vbb.0
	for <guile-devel@gnu.org>; Tue, 20 Dec 2011 22:52:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=fBYnpaXTXvY01NUQbbDcOHmLLs0V1UwKcy0/9oYuJqI=;
	b=FphWRadAkbok3rs7ysCXPMhs4GskbLsJbFk5tjRrzAHw8E059tl58Lb/9jI8bVHumO
	mf9SDhNvnlxxKGY8lZ9Qx/A28AiqO2fI384brYEXOgdfHXh3BnDTQXYvkEe2YPe4JZCp
	R57VHQiRPMy3qwvcJSdSYgOGKt9ZV9/fm497w=
MIME-Version: 1.0
Received: by 10.52.26.66 with SMTP id j2mr3037071vdg.98.1324450346511; Tue, 20
	Dec 2011 22:52:26 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Tue, 20 Dec 2011 22:52:26 -0800 (PST)
In-Reply-To: <201112202253.56464.bruno@clisp.org>
References: <201112202253.56464.bruno@clisp.org>
Date: Wed, 21 Dec 2011 14:52:26 +0800
Message-ID: <CAPjoZoe5hmJOwGyTA1QmZfp0QAJf44VF_RKWb=z4EsKzs8xgBA@mail.gmail.com>
Subject: Re: goops web page
From: Nala Ginrut <nalaginrut@gmail.com>
To: Bruno Haible <bruno@clisp.org>
Content-Type: multipart/alternative; boundary=20cf307f372e6d2e3804b494a08b
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.212.41
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 21 Dec 2011 06:52:32 -0000

--20cf307f372e6d2e3804b494a08b
Content-Type: text/plain; charset=UTF-8

Yup. I think there're lot of old info on Guile's website.
Seems all guilers are real doer rather than adman. ;-)

On Wed, Dec 21, 2011 at 5:53 AM, Bruno Haible <bruno@clisp.org> wrote:

> Hi,
>
> A web search for guile-oop pointed me to
>  http://www.gnu.org/software/goops/
> It says:
>
>  "There are plans to merge GOOPS into the Guile distribution."
>
>  "Latest released version is 1.0"
>
>  "Version 1.0 of GOOPS is now available via anonymous FTP as
>   http://ftp.gnu.org/gnu/guile/guile-oops-1.0.tar.gz."
>
>  "This release mostly contains adaptations to guile-1.4 and bug fixes."
>
>  "The bleeding edge of development is available via anonymous CVS."
>
> goops is part of the guile 2.0 distribution. This web page appears to be
> hopelessly out of date. Why not replace it with a forward to
> http://www.gnu.org/software/guile/ ?
>
> Bruno
>
>

--20cf307f372e6d2e3804b494a08b
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Yup. I think there&#39;re lot of old info on Guile&#39;s website.=C2=A0<div=
>Seems all guilers are real doer rather than adman. ;-)<br><div><br><div cl=
ass=3D"gmail_quote">On Wed, Dec 21, 2011 at 5:53 AM, Bruno Haible <span dir=
=3D"ltr">&lt;<a href=3D"mailto:bruno@clisp.org">bruno@clisp.org</a>&gt;</sp=
an> wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">Hi,<br>
<br>
A web search for guile-oop pointed me to<br>
 =C2=A0<a href=3D"http://www.gnu.org/software/goops/" target=3D"_blank">htt=
p://www.gnu.org/software/goops/</a><br>
It says:<br>
<br>
 =C2=A0&quot;There are plans to merge GOOPS into the Guile distribution.&qu=
ot;<br>
<br>
 =C2=A0&quot;Latest released version is 1.0&quot;<br>
<br>
 =C2=A0&quot;Version 1.0 of GOOPS is now available via anonymous FTP as<br>
 =C2=A0 <a href=3D"http://ftp.gnu.org/gnu/guile/guile-oops-1.0.tar.gz" targ=
et=3D"_blank">http://ftp.gnu.org/gnu/guile/guile-oops-1.0.tar.gz</a>.&quot;=
<br>
<br>
 =C2=A0&quot;This release mostly contains adaptations to guile-1.4 and bug =
fixes.&quot;<br>
<br>
 =C2=A0&quot;The bleeding edge of development is available via anonymous CV=
S.&quot;<br>
<br>
goops is part of the guile 2.0 distribution. This web page appears to be<br=
>
hopelessly out of date. Why not replace it with a forward to<br>
<a href=3D"http://www.gnu.org/software/guile/" target=3D"_blank">http://www=
.gnu.org/software/guile/</a> ?<br>
<span class=3D"HOEnZb"><font color=3D"#888888"><br>
Bruno<br>
<br>
</font></span></blockquote></div><br></div></div>

--20cf307f372e6d2e3804b494a08b--


From MAILER-DAEMON Wed Dec 21 05:33:03 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RdJTr-00088Y-Ay
	for mharc-guile-devel@gnu.org; Wed, 21 Dec 2011 05:33:03 -0500
Received: from eggs.gnu.org ([140.186.70.92]:38013)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RdJTk-00087E-Ah
	for guile-devel@gnu.org; Wed, 21 Dec 2011 05:33:01 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RdJTe-0007hA-R3
	for guile-devel@gnu.org; Wed, 21 Dec 2011 05:32:56 -0500
Received: from lo.gmane.org ([80.91.229.12]:42581)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1RdJTe-0007g8-DO
	for guile-devel@gnu.org; Wed, 21 Dec 2011 05:32:50 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1RdJTb-0003XR-PT
	for guile-devel@gnu.org; Wed, 21 Dec 2011 11:32:47 +0100
Received: from cpc13-rdng21-2-0-cust334.15-3.cable.virginmedia.com
	([82.12.149.79]) by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 21 Dec 2011 11:32:47 +0100
Received: from ian by cpc13-rdng21-2-0-cust334.15-3.cable.virginmedia.com with
	local (Gmexim 0.1 (Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Wed, 21 Dec 2011 11:32:47 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: Ian Hulin <ian@hulin.org.uk>
Subject: Re: summary: lilypond, lambda, and local-eval
Date: Wed, 21 Dec 2011 10:32:39 +0000
Lines: 12
Message-ID: <4EF1B5C7.8030808@hulin.org.uk>
References: <87r506uodd.fsf@pobox.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: cpc13-rdng21-2-0-cust334.15-3.cable.virginmedia.com
User-Agent: Mozilla/5.0 (X11; Linux i686;
	rv:8.0) Gecko/20111124 Thunderbird/8.0
In-Reply-To: <87r506uodd.fsf@pobox.com>
X-Enigmail-Version: 1.3.4
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 21 Dec 2011 10:33:02 -0000

Hi Andy and Guile developers,

As the original OP about (local-eval) getting withdrawn please accept
my thanks for the excellent work going on in these threads.  I still
follow it even though I barely understand a lot of the stuff that's
being discussed.

Thanks a million, guys, and compliments of the season,

Cheers,
Ian Hulin (LilyPond Guile V2 Migration troll)




From MAILER-DAEMON Wed Dec 21 09:58:28 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RdNci-0001DU-OJ
	for mharc-guile-devel@gnu.org; Wed, 21 Dec 2011 09:58:28 -0500
Received: from eggs.gnu.org ([140.186.70.92]:60412)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RdNcZ-00019N-Sx
	for guile-devel@gnu.org; Wed, 21 Dec 2011 09:58:25 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RdNcV-0004V7-GS
	for guile-devel@gnu.org; Wed, 21 Dec 2011 09:58:19 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:60270
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RdNcV-0004V3-Dt
	for guile-devel@gnu.org; Wed, 21 Dec 2011 09:58:15 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id DB0F68276;
	Wed, 21 Dec 2011 09:58:14 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=i8mbKdhjS/ylKK5pjkP1STo5bOo=; b=Fh5x9X
	HRO/w/6L6LUuhkJJbY4AZGjJnit2C24+OnZYBOInTATzuHMRVq7QHUQaiDeYqaiu
	aNvJwoa4fCLD93AaRYg3TKyA/E0vqhlK7lZPQSUml8xOotbKvTcvrJlP+0TMqCou
	+bvyNUlT5yBbULPg2AWhqj43JRzXac+b+e3sg=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=c4+08nacQS6T/e4u50nuDr6fHSXqDvDq
	8cC0MurcT7sDfpasbr5NRlGigZr5Ltg7WakGuLO4K02BIoDJEgHABwqjMOH/p6Hr
	lGzNhY+LrK7RFI25FGJlIegyJiUsPgsVJlz046vRvmsjmBtNhMdCae4N4VrZZ24N
	yWJ3G+ez6R8=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id D05438275;
	Wed, 21 Dec 2011 09:58:14 -0500 (EST)
Received: from badger (unknown [184.174.165.119]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 7BDE28274;
	Wed, 21 Dec 2011 09:58:14 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Bruno Haible <bruno@clisp.org>
Subject: Re: goops web page
References: <201112202253.56464.bruno@clisp.org>
Date: Wed, 21 Dec 2011 15:58:11 +0100
In-Reply-To: <201112202253.56464.bruno@clisp.org> (Bruno Haible's message of
	"Tue, 20 Dec 2011 22:53:56 +0100")
Message-ID: <8739cet1j0.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 3558F9E4-2BE4-11E1-B07C-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 21 Dec 2011 14:58:25 -0000

On Tue 20 Dec 2011 22:53, Bruno Haible <bruno@clisp.org> writes:

> A web search for guile-oop pointed me to
>   http://www.gnu.org/software/goops/

Ew :)

> goops is part of the guile 2.0 distribution. This web page appears to be
> hopelessly out of date. Why not replace it with a forward to
> http://www.gnu.org/software/guile/ ?

Will do.

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Wed Dec 21 10:39:25 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RdOGL-00017h-JM
	for mharc-guile-devel@gnu.org; Wed, 21 Dec 2011 10:39:25 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55797)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RdOGE-00015y-6h
	for guile-devel@gnu.org; Wed, 21 Dec 2011 10:39:23 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RdOG8-0005aI-4q
	for guile-devel@gnu.org; Wed, 21 Dec 2011 10:39:18 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:63662
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RdOG7-0005aB-Uu
	for guile-devel@gnu.org; Wed, 21 Dec 2011 10:39:12 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 412C2867A;
	Wed, 21 Dec 2011 10:39:11 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=gYEgF6p/dKI431BwMkNbv7nxy04=; b=Y384eh
	/dI/Y9fw3jlc/48V3GC51KSXipI7Q3SOieqjXtp8mKFB5C6ua53hV69pRdReCJoA
	vz8NMZ4iWPj0l2sI+Q5b+C5BZXd/NwdPDG8cq9fTFKlovYl3x8mwS30eWe4XJQ7T
	IsRk6jnbq7BMU4nkNfotYCxLBjzg5WX8whW7c=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=fwmocIU2OXBzY9Dl3Nijk5ey8r6o/72A
	QqyT7r3b07COTJJQHSwffqPvbbQPynJfwd2So+42sW1VNLVaCeTb6NQ9ZkZL0qSn
	M4Wd9rW1i196KupvcRRtkPU3pGPe0PdGa0NzZyyq6RZpyzRrXHrtVvLU577yOVOX
	fV9EHiFfipU=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 386EA8679;
	Wed, 21 Dec 2011 10:39:11 -0500 (EST)
Received: from badger (unknown [184.174.165.119]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id CAFB88678;
	Wed, 21 Dec 2011 10:39:10 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Bruno Haible <bruno@clisp.org>
Subject: Re: a stale link
References: <201112202253.58995.bruno@clisp.org>
Date: Wed, 21 Dec 2011 16:39:08 +0100
In-Reply-To: <201112202253.58995.bruno@clisp.org> (Bruno Haible's message of
	"Tue, 20 Dec 2011 22:53:58 +0100")
Message-ID: <87ty4url2b.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: ED6ED044-2BE9-11E1-BFD9-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 21 Dec 2011 15:39:23 -0000

On Tue 20 Dec 2011 22:53, Bruno Haible <bruno@clisp.org> writes:

> http://www.gnu.org/software/guile/anon-cvs.html contains a hyperlink
> "read this page" to http://www.gnu.org/software/guile/repository.html
> which doesn't exist.
>
> I think it ought to be replaced with
> http://www.gnu.org/software/guile/download.html#git

I have removed the anon-cvs.html page.  It seems like the best thing to
do, to get it out of the indices of the various search engines.

Thanks for the report,

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Wed Dec 21 10:47:35 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RdOOF-0003Kq-RF
	for mharc-guile-devel@gnu.org; Wed, 21 Dec 2011 10:47:35 -0500
Received: from eggs.gnu.org ([140.186.70.92]:49454)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RdOO8-0003Fi-0T
	for guile-devel@gnu.org; Wed, 21 Dec 2011 10:47:32 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RdOO2-0006yN-70
	for guile-devel@gnu.org; Wed, 21 Dec 2011 10:47:27 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:51665
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RdOO2-0006yH-4N
	for guile-devel@gnu.org; Wed, 21 Dec 2011 10:47:22 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 0BDB88735;
	Wed, 21 Dec 2011 10:47:21 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=siSy+2eJIc6jT1MDoqm4yD4ahVE=; b=l9hzX7
	xrg7ipyyLTcjE5KphrAQqyEq3OirpVdL9lc2zd3F4qOpfUE1sU9o7mklBral+HqN
	7PzOg8Ui5B/HC/8Eq8aokNZeIbpemyRCtFZ7AMuP/X8uuVrWVlyqsHL6SaUo8jFn
	Qk2fiF7kT5Yz9z4e+Z9QTf7tzh9X1vzjWbZ6k=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=Vh2nmvK0L24ANePfUWyAYHQgBXDU8Gid
	maHkzZLr0iUyXs4U4goeamzpy/pAOnDTN1CccuurDMzb2AZmrIVTB8QX8FFfiI0O
	E7fxi/Vf77VvHQO/2/2hCS2XH/wDILM9vuC6EKrO32SAuHBZvmzN6b3uPOW6n+nG
	m7jTZ9GkMVc=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 0558A8734;
	Wed, 21 Dec 2011 10:47:21 -0500 (EST)
Received: from badger (unknown [184.174.165.119]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 9B2A98733;
	Wed, 21 Dec 2011 10:47:20 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Noah Lavine <noah.b.lavine@gmail.com>
Subject: Re: Minimal Guile
References: <1324326921.17612.YahooMailNeo@web37905.mail.mud.yahoo.com>
	<CA+U71=PEUpDHC76UPkSeSESfV+V7enxWwMJNWwfdbKjLTvSWMQ@mail.gmail.com>
Date: Wed, 21 Dec 2011 16:47:18 +0100
In-Reply-To: <CA+U71=PEUpDHC76UPkSeSESfV+V7enxWwMJNWwfdbKjLTvSWMQ@mail.gmail.com>
	(Noah Lavine's message of "Mon, 19 Dec 2011 17:32:04 -0500")
Message-ID: <87pqfirkop.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Pobox-Relay-ID: 1160F6CA-2BEB-11E1-9A70-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 21 Dec 2011 15:47:32 -0000

Hi Noah,

On Mon 19 Dec 2011 23:32, Noah Lavine <noah.b.lavine@gmail.com> writes:

> I was thinking about it though, and I think there is another thing
> that is causing a lot of this "bloat": all of the Scheme modules we
> are adding.

Do you really think so?  It's more installed size, but it doesn't
affect runtime speed, runtime size, or compile-time portability.

> There is a tension here, because having lots of modules is very
> important for using Guile as a language to write programs in. But when
> it is used as an extension to other languages, most of them are not
> useful.

A point of clarification: as an extension language, Guile is meant to be
a language to extend programs, not a language to extend other languages.

> So if I were dreaming and not thinking about how hard it is to
> write code, I would get a system that lets me pick which modules I
> want to distribute and bundle them up with libguile into a package
> that can be distributed and built on its own.

It sounds more interesting to bundle up a stripped-down build product,
rather than a stripped-down source package.

YMMV of course :)

Andy
-- 
http://wingolog.org/


From MAILER-DAEMON Wed Dec 21 11:03:30 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RdOdd-0001kO-Vy
	for mharc-guile-devel@gnu.org; Wed, 21 Dec 2011 11:03:29 -0500
Received: from eggs.gnu.org ([140.186.70.92]:44444)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <spk121@yahoo.com>) id 1RdOdX-0001RW-65
	for guile-devel@gnu.org; Wed, 21 Dec 2011 11:03:27 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <spk121@yahoo.com>) id 1RdOdN-00021r-DQ
	for guile-devel@gnu.org; Wed, 21 Dec 2011 11:03:23 -0500
Received: from nm7-vm0.bullet.mail.sp2.yahoo.com ([98.139.91.192]:41473)
	by eggs.gnu.org with smtp (Exim 4.71)
	(envelope-from <spk121@yahoo.com>) id 1RdOdM-00021X-S3
	for guile-devel@gnu.org; Wed, 21 Dec 2011 11:03:13 -0500
Received: from [98.139.91.62] by nm7.bullet.mail.sp2.yahoo.com with NNFMP;
	21 Dec 2011 16:03:11 -0000
Received: from [98.139.91.41] by tm2.bullet.mail.sp2.yahoo.com with NNFMP;
	21 Dec 2011 16:03:11 -0000
Received: from [127.0.0.1] by omp1041.mail.sp2.yahoo.com with NNFMP;
	21 Dec 2011 16:03:11 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 919497.9591.bm@omp1041.mail.sp2.yahoo.com
Received: (qmail 27528 invoked by uid 60001); 21 Dec 2011 16:03:11 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024;
	t=1324483391; bh=zeQZyEpGkkamb6VTh5UjeXr5Wkn0yXqq90K5or8051Q=;
	h=X-YMail-OSG:Received:X-Mailer:References:Message-ID:Date:From:Reply-To:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
	b=HRfCCTszAIezuMCIuqnV/RfIAq1H/ge4lASzIg6Kms7lmlrS8tddqMkd1MRjj46vrXBZHP/SvnqSjL9Tq/kPBwOJMQ9jUEYE9fqAu4nsxyCA9fNG96MoK7AW5I7F18tfZvhV4+LJyWQru2O/LSMxafFhcQvTQ5yR8l6X5P3N2P0=
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws; s=s1024; d=yahoo.com;
	h=X-YMail-OSG:Received:X-Mailer:References:Message-ID:Date:From:Reply-To:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
	b=y8sL+qQmqu9YrxlPqFrZlH4SbP5LObHwifjrOwaZSjgGT8ask+1JqxnN5uagwVOJ5Kqd1GKs2S+TJCUlbiU66cf38ieHwLCTmWC0C+waCIR5nnH0EzYUU7fFl4rXJ0RU9ZBBDsgFGHnM8pAXHzfepdZAHQmW3l384f7zgISKtKE=;
X-YMail-OSG: ecRz2D4VM1nSqDEzX_CjmBMaAq0fIlM5Ii8oQ6K2BX_Tpqo
	kKd0pFWZ2u6dU8qa2ybc45sO7IzCI0IpKeO0BKdVAUfEfEGhcm5slPQoA1G8
	1asts8vkui_eevEaXIiipgumLOZf7kHcFLDhMijfb6ffnJkFZcdROkAaYf.3
	m0kCi9ygz3Z9vcYJFQMc4cqVtN7qTzLEP9R1TTOfwqccgO1SmVj9jeIPJ1fI
	tBF2y.JivL_Pu.NUw_rwxF2Nr5W74aYnJx9u6FFVAHdLAj_KPR1jjHnNYVks
	HLq9j7IsNz2km5vUVd1lK9E0MO4lCKzYczMZ0NzmqdPraoDAcy440069eXX6
	eLx.cwDy5hW90ykRIsenR_VkbUqGw7xJGvf92cEU8mKFlT2lXNBECTem58BJ
	HZP241IwVwUq92DDGedX0KkUFd235QkMedEOsCMOk9S.8SdfZ9KccFFBkr5y
	S5nJeTNxNB1.oi07CfOKC
Received: from [71.130.219.20] by web37904.mail.mud.yahoo.com via HTTP;
	Wed, 21 Dec 2011 08:03:11 PST
X-Mailer: YahooMailWebService/0.8.115.331698
References: <1324326921.17612.YahooMailNeo@web37905.mail.mud.yahoo.com>
Message-ID: <1324483391.16920.YahooMailNeo@web37904.mail.mud.yahoo.com>
Date: Wed, 21 Dec 2011 08:03:11 -0800 (PST)
From: Mike Gran <spk121@yahoo.com>
Subject: Re: Minimal Guile
To: Mike Gran <spk121@yahoo.com>, guile-devel <guile-devel@gnu.org>
In-Reply-To: <1324326921.17612.YahooMailNeo@web37905.mail.mud.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 98.139.91.192
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
Reply-To: Mike Gran <spk121@yahoo.com>
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 21 Dec 2011 16:03:27 -0000

> From: Mike Gran <spk121@yahoo.com>=0A> =0A> Hi-=0A> =0A> Re point 2: hard=
 to distribute.=0A> =A0=0A> A while ago I was looking at the idea of minimi=
zing the number of=0A> files needed to ship Guile as a dependency.=A0 At th=
e time, I thought=0A> that one could retool the build so that it produced=
=0A> - a tar.gz of the distributable header files=0A> - libguile=A0as a mon=
olithic .so or .dll with no dependencies.=0A> =A0 Dependencies would be wra=
pped into the monolithic .so or .dll.=0A> - all the compiled .go files as a=
 tar file=0A> - and a Guile executable that used both of the above=0A=0AI'm=
 replying to myself.=A0 LOL.=A0 But I agree with myself that this=0Asounds =
like a good idea to me.=0A=A0=0AI think as soon as I get a spare cycle, I'm=
 going to make an=0Aexperimental branch where all the core=A0.scm and .go f=
iles are in=0Aa single archive file that will act like a read-only filesyst=
em.=0A=A0=0AIt'll be fun to try to minimize it down to just=0Athe guile exe=
cutable, libguile-*, and a scheme archive file.=A0 And it=0Amight help with=
 distribution of prebuilt versions.=0A=A0=0ATo keep it GNU, I looked around=
 to see what library-style GNU=0Asolutions exist for treating an archive fi=
le like a filesystem.=0AOddly, no good documented (L)GPL GNU options dealin=
g with tar, cpio,=0Apax, or 'ar' in an API way.=A0 But, there is a solution=
 for .iso =0Afiles: libiso9660 from GNU libcdio.=0A=A0=0AOK?=A0 Any objecti=
ons?=0A=A0=0AThanks,=0A=A0=0AMike Gran


From MAILER-DAEMON Wed Dec 21 16:05:25 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RdTLp-0007oW-Ky
	for mharc-guile-devel@gnu.org; Wed, 21 Dec 2011 16:05:25 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59874)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RdTLn-0007nt-2F
	for guile-devel@gnu.org; Wed, 21 Dec 2011 16:05:24 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RdTLl-00047W-CX
	for guile-devel@gnu.org; Wed, 21 Dec 2011 16:05:22 -0500
Received: from a-pb-sasl-sd.pobox.com ([74.115.168.62]:63456
	helo=sasl.smtp.pobox.com) by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <wingo@pobox.com>) id 1RdTLl-00047I-62
	for guile-devel@gnu.org; Wed, 21 Dec 2011 16:05:21 -0500
Received: from sasl.smtp.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 6F61585B2;
	Wed, 21 Dec 2011 16:05:20 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; s=sasl; bh=nwHX5/ZEptWY
	euBASr7EEbsZK7g=; b=DkvBuafLMYSAyVS02FwTGX2k3+cUv+eGCxCkf+zRi4vA
	pMNWkKjaBXnNfEIs0Iy1GWBLs/ZtpS+FwjaE37bZ97Hvf6qV8yyPjjKawRwjo3Bn
	UynnVfQSyNktSlVhCuLgKyfbghVJt+3W3uQphpU6jIxCjVfhCeHws5nTcXB21iM=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type:content-transfer-encoding; q=dns; s=sasl; b=ElkHPJ
	8kGCybO57EpNs0SmFOhikA4tR5z4ey3GwtllB0KXAMyGkX3w85NiTMCx39oUHlhE
	5cDv44Ln/JSm9sxfVa6HA/iL9qRX7vnoBjokYWcroLTElNTaPhGCJiST6DCMOivf
	HcpmcsChG9UzrVEOdFDrZNgCMKDcLbnxXqfe0=
Received: from a-pb-sasl-sd.pobox.com (unknown [127.0.0.1])
	by a-pb-sasl-sd.pobox.com (Postfix) with ESMTP id 68C0B85B1;
	Wed, 21 Dec 2011 16:05:20 -0500 (EST)
Received: from badger (unknown [184.174.165.119]) (using TLSv1 with cipher
	DHE-RSA-AES256-SHA (256/256 bits)) (No client certificate requested) by
	a-pb-sasl-sd.pobox.com (Postfix) with ESMTPSA id 1AE3D85B0;
	Wed, 21 Dec 2011 16:05:20 -0500 (EST)
From: Andy Wingo <wingo@pobox.com>
To: Mike Gran <spk121@yahoo.com>
Subject: Re: Minimal Guile
References: <1324326921.17612.YahooMailNeo@web37905.mail.mud.yahoo.com>
	<1324483391.16920.YahooMailNeo@web37904.mail.mud.yahoo.com>
Date: Wed, 21 Dec 2011 16:05:17 -0500
In-Reply-To: <1324483391.16920.YahooMailNeo@web37904.mail.mud.yahoo.com>
	(Mike Gran's message of "Wed, 21 Dec 2011 08:03:11 -0800 (PST)")
Message-ID: <87aa6lskj6.fsf@pobox.com>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Pobox-Relay-ID: 7DA1453E-2C17-11E1-84FD-65B1DE995924-02397024!a-pb-sasl-sd.pobox.com
X-detected-operating-system: by eggs.gnu.org: Solaris 10 (beta)
X-Received-From: 74.115.168.62
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Wed, 21 Dec 2011 21:05:24 -0000

On Wed 21 Dec 2011 11:03, Mike Gran <spk121@yahoo.com> writes:

>> A while ago I was looking at the idea of minimizing the number of
>> files needed to ship Guile as a dependency.=C2=A0 At the time, I thought
>> that one could retool the build so that it produced
>> - a tar.gz of the distributable header files
>> - libguile=C2=A0as a monolithic .so or .dll with no dependencies.
>> =C2=A0 Dependencies would be wrapped into the monolithic .so or .dll.
>> - all the compiled .go files as a tar file
>> - and a Guile executable that used both of the above
>
> I'm replying to myself.=C2=A0 LOL.=C2=A0 But I agree with myself that this
> sounds like a good idea to me.

That's good that you're replying to yourself, because I (for one)
overlooked this part of your message.  Too much mail lately! :-)

> I think as soon as I get a spare cycle, I'm going to make an
> experimental branch where all the core=C2=A0.scm and .go files are in
> a single archive file that will act like a read-only filesystem.

Sounds like an interesting experiment.  If you find yourself getting
close to something workable, feel free to make a new branch in Guile
git.

Happy hacking,

Andy
--=20
http://wingolog.org/


From MAILER-DAEMON Wed Dec 21 20:07:05 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RdX7h-0004Hi-64
	for mharc-guile-devel@gnu.org; Wed, 21 Dec 2011 20:07:05 -0500
Received: from eggs.gnu.org ([140.186.70.92]:53717)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RdX7e-0004Hb-Bu
	for guile-devel@gnu.org; Wed, 21 Dec 2011 20:07:03 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RdX7d-00069k-4B
	for guile-devel@gnu.org; Wed, 21 Dec 2011 20:07:02 -0500
Received: from mail-tul01m020-f169.google.com ([209.85.214.169]:57272)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RdX7d-00069c-16
	for guile-devel@gnu.org; Wed, 21 Dec 2011 20:07:01 -0500
Received: by obcwo8 with SMTP id wo8so4448686obc.0
	for <guile-devel@gnu.org>; Wed, 21 Dec 2011 17:07:00 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:sender:in-reply-to:references:date
	:x-google-sender-auth:message-id:subject:from:to:cc:content-type
	:content-transfer-encoding;
	bh=kHSwD5d9joL7TcVp99Pm3pDO0w3DjmAlCmTHh9doGjs=;
	b=ZOxhYOTKv0b2CUBfMNg+aixM9T2OGNH4A9wScTs4DUZwmIBFK66yNIqA14oeDNZ1X2
	Cqyc3r/RCT2qBrGJOgmcLZac+l2Yx73obcGzTeDi9hkE6s9PabmRwqw5GjaTAf7POIcD
	mDUpSx+1i+esJN6PV5/PykI5taU68AxEZBb9w=
MIME-Version: 1.0
Received: by 10.50.108.140 with SMTP id hk12mr6378452igb.18.1324516020059;
	Wed, 21 Dec 2011 17:07:00 -0800 (PST)
Sender: noah549@gmail.com
Received: by 10.43.51.132 with HTTP; Wed, 21 Dec 2011 17:07:00 -0800 (PST)
In-Reply-To: <1324483391.16920.YahooMailNeo@web37904.mail.mud.yahoo.com>
References: <1324326921.17612.YahooMailNeo@web37905.mail.mud.yahoo.com>
	<1324483391.16920.YahooMailNeo@web37904.mail.mud.yahoo.com>
Date: Wed, 21 Dec 2011 20:07:00 -0500
X-Google-Sender-Auth: IPMcQm6mRBWOER20JtlrPnpEm6k
Message-ID: <CA+U71=O8+E7TiGiCz2B6A4VgYX03XO2zmjd5_tCaFcD5V3_-yw@mail.gmail.com>
Subject: Re: Minimal Guile
From: Noah Lavine <noah.b.lavine@gmail.com>
To: Mike Gran <spk121@yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.214.169
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 22 Dec 2011 01:07:03 -0000

Hello,

> To keep it GNU, I looked around to see what library-style GNU
> solutions exist for treating an archive file like a filesystem.
> Oddly, no good documented (L)GPL GNU options dealing with tar, cpio,
> pax, or 'ar' in an API way.=A0 But, there is a solution for .iso
> files: libiso9660 from GNU libcdio.

Emacs has the ability to look inside tar files, so there might be
something in there.

That is just a thought, though. I can think of reasons you might not
want to do it.

This project sounds very interesting. Good luck!

Noah


From MAILER-DAEMON Thu Dec 22 03:14:22 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RddnC-0002Ar-09
	for mharc-guile-devel@gnu.org; Thu, 22 Dec 2011 03:14:22 -0500
Received: from eggs.gnu.org ([140.186.70.92]:50510)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rddn6-00029c-Gw
	for guile-devel@gnu.org; Thu, 22 Dec 2011 03:14:20 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rddn0-0001m4-Dr
	for guile-devel@gnu.org; Thu, 22 Dec 2011 03:14:16 -0500
Received: from lo.gmane.org ([80.91.229.12]:50664)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rddn0-0001ly-0J
	for guile-devel@gnu.org; Thu, 22 Dec 2011 03:14:10 -0500
Received: from list by lo.gmane.org with local (Exim 4.69)
	(envelope-from <guile-devel@m.gmane.org>) id 1Rddmz-0007B7-6Y
	for guile-devel@gnu.org; Thu, 22 Dec 2011 09:14:09 +0100
Received: from p508ede06.dip.t-dialin.net ([80.142.222.6])
	by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
	id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Thu, 22 Dec 2011 09:14:09 +0100
Received: from dak by p508ede06.dip.t-dialin.net with local (Gmexim 0.1
	(Debian)) id 1AlnuQ-0007hv-00
	for <guile-devel@gnu.org>; Thu, 22 Dec 2011 09:14:09 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: guile-devel@gnu.org
From: David Kastrup <dak@gnu.org>
Subject: Re: Minimal Guile
Date: Thu, 22 Dec 2011 09:13:56 +0100
Organization: Organization?!?
Lines: 18
Message-ID: <87obv13tx7.fsf@fencepost.gnu.org>
References: <1324326921.17612.YahooMailNeo@web37905.mail.mud.yahoo.com>
	<1324483391.16920.YahooMailNeo@web37904.mail.mud.yahoo.com>
	<CA+U71=O8+E7TiGiCz2B6A4VgYX03XO2zmjd5_tCaFcD5V3_-yw@mail.gmail.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@dough.gmane.org
X-Gmane-NNTP-Posting-Host: p508ede06.dip.t-dialin.net
X-Face: 2FEFf>]>q>2iw=B6,
	xrUubRI>pR&Ml9=ao@P@i)L:\urd*t9M~y1^:+Y]'C0~{mAl`oQuAl
	\!3KEIp?*w`|bL5qr,H)LFO6Q=qx~iH4DN; i";
	/yuIsqbLLCh/!U#X[S~(5eZ41to5f%E@'ELIi$t^
	Vc\LWP@J5p^rst0+('>Er0=^1{]M9!p?&:\z]|;&=NP3AhB!B_bi^]Pfkw
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.92 (gnu/linux)
Cancel-Lock: sha1:9c0Znz5J/V2TqijnIt6S44ACLvE=
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 3)
X-Received-From: 80.91.229.12
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 22 Dec 2011 08:14:20 -0000

Noah Lavine <noah.b.lavine@gmail.com> writes:

> Hello,
>
>> To keep it GNU, I looked around to see what library-style GNU
>> solutions exist for treating an archive file like a filesystem.
>> Oddly, no good documented (L)GPL GNU options dealing with tar, cpio,
>> pax, or 'ar' in an API way. But, there is a solution for .iso
>> files: libiso9660 from GNU libcdio.
>
> Emacs has the ability to look inside tar files, so there might be
> something in there.

No, it doesn't.  It just reads the whole tar file into a buffer, and
picks out parts on demand.  Convenient, but a memory hog.

-- 
David Kastrup



From MAILER-DAEMON Fri Dec 23 10:50:30 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Re7OA-0005y6-7m
	for mharc-guile-devel@gnu.org; Fri, 23 Dec 2011 10:50:30 -0500
Received: from eggs.gnu.org ([140.186.70.92]:32916)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ianprice90@googlemail.com>) id 1Re7O7-0005x4-RG
	for guile-devel@gnu.org; Fri, 23 Dec 2011 10:50:28 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <ianprice90@googlemail.com>) id 1Re7O5-0003Dn-K7
	for guile-devel@gnu.org; Fri, 23 Dec 2011 10:50:27 -0500
Received: from mail-ww0-f49.google.com ([74.125.82.49]:49764)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <ianprice90@googlemail.com>) id 1Re7O5-0003DX-Dv
	for guile-devel@gnu.org; Fri, 23 Dec 2011 10:50:25 -0500
Received: by wgbdt11 with SMTP id dt11so14099375wgb.30
	for <guile-devel@gnu.org>; Fri, 23 Dec 2011 07:50:23 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
	d=googlemail.com; s=gamma;
	h=from:to:cc:subject:date:message-id:user-agent:mime-version
	:content-type; bh=04axPLSu+z64Bgbp+UW8T4qvPGJKmjUOETk5bWKPgmo=;
	b=QOdMabEUj2j4IycW4SYv8G5fDcbL1FfXvTLoeYEuzELlRNb4PbWECvlKk5vGOQ6DZD
	i3MKtOBpoC4yEAnhUKSAiHn/AykTmhLuJeS8vG94ypIjkW3+DheVidZyiSQOqfUYFM7x
	UMI7s08ZQ1ZEhjdEEpgwS6zN+NJ/l7LLs08us=
Received: by 10.227.199.14 with SMTP id eq14mr18514998wbb.14.1324655423209;
	Fri, 23 Dec 2011 07:50:23 -0800 (PST)
Received: from Kagami.home (host86-169-200-186.range86-169.btcentralplus.com.
	[86.169.200.186])
	by mx.google.com with ESMTPS id ez4sm1606924wbb.5.2011.12.23.07.50.20
	(version=TLSv1/SSLv3 cipher=OTHER);
	Fri, 23 Dec 2011 07:50:21 -0800 (PST)
From: Ian Price <ianprice90@googlemail.com>
To: Guile Mailing List <guile-devel@gnu.org>
Subject: Syntax Parameters documentation for guile
Date: Fri, 23 Dec 2011 15:46:19 +0000
Message-ID: <87pqff8f5g.fsf@Kagami.home>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 74.125.82.49
Cc: Eli Barzilay <eli@barzilay.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 23 Dec 2011 15:50:28 -0000


Hello guilers,
I've taken the liberty of writing documentation for the syntax
parameters that were added to master a short while back. Comments kindly
requested. It is in org mode format, as I do not know texinfo at this
moment, but I will look into that shortly. It is also missing an
example, but I have to go and buy one last Christmas present, and will
do it this evening :).

Eli,
I'd especially appreciate it if you could clear up any misconceptions I
may have, or may be unintentionally imparting on others.

* Syntax Parameters

Syntax parameters[fn:1] are a mechanism for rebinding a macro definition
within the dynamic extent of a macro expansion. It provides a
convenient solution to one of the most common types of unhygienic
macro: those that introduce a special binding each time the macro is
used. Examples include an 'if' form that binds the result of the test
to an 'it' binding, or class macros that introduce a special 'self'
binding.

With syntax parameters, instead of introducing the binding
unhygienically each time, we instead create one binding for the
keyword, which we can then adjust later when we want the keyword to
have a different meaning. As no new bindings are introduced hygiene is
preserved. This is similar to the dynamic binding mechanisms we have
at run-time like parameters[fn:2] or fluids[fn:3].

** define-syntax-parameter keyword transformer [syntax]
Binds keyword to the value obtained by evaluating transformer as a
syntax-parameter. The transformer provides the default expansion for
the syntax parameter, and in the absence of syntax-parameterize, is
functionally equivalent to define-syntax.

** syntax-parameterize ((keyword transformer) ...) exp ... [syntax]
(note, each keyword must be bound to a syntax-parameter 

Adjusts each of the keywords to use the value obtained by evaluating
their respective transformer, in the expansion of the exp forms. It
differs from let-syntax, in that the binding is not shadowed, but
adjusted, and so uses of the keyword in the expansion of exp forms use
the new transformers.

** TODO example
if it, loop escape?, class?

* Footnotes
[fn:1] Eli Barzilay, Ryan Culpepper and Matthew Flatt. Keeping it
Clean with Syntax Parameters. In Proc. Workshop on Scheme and
Functional Programming, October 2011.

[fn:2] Marc Feeley. SRFI 39: Parameter objects, 2003.
http://srfi.schemers.org/srfi-39/.

[fn:3] https://www.gnu.org/software/guile/manual/guile.html#Fluids-and-Dynamic-States

-- 
Ian Price

"Programming is like pinball. The reward for doing it well is
the opportunity to do it again" - from "The Wizardy Compiled"


From MAILER-DAEMON Sat Dec 24 07:51:07 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1ReR47-0002Yq-9z
	for mharc-guile-devel@gnu.org; Sat, 24 Dec 2011 07:51:07 -0500
Received: from eggs.gnu.org ([140.186.70.92]:46444)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <neil@ossau.homelinux.net>) id 1ReR44-0002WR-3g
	for guile-devel@gnu.org; Sat, 24 Dec 2011 07:51:05 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <neil@ossau.homelinux.net>) id 1ReR42-0007IZ-GT
	for guile-devel@gnu.org; Sat, 24 Dec 2011 07:51:03 -0500
Received: from out1.ip06ir2.opaltelecom.net ([62.24.128.242]:37100)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <neil@ossau.homelinux.net>) id 1ReR42-0007IT-C7
	for guile-devel@gnu.org; Sat, 24 Dec 2011 07:51:02 -0500
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: ApsIAN7J9U5OkRO5/2dsb2JhbAApGqsCgTeBBoIzHCMYJDQBBCUyBYd8BiO3CIh1gxoEpzY
X-IronPort-AV: E=Sophos;i="4.71,403,1320624000"; d="scan'208";a="522665882"
Received: from host-78-145-19-185.as13285.net (HELO arudy) ([78.145.19.185])
	by out1.ip06ir2.opaltelecom.net with ESMTP; 24 Dec 2011 12:51:00 +0000
Received: from neil-laptop.ossau.uklinux.net.ossau.homelinux.net
	(host-78-145-19-185.as13285.net [78.145.19.185])
	by arudy (Postfix) with ESMTPA id 1A5883803B;
	Sat, 24 Dec 2011 12:50:59 +0000 (GMT)
From: Neil Jerram <neil@ossau.homelinux.net>
To: guile-devel@gnu.org
Subject: Thread+GC issues on ARM
Date: Sat, 24 Dec 2011 12:50:57 +0000
Message-ID: <87ipl6i15a.fsf@neil-laptop.ossau.uklinux.net>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 62.24.128.242
Cc: rlb@defaultvalue.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sat, 24 Dec 2011 12:51:05 -0000

Hi there!

Just in case anyone else is looking at this too, I just wanted to
announce that I'm investigating why the Debian Guile 2.0.3 fails to pass
'make check' on ARM, as can be seen here:
https://buildd.debian.org/status/package.php?p=guile-2.0.  Now that
there's a Debian package for Guile 2.0 - thanks Rob! - I couldn't resist
trying to build it on my GTA04.

It all looks quite tractable - just complex interactions between when
Guile's thread finalizer (on_thread_exit) runs, libgc's own
finalizer/cleanup, and the fact that Guile's finalizer re-registers with
the GC.

Also I think I might be able to throw light on the longstanding
threads.test hang
(http://www.mail-archive.com/guile-devel@gnu.org/msg06007.html).  When I
hit that in GDB, there were only 3 threads known to GDB, but libgc's
thread count was 4, and that will obviously cause libgc to hang.

So, more soon, I hope.

        Neil


From MAILER-DAEMON Sat Dec 24 11:31:20 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1ReUVE-0006k1-Fl
	for mharc-guile-devel@gnu.org; Sat, 24 Dec 2011 11:31:20 -0500
Received: from eggs.gnu.org ([140.186.70.92]:60724)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <self@antono.info>) id 1ReUVA-0006e7-3v
	for guile-devel@gnu.org; Sat, 24 Dec 2011 11:31:17 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <self@antono.info>) id 1ReUV8-00018P-7d
	for guile-devel@gnu.org; Sat, 24 Dec 2011 11:31:16 -0500
Received: from ec2-50-19-243-116.compute-1.amazonaws.com
	([50.19.243.116]:34671 helo=mail.antono.info)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <self@antono.info>) id 1ReUV8-00018J-5c
	for guile-devel@gnu.org; Sat, 24 Dec 2011 11:31:14 -0500
Received: by mail.antono.info (Postfix, from userid 1003)
	id D745860F8E; Sat, 24 Dec 2011 15:54:29 +0000 (UTC)
Received: from [192.168.1.12] (unknown [178.120.90.232])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested) (Authenticated sender: antono)
	by mail.antono.info (Postfix) with ESMTPSA id 4F9EF60D76;
	Sat, 24 Dec 2011 15:54:28 +0000 (UTC)
Message-ID: <1324742064.31036.17.camel@libero>
Subject: Re: Minimal Guile
From: Antono Vasiljev <self@antono.info>
To: Mike Gran <spk121@yahoo.com>
Date: Sat, 24 Dec 2011 18:54:24 +0300
In-Reply-To: <1324483391.16920.YahooMailNeo@web37904.mail.mud.yahoo.com>
References: <1324326921.17612.YahooMailNeo@web37905.mail.mud.yahoo.com>
	<1324483391.16920.YahooMailNeo@web37904.mail.mud.yahoo.com>
Organization: Red Brigade
Content-Type: text/plain; charset="UTF-8"
X-Mailer: Evolution 3.2.2- 
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 50.19.243.116
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
Reply-To: self@antono.info
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sat, 24 Dec 2011 16:31:17 -0000

On Wed, 2011-12-21 at 08:03 -0800, Mike Gran wrote:
 
> To keep it GNU, I looked around to see what library-style GNU
> solutions exist for treating an archive file like a filesystem.
> Oddly, no good documented (L)GPL GNU options dealing with tar, cpio,
> pax, or 'ar' in an API way.  But, there is a solution for .iso 
> files: libiso9660 from GNU libcdio.

You may be interested in tool made by Alexander Larson:

http://blogs.gnome.org/alexl/2011/09/30/rethinking-the-linux-distibution/
http://people.gnome.org/~alexl/glick2/
http://git.gnome.org/browse/glick2


-- 
Antono Vasiljev <self@antono.info>
Red Brigade



From MAILER-DAEMON Sat Dec 24 23:07:23 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RefMp-0001Qn-1Z
	for mharc-guile-devel@gnu.org; Sat, 24 Dec 2011 23:07:23 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59290)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <gbenison@gmail.com>) id 1RefMl-0001Oj-21
	for guile-devel@gnu.org; Sat, 24 Dec 2011 23:07:19 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <gbenison@gmail.com>) id 1RefMj-0007hN-Nl
	for guile-devel@gnu.org; Sat, 24 Dec 2011 23:07:19 -0500
Received: from mail-ee0-f41.google.com ([74.125.83.41]:57306)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <gbenison@gmail.com>) id 1RefMj-0007hB-0Y
	for guile-devel@gnu.org; Sat, 24 Dec 2011 23:07:17 -0500
Received: by eekc41 with SMTP id c41so11015256eek.0
	for <guile-devel@gnu.org>; Sat, 24 Dec 2011 20:07:15 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:date:message-id:subject:from:to:content-type;
	bh=YhRcqGYdTlb6L28n6ftthbQ8qCgg99nYlZr5ijygtCA=;
	b=HdiD2f3m3FemLlwo81i3dIJwzH7Qk8vLPrriR9R5YQeBgBPX+qGogtaxxHUQKj2nyI
	I9MMt1/ov7NB5fckM2EqFNkPucz1m3LH9pY7vsOSmC3YRGZ3JOoR5mF00Zvea+plvGhS
	G4KyMIYbqhqrEHWXS6VD0T6h4JmistWxYm+lg=
MIME-Version: 1.0
Received: by 10.204.148.80 with SMTP id o16mr5244489bkv.93.1324786035562; Sat,
	24 Dec 2011 20:07:15 -0800 (PST)
Received: by 10.204.73.19 with HTTP; Sat, 24 Dec 2011 20:07:15 -0800 (PST)
Date: Sat, 24 Dec 2011 20:07:15 -0800
Message-ID: <CAEmW81F8Kim9nzhnugo4SZMP4wBY+Hb-sUND7HhiOVuwV+080w@mail.gmail.com>
Subject: patch: commit 5d34402: update non-text versions of figure
From: gregory benison <gbenison@gmail.com>
To: guile-devel@gnu.org
Content-Type: multipart/mixed; boundary=0015175cad9a0d9b5604b4e2c9dd
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 74.125.83.41
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sun, 25 Dec 2011 04:07:20 -0000

--0015175cad9a0d9b5604b4e2c9dd
Content-Type: text/plain; charset=ISO-8859-1

> commit 5d344028fbf8b3e764549d975b20aa20ae316aa9
> Author: Mark H Weaver <mhw@netris.org>
> Date:   Tue Mar 1 13:46:08 2011 -0500
>
>   Remove incorrect footnote from GOOPS manual
>
>   * doc/ref/goops.texi (Inheritance): Remove footnote which incorrectly
>    stated that <complex> was not shown in the class hierarchy figure.

It seems that <complex> was where it was supposed to be in the text
version of the figure (doc/ref/hierarchy.txt), but not in the other
formats (hierarchy.png, hierarchy.pdf) - so that in the pdf version of
the manual the figure does not match the manual text.

The attached patch brings the pdf and png versions of hierarchy.X in
sync with hierarchy.txt, and with the manual text.

--0015175cad9a0d9b5604b4e2c9dd
Content-Type: application/octet-stream; 
	name="0001-doc-ref-hierarchy.png-conform-to-hierarchy.txt-and-m.patch"
Content-Disposition: attachment; 
	filename="0001-doc-ref-hierarchy.png-conform-to-hierarchy.txt-and-m.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gwlj9n580

RnJvbSA1OWVjNDkwNjZhZThkZDY1ZjFlYWIzZmQwMjk2Y2E1OTYzMDZkNzhmIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBHcmVnIEJlbmlzb24gPGdiZW5pc29uQGdtYWlsLmNvbT4KRGF0
ZTogU2F0LCAyNCBEZWMgMjAxMSAxMToyNzoxMiAtMDgwMApTdWJqZWN0OiBbUEFUQ0hdIGRvYy9y
ZWYvaGllcmFyY2h5LnBuZzogY29uZm9ybSB0byBoaWVyYXJjaHkudHh0IGFuZCBtYW51YWwKCmhp
ZXJhcmNoeS5wbmcgKGFuZCAucGRmLCAuZXBzKSB3ZXJlIGNoYW5nZWQgdG8gYWRkIG9uZSBub2Rl
CnRvIHRoZSBncmFwaCwgZ2V0dGluZyB0aGVtIGluIHN5bmMgd2l0aCBoaWVyYXJjaHkudHh0Cihh
bmQgdGhlIEdPT1BTIHNlY3Rpb24gb2YgdGhlIG1hbnVhbCkuCgpBbHNvIGFkZGVkIGhpZXJhcmNo
eS5kb3QsIGEgZmlsZSB0byBnZW5lcmF0ZSBzYWlkIGZpZ3VyZQp1c2luZyBncmFwaHZpei4KLS0t
CiBkb2MvcmVmL2hpZXJhcmNoeS5kb3QgfCAgIDIxICsrCiBkb2MvcmVmL2hpZXJhcmNoeS5lcHMg
fCAgNzIyICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0K
IGRvYy9yZWYvaGllcmFyY2h5LnBkZiB8ICBCaW4gMTcyMiAtPiA3Mjg2IGJ5dGVzCiBkb2MvcmVm
L2hpZXJhcmNoeS5wbmcgfCAgQmluIDYyNTEgLT4gMTI0NjggYnl0ZXMKIDQgZmlsZXMgY2hhbmdl
ZCwgNjE5IGluc2VydGlvbnMoKyksIDEyNCBkZWxldGlvbnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDY0
NCBkb2MvcmVmL2hpZXJhcmNoeS5kb3QKCmRpZmYgLS1naXQgYS9kb2MvcmVmL2hpZXJhcmNoeS5k
b3QgYi9kb2MvcmVmL2hpZXJhcmNoeS5kb3QKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAw
MDAwMC4uZjBkOWRhZgotLS0gL2Rldi9udWxsCisrKyBiL2RvYy9yZWYvaGllcmFyY2h5LmRvdApA
QCAtMCwwICsxLDIxIEBACisvKgorICogUHJvY2VzcyB0aGlzIGZpbGUgd2l0aCBncmFwaHZpeiB0
byBwcm9kdWNlIGhpZXJhcmNoeS5bcG5nLGVwc10KKyAqIGUuZy4gZG90IGhpZXJhcmNoeS5kb3Qg
LVRwbmcgPiBoaWVyYXJjaHkucG5nCisgKi8KK2RpZ3JhcGggaGllcmFyY2h5IHsKKwlncmFwaCBb
cmFua2Rpcj0iQlQiXTsKKwlub2RlICBbc2hhcGU9Im5vbmUiXTsKKwlGIC0+IEQKKwlGIC0+IEUK
KwlEIC0+IEEKKwlFIC0+IEEKKwlEIC0+IEIKKwlFIC0+IEMKKwlBIC0+ICI8b2JqZWN0PiIKKwlC
IC0+ICI8b2JqZWN0PiIKKwlDIC0+ICI8b2JqZWN0PiIKKwkiPG9iamVjdD4iICAgIC0+ICI8dG9w
PiIKKwkiPHBhaXI+IiAgICAgIC0+ICI8dG9wPiIKKwkiPHByb2NlZHVyZT4iIC0+ICI8dG9wPiIK
KwkiPGludGVnZXI+IiAgIC0+ICI8cmVhbD4iIC0+ICI8Y29tcGxleD4iIC0+ICI8bnVtYmVyPiIg
LT4gIjx0b3A+IgorfQpkaWZmIC0tZ2l0IGEvZG9jL3JlZi9oaWVyYXJjaHkuZXBzIGIvZG9jL3Jl
Zi9oaWVyYXJjaHkuZXBzCmluZGV4IDdiMWE5ODYuLmQ5ZTg5NmMgMTAwNjQ0Ci0tLSBhL2RvYy9y
ZWYvaGllcmFyY2h5LmVwcworKysgYi9kb2MvcmVmL2hpZXJhcmNoeS5lcHMKQEAgLTEsMTI3ICsx
LDYwMSBAQAotJSFQUy1BZG9iZS0yLjAgRVBTRgotJSVUaXRsZTogL3RtcC94ZmlnLWZpZzAxNjI5
NQotJSVDcmVhdG9yOiBmaWcyZGV2Ci0lJUNyZWF0aW9uRGF0ZTogRnJpIEp1biAxMCAyMzoxODox
NiAxOTk0Ci0lJUZvcjogZWdAa2FvbGluIChFcmljayBHYWxsZXNpbykKLSUlQm91bmRpbmdCb3g6
IDAgMCAzNjEgMjE3Ci0lJVBhZ2VzOiAwCislIVBTLUFkb2JlLTMuMAorJSVDcmVhdG9yOiBncmFw
aHZpeiB2ZXJzaW9uIDIuMjYuMyAoMjAxMDAxMjYuMTYwMCkKKyUlVGl0bGU6IGhpZXJhcmNoeQor
JSVQYWdlczogKGF0ZW5kKQorJSVCb3VuZGluZ0JveDogKGF0ZW5kKQogJSVFbmRDb21tZW50cwot
LyRGMnBzRGljdCAyMDAgZGljdCBkZWYgCi0kRjJwc0RpY3QgYmVnaW4KLSRGMnBzRGljdCAvbXRy
eCBtYXRyaXggcHV0Ci0vbCB7bGluZXRvfSBiaW5kIGRlZgotL20ge21vdmV0b30gYmluZCBkZWYK
LS9zIHtzdHJva2V9IGJpbmQgZGVmCi0vbiB7bmV3cGF0aH0gYmluZCBkZWYKLS9ncyB7Z3NhdmV9
IGJpbmQgZGVmCi0vZ3Ige2dyZXN0b3JlfSBiaW5kIGRlZgotL2NscCB7Y2xvc2VwYXRofSBiaW5k
IGRlZgotL2dyYXljb2wge2R1cCBkdXAgY3VycmVudHJnYmNvbG9yIDQgLTIgcm9sbCBtdWwgNCAt
MiByb2xsIG11bAotNCAtMiByb2xsIG11bCBzZXRyZ2Jjb2xvcn0gYmluZCBkZWYKLS9jb2wtMSB7
fSBkZWYKLS9jb2wwIHswIDAgMCBzZXRyZ2Jjb2xvcn0gYmluZCBkZWYKLS9jb2wxIHswIDAgMSBz
ZXRyZ2Jjb2xvcn0gYmluZCBkZWYKLS9jb2wyIHswIDEgMCBzZXRyZ2Jjb2xvcn0gYmluZCBkZWYK
LS9jb2wzIHswIDEgMSBzZXRyZ2Jjb2xvcn0gYmluZCBkZWYKLS9jb2w0IHsxIDAgMCBzZXRyZ2Jj
b2xvcn0gYmluZCBkZWYKLS9jb2w1IHsxIDAgMSBzZXRyZ2Jjb2xvcn0gYmluZCBkZWYKLS9jb2w2
IHsxIDEgMCBzZXRyZ2Jjb2xvcn0gYmluZCBkZWYKLS9jb2w3IHsxIDEgMSBzZXRyZ2Jjb2xvcn0g
YmluZCBkZWYKLQllbmQKLS8kRjJwc0JlZ2luIHskRjJwc0RpY3QgYmVnaW4gLyRGMnBzRW50ZXJl
ZFN0YXRlIHNhdmUgZGVmfSBkZWYKLS8kRjJwc0VuZCB7JEYycHNFbnRlcmVkU3RhdGUgcmVzdG9y
ZSBlbmR9IGRlZgorc2F2ZQorJSVCZWdpblByb2xvZworL0RvdERpY3QgMjAwIGRpY3QgZGVmCitE
b3REaWN0IGJlZ2luCisKKy9zZXR1cExhdGluMSB7CittYXJrCisvRW5jb2RpbmdWZWN0b3IgMjU2
IGFycmF5IGRlZgorIEVuY29kaW5nVmVjdG9yIDAKKworSVNPTGF0aW4xRW5jb2RpbmcgMCAyNTUg
Z2V0aW50ZXJ2YWwgcHV0aW50ZXJ2YWwKK0VuY29kaW5nVmVjdG9yIDQ1IC9oeXBoZW4gcHV0CisK
KyUgU2V0IHVwIElTTyBMYXRpbiAxIGNoYXJhY3RlciBlbmNvZGluZworL3N0YXJuZXRJU08gewor
ICAgICAgICBkdXAgZHVwIGZpbmRmb250IGR1cCBsZW5ndGggZGljdCBiZWdpbgorICAgICAgICB7
IDEgaW5kZXggL0ZJRCBuZSB7IGRlZiB9eyBwb3AgcG9wIH0gaWZlbHNlCisgICAgICAgIH0gZm9y
YWxsCisgICAgICAgIC9FbmNvZGluZyBFbmNvZGluZ1ZlY3RvciBkZWYKKyAgICAgICAgY3VycmVu
dGRpY3QgZW5kIGRlZmluZWZvbnQKK30gZGVmCisvVGltZXMtUm9tYW4gc3Rhcm5ldElTTyBkZWYK
Ky9UaW1lcy1JdGFsaWMgc3Rhcm5ldElTTyBkZWYKKy9UaW1lcy1Cb2xkIHN0YXJuZXRJU08gZGVm
CisvVGltZXMtQm9sZEl0YWxpYyBzdGFybmV0SVNPIGRlZgorL0hlbHZldGljYSBzdGFybmV0SVNP
IGRlZgorL0hlbHZldGljYS1PYmxpcXVlIHN0YXJuZXRJU08gZGVmCisvSGVsdmV0aWNhLUJvbGQg
c3Rhcm5ldElTTyBkZWYKKy9IZWx2ZXRpY2EtQm9sZE9ibGlxdWUgc3Rhcm5ldElTTyBkZWYKKy9D
b3VyaWVyIHN0YXJuZXRJU08gZGVmCisvQ291cmllci1PYmxpcXVlIHN0YXJuZXRJU08gZGVmCisv
Q291cmllci1Cb2xkIHN0YXJuZXRJU08gZGVmCisvQ291cmllci1Cb2xkT2JsaXF1ZSBzdGFybmV0
SVNPIGRlZgorY2xlYXJ0b21hcmsKK30gYmluZCBkZWYKKworJSVCZWdpblJlc291cmNlOiBwcm9j
c2V0IGdyYXBodml6IDAgMAorL2Nvb3JkLWZvbnQtZmFtaWx5IC9UaW1lcy1Sb21hbiBkZWYKKy9k
ZWZhdWx0LWZvbnQtZmFtaWx5IC9UaW1lcy1Sb21hbiBkZWYKKy9jb29yZGZvbnQgY29vcmQtZm9u
dC1mYW1pbHkgZmluZGZvbnQgOCBzY2FsZWZvbnQgZGVmCisKKy9JbnZTY2FsZUZhY3RvciAxLjAg
ZGVmCisvc2V0X3NjYWxlIHsKKyAgICAgICBkdXAgMSBleGNoIGRpdiAvSW52U2NhbGVGYWN0b3Ig
ZXhjaCBkZWYKKyAgICAgICBzY2FsZQorfSBiaW5kIGRlZgorCislIHN0eWxlcworL3NvbGlkIHsg
W10gMCBzZXRkYXNoIH0gYmluZCBkZWYKKy9kYXNoZWQgeyBbOSBJbnZTY2FsZUZhY3RvciBtdWwg
ZHVwIF0gMCBzZXRkYXNoIH0gYmluZCBkZWYKKy9kb3R0ZWQgeyBbMSBJbnZTY2FsZUZhY3RvciBt
dWwgNiBJbnZTY2FsZUZhY3RvciBtdWxdIDAgc2V0ZGFzaCB9IGJpbmQgZGVmCisvaW52aXMgey9m
aWxsIHtuZXdwYXRofSBkZWYgL3N0cm9rZSB7bmV3cGF0aH0gZGVmIC9zaG93IHtwb3AgbmV3cGF0
aH0gZGVmfSBiaW5kIGRlZgorL2JvbGQgeyAyIHNldGxpbmV3aWR0aCB9IGJpbmQgZGVmCisvZmls
bGVkIHsgfSBiaW5kIGRlZgorL3VuZmlsbGVkIHsgfSBiaW5kIGRlZgorL3JvdW5kZWQgeyB9IGJp
bmQgZGVmCisvZGlhZ29uYWxzIHsgfSBiaW5kIGRlZgorCislIGhvb2tzIGZvciBzZXR0aW5nIGNv
bG9yIAorL25vZGVjb2xvciB7IHNldGhzYmNvbG9yIH0gYmluZCBkZWYKKy9lZGdlY29sb3IgeyBz
ZXRoc2Jjb2xvciB9IGJpbmQgZGVmCisvZ3JhcGhjb2xvciB7IHNldGhzYmNvbG9yIH0gYmluZCBk
ZWYKKy9ub3Bjb2xvciB7cG9wIHBvcCBwb3B9IGJpbmQgZGVmCisKKy9iZWdpbnBhZ2UgewklIGkg
aiBucGFnZXMKKwkvbnBhZ2VzIGV4Y2ggZGVmCisJL2ogZXhjaCBkZWYKKwkvaSBleGNoIGRlZgor
CS9zdHIgMTAgc3RyaW5nIGRlZgorCW5wYWdlcyAxIGd0IHsKKwkJZ3NhdmUKKwkJCWNvb3JkZm9u
dCBzZXRmb250CisJCQkwIDAgbW92ZXRvCisJCQkoXCgpIHNob3cgaSBzdHIgY3ZzIHNob3cgKCwp
IHNob3cgaiBzdHIgY3ZzIHNob3cgKFwpKSBzaG93CisJCWdyZXN0b3JlCisJfSBpZgorfSBiaW5k
IGRlZgorCisvc2V0X2ZvbnQgeworCWZpbmRmb250IGV4Y2gKKwlzY2FsZWZvbnQgc2V0Zm9udAor
fSBkZWYKKworJSBkcmF3IHRleHQgZml0dGVkIHRvIGl0cyBleHBlY3RlZCB3aWR0aAorL2FsaWdu
ZWR0ZXh0IHsJCQklIHdpZHRoIHRleHQKKwkvdGV4dCBleGNoIGRlZgorCS93aWR0aCBleGNoIGRl
ZgorCWdzYXZlCisJCXdpZHRoIDAgZ3QgeworCQkJW10gMCBzZXRkYXNoCisJCQl0ZXh0IHN0cmlu
Z3dpZHRoIHBvcCB3aWR0aCBleGNoIHN1YiB0ZXh0IGxlbmd0aCBkaXYgMCB0ZXh0IGFzaG93CisJ
CX0gaWYKKwlncmVzdG9yZQorfSBkZWYKKworL2JveHByaW0gewkJCQklIHhjb3JuZXIgeWNvcm5l
ciB4c2l6ZSB5c2l6ZQorCQk0IDIgcm9sbAorCQltb3ZldG8KKwkJMiBjb3B5CisJCWV4Y2ggMCBy
bGluZXRvCisJCTAgZXhjaCBybGluZXRvCisJCXBvcCBuZWcgMCBybGluZXRvCisJCWNsb3NlcGF0
aAorfSBiaW5kIGRlZgorCisvZWxsaXBzZV9wYXRoIHsKKwkvcnkgZXhjaCBkZWYKKwkvcnggZXhj
aCBkZWYKKwkveSBleGNoIGRlZgorCS94IGV4Y2ggZGVmCisJbWF0cml4IGN1cnJlbnRtYXRyaXgK
KwluZXdwYXRoCisJeCB5IHRyYW5zbGF0ZQorCXJ4IHJ5IHNjYWxlCisJMCAwIDEgMCAzNjAgYXJj
CisJc2V0bWF0cml4Cit9IGJpbmQgZGVmCisKKy9lbmRwYWdlIHsgc2hvd3BhZ2UgfSBiaW5kIGRl
ZgorL3Nob3dwYWdlIHsgfSBkZWYKKworL2xheWVyY29sb3JzZXEKKwlbCSUgbGF5ZXIgY29sb3Ig
c2VxdWVuY2UgLSBkYXJrZXN0IHRvIGxpZ2h0ZXN0CisJCVswIDAgMF0KKwkJWy4yIC44IC44XQor
CQlbLjQgLjggLjhdCisJCVsuNiAuOCAuOF0KKwkJWy44IC44IC44XQorCV0KK2RlZgorCisvbGF5
ZXJsZW4gbGF5ZXJjb2xvcnNlcSBsZW5ndGggZGVmCisKKy9zZXRsYXllciB7L21heGxheWVyIGV4
Y2ggZGVmIC9jdXJsYXllciBleGNoIGRlZgorCWxheWVyY29sb3JzZXEgY3VybGF5ZXIgMSBzdWIg
bGF5ZXJsZW4gbW9kIGdldAorCWFsb2FkIHBvcCBzZXRoc2Jjb2xvcgorCS9ub2RlY29sb3Ige25v
cGNvbG9yfSBkZWYKKwkvZWRnZWNvbG9yIHtub3Bjb2xvcn0gZGVmCisJL2dyYXBoY29sb3Ige25v
cGNvbG9yfSBkZWYKK30gYmluZCBkZWYKKworL29ubGF5ZXIgeyBjdXJsYXllciBuZSB7aW52aXN9
IGlmIH0gZGVmCisKKy9vbmxheWVycyB7CisJL215dXBwZXIgZXhjaCBkZWYKKwkvbXlsb3dlciBl
eGNoIGRlZgorCWN1cmxheWVyIG15bG93ZXIgbHQKKwljdXJsYXllciBteXVwcGVyIGd0CisJb3IK
Kwl7aW52aXN9IGlmCit9IGRlZgorCisvY3VybGF5ZXIgMCBkZWYKKworJSVFbmRSZXNvdXJjZQog
JSVFbmRQcm9sb2cKKyUlQmVnaW5TZXR1cAorMTQgZGVmYXVsdC1mb250LWZhbWlseSBzZXRfZm9u
dAorMSBzZXRtaXRlcmxpbWl0CislIC9hcnJvd2xlbmd0aCAxMCBkZWYKKyUgL2Fycm93d2lkdGgg
NSBkZWYKKworJSBtYWtlIHN1cmUgcGRmbWFyayBpcyBoYXJtbGVzcyBmb3IgUFMtaW50ZXJwcmV0
ZXJzIG90aGVyIHRoYW4gRGlzdGlsbGVyCisvcGRmbWFyayB3aGVyZSB7cG9wfSB7dXNlcmRpY3Qg
L3BkZm1hcmsgL2NsZWFydG9tYXJrIGxvYWQgcHV0fSBpZmVsc2UKKyUgbWFrZSAnPDwnIGFuZCAn
Pj4nIHNhZmUgb24gUFMgTGV2ZWwgMSBkZXZpY2VzCisvbGFuZ3VhZ2VsZXZlbCB3aGVyZSB7cG9w
IGxhbmd1YWdlbGV2ZWx9ezF9IGlmZWxzZQorMiBsdCB7CisgICAgdXNlcmRpY3QgKDw8KSBjdm4g
KFspIGN2biBsb2FkIHB1dAorICAgIHVzZXJkaWN0ICg+PikgY3ZuIChbKSBjdm4gbG9hZCBwdXQK
K30gaWYKIAotJEYycHNCZWdpbgotMCBzZXRsaW5lY2FwIDAgc2V0bGluZWpvaW4KLS0yMTYuMCAy
ODguMCB0cmFuc2xhdGUgMC45MDAgLTAuOTAwIHNjYWxlCi0wLjUwMCBzZXRsaW5ld2lkdGgKLW4g
MzA5IDE1OSBtIDMwOSAxNTkgbCBncyBjb2wtMSBzIGdyCi1uIDI0Ni40MDEgMjE2Ljg4OSBtIDI0
NC4wMDAgMjA5LjAwMCBsIDI0OS44MzEgMjE0LjgzMSBsIGdzIDIgc2V0bGluZWpvaW4gY29sLTEg
cyBncgotJSBQb2x5bGluZQotbiAyNDQgMjA5IG0gMjc0IDI1OSBsIGdzIGNvbC0xIHMgZ3IKLW4g
Mjk4LjE2OSAyMTQuODMxIG0gMzA0LjAwMCAyMDkuMDAwIGwgMzAxLjU5OSAyMTYuODg5IGwgZ3Mg
MiBzZXRsaW5lam9pbiBjb2wtMSBzIGdyCi0lIFBvbHlsaW5lCi1uIDMwNCAyMDkgbSAyNzQgMjU5
IGwgZ3MgY29sLTEgcyBncgotbiAyNTUuNzIxIDIxMy43NzggbSAyNDkuMDAwIDIwOS4wMDAgbCAy
NTcuMTc5IDIxMC4wNTMgbCBncyAyIHNldGxpbmVqb2luIGNvbC0xIHMgZ3IKLSUgUG9seWxpbmUK
LW4gMjQ5IDIwOSBtIDM2NCAyNTQgbCBncyBjb2wtMSBzIGdyCi1uIDM3MC4zMTIgMjE2LjM3NiBt
IDM3NC4wMDAgMjA5LjAwMCBsIDM3NC4yMTcgMjE3LjI0MyBsIGdzIDIgc2V0bGluZWpvaW4gY29s
LTEgcyBncgotJSBQb2x5bGluZQotbiAzNzQgMjA5IG0gMzY0IDI1NCBsIGdzIGNvbC0xIHMgZ3IK
LW4gMjgzLjc3MiAyODAuNzI1IG0gMjc5LjAwMCAyNzQuMDAwIGwgMjg2LjM3NiAyNzcuNjg4IGwg
Z3MgMiBzZXRsaW5lam9pbiBjb2wtMSBzIGdyCi0lIFBvbHlsaW5lCi1uIDI3OSAyNzQgbSAzMTQg
MzA0IGwgZ3MgY29sLTEgcyBncgotbiAzNTEuNDU3IDI3Mi4zMzMgbSAzNTkuMDAwIDI2OS4wMDAg
bCAzNTMuOTEzIDI3NS40OTAgbCBncyAyIHNldGxpbmVqb2luIGNvbC0xIHMgZ3IKLSUgUG9seWxp
bmUKLW4gMzU5IDI2OSBtIDMxNCAzMDQgbCBncyBjb2wtMSBzIGdyCi1uIDMwMC45NTAgMTY1Ljc4
OSBtIDMwOS4wMDAgMTY0LjAwMCBsIDMwMi43MzkgMTY5LjM2NyBsIGdzIDIgc2V0bGluZWpvaW4g
Y29sLTEgcyBncgotJSBQb2x5bGluZQotbiAzMDkgMTY0IG0gMjQ5IDE5NCBsIGdzIGNvbC0xIHMg
Z3IKLW4gMzA3LjAwMCAxNzIuMDAwIG0gMzA5LjAwMCAxNjQuMDAwIGwgMzExLjAwMCAxNzIuMDAw
IGwgZ3MgMiBzZXRsaW5lam9pbiBjb2wtMSBzIGdyCi0lIFBvbHlsaW5lCi1uIDMwOSAxNjQgbSAz
MDkgMTk5IGwgZ3MgY29sLTEgcyBncgotbiAzMTUuMjYxIDE2OS4zNjcgbSAzMDkuMDAwIDE2NC4w
MDAgbCAzMTcuMDUwIDE2NS43ODkgbCBncyAyIHNldGxpbmVqb2luIGNvbC0xIHMgZ3IKLSUgUG9s
eWxpbmUKLW4gMzA5IDE2NCBtIDM3OSAxOTkgbCBncyBjb2wtMSBzIGdyCi1uIDQwNi45NDkgMTAx
LjcwMSBtIDQwNC4wMDAgOTQuMDAwIGwgNDEwLjIyNiA5OS40MDcgbCBncyAyIHNldGxpbmVqb2lu
IGNvbC0xIHMgZ3IKLSUgUG9seWxpbmUKLW4gNDA0IDk0IG0gNDM5IDE0NCBsIGdzIGNvbC0xIHMg
Z3IKLW4gNDEwLjM2MyA5OS4yNDUgbSA0MDQuMDAwIDk0LjAwMCBsIDQxMi4wODMgOTUuNjM0IGwg
Z3MgMiBzZXRsaW5lam9pbiBjb2wtMSBzIGdyCi0lIFBvbHlsaW5lCi1uIDQwNCA5NCBtIDUwOSAx
NDQgbCBncyBjb2wtMSBzIGdyCi1uIDQxMS4xNzMgOTguMDY4IG0gNDA0LjAwMCA5NC4wMDAgbCA0
MTIuMjQzIDk0LjIxNCBsIGdzIDIgc2V0bGluZWpvaW4gY29sLTEgcyBncgotJSBQb2x5bGluZQot
biA0MDQgOTQgbSA1ODQgMTQ0IGwgZ3MgY29sLTEgcyBncgotbiAzOTYuMDc1IDk2LjI3NyBtIDQw
NC4wMDAgOTQuMDAwIGwgMzk4LjA3OSA5OS43MzkgbCBncyAyIHNldGxpbmVqb2luIGNvbC0xIHMg
Z3IKLSUgUG9seWxpbmUKLW4gNDA0IDk0IG0gMzA5IDE0OSBsIGdzIGNvbC0xIHMgZ3IKLSUgUG9s
eWxpbmUKLW4gNTg0IDIyOSBtIDU4NCAyMDQgbCBncyBjb2wtMSBzIGdyCi1uIDU4Mi4wMDAgMjEy
LjAwMCBtIDU4NC4wMDAgMjA0LjAwMCBsIDU4Ni4wMDAgMjEyLjAwMCBsIGdzIDIgc2V0bGluZWpv
aW4gY29sLTEgcyBncgotJSBQb2x5bGluZQotbiA1ODQgMTg5IG0gNTg0IDE1OSBsIGdzIGNvbC0x
IHMgZ3IKLW4gNTgyLjAwMCAxNjcuMDAwIG0gNTg0LjAwMCAxNTkuMDAwIGwgNTg2LjAwMCAxNjcu
MDAwIGwgZ3MgMiBzZXRsaW5lam9pbiBjb2wtMSBzIGdyCi0vVGltZXMtQm9sZCBmaW5kZm9udCAx
Mi4wMCBzY2FsZWZvbnQgc2V0Zm9udAotMjM5IDIwOSBtIAotZ3MgMSAtMSBzY2FsZSAoQSkgY29s
LTEgc2hvdyBncgotL1RpbWVzLUJvbGQgZmluZGZvbnQgMTIuMDAgc2NhbGVmb250IHNldGZvbnQK
LTI3NCAyNzQgbSAKLWdzIDEgLTEgc2NhbGUgKEQpIGNvbC0xIHNob3cgZ3IKLS9UaW1lcy1Cb2xk
IGZpbmRmb250IDEyLjAwIHNjYWxlZm9udCBzZXRmb250Ci0zNTkgMjY5IG0gCi1ncyAxIC0xIHNj
YWxlIChFKSBjb2wtMSBzaG93IGdyCi0vVGltZXMtQm9sZCBmaW5kZm9udCAxMi4wMCBzY2FsZWZv
bnQgc2V0Zm9udAotMzA0IDIwOSBtIAotZ3MgMSAtMSBzY2FsZSAoQikgY29sLTEgc2hvdyBncgot
L1RpbWVzLUJvbGQgZmluZGZvbnQgMTIuMDAgc2NhbGVmb250IHNldGZvbnQKLTM3NCAyMDkgbSAK
LWdzIDEgLTEgc2NhbGUgKEMpIGNvbC0xIHNob3cgZ3IKLS9UaW1lcy1Cb2xkIGZpbmRmb250IDEy
LjAwIHNjYWxlZm9udCBzZXRmb250Ci0zMTQgMzE5IG0gCi1ncyAxIC0xIHNjYWxlIChGKSBjb2wt
MSBzaG93IGdyCi0vVGltZXMtQm9sZCBmaW5kZm9udCAxMi4wMCBzY2FsZWZvbnQgc2V0Zm9udAot
Mjg5IDE1OSBtIAotZ3MgMSAtMSBzY2FsZSAoPG9iamVjdD4pIGNvbC0xIHNob3cgZ3IKLS9UaW1l
cy1Cb2xkIGZpbmRmb250IDEyLjAwIHNjYWxlZm9udCBzZXRmb250Ci0zODkgODkgbSAKLWdzIDEg
LTEgc2NhbGUgKDx0b3A+KSBjb2wtMSBzaG93IGdyCi0vVGltZXMtQm9sZCBmaW5kZm9udCAxMi4w
MCBzY2FsZWZvbnQgc2V0Zm9udAotNDI0IDE1NCBtIAotZ3MgMSAtMSBzY2FsZSAoPHBhaXI+KSBj
b2wtMSBzaG93IGdyCi0vVGltZXMtQm9sZCBmaW5kZm9udCAxMi4wMCBzY2FsZWZvbnQgc2V0Zm9u
dAotNDc0IDE1NCBtIAotZ3MgMSAtMSBzY2FsZSAoPHByb2NlZHVyZT4pIGNvbC0xIHNob3cgZ3IK
LS9UaW1lcy1Cb2xkIGZpbmRmb250IDEyLjAwIHNjYWxlZm9udCBzZXRmb250Ci01NTkgMTU0IG0g
Ci1ncyAxIC0xIHNjYWxlICg8bnVtYmVyPikgY29sLTEgc2hvdyBncgotL1RpbWVzLUJvbGQgZmlu
ZGZvbnQgMTIuMDAgc2NhbGVmb250IHNldGZvbnQKLTYyOSAxNTQgbSAKLWdzIDEgLTEgc2NhbGUg
KC4uLikgY29sLTEgc2hvdyBncgotL1RpbWVzLUJvbGQgZmluZGZvbnQgMTIuMDAgc2NhbGVmb250
IHNldGZvbnQKLTU2OSAxOTkgbSAKLWdzIDEgLTEgc2NhbGUgKDxyZWFsPikgY29sLTEgc2hvdyBn
cgotL1RpbWVzLUJvbGQgZmluZGZvbnQgMTIuMDAgc2NhbGVmb250IHNldGZvbnQKLTU1OSAyMzkg
bSAKLWdzIDEgLTEgc2NhbGUgKDxpbnRlZ2VyPikgY29sLTEgc2hvdyBncgotJEYycHNFbmQKKyUl
RW5kU2V0dXAKK3NldHVwTGF0aW4xCislJVBhZ2U6IDEgMQorJSVQYWdlQm91bmRpbmdCb3g6IDM2
IDM2IDQ1MiAzNjgKKyUlUGFnZU9yaWVudGF0aW9uOiBQb3J0cmFpdAorMCAwIDEgYmVnaW5wYWdl
Citnc2F2ZQorMzYgMzYgNDE2IDMzMiBib3hwcmltIGNsaXAgbmV3cGF0aAorMSAxIHNldF9zY2Fs
ZSAwIHJvdGF0ZSA0MCA0MSB0cmFuc2xhdGUKKyUgRgorZ3NhdmUKKzAgMCAwIG5vZGVjb2xvcgor
MTQgL1RpbWVzLVJvbWFuIHNldF9mb250Cis5NC41IDEzLjQgbW92ZXRvIDkgKEYpIGFsaWduZWR0
ZXh0CitncmVzdG9yZQorJSBECitnc2F2ZQorMCAwIDAgbm9kZWNvbG9yCisxNCAvVGltZXMtUm9t
YW4gc2V0X2ZvbnQKKzU3LjUgODUuNCBtb3ZldG8gMTEgKEQpIGFsaWduZWR0ZXh0CitncmVzdG9y
ZQorJSBGLT5ECitnc2F2ZQorMSBzZXRsaW5ld2lkdGgKKzAgMCAwIGVkZ2Vjb2xvcgorbmV3cGF0
aCA4OS45MiAzNi4xNyBtb3ZldG8KKzg1Ljk0IDQ0LjEyIDgxLjE4IDUzLjYzIDc2Ljc5IDYyLjQz
IGN1cnZldG8KK3N0cm9rZQorMCAwIDAgZWRnZWNvbG9yCituZXdwYXRoIDczLjU1IDYxLjA4IG1v
dmV0bworNzIuMjEgNzEuNTkgbGluZXRvCis3OS44MSA2NC4yMSBsaW5ldG8KK2Nsb3NlcGF0aCBm
aWxsCisxIHNldGxpbmV3aWR0aAorc29saWQKKzAgMCAwIGVkZ2Vjb2xvcgorbmV3cGF0aCA3My41
NSA2MS4wOCBtb3ZldG8KKzcyLjIxIDcxLjU5IGxpbmV0bworNzkuODEgNjQuMjEgbGluZXRvCitj
bG9zZXBhdGggc3Ryb2tlCitncmVzdG9yZQorJSBFCitnc2F2ZQorMCAwIDAgbm9kZWNvbG9yCisx
NCAvVGltZXMtUm9tYW4gc2V0X2ZvbnQKKzEzMCA4NS40IG1vdmV0byAxMCAoRSkgYWxpZ25lZHRl
eHQKK2dyZXN0b3JlCislIEYtPkUKK2dzYXZlCisxIHNldGxpbmV3aWR0aAorMCAwIDAgZWRnZWNv
bG9yCituZXdwYXRoIDEwOC4wOCAzNi4xNyBtb3ZldG8KKzExMi4wNiA0NC4xMiAxMTYuODIgNTMu
NjMgMTIxLjIxIDYyLjQzIGN1cnZldG8KK3N0cm9rZQorMCAwIDAgZWRnZWNvbG9yCituZXdwYXRo
IDExOC4xOSA2NC4yMSBtb3ZldG8KKzEyNS43OSA3MS41OSBsaW5ldG8KKzEyNC40NSA2MS4wOCBs
aW5ldG8KK2Nsb3NlcGF0aCBmaWxsCisxIHNldGxpbmV3aWR0aAorc29saWQKKzAgMCAwIGVkZ2Vj
b2xvcgorbmV3cGF0aCAxMTguMTkgNjQuMjEgbW92ZXRvCisxMjUuNzkgNzEuNTkgbGluZXRvCisx
MjQuNDUgNjEuMDggbGluZXRvCitjbG9zZXBhdGggc3Ryb2tlCitncmVzdG9yZQorJSBBCitnc2F2
ZQorMCAwIDAgbm9kZWNvbG9yCisxNCAvVGltZXMtUm9tYW4gc2V0X2ZvbnQKKzkzLjUgMTU3LjQg
bW92ZXRvIDExIChBKSBhbGlnbmVkdGV4dAorZ3Jlc3RvcmUKKyUgRC0+QQorZ3NhdmUKKzEgc2V0
bGluZXdpZHRoCiswIDAgMCBlZGdlY29sb3IKK25ld3BhdGggNzIuMDggMTA4LjE3IG1vdmV0bwor
NzYuMDYgMTE2LjEyIDgwLjgyIDEyNS42MyA4NS4yMSAxMzQuNDMgY3VydmV0bworc3Ryb2tlCisw
IDAgMCBlZGdlY29sb3IKK25ld3BhdGggODIuMTkgMTM2LjIxIG1vdmV0bworODkuNzkgMTQzLjU5
IGxpbmV0bworODguNDUgMTMzLjA4IGxpbmV0bworY2xvc2VwYXRoIGZpbGwKKzEgc2V0bGluZXdp
ZHRoCitzb2xpZAorMCAwIDAgZWRnZWNvbG9yCituZXdwYXRoIDgyLjE5IDEzNi4yMSBtb3ZldG8K
Kzg5Ljc5IDE0My41OSBsaW5ldG8KKzg4LjQ1IDEzMy4wOCBsaW5ldG8KK2Nsb3NlcGF0aCBzdHJv
a2UKK2dyZXN0b3JlCislIEIKK2dzYXZlCiswIDAgMCBub2RlY29sb3IKKzE0IC9UaW1lcy1Sb21h
biBzZXRfZm9udAorMjIgMTU3LjQgbW92ZXRvIDEwIChCKSBhbGlnbmVkdGV4dAorZ3Jlc3RvcmUK
KyUgRC0+QgorZ3NhdmUKKzEgc2V0bGluZXdpZHRoCiswIDAgMCBlZGdlY29sb3IKK25ld3BhdGgg
NTMuOTIgMTA4LjE3IG1vdmV0bworNDkuOTQgMTE2LjEyIDQ1LjE4IDEyNS42MyA0MC43OSAxMzQu
NDMgY3VydmV0bworc3Ryb2tlCiswIDAgMCBlZGdlY29sb3IKK25ld3BhdGggMzcuNTUgMTMzLjA4
IG1vdmV0bworMzYuMjEgMTQzLjU5IGxpbmV0bworNDMuODEgMTM2LjIxIGxpbmV0bworY2xvc2Vw
YXRoIGZpbGwKKzEgc2V0bGluZXdpZHRoCitzb2xpZAorMCAwIDAgZWRnZWNvbG9yCituZXdwYXRo
IDM3LjU1IDEzMy4wOCBtb3ZldG8KKzM2LjIxIDE0My41OSBsaW5ldG8KKzQzLjgxIDEzNi4yMSBs
aW5ldG8KK2Nsb3NlcGF0aCBzdHJva2UKK2dyZXN0b3JlCislIEUtPkEKK2dzYXZlCisxIHNldGxp
bmV3aWR0aAorMCAwIDAgZWRnZWNvbG9yCituZXdwYXRoIDEyNS45MiAxMDguMTcgbW92ZXRvCisx
MjEuOTQgMTE2LjEyIDExNy4xOCAxMjUuNjMgMTEyLjc5IDEzNC40MyBjdXJ2ZXRvCitzdHJva2UK
KzAgMCAwIGVkZ2Vjb2xvcgorbmV3cGF0aCAxMDkuNTUgMTMzLjA4IG1vdmV0bworMTA4LjIxIDE0
My41OSBsaW5ldG8KKzExNS44MSAxMzYuMjEgbGluZXRvCitjbG9zZXBhdGggZmlsbAorMSBzZXRs
aW5ld2lkdGgKK3NvbGlkCiswIDAgMCBlZGdlY29sb3IKK25ld3BhdGggMTA5LjU1IDEzMy4wOCBt
b3ZldG8KKzEwOC4yMSAxNDMuNTkgbGluZXRvCisxMTUuODEgMTM2LjIxIGxpbmV0bworY2xvc2Vw
YXRoIHN0cm9rZQorZ3Jlc3RvcmUKKyUgQworZ3NhdmUKKzAgMCAwIG5vZGVjb2xvcgorMTQgL1Rp
bWVzLVJvbWFuIHNldF9mb250CisxNjYgMTU3LjQgbW92ZXRvIDEwIChDKSBhbGlnbmVkdGV4dAor
Z3Jlc3RvcmUKKyUgRS0+QworZ3NhdmUKKzEgc2V0bGluZXdpZHRoCiswIDAgMCBlZGdlY29sb3IK
K25ld3BhdGggMTQ0LjA4IDEwOC4xNyBtb3ZldG8KKzE0OC4wNiAxMTYuMTIgMTUyLjgyIDEyNS42
MyAxNTcuMjEgMTM0LjQzIGN1cnZldG8KK3N0cm9rZQorMCAwIDAgZWRnZWNvbG9yCituZXdwYXRo
IDE1NC4xOSAxMzYuMjEgbW92ZXRvCisxNjEuNzkgMTQzLjU5IGxpbmV0bworMTYwLjQ1IDEzMy4w
OCBsaW5ldG8KK2Nsb3NlcGF0aCBmaWxsCisxIHNldGxpbmV3aWR0aAorc29saWQKKzAgMCAwIGVk
Z2Vjb2xvcgorbmV3cGF0aCAxNTQuMTkgMTM2LjIxIG1vdmV0bworMTYxLjc5IDE0My41OSBsaW5l
dG8KKzE2MC40NSAxMzMuMDggbGluZXRvCitjbG9zZXBhdGggc3Ryb2tlCitncmVzdG9yZQorJSA8
b2JqZWN0PgorZ3NhdmUKKzAgMCAwIG5vZGVjb2xvcgorMTQgL1RpbWVzLVJvbWFuIHNldF9mb250
Cis3My41IDIyOS40IG1vdmV0byA1MSAoPG9iamVjdD4pIGFsaWduZWR0ZXh0CitncmVzdG9yZQor
JSBBLT48b2JqZWN0PgorZ3NhdmUKKzEgc2V0bGluZXdpZHRoCiswIDAgMCBlZGdlY29sb3IKK25l
d3BhdGggOTkgMTgwLjE3IG1vdmV0bworOTkgMTg3Ljg3IDk5IDE5Ny4wMyA5OSAyMDUuNTggY3Vy
dmV0bworc3Ryb2tlCiswIDAgMCBlZGdlY29sb3IKK25ld3BhdGggOTUuNSAyMDUuNTkgbW92ZXRv
Cis5OSAyMTUuNTkgbGluZXRvCisxMDIuNSAyMDUuNTkgbGluZXRvCitjbG9zZXBhdGggZmlsbAor
MSBzZXRsaW5ld2lkdGgKK3NvbGlkCiswIDAgMCBlZGdlY29sb3IKK25ld3BhdGggOTUuNSAyMDUu
NTkgbW92ZXRvCis5OSAyMTUuNTkgbGluZXRvCisxMDIuNSAyMDUuNTkgbGluZXRvCitjbG9zZXBh
dGggc3Ryb2tlCitncmVzdG9yZQorJSBCLT48b2JqZWN0PgorZ3NhdmUKKzEgc2V0bGluZXdpZHRo
CiswIDAgMCBlZGdlY29sb3IKK25ld3BhdGggNDUuMTcgMTgwLjE3IG1vdmV0bworNTMuNzIgMTg4
LjcyIDY0LjA2IDE5OS4wNiA3My4zOCAyMDguMzggY3VydmV0bworc3Ryb2tlCiswIDAgMCBlZGdl
Y29sb3IKK25ld3BhdGggNzEuMDQgMjEwLjk5IG1vdmV0bworODAuNTkgMjE1LjU5IGxpbmV0bwor
NzUuOTkgMjA2LjA0IGxpbmV0bworY2xvc2VwYXRoIGZpbGwKKzEgc2V0bGluZXdpZHRoCitzb2xp
ZAorMCAwIDAgZWRnZWNvbG9yCituZXdwYXRoIDcxLjA0IDIxMC45OSBtb3ZldG8KKzgwLjU5IDIx
NS41OSBsaW5ldG8KKzc1Ljk5IDIwNi4wNCBsaW5ldG8KK2Nsb3NlcGF0aCBzdHJva2UKK2dyZXN0
b3JlCislIEMtPjxvYmplY3Q+Citnc2F2ZQorMSBzZXRsaW5ld2lkdGgKKzAgMCAwIGVkZ2Vjb2xv
cgorbmV3cGF0aCAxNTIuODMgMTgwLjE3IG1vdmV0bworMTQ0LjI4IDE4OC43MiAxMzMuOTQgMTk5
LjA2IDEyNC42MiAyMDguMzggY3VydmV0bworc3Ryb2tlCiswIDAgMCBlZGdlY29sb3IKK25ld3Bh
dGggMTIyLjAxIDIwNi4wNCBtb3ZldG8KKzExNy40MSAyMTUuNTkgbGluZXRvCisxMjYuOTYgMjEw
Ljk5IGxpbmV0bworY2xvc2VwYXRoIGZpbGwKKzEgc2V0bGluZXdpZHRoCitzb2xpZAorMCAwIDAg
ZWRnZWNvbG9yCituZXdwYXRoIDEyMi4wMSAyMDYuMDQgbW92ZXRvCisxMTcuNDEgMjE1LjU5IGxp
bmV0bworMTI2Ljk2IDIxMC45OSBsaW5ldG8KK2Nsb3NlcGF0aCBzdHJva2UKK2dyZXN0b3JlCisl
IDx0b3A+Citnc2F2ZQorMCAwIDAgbm9kZWNvbG9yCisxNCAvVGltZXMtUm9tYW4gc2V0X2ZvbnQK
KzIwNS41IDMwMS40IG1vdmV0byAzNSAoPHRvcD4pIGFsaWduZWR0ZXh0CitncmVzdG9yZQorJSA8
b2JqZWN0Pi0+PHRvcD4KK2dzYXZlCisxIHNldGxpbmV3aWR0aAorMCAwIDAgZWRnZWNvbG9yCitu
ZXdwYXRoIDEzMC4yOSAyNTIuMTcgbW92ZXRvCisxNDcuNTIgMjYyLjE3IDE2OC45OCAyNzQuNjMg
MTg2LjkyIDI4NS4wNSBjdXJ2ZXRvCitzdHJva2UKKzAgMCAwIGVkZ2Vjb2xvcgorbmV3cGF0aCAx
ODUuNTMgMjg4LjI5IG1vdmV0bworMTk1LjkzIDI5MC4yOCBsaW5ldG8KKzE4OS4wNCAyODIuMjMg
bGluZXRvCitjbG9zZXBhdGggZmlsbAorMSBzZXRsaW5ld2lkdGgKK3NvbGlkCiswIDAgMCBlZGdl
Y29sb3IKK25ld3BhdGggMTg1LjUzIDI4OC4yOSBtb3ZldG8KKzE5NS45MyAyOTAuMjggbGluZXRv
CisxODkuMDQgMjgyLjIzIGxpbmV0bworY2xvc2VwYXRoIHN0cm9rZQorZ3Jlc3RvcmUKKyUgPHBh
aXI+Citnc2F2ZQorMCAwIDAgbm9kZWNvbG9yCisxNCAvVGltZXMtUm9tYW4gc2V0X2ZvbnQKKzE1
OCAyMjkuNCBtb3ZldG8gNDAgKDxwYWlyPikgYWxpZ25lZHRleHQKK2dyZXN0b3JlCislIDxwYWly
Pi0+PHRvcD4KK2dzYXZlCisxIHNldGxpbmV3aWR0aAorMCAwIDAgZWRnZWNvbG9yCituZXdwYXRo
IDE4OS4zNiAyNTIuMTcgbW92ZXRvCisxOTQuNDMgMjYwLjI5IDIwMC41MiAyNzAuMDQgMjA2LjEy
IDI3OC45OSBjdXJ2ZXRvCitzdHJva2UKKzAgMCAwIGVkZ2Vjb2xvcgorbmV3cGF0aCAyMDMuMjIg
MjgwLjk2IG1vdmV0bworMjExLjQ5IDI4Ny41OSBsaW5ldG8KKzIwOS4xNiAyNzcuMjUgbGluZXRv
CitjbG9zZXBhdGggZmlsbAorMSBzZXRsaW5ld2lkdGgKK3NvbGlkCiswIDAgMCBlZGdlY29sb3IK
K25ld3BhdGggMjAzLjIyIDI4MC45NiBtb3ZldG8KKzIxMS40OSAyODcuNTkgbGluZXRvCisyMDku
MTYgMjc3LjI1IGxpbmV0bworY2xvc2VwYXRoIHN0cm9rZQorZ3Jlc3RvcmUKKyUgPHByb2NlZHVy
ZT4KK2dzYXZlCiswIDAgMCBub2RlY29sb3IKKzE0IC9UaW1lcy1Sb21hbiBzZXRfZm9udAorMjMx
LjUgMjI5LjQgbW92ZXRvIDczICg8cHJvY2VkdXJlPikgYWxpZ25lZHRleHQKK2dyZXN0b3JlCisl
IDxwcm9jZWR1cmU+LT48dG9wPgorZ3NhdmUKKzEgc2V0bGluZXdpZHRoCiswIDAgMCBlZGdlY29s
b3IKK25ld3BhdGggMjU2LjY0IDI1Mi4xNyBtb3ZldG8KKzI1MS41NyAyNjAuMjkgMjQ1LjQ4IDI3
MC4wNCAyMzkuODggMjc4Ljk5IGN1cnZldG8KK3N0cm9rZQorMCAwIDAgZWRnZWNvbG9yCituZXdw
YXRoIDIzNi44NCAyNzcuMjUgbW92ZXRvCisyMzQuNTEgMjg3LjU5IGxpbmV0bworMjQyLjc4IDI4
MC45NiBsaW5ldG8KK2Nsb3NlcGF0aCBmaWxsCisxIHNldGxpbmV3aWR0aAorc29saWQKKzAgMCAw
IGVkZ2Vjb2xvcgorbmV3cGF0aCAyMzYuODQgMjc3LjI1IG1vdmV0bworMjM0LjUxIDI4Ny41OSBs
aW5ldG8KKzI0Mi43OCAyODAuOTYgbGluZXRvCitjbG9zZXBhdGggc3Ryb2tlCitncmVzdG9yZQor
JSA8aW50ZWdlcj4KK2dzYXZlCiswIDAgMCBub2RlY29sb3IKKzE0IC9UaW1lcy1Sb21hbiBzZXRf
Zm9udAorMzM5LjUgMTMuNCBtb3ZldG8gNTcgKDxpbnRlZ2VyPikgYWxpZ25lZHRleHQKK2dyZXN0
b3JlCislIDxyZWFsPgorZ3NhdmUKKzAgMCAwIG5vZGVjb2xvcgorMTQgL1RpbWVzLVJvbWFuIHNl
dF9mb250CiszNDguNSA4NS40IG1vdmV0byAzOSAoPHJlYWw+KSBhbGlnbmVkdGV4dAorZ3Jlc3Rv
cmUKKyUgPGludGVnZXI+LT48cmVhbD4KK2dzYXZlCisxIHNldGxpbmV3aWR0aAorMCAwIDAgZWRn
ZWNvbG9yCituZXdwYXRoIDM2OCAzNi4xNyBtb3ZldG8KKzM2OCA0My44NyAzNjggNTMuMDMgMzY4
IDYxLjU4IGN1cnZldG8KK3N0cm9rZQorMCAwIDAgZWRnZWNvbG9yCituZXdwYXRoIDM2NC41IDYx
LjU5IG1vdmV0bworMzY4IDcxLjU5IGxpbmV0bworMzcxLjUgNjEuNTkgbGluZXRvCitjbG9zZXBh
dGggZmlsbAorMSBzZXRsaW5ld2lkdGgKK3NvbGlkCiswIDAgMCBlZGdlY29sb3IKK25ld3BhdGgg
MzY0LjUgNjEuNTkgbW92ZXRvCiszNjggNzEuNTkgbGluZXRvCiszNzEuNSA2MS41OSBsaW5ldG8K
K2Nsb3NlcGF0aCBzdHJva2UKK2dyZXN0b3JlCislIDxjb21wbGV4PgorZ3NhdmUKKzAgMCAwIG5v
ZGVjb2xvcgorMTQgL1RpbWVzLVJvbWFuIHNldF9mb250CiszMzYgMTU3LjQgbW92ZXRvIDY0ICg8
Y29tcGxleD4pIGFsaWduZWR0ZXh0CitncmVzdG9yZQorJSA8cmVhbD4tPjxjb21wbGV4PgorZ3Nh
dmUKKzEgc2V0bGluZXdpZHRoCiswIDAgMCBlZGdlY29sb3IKK25ld3BhdGggMzY4IDEwOC4xNyBt
b3ZldG8KKzM2OCAxMTUuODcgMzY4IDEyNS4wMyAzNjggMTMzLjU4IGN1cnZldG8KK3N0cm9rZQor
MCAwIDAgZWRnZWNvbG9yCituZXdwYXRoIDM2NC41IDEzMy41OSBtb3ZldG8KKzM2OCAxNDMuNTkg
bGluZXRvCiszNzEuNSAxMzMuNTkgbGluZXRvCitjbG9zZXBhdGggZmlsbAorMSBzZXRsaW5ld2lk
dGgKK3NvbGlkCiswIDAgMCBlZGdlY29sb3IKK25ld3BhdGggMzY0LjUgMTMzLjU5IG1vdmV0bwor
MzY4IDE0My41OSBsaW5ldG8KKzM3MS41IDEzMy41OSBsaW5ldG8KK2Nsb3NlcGF0aCBzdHJva2UK
K2dyZXN0b3JlCislIDxudW1iZXI+Citnc2F2ZQorMCAwIDAgbm9kZWNvbG9yCisxNCAvVGltZXMt
Um9tYW4gc2V0X2ZvbnQKKzMzNy41IDIyOS40IG1vdmV0byA2MSAoPG51bWJlcj4pIGFsaWduZWR0
ZXh0CitncmVzdG9yZQorJSA8Y29tcGxleD4tPjxudW1iZXI+Citnc2F2ZQorMSBzZXRsaW5ld2lk
dGgKKzAgMCAwIGVkZ2Vjb2xvcgorbmV3cGF0aCAzNjggMTgwLjE3IG1vdmV0bworMzY4IDE4Ny44
NyAzNjggMTk3LjAzIDM2OCAyMDUuNTggY3VydmV0bworc3Ryb2tlCiswIDAgMCBlZGdlY29sb3IK
K25ld3BhdGggMzY0LjUgMjA1LjU5IG1vdmV0bworMzY4IDIxNS41OSBsaW5ldG8KKzM3MS41IDIw
NS41OSBsaW5ldG8KK2Nsb3NlcGF0aCBmaWxsCisxIHNldGxpbmV3aWR0aAorc29saWQKKzAgMCAw
IGVkZ2Vjb2xvcgorbmV3cGF0aCAzNjQuNSAyMDUuNTkgbW92ZXRvCiszNjggMjE1LjU5IGxpbmV0
bworMzcxLjUgMjA1LjU5IGxpbmV0bworY2xvc2VwYXRoIHN0cm9rZQorZ3Jlc3RvcmUKKyUgPG51
bWJlcj4tPjx0b3A+Citnc2F2ZQorMSBzZXRsaW5ld2lkdGgKKzAgMCAwIGVkZ2Vjb2xvcgorbmV3
cGF0aCAzMzEuNDEgMjUyLjE3IG1vdmV0bworMzA5LjM5IDI2My4xIDI4MS40NSAyNzYuOTggMjU5
LjQ1IDI4Ny45IGN1cnZldG8KK3N0cm9rZQorMCAwIDAgZWRnZWNvbG9yCituZXdwYXRoIDI1Ny44
MiAyODQuOCBtb3ZldG8KKzI1MC40MiAyOTIuMzggbGluZXRvCisyNjAuOTQgMjkxLjA3IGxpbmV0
bworY2xvc2VwYXRoIGZpbGwKKzEgc2V0bGluZXdpZHRoCitzb2xpZAorMCAwIDAgZWRnZWNvbG9y
CituZXdwYXRoIDI1Ny44MiAyODQuOCBtb3ZldG8KKzI1MC40MiAyOTIuMzggbGluZXRvCisyNjAu
OTQgMjkxLjA3IGxpbmV0bworY2xvc2VwYXRoIHN0cm9rZQorZ3Jlc3RvcmUKK2VuZHBhZ2UKK3No
b3dwYWdlCitncmVzdG9yZQorJSVQYWdlVHJhaWxlcgorJSVFbmRQYWdlOiAxCislJVRyYWlsZXIK
KyUlUGFnZXM6IDEKKyUlQm91bmRpbmdCb3g6IDM2IDM2IDQ1MiAzNjgKK2VuZAorcmVzdG9yZQor
JSVFT0YKZGlmZiAtLWdpdCBhL2RvYy9yZWYvaGllcmFyY2h5LnBkZiBiL2RvYy9yZWYvaGllcmFy
Y2h5LnBkZgppbmRleCAzYTE5YmE0ZWI0MmRmNDY3NzY0MTJhZDcwMGMxNjY1ZmIzOTNlZDYyLi44
YzAyZDdhNTZkZmUxMzhkMDljYWZhYWNiMzM5NzVkMWI5OTIwODA3IDEwMDY0NApHSVQgYmluYXJ5
IHBhdGNoCmxpdGVyYWwgNzI4Ngp6Y21iX0Iye0BHOV9aNWskWGhWQ2lFSkoxOVM8SCtYVntCdXxu
azdyOXJrVE1vM29+T0VsMldNJW0xSE4xRVJqbC0KejZpR3l+V2wzbUpOLTljR2BvQS0yYEBZfXlK
cGI+Vj1RYTE5ZChPRyVvXjk/cWwoJGZmKUtMZnhtfiEzZ21gb1RKCnpLbXkhZG8taCYjRy1xKCEx
cyh0bmc0bHBZT3FQSmIxMyk3ZFJsdU15WGswcGpPb3M2VkpPLTV3M3JKM311amoxQgp6RlM8NmlG
K2Q+d3J1ZE5hO3plXkY5Knd0Xl9JcDA+XipoSClDfGRvfTc0PHs4ZDNXNHdCWkFXOW8rRW4/ZWNp
NUoKel55JGBCc3FedFdyWEhzPzdMQXIobzM0QTJ4Qkh2PnNecEAzR0dlfkgoO3drZUxHQztDT3s3
T1MlX3J5ejQ8RVZQCnpmQDAxZGh2WW00WXZUam8pcXhlPCtaSnw8UkhMaVMoJTVkVFI/bGxrT0Q2
bz5gfDZGU3BVc359KlBmSXp5KWIqSAp6PjZiOUgtUUIxMnlTQ3sxdEtPdFl2JDhiO3J7TzAqYDwx
QjhPQnVjUVNZX3pXYXZOVUlkcGhyPylOLXorYkBTU1YKemZlKChgNEw3eGZncX49WnBZQmVJKEtq
aDF5LXxFeUUhWEtYPyZsKjBnb09ZeXViLT49ek54Zlc+Tmd5SSUlXyhvCnplRUBrfUkrbEFRRXw1
QWYlWT5TKVIrQzEoKmM1I0RnSlMoTFd4flM/JDB6ZUd3Sit6LUNZZGA4ekRYb3gmOEJuSAp6Jiot
KyM/TCE1Y0UhX0MmPUZ7VXU8dC1OJT1+blV2VUdCMj90Uz09Yk1kOzVWOWdOQGkkdH5YT3FPSERU
RyhLbX4Kel8keTF8XlE0ZyEhOG8+Uzc0dSpQQGwyZF9NdXhNPXlhViZFJDRlRUtHajZYI20oNjlV
WDUmd1h2e1ZrRll2IXV2CnpabEA5Iz0xI1hQaD55MX5hbzRTUG80OCZkaDtXIyZucDVtP0x6MChZ
JU5HO3RUNmlxNSlOYT4oODhBZkFSR30kXgp6N0RyNn10VEdxJXspcDF0X0V3bVVVNXNFe2pkWjdg
Szw/ekhJVERldypQVnVDYzYmcT9hbWItc3VTWXt5TUxyeHUKendLeV5nTitXNzhZcUR0Z1BkSklY
X3ZzO0syWXQ3PkROO0phRTd+Ul5VJlAxMjRDPSFjLTtgRUdocEkxRXYrSlBkCnp0PXhrITUlNH40
THJDYEY9PigjPnMoNnpGOD1tMzA/VklRR252U2AlN1NxfHtKeDRBWURRKjFIZUAkMUZWMFImKwp6
KiNAPDYhK2cpZCtTeko1PE0jSio1QDM2UXV7VWMqVlhKV0ZUUTZPOWE9RSsweXNyLVhacU9fOXhD
P2hQLT1EOFYKektQKz5ubGgoKlRRK3lwK24kNXArQyQlSW8rVFBTQmJHQFR1NH49MT17OVp5WDJD
STFKVnNOVCk4XzlpMGlqYU17CnpeODkpSEhrVnklR0B0T2NTP2BhZVclUCFBM1ItSS1mN0UlVWlG
e21sLUxpSWgjTSR7dUYlazVPOXVqZFVrJjtabwp6VkdIfXJuanlOVHpGczQmPDNgMz0+QnBBbTFG
Ymk2JWRWKSgwTDJkYTEka056JGQ2eWtxPWx4KyU9ZDMxKTwtdDIKenAmY2VBbWR+QC04fTFkV05f
Pz8pcVRsM0ptUHVFND5DTmdKTzVTN1hyX1MqbmQtJE80KFBrZnI7WkliQCRhTGx4CnpKc3k/cmo5
TXdeKiF3eVRlcXF6dCpvV2JlUHU/ekgxfkZGJFVmU25VaTB6eHtXcFZ5Vm1Ue0VALUM2aEdoa1Be
Ywp6diZ0KjRnJmJgdClURm4qXld8MHc7YHhaPEghZkAmeVlwfiQoTU5vNCZ5I193ZDU0M2UmdG4y
Sm98Xyl+VjRQJlEKenM8bjYxdmc9SjFyLU0lMHpHV0JMP3RhaV5XPDd4QC1nZSQ2YSUjbzV1Unx9
TjQxOUB3ZGo2JWF5O2tOP1hYRW92CnomTTBucCtjen0pPTZuTXojTihpcSZQRkF0K154QHMtajYt
ZHp3JjB1cDBAREhDOSU0T19gbm9kKXxyI3hiYCVYWgp6QF9uQGFNYVFJXjFaIUEjOFZyQmpXaj9u
eHU9LT11N24jU3t0X2xXK0s5Z1Jja3VXNio2T3ImNmcrZFp3R2NiKWAKej5CPXQ5bipuYTJ4LSZv
djJBeFVPPUxQYElOTjhDRGcjJDFjdj9+bCs8U3txYDAzJUZqRndsbTw9bGIkITNfZ19WCnp3KHoo
I1RaWF9IZ3B3ZnUrQSN0STVWflEyen1RdipyOEB2NjxPN2l5YVVwVVBOO0hBOEE3fXYwQSZ6YE5t
XkUhKwp6NU5KaiQ7VEdTc0Q4dm50M2xJcyQyUzc2Pm9ld3l9Z2tzeWtUbWd1S3VhTTwkcShiZzkz
SFVwdTBhWlh7YW92QmcKem4zM0xzQSl3TnM2IyhAZUBNfn1VcEEzRS0wfHJgY3U+ZXFIQHtFdzhR
X1hCO2dORiZ9WTx7czM5ck1Ta0NRUzNzCnpScEU0SVFKPjBaMm8oYnduYzhpJnUtYShIV0hiMmNI
ZTVFOUJUXldKIUtkKzwtVTJRVUFQQVg9NmUzIUk2dzJpQgp6MXFMMmU5KUxyRj1HMiluM1hLRkVt
fj8+JC14PEstZ3RgKl9nJl9ldjhWJXJaYytvMndMc0RYfkxkVz5hMmczYzIKekE4MWBlTGolQWZ8
Tk1xX2YqP28kam5APnQtJCFfOENXSiNUP0U1K2ZCaDxQTz4tJGBeQ1VoQU5edXgmSHhJXk18Cnpe
Zi1MeCYkK0dkRWBpV0xnKGloOEBXVzRwM2ktfDBmNjxwe1lEcn0/eysoKnxBdCFmTSQwR3JDRylm
Ynw8Rk5vdgp6NlhQb1VqZHRlKTcmSHZqPEl7djU0PyFWa3JGeHElbkM+M1g2cHc+fUxiQ3xoZ3Jx
UVZHdnM0VG5qWGlVI1E9fm4KeiZ7bmA7K2U0bFg7YU0+R2VDUnxYZHgkZ3VJP2t9c3ooSlRvPDNX
KzUzaElJU3BhRG4kNE04SzIzaG59RkFSVDBZCno/d350I0x4NjQkQVFTV2lTczt0Uz1Zd3BKMTlD
eGNrT3ZBdFVvYiNUYldaNGshTjM0MEdeQ049eS0reHgoYWByUgp6JG5RNTBOWUxOKVlWaE9BZitu
REZXYik2OzNFTXU8JmVtYU43KW9pdlJMIyVDX0Z6SGFWZiVfSlpRWHRfYzdjdHEKenYwbEY5ZiQk
TyZJX2ZrX0tfTmQ8R0d3LWJ4Rmw2N1NfSkA5UlN9TmVyc3tzTDJfMlNZOT1Se2ZAZjlpRUZPI1Bk
Cno+KC00OENaQjJ8d0RTOVFrNnkwYG5WNFcjT30jckM5PUklflpvY1VxK2REOWErV2Nqd091djBJ
ZWVTYiV0Y0spPAp6KCVIWVk9fjdkbntIQzEyPyQwcz9pYEdUVkEqTTslTTg+fFZRY1JzJkdidmQr
XnYtbVJhaDlEWVRXYEIxJE5GTEcKeiFGTHNAUDhXN1BEXmhHV3JjZmRvJXh7PmJhX1NvITg/NSlN
NC11OG88KSNJKFlTRyZsTWkxSUlKUFZ3PCQkUHJaCnptcVRAUV5TaVhFciVHTVQ3Tk5FMTYzUXd5
KkZOOSRYNm4lKDcxbEArd3orNjxKSUhSWnJPVjNpKlZiS28kd0dGcQp6b1YqO15wbXhHdD8jczZZ
aFNxVD0mc09FQmBVPWRlWilYbFJKfitSLXQwY0tIcTxwWmZRX1dOQWdHeU9LeDI1KngKemtAT1NS
NGQrdFlaMCooYHIoRHc7JDttd0h2MDtDPSQ9NzR1YG41TEI9aCR0IzQmfSlDK3xIViN5MjNaITtk
WEZYCnotX15qU1VuSG1MSHkoc2ZoVkt3WkQ9Z2BsQUV0fSlTT1Y2NU9ITHp3XlgmZ31nVER0YUNT
fCpWUkkhZXY2cXhZJgp6U2BffHRuP2okbjdxanRlV0M2OHN6aEAtdFczdClfU0khMnJnMUNnWjFu
R280cFUrOE4mY2lPXzFvUkh3LWtVQTUKel9kTShMa1M2SzY0eWtyVyVyPVc5VmQ5S1hkTnN6I1M0
K2gpJE5TeW50fkZGPjgpVWtGRHJqOGR2endpRE97JSMwCnpvSz1SQ1J6eUlsIWU/WWh5YklveG9Y
T3A8VUBwPEp1aGpMUFNhQENWKTYtMSp7WG87JW97PTMxQlN2YnpJZDA0QQp6REE4fXU+XlJoYCpq
ZFlvPihsUUBURTxRI1dTQjFAT3wyRnJOTXJvPm5gIUFFPXFGIXo2dCp2WVUqP3hmVUdCQigKentu
ZTUjVXs1UDdYPVdRUVZydU1uKmt2ODZfSVlFe3sjUGx0XzhOUm1FJWx5I2A9YTllP2ZWPWFSaTUj
XisxPkAyCnotfCY1dz56amNWTCMzU34hTyoyTzs7YTRfP2N+eWhGVXY+Yl94MGBlaTNUbngxQENC
PyY5P3ZTYzAqMFZVQnwqbQp6T2Z3LXhJQGcofnZhRFZ6JDwoejFwfClIMG8+VDIwdHokQ2ErSyN2
cjtPRmNVXkB+YmwzWUBBPHlYdlooRWNIJDkKel88c1h6TzVUPXB5TnNEeHJYK3NnKz1AaW0qTi1r
TDFjeD03TkVJWmhQRHZJJTtXcUNtTT80JEg5IUJaSnl3JSkwCno9Qn1vKUlwamNzcS1tdEFHREJ0
ST5OJmQkdTlNSUJgV3ZqST13MW8mKHI+aXleNHZMOEokKElTLT1WT3VoUiV8OAp6ZG5FaG9fX2s/
T2J9KVYxJX1+PjFhQXorMzNIfDFrRko/ZjlJV0VsTGN8MFMyc3EmT2pfU2JwNmN9TFh+VGY/X3IK
emVBIShfcH11c0ZjcX4obkdCYEFmU2t7JT94YSZnZW5fMkxGeShyfSlzU1NxMzRYblFIZGtoPFZZ
eFl4dWRzLXdhCnpFPVpBWUpQajFBdWQzcyVMYHI+MDV8M3AoSihkV2pLMDM4TUhxa1FkJjw0KlhY
MXBVKE01I2MoeTtudmIrJUxEZgp6LUMzSVdFU0doX0c8d318e0dgRHxScHw4OFpYPVVgYEd5fj5t
Wm1QeEd7NX07KkYteCpVJXElailkSDd0IUg0JjYKejw9PCtEb0orSX1ATmRQUXp9RnhvOHZXKVFT
fHd5VStZYyFxMEx1Rip2QjQpNjMkeSUtUENScHN3Uyp0TkYxfjNsCnpZaUNEOFFNVTMlfEhTUiRt
Q1pIZipoR2N0YDEoYFVnUVdVMyhAKHpjJVV1Nl90ck9meyVEPmRrTlRGZ2BAd1VWewp6cituP0Iz
TkdiSWJ0N2smdG8lQisqVF9OaGptcVR1NEQ3NG9Ke0VHPT9pcTcrWTxzcnVpfk9QcSlBfWQrT3st
aWQKekZBY3IzcllidmFORjArZ3tBZUAyZDApZFVsdVFLZmM2ISp9Uj5ha1c2LUwhaDVodTY1QjJ9
S29ndj17Nz45dSl2Cno1aWRwXy1laXtCd04xUkRwdT0oTE50YHt0K2IqQWZPRyV+bj82KmNrP3pM
N29YNTZLZk5nR19rZ0x+UTZfYmpwNgp6bz5RVnErJjhfbCVRTmx9fDhTMylhJj0/UmVaOEQlPDdT
dGYqbzE/R3h2Pyp8N0VFdUlvPCFANjZMclNucDw8SnsKelJyKWJ7aSNRKihhdU9CQChtUHw4Wnxr
Ui1DKHVfK0Y2YlY9U0pjMGcqTmQoZXt9NlRNej4hRDkoays1MDRleDxYCnpTMSU+K3F8JHVaYGBV
dWU0I3V7eEhAam5edTY1WVp6cCg/QiZ0N2NUbyRyfW57R3orKHdic3AoUSlvbT8rVXJ4eAp6Vl5e
THdnJFlqVmloYlB+dGRtfV5yZ1V7SXsoZjQoWGwteiFMLXp1OGctLVc3TXNFXnVJZDN4YHNgUyEw
TUMxNjsKemhoLSlqPT5gclBQT0JITURwZThSYUpxVkB5P2xjTz5fKm8tMzlIc2o5NTMzSHFidDlg
ZEF4WERzcWMlamBTb0ZJCnokP2R9Kk9xLUp6TT1EelA5P09lUCZCKGRETz47aXl2aWE/KnkyeWBf
RXxiWm11VSt+clBIc0k+eUhjdkB0enc5aAp6T05VJE5AKTEoYk1ifm8hUklfTVd7YWNUemA1M09Y
QFZDbSVlUCFiN1RER140WE85bVQzIWJWbHhfI3t+PHQ0N0IKenVyRl84YkY4ZV9nMjMxcSErSWF1
T0l1bzIlMkhkS1ZfcHVmIVN5ZW0/N2lPPUdOXj5GQn5PJHVlfHBKNElZKW8qCnpARHswbG0taFlA
bGFkaClTcTR1QlArPTsycVhNaCVEYn1yMTREUXRAY3gtentkITQwMzgwUmwoOHlOOCN4b3A8Xgp6
ZFlrcmV6VVRRX1Z1fExwYjl2N0RIaFotI0N1UVdkY0kkY1RNS2BwIypLeiNQYFZMTn13K0UwJCk9
dHE/SF97Y0MKekltdm0yb31wTnNDX2lAQlpZYTxIaXRFfSpJajZVPnROZ012YkxNUE5OLXRhNlJQ
PGhQO0w2aHNuU2Y1VzFKQWkzCnpDN3ltTTVBRWE2SWhAUjBwP3NJOHc8N1FJeTRteWs3WX04YTJO
bFpKazNNfkBrfSorRkRvTlBuNyZkeTJ0O01zXgp6YyNzYCNJfjFqbzB+WFR1SSkhPyZZNmBEQ0dD
bVdrNlZmT2Q2bGtwVDN9YmRAckhgayVDNiZ+Vnk+TUEtXjdFcnQKelgkIzk2ciZoaDM5Rio4dmFj
UVlpLUJzZE11ckBpMnB6SVZNWiNaaHt6PmVyZFBDWURXanx9dDZ7X3JXYnQ+QE9NCno9a0xXRG0p
XmZDSntpemdMQlpVREtYJEhwZFFNN2o7eyRzS0o+fnZuOS09VCYkN2wyTHlvUiF4Vkl7YGQ+Z19U
TQp6IT1xQThZKVckN09hRDVZdillQF9xeTJvaT5ySGFkNkdRYXFnVSF2S15Ad3RkeDZnN2NQPkZX
UlMxVlNYOVI9QEkKem5TV3NDbS15NCVtfFckUyg2WWtDMz5gZktsQUUlV2R+UlgkbWZRTHlgdUdO
VDhONUpqdDhKcFdSNzI2V3AhdClzCnoyRWohQ1lLfT9rLVMtYmwrRkJPdmFlNyQ/RSo+OF8oaHh+
aFhYTXRLYG1+UHN6Zz1kbzdqeVQrcHg2bHElUSQldwp6ZVpWPntFVSYzPFkmWWREYE5RTlZiTW4j
KzxQWEZMLVZAUWN0JFA+Y2FxSyRSaCp1S1BvKSphdEFFeyo1eSFQUEAKenRrMCVkNSprfGB1dldI
SE1zMD59ZyhocEhPcGhGU055fisyISglUmd4VjhDOG9GQjJ8Z2x1UCZPOFlYKzN8VyNHCnp5bURj
YXI/SWNQel4qKis2P001JFp7ME85QGBUaEMkIW5LNTIwQ3M5e09CNjdqdm09MztaLVk8JnRFJkgt
R2dtXgp6KnJMQGo7Kz1CY3IxS2NKPUh6YTgoO0ElfCtsIV8+e0w+Uzx4VzAzWmtIKn1kd351RDha
dCpfPElkJj5DaVdIKGwKenBQWEsmRGZlan48dWY9aXZfdzNwTiNgQ0dRTCQ3PlRQRENSMkRyUGM/
Kip1e2lGMntNdShITDxNZl9rUS1EYlZMCnp5ekR0VVNIdFVsWndqflh1KVpBa0ppR0w2Ynl4Vmpu
Xm1FfW1zTjNoVU43JFB5ZXdhVHhUbmxUeXNoZ0ltSl9VSwp6YXk4fVpmKntXOWghNGwteD5AWTIt
Tktvcj9ZUjE/Q0hyITwoezFaV2R4d3luKilQX2hOOGVrTk05T19sQVhRQWAKem81a14/UTdjMDBI
dGxjJFN0YTxNQD4jRkE4czc0Nl5+NFdLKDJ8ZXI8QCNrXlFPcSQ0a2pHNWlBNHFafm8/PkpqCnol
fSpxMUA7OWFTS1QxKlhuVH5vfmVWa2Q/RWZJRmd1aEhwKlkzWWExNl9ZOUwkJXA2UVA0aW10KW9T
TEp6KihrOwp6Sz1ZX3k4ZEdhXyExO34le2NmXzdlbzZQPGc/aD1CVFVXWTFtVCo5eEd1WjdlKGNM
XmRtRXtvQyU5M3tZYz5Mc08KekYpIU1WQlBjZXFybT49SW0mRU5lKzQqcypYdy15IU1iU0RockV5
Rn1wTGxrYGZYXm9oaFhMaTJKbFdMTEN2OXJjCnpRRlJMKFl1MDZ6ZHpadXlCISQxfnhJbkNTOHl8
SF9HaSs+SW9ZSFQ9TnR+aTZzM2JvaylNNTNDWntKYzFHPkleTgp6Qz83RENhZWFTIXk0SHhFakJR
KWh0a3ZeNjc3RldgS1p8dXlTXjlmdl5QXno+YiFUXzlGI21DM01gN140RjY8PG8KejBCPFZJaXk7
N1pHMkVGUFpUTShLNiZ6c0Z3YyFwfTMjNWcmMG1GbDc2MnhRSjIzZ3dDZzFsJTFJJFZiZ0JrNTN+
CnpFJilTNWZhPE84Q1RkcGwwalJ7JFVUPEp5Wm5SI0E1SV91SWQkWGFzODM8c3JJREJHJkhlNXRQ
Z3ZMVEoyblIkYwp6MHh4YTJxczEwTHp+IT5NbTt3TmVBUnRpY0Q5azNualJ6SER7Iz4zSGZJe0hs
NUtBODJqYzViNDQ4QWpqWDQtSE0KemZ4dyN4Zzh1JmcyITlOTSVYMEAmMU9mcD5xQ3FyVDlsfXVP
MlhYfHwwQ2YmdTUhejJBMi1FUT04SGJNJCQlTFNCCnoqJngjcUw/TXZpa0J4cDUobzhNfjVOPUd9
I3F8fHYhfF8tdWx9QDgkKU54cTRoQl53eHBzNkZGTjFjWWxCYXc4fQp6RjEjRF4kNDFgMjNIWmxP
JjtxbS0yR1JnREIwfTh8eC1YNXYofW8qd0YkYXUyeE9+Qyk1KntFUmtRIzdzPUhVTi0KemNfNGZJ
Pnl0eDlvSDtyUCFYYThmTVlVVFgxKiMqLVhlMGA8MXpIYEF1fHNKUEhFPXt8aXFzP2BrdEZhaG4y
XkNDCnpRVWcpPmBNOzM8aFdRJlFtdUNtTDBvazJMXzRlPiUxXzZFeTkkI254R3k7dTdVO3RHfTl3
WlY0alpydXhRdGk3Qwp6QjJGYGVCdjVGby0mRk9fRFVhJUhWZXl+VSQ3VHpDVDhLeGFhR3xSZFJQ
UyU1WHYyTWRuUk1kKzs1UHBRJTBLN34KemJsVDZ1Yz5ENUxxUl5xIUtuOUI7bCQjSXYwfTQ2fm9r
biF5XjRMXyFAdX1ZNFB8dCFZZlhvM3haVk0tcXBoVz53Cnp6KyNYXmZ2THc1ZD5eb3chYXlVa3My
cTF+Y3pgO2M7WVJnazNFKlQ4Q1dBLWkoTDRnYjg7UWp2ZTs8ZWwhQyViJgp6ZyRZRjxERG9qfGY8
TjtMODN6MUEmcCpmTFMyQmZDdl5MeWRtQDVDNHRiYzI9e0ReKGtlLS0qX1BgXmhRUG1zb2kKejV2
NThZM2QwZUZNcV5NSzhhUG9UIWpWV2dnYSQ/SWY1RGd1NjRpZWZTdVRIdW1XdncxKWxPKCEpdF9j
bGBgT0EyCno7NCQyd21MNXQyQ1FOPGI5e2A4TlZ6N1c0RmF0d3JwcktaeEBCdWhLVV5wQk9ZV012
S0x0JGBHSk5HWHpIMHAxKAp6UH11KCs0QExNSjkhZihLWVYtWXRBQ35hPGVGLVMyMV5aViMlLWB7
X2YwcjRKTW5YLXtLV1ZYTzxadHswSlN4OysKejwzYXp8MTMrNzU1WSpHdzA2LWZxN2l2QldKOGw1
RG5kOE88TUJPKjI4JVAxMU5vWU5OMCpaanVyfDReOUFlRXF6CnIyMVhoTjhpc2xWOTdVZigoNCZ6
NUpCRipVdWd3PXdjPjxBdmFHRj5RT2orNWAkX1Z5PCp3MWhQCgpkZWx0YSAxMjAxCnpjbWV4bnY1
U3tPSE5lRzkqSEYpUkI4T2RsP3YmR2ModU8+KS0reXVHekNGNU9rO1dAVjdSRmcteCkpLWotIzYo
QQp6OXBARH5Rbl5GKCpZQ1pUX1E+M3BJM1BFJXlpY1IrJD9EUTAqUkgxamh8ZlJVRWBSZGdVJkY+
THxCUTNxX2ltMiYKentnUHdabEM9SHY+JX43YV90WUI5KHkkN1J1NCMqMnFgVENyYy1hSntGdlVx
I25NTGVCNiZmek51S3EyZkZIckNJCnpPWlJ9WHg5SjN0eXklYGU3cHIrNTlTfHduPUJtN0JDT1pl
U1Ewenc0PkUoPlBPPX1hPThvWHZXJmFyNyFvfk57WQp6KXJVTUQmaD8jTXd4dFZ0LW4tcFd1ez0w
Z0RXb1lYJkBvUmRVYHA8VFJVQzZYSGJ0RTUrb1dCKmk7WSNOS1NrK2QKemFtaEpPISMoPlo2bygk
dk9JKWRJXkwlUFNASWd4ez1adUgteV8xc1h3ZlJVKk48Qz9Edipod1JFZmJ9MyNseT9KCnpHOGcl
Rk8tb0NnblIkYCglQUA8bWk+QlBHWVB0ez9KTVg9citMRHhlVXUtIzZ1NXE8c3NiKUdKJDZ2QUwr
fmJ5TQp6LW5QRUc2Kz4yaFVEdFpIRHw/O2VeZmZCZ2xDdz1Oc0VhNk8tYG1ZMXN5UDJ1X3syfHdM
WWxyXnNeWEkteVU3MCQKekc8PE1NPFZiemZWfG4rTEZSc1ErPz1ZTDIoeHZeZXA+cy1ya0V5Xkgz
MztSRD89NzFTTlpOR0hPV0FnMCl0OGV3Cnooa1hoRTxNUChgOTh1bGteTkhPclFLWm4renhEMiU2
RTlUbSRaUGM7eEAzTkctdUE+PGQhT0gjOEdmWj9jSUBIJQp6Um9WSnNHbT9KRCV1TmEzP2B3YlNN
ajdBS0FnO1F3PSo+VE4jM1ZgfG9BRnd0d0xVKzVkKW1qSHd9aFZjXkVOLS0KejZ0JTBOdnIjWnVI
QHYkJGItOWRrcjtlUiZ7bn52cWxkUWl+aHRfOWlyMzZRKGhoRHo8YFJ3N2V6aCFaQE17akVFCnp7
cmRMaig/MXBzdEI+QTF7cV5zPW53dU5sVW1qYHNgbVM+QyZjQ35GaGImJHN4WiY7MSVsRkAmVTNR
WDFvU1IjNAp6WXJ1d2VkIWlpdytVLTkzSFRtYG1YWDdhbmQoVCQ8fEZVaTg+aWRXNWJ7Z0lQXz1t
ayQhJEtsOEZRdkdvQ15hI2MKejMmX2UoJUhsRnBGaS0lflcoSmVEdjFxZCFuOzl3PzhKYlVpIUQ3
UV8zNnUtcyhzIz94RF5WfnNtfjcxMkpven1RCnpGezk8PUtkaUVoMjl1QE8zeypvaGI1bzBUbyRf
OzFeZ304T1FvKEF1Xm4qKjJOPGNpMmtmRUwzPFVmKSteJWk9RAp6cmtZJigmT3BtY0dWfTlYNT0m
QXdUJiM9PzQ5cEJuM0ByPXxPKVpRLV4xa15neFRIY2RPTDleKl5oPElKXmVmVWIKeih7K0teenxo
UmQ1XmlqTWtwQHVBQz8mTkZYcG0hUk5kezBMSFFnYVFGK1YzJEp4P0o8IT9oP2dJYXxSIUYoKVVy
CnpJNVImK1FgNjI0OFZuVWhzY0JwVzNXa1EwJnEreiE4KDVrZkQ7UikpTFlAS19tfDxYT1hhTmk+
UjUxZmZMbFg9IQp6YkY7fUIoeUFjXzx8ZH0tYSl0JipoOFNYb1NpfXM+ajQ7I3pFdGBCLVQ4N2Ja
QC1KeVEyYU80PWA8O19oPVkyOXgKbStnQipoOX1eUjtpQTUtdSVnJkNneEZvVHQxbmZhV1Z7PU9g
UmFJQWlIIWM3UzE+WHorCgpkaWZmIC0tZ2l0IGEvZG9jL3JlZi9oaWVyYXJjaHkucG5nIGIvZG9j
L3JlZi9oaWVyYXJjaHkucG5nCmluZGV4IDQ2ZjU4YjA1MWNkN2VmN2Q1N2RiZjMzMDVjNDQ3Zjc5
YzEzYmJkYzAuLmUzYTUxNjE2NGUwZGEyZjhlMGQ5NjgxZjgwNDQyNjVhODQ3ZmQzZDEgMTAwNjQ0
CkdJVCBiaW5hcnkgcGF0Y2gKbGl0ZXJhbCAxMjQ2OAp6Y21jSjBYSD1BM3Yqa21CMDsxNThSZ2hw
NGxxOFp0cGgtJGdSMExrS0F8Tj5qTDkkM3gjNzA0SzVKZzJtR1BERjAKelB5dENJd3EhdyY0M2Jr
clB2TGlHJkFxY2AmNitqeVA1YX4zPyZxQjZvSTBuZmNJe25uaksxIzBCWnJQM0xKO0gjCnpQRS04
fmZ9biZEZ3lKbT8zY2s2b3MrdDQ7SWNUa1FRNV8tZ3xILWIpUGVjJUkxZ0VaWV47WWApKEN0OXhp
TW1mcQp6RFJtZ2tYZ3BkZzhlXl9yUkxTZWZSK3d7RHUmU1Bseyl9TyllaiRKTXgoXnpDTVd+I3to
PkBXYGBSWGk9eU88O1YKelY+c19zTXByMzhEbXFXMHlPZjdHNHQoR1hMd0gmaUk8e2B+Jmw5VFZZ
PDtzKmhCfGtPWkcwdEcrUjd3JGYtK05YCnpgcjJ3LSN2bio7MlpuJGsqbVR9NzFoRyFRQjhhI3FI
eGtOQEtfbDQxajVHLU1MMFQjVmVUTkUjTTV+fUVrUzZZYgp6JnR0ampOdyhkNSRoSW5xcThtIz5H
SG88MnN9cXFYZWttVmo0VWFna050SD4kO0Z7KHROdiVxR15vQG95eW1rSG4Kem99KTxYZTJES31P
fGM8djlEVk5yNns+dCg9O1I9eTsyLVNyd3ZGLSQpWnIjeDA+WFZrVTUrdWBxfWdBTm9sVzg+Cnph
enlxOWNQc0FhQWc9YEhIRlhSK28xKkZ7PyVVYWU7Vy18eF5qI01vPkJWXykodWp3cSgxZm0mXnNY
aF5fUXwhaAp6Y1lkUjZ1QHowOU9nfDdhN3E7e2VpX1AwP1ZYNU43S2UpSEZoSz5Aa3JsaDVzcThH
bS1gKEImc2U7QkhaWkJtMlYKemJ4R3lSRlpxNFRlZi19VV44TCpsbHVIeGlFczNBdkljTkpUVz9p
YT1sQWImZkJ5Y29JRWx7Sno7QGEpZiZlPmphCnphQ2otKUhzND4tX1R8Z21hTlhfNmp0cSUmPWo4
bnNVaGozaUhqKEpJPHJQaTlWaDBgVT9WcmVjakQ2dz9uS1FTUgp6UEdpeVZrbVo7dWNJaHZse2BS
dEd6R2BIKyFpbzZoJWFfdnomJndUcEY2ZnM7K2hXaV5IRSFKYV8zK2ZpXzQkRX4KekhLRy1IIzw7
PDh4VkMwMFI/XjdJTzQpYnJocyFgXnBSPUA4citBN3M5XjxueHhWNT9UJWRTaT13d0s0IW9zJVgz
CnpnQ2hqKlppaTcpIXZzfXNCbFNhWHtrUmtaJTFjVlJ0eEV6fHlEeWZvRGRSREd7UVNaMmNQMFR7
KHMtZz87TjY3QQp6KEZFSHFuVEQrK09MdTZsQUM4ZHEqOz0taGEkOD4qK1MhYFMlOThXP0lPX2h3
dC18LU1NTnIycCF2ZWRHXndaXkUKekswRGdtdm52TSZud1g+eihkU2FNan56UChIYWl1RD1FMCFI
K0VPSExtWD8pbSU9TE0jJnphIXghbU0kKmYqcWVkCno7SkhyNGpsdCFLdyNMNWl1KzhIcVBBdH4w
YmhzT2g7VndTe2JMQFF6QXd9XiE2JS1XUXtffnolPSoqZShZTU16Qwp6O287IzlKPGxDVmRFUE4/
UTFhQSEmd1FLeWFGLTZPWlYqekA9Ylg4OHF2VzVEX2ZLckozS2Q2YDx0VVQ0SWAxNGoKekxSa0I1
KUBUeEFUcTtaK1dlRUEpKGMkWHNkXnA0ZmhyQEEma2R9VkZ6YXheZ240VHo7cTgkP3g8M3VkbDlU
P2VUCnotN2BYcEhNeUpFT3A/ZihwT20rXlc7aEZhPD11YjJnTjN+IWo7ajUxbSRlTEJZS356TnND
NFctQlBBdkU/YjdiQwp6XlNBIUFKe0chb2tLSlJCd0RwSVdsJThKZXp3JXE8JmNUfDxnal8qQSNr
SCUzaFB8LW1tOHF1PlBBVWRTbDgjV2cKeiFhRmk3PmpEKEYjdUpTU2RSS1ZMYFVYcEdkfEkwJjNT
Y2wxbUNMRUFzb2hVNmt7QTNNNV5lcFBxS31SbSZoKV43CnpgRWRQcHhCVkp8Y2h+M29uRCEzIXE2
dzNreDQrckpNTXowV1gtZ0l4RFpBTVRyezA7UkpXXm0+Mz09TDR5X0Ylawp6UTBUJldiYzRNVEAl
VGEzUlBFPkU8S3FwYTJ7RXw3YlNAUS1BM3MqU3kqXjByRFVnNDh7bH1aQCpOdGF9LWR1MEEKekc0
WWs8VT15P0NJQV4yek1CdVJEPkM+bVZmO1g/ajQhKXNObHwkO35EZlM7V3Q5MChHQHlmXkdDPVZX
SG0tRG8tCnp3WUErJHFyfjl3JS1rS1h0czNnaHMkQmhzZTNBJEpyUUAxUVord2JSRnkye3N5SiVX
eU0wQmBlNn08SDwoKU1sMwp6PWc7bzBhS3VxQ0opR2ZhQGo5JjNaX3dqbkt0TzwrK01VVSNTOzU9
V2RjbiZ+SURCYm9zcWYtMj1pWURoQnBDMnYKenIhcVA0PWVzYnRgdkw7X3VVQF5uKl9sfXN3Z21H
PlJgeTNtOV8rKm96QHAqR19BRUYyVEtkSDByfSlzbTxlJTtKCnpgNWticHNEfEhRdGk3JHlrb0E+
Xyp3e2xpPjRXeVJDUCY/bGRjO3d3biMrZGxrLSNJaGBGc0ExSGo+dz84ZVk9TAp6eERDSXE0QCVS
MUtBOUR3UjQkZEo7T0ZgfGZ5ZFNGJWplUVNeNnJMe2FYcChgLUNFTVhnK2UyeiszJHNJWkVkRnIK
ejdXbyEkZVA3QitkUVd3TShgd3YmOFpDfU5UYmw8Mz9TNmZ4MSpSRlFAdFFueExiX1R9SzQ4QHpo
bGt5Pl8yMDdICnpTUXZXd0A/fmI/YVlqWilSdVIpWWpWJmU0XlM4UUlAKEFHZURjVn1lcVc3bnNU
ZkNJUnZATGgjc0tHNDlFOVFCbgp6NlJePj9UdFRiZDVMR2ZDSiRqVXVjNiljKnImRTlmezFldGAk
PnNQfVZYXmo/QDkzeEE9UT9SMExgUyZaNHJTdTsKelY/STVsIWc/OTxRc3A2TUJ6TTs1KDxCfTZz
Y00lYE1EUUdoMzNafHZ4SD8pfUB3V2NgPHFrSkgod0ExV2k8MVlfCnolQU5icG5JcmBiOE4mKUQr
TEZ9QDc0PGhwTEs/RDhxKHc0dDErVjtXKkNoVVFCPTdCWmFHVmhtaXU/V2l5OGY0cwp6N2hjeHt0
ail+emx7SnVlN21XPUtVNHtyMVp7RUJ5JGt6P2RUd01FQCY5QXVyO3xCYzhraHlzX0woUEtWOXJK
O0IKej5AYihvcHgxMXZ1JGdkQCFiMF9wPjk1WiZAMVkyPWtGdlp4bzAwaztQNmJ+TUluUXlwdHhC
WG5qck9jYUJUcER3CnpWYXw2NExSNyUmKU1heVgoKXhoZzt5fjQ2e213I01TRWFvN2w+WEpMdEhn
I3FERzc8NWQzQUdEKWVqNklufmdMcwp6IzlsRHY/Q2s4MmJqRzdjc349Q2VhVlExZTA9ciMpQGpm
d0NaRChVfkBraHhvaF9mdmBvMkxUTTJrbjNMPXFiO1MKekcmRDNAeDNzanhkXm1QQ2V8dml5QF88
PlAoUFVfJnZvdntIRkNfTkVeSjRSd3ZEIy1pbyVobCV7amhnfEx1dkZ+Cno1U2hRTmMmYkduVVA/
Y1JmP1BNNnAlZkliSmxAaDYjUUBRSV94JkJ9bTZlc0pUWCE/Pi1vMVBBIUFYJWJYTzVxfQp6N0Fv
QXZwVjtEQiNjKjZ3QEtCbS1VI1RzeiRidGBkTm1KOClwbUtodXcqYzxtX3ElaiM3cTBoRSVzfC0z
O2FaWmQKemc4THdCKEs3S0xLNldsKjMwPCR8T0ArI1Z4WjJqPHVBezVGQGJ5Xy1nNlI2eiVIJSsk
T0lrKW9wPHJ5fD0maXtOCnpLaHB9dy1kQmJ+UUhANzRRMlRNZFo4PWQtJDs4NTxQX1ErZ1FeQ2VX
UjgleSs8TkY9WUtSQDM/TktSP3JrOTAwUwp6LXRhaTtQJGB9WXlMUj0hZmRrWGkoO313anBXRTZC
aWlfRTxHKExUeCljP3tUQTN+Q1JHUWA1Vi1TdlVYTGY2MWEKenZWenVBWDdTVEtgVDVWRVVzeVNC
cWZnSCVwWkJ8SzFNVWJPJiomLUdAZXE0OVE+PWs+Ql9zTWdCdSUmYXRxV0k9CnpMQ0FUQ25YY095
Vy08JmxQOFBNOD5CP3l8JntPMGlwaE1FLUBec0MocXNDWmlzWlBDb14oc30kRFhHflM7YDVzeQp6
U18/aXRLMF5lYjZFZCNwP35WdGE3OEU/MnFScW0+bDF1MENWWUQlLW10JSVsJXE3UjFyT0N+JWNI
X25rT0gwYyUKelhfcVNvMjZUckdNS3FYK217LTRua2U7dWIhRHRwS1dAMkl6dzdwNkBaI04qUTs1
aTxoc3kwKThWNjwyYEgtOypsCnohV21Mfnl1eU59dylVNnlfQiFBQilHNXpMYUlnXjdOcVpYJlkh
PWFha1JoR0V6YyFJbjxgJmYhJmBzQ0JTT3ReOAp6ZFpNUjMjaX1XNWEhPlVgY0tPQ3xaTGRXeSpt
TGZPYz12PjBZXzJSdkpnam9XaGlEPDRyc0ZOTFNHKVJFMy1UQ0AKek1fWHYzYnUtVVRyPmU9alU1
fEpgNnxRU2g3YSUxZEFpJT91PEZffnIjeVY9eihOTVMycDxxezVRKEFoKG5AOHRHCnphcShocjBy
QUQ8cnxOOHNrfml0czdLWUx8VnFHdzM/QHkhZCUqQFEqYjNhTjkzeWwyentSeEM4SW01YEsjS2Nw
Qwp6Z3dWT2M4aVMrPnhLWGo5Ny1wLVd3YTJNeWJwZE88UVB3UTlSNitZVUV0Rz10VGR7Y0V0KTwq
NCYleGNmbzYyNXEKekRLc2E4X2cxbi0wJWkrbWMzKWt7YDw+QTFJTncpeFEkPERQIypMPl92RHRp
I0d5eHV2JkVPYHJsJTk5fkBrWHFFCnpRYEs5fUBgVmdpTjhhMVhySzFmR3haTmNkdlpkOTFIKTNN
OHhTXndeMSpmZSZfd2B3dW5PbUkoZUtWbG92N3VVagp6Ml5rcH5LRTg+ezBvUmBTeihFM20wR2FP
cm0kSWNka0JYNDZ1dz5KYGlqTD1SZUxGalRJcCEwWislIWc0dTYoViMKenk8eWokeTB2fVdBbWVq
O3lVVEZ4N0Y8TFBIcGJaM3VPWk95JSpAMV5lJTgmOWYxSEB1XlYrMkItbzMrfnBRbTdgCnoqSGwt
fD4ofDBLSmNRQmJEfUwqekYyK3hoNHN3JkB4cy0/RElvcjBSNypUYkpCRHFKJiQhcnNEY2tVWCY3
PH5oUwp6I0tnb0s2e1prai19PWxOYnglbVhBOVd3Unk7ISVxdm12d1V7ZCRELVRMdUVqTX1wIURU
KXRrR2s9Rn5hJCZUQGEKenFZdHNzWFZUaH1sOVIjUC0kR19URn5RdUx3WU1yeik+ckdkWGJDM0tz
OGdLIXFgWCUkckNSUXtGanhjbWdyQVJaCnokYWxhNlA3aUs7dTg/WkJDYnhRTE19fFZrcEYzUEhC
bnJoVzJwQj9vRDdheVQlWVpMZks5e2FMR35sKkE0aV9ffQp6JH4jOGRTe1k5bWgwcV5hVCkleTMq
RkVGJSgraXcocDZjRm1EemB7V3BZSG9tQ1dKYFhlTDFgT0ZNfnBnd3pNMysKemU/bXN4bT97S2JX
YVEjOUtVbWBobzBYN3x4RXB4aUxBSkhFNisodUgyI1pDdS1NNGB8blplciotRk1aS1FxXkYpCnpr
bVZxbUBrTXo8JUZUUGhSbiFBUDsmKiU2aTZ4NzcpaVRJZFJsdTVLVm9TTGJRNH5nKTh5ZG9lPENP
UDRKOWQodAp6MGJiUiN4NFEkRkQ8fUI9RzxrUH45M3Z7Z1R2Sm02VlcoP0xhO2ZWY2h1az9rUnxk
eGBoSzdjJnVDOHJLQkUxfTYKelJ9Xm8wTHtvKS0/OHM3OWNJbFQpWT5APEgyazx5ZlI2dT5eMik0
THhKJDJzKDVheitSMDhYKTRYcygpOXlRe1M0CnpmYXcjfXd0MGtOY19+Y28/ZHxfNXYyS1A4JmN3
dSZFTW0zfXVyNWBiemd5JDM+ZzdpfWl3KSVkM2E3VnppXyZUQgp6eG90N2cmMmVufEZpcnQ3a0Rj
QX5EYnc3XnZGMTEtPER4SFpaRHBvfmRkaj0yVVkmfT5RZF9OVmpiQHFkcXRXYW8Kejk9fD5VTzJs
OT1Vb3NTa1F3RHs1SX1LIW9nUmFRMzktUUBpWUEkQXJYYXNOPiMyMSZ8U0deKXRnWlEqR0dYc05E
CnpneHBPSDZwdUw+OXh2ITloYmROLV9tJnZDQ241Pn04VVlSfEBxbmBuKmAya3JITDxMNiY2cllj
KClXN2RHeTVHLQp6O0hmQmVOU3AqJSo4VkEhLVBFJVBmfT93YG16OX5CY35TejdWeHgma3VXMjM1
b1p2bDtjY08zaEdONGdHQGk2PG8Kei03VHlkLVg3a2wtYF8jcXstRDtqSGR+WHVwTFpBX3codm84
ek5Ea20tcUZFbzVxLV9MKmI+c1oxQjg3QEk5bGA/CnpPdGNaJWhMRFhITUBEU1V3V210VzQhQVky
U2o1fVMlKj9ucD81OyFKaVdiR1pmPjZtTVAoPnw7WXRNbGtUNWpLTQp6NGM5emIlITx8R0AqR3Fl
NWRheDxRWUNSbzZGaDI+T35aRyRsUHY+SThAVkNOWnNWVUg/cnlLZXJHejtAYEo3fFYKejgtYDlH
NWFpZEt3MG5BYmUwSFJzazhiWGFrVGFoPXNrVXhEKVAwdkdkLSZ3KU9oSXcxc1FOYG1DbnMyVWYy
RTY9CnpSTWZwPzYrKXlNRCN3QTNqfUpefSp6aj1gUEIqdSRKRntfPVVFRGdOeU1hUUdCYVRmPlM2
NWZiZT5yYlRiK3RKfgp6dHZ5WXF2IXpBT1p5fGp1KjdedTdSUn0kWT80TCVpSiQteTBFfEgmOElv
UkE9PyVAQEVlZT89Zyo0V0J3MWE4WV8KekVxSCFLTUZxR21jIWVXPGhUPzRfWjtnXldSTjtQWHFV
S05qQ05jPDVkajlAM1E9WXQyZlJOJFgoajshaVBwTUtGCnp4R0A5KDBAWXk0SEVeVUtmPX47bmNS
YXlwXlhrYzRgPUomNWchdWhDKzw5YCVXVHV3M0huWVdMRHArRmluPlQreAp6S1JpYHZURVM9JGNN
WWE0ZShfQDhDTU9IQkc/P3E1MDNuZWB3WUJHUV9+OCg4KEFyQE4pZUVUaVo7Y2BEazRBQVYKensz
dit9cDBXVWQ2O2phREt2Z2xecm5sYkhTMExtNzkjdjx7XilvSXFIPnZUUWZXK0pqbWg3JXpLZTVr
TEckd0ZhCno5N2R1a3t5cUUhPlR7YFpvOTd6XzkhYmZVWHZ3I19RPjQ0eFZZeGI7dzwpdH1lTFhY
fSRhRT93aldue0BHZWMmKwp6RksmZ3NXRjxEK1FKS0A+OGgyKFJfTi1fYTEpcm1wayRxWXNeaHhm
KSg2Vyl5UkJCNndReWxgO3lEX3RnTDR7M1QKekhDezJabShDbTgzdE4pZUkoLXZVOVIpakM7flJ+
Wnc7UXlBe2wyflBRfF9GfHEjTkA2KV4kaT9BI1REY2QxY0s/CnpycTheN1B4X3RUaUkqPX48M0VV
aFZBbmorKEg0fGhvSUJ0O3pBZk9ZeDR6OSRFVk0penRkUzxKPXluTE95V1NmQQp6bz54U0VKNlNV
R294NGJBWHtFczZkXnRYPU1HWElkUXxpU35yJm1vUCszSnFTbXVSdTE7JCs7aXoyZk83emRkKSUK
ekl0Xj0tJTM3WCZCbkxDKipkPzxSTns5P15QTWQ2K2peeilHSFQye3hUK3MzTExNPjhFQ2wrNShi
Q014KmVuRGdrCnopcClBIyNUU1E/SHY1eE5nQ2M2MTYpaGhFPikyK3Vud1FEdmFQUX5KRGRfUGle
VCUxTkB4UjRDbXtmT1pPZD8mYwp6Szg9M0ErZFpqciFaUmA4V0lCYj8kbjVlekYzO1RlVDgpbiFV
dy1Wbm1zTEUjQ1h8cVRJejRybDtXMjdGfEwjKy0KemRrSSpjKm5adk9kNEJWYWxSK20tYyNKMiQq
VSgpJlQhbEJ2SE5iTTRieCsxVU9INik9PDF2MD1TbXdua3NEOSE2CnpGX0chJk0hfnpweSM3NmRs
S3hCTHhHWFdGRkFkdUYha1QpdmFFTUgjdGI9R1ImVmk0emRuPUJtS3JGR2N5QE9yUQp6eWhzOFVY
dS0ydU16YCglKl45NDhaezIqTVFueHQ3S0R6T3BRPSl2JG8/b1cxcFcxQHdNP0ltTUxpT2Q2cnc4
QmUKeilRRGBmeF4lOVJOQm9Da0NvbE55UyNPMTtrbXpiXyFjQjk/TD9TdU1YP1JYdi1zP0UhQXBJ
PyhAaSh1STctQ1Z4CnpxKi1Mdjw0dm10QU0xT2dvQm48KV9xYllxSFRYTDVrPypxKDZwcWheRndF
eSpsWGxMJGJEM29EbyY2WTg1OyZpUAp6fDghbUd6QFdMIyFmNWNZMyZ1QF5XOHl7eCltT0coQ29M
e3hlXkdAU2dAP0piKGdTclRhZGNJNlZEPmhXOWRhKmgKel8zcXxVXlNxOzZaU0xjMSFzZ1YjPWU9
a0R6b1lsMip8Xz9zeGhvJUhgd0laYjZjb15UQGo7bUdITVRtXkBaezttCnoyYlJfREpmdDxHdDBw
ISE3OXZfcTV3OSNKQXhVWHh1MXgmSyQ2Q15JOD5HSkxNS2UmfHZfcG0objc+fU1VJjhgSwp6LVJk
TmhJc3VqM3R2UTFQN0A2O1hnYkFAZjZSYGIxMnRLbj1DUHk3VXdoVURea1BwZnY3RkhJUHBxPT9E
czYtZ04KejZvSDJkKiZMMDZzNjdrLUJfSGJmKSM7djU7ejZ2TnYkV2Fle207WDhKMD1TKXZ9WDFq
IVBydHJmTiFCLTMhXkB7CnpJYWsoY1Z7JWc1eCt6PWImSWZaQkhNSz92emtJbF9jXjZqLXRhZSkr
RTJKZVFVej05RTB2UGM/Y0BHbHpyJCNGZwp6V0xIb35yfnR4ZlFJViheQj1QLXUoUzZSOWZONT1R
WjA8cVAyJkUkKSg+TCN7YW9JOT5ZdlBZX0olSWNFZXA0SmkKekhaSEVRQUA1T0FsQzstdj9TZnYl
dmM1VXIrYTRZc3o8T01HYTFzI1ghWEs+eiswOzxVUjA0LWw7SWxUPG85amR5Cno4UDQ2PytkREJh
QCRBe05tUXY/KXk5eXVMP04pJVZrP0x5Izl1WGVJOzdXeSlsYWVBRUswdSV+Nkp7azZFaUIwSQp6
IVlIZXBgeHk3T0RRTFZRbmdiWXA4UlpNVzZqJmUpVmBqbVJTZTBycGctfiVWSn1HSVB3OSoqQDJI
aF9PPXFJMjAKenpFdVJrT0RaJmY+KzFxcD8qOUd6Y25ubHh4dypOMmgkKSR3ZCFKN3xzRSRrXj47
YW0jaEN+UXQqIUdgQjF7VkdoCnolOCV0UkN5Km0rbFRmZSVhRW1QenB2Z1ZlI1NUU3RFUT9Ub21E
ezVIbCF2VyE4ZjxtbVVHfkY+NWdnOH01aWspJgp6PH41OWFqdEBCR2MtdTtnJE18cl5XIS07NUpA
e2IrOVYmUTIhU3s3cGh7SW5GUEpvYiQ2K2RfPXkyWWx7dj1ESEwKekh8SmAjcnp7Nnh2LTt0JkpF
ZUIqJEJBbntvR1hGJGgtbTF+UkpeVkc8bX4lLV5ZbThOczxpZ3N6el9pfWw/SHxeCnpgWj1UXk5L
Kj49QDhJWmsoeGlMOGVUeXpVZ1Q/NCkxQlJUZzhWTWU3YHVJZnFJcENjMHQ2Z2ZOWlc5Mj12STNX
NQp6Vz9pdFEhbz88S3szSXpZZUVGPjw+dFkjcDZYN0peYFRxSWd5MD5+K05+ejg/KmwlI2VndGRF
fF5xOzc/MD1admgKelcren0oSGh+TFRrY3djfEZzWExXO2l0XzBgdD9jYHhLMTUtKFdfVHlOUkt5
V2RZeDlNeD9MTiY8Qz8hI3gob256CnpEK2VvJHh9bVUtezQrPilrQilnQF54ZEU5V15DVyNCRTZH
eHdsTSp1dmh3SihmdXU+dV8zSnJmOy18MH5OQXB7QAp6Kitmam8wfiVBQ3QpWSVkbXZVbFZxR2F5
fHhBMHZVb2M0OFhiZ2tORjhVVGpwekI8R34lTilfKS13en15KnZXVGsKenRob2FYUkx1TUUxMmZI
fXZxM0JFR0VsJX5DWn1ASFUlWTwoYHNRcGhXOypsc0xKaGRpeDliVj0rYk9fVTtyWDxaCnpnaVVm
PXdrZ3pteilOZCY5e35MZDJyTXBHUUg0cDc8LV4kYCVRXyVNeCl5XkxadilxMCRVTT1vSHswK0g/
RmQ4IQp6NyQ1RjBUIzljNC1zZjlOMUFsKXhyYytzSitzMkIrZjNmb2Q0OTVWKXg/bjMlRWpBe1d3
WU4oNlhRfE9yZWpgQ3UKeiMxKFI+RmEhSHB0aGJOT3NXOCtTdE1WREMyK1B+XlFpWVhZOCR2PnFn
QU4+I0BnYGRNUlJIQ0VwTm9adWlvRkFYCnpLZ20yZSQjeDNATCN+cl5jeWRqUnlNZFk2NCZjYmxe
WnVVakdKdiEwcTlNT2lac0hSWUQrbmxXdXFgMDt7QWJUegp6SGhkPSV0IWd9PHNZVEl1Mm40Uzgt
UnhBX2RDZm15VElwPSE9OypqT1QkaUQ+UGg7U3xpVWx2eDtxYWAmfDc1b3EKekE/akJGWTZTIWtS
KFFMNTN5a0Ayaih3JWl3aFF7NE1UTGFZbCE2RnZ3byUrZGdTM211I2hXcVpjc3cyJGRpQVp8Cnp0
elRUXiV7Vkw0KmhJMXdlKzFIKWFeQWxiZzlCXmBidD51eGNaaG9QMUhwUntoJm1KUHhJdTA2Z0lG
e1FFcm0oJgp6VFJPSUhmeX1eVjkwWillQzVgUzBCLSNYJXpfIUdwZUM4JCU0ekVyXzVzaGEyJSg/
V0c3WH19dlVGQ0VuMStNaVAKemR6QDUwcWVfRVNlfjJhanpMITtLUj5rPUQte1QyYnZOfnh+XzN0
UTZlMDBgeHY/e19JTSNVUzlnNzNQX1lYIzZ0CnpPdFB2cHBfT0N1VmJOTEZqO2JQKCVuaHthcXpK
cDtVczZoaTMlQ1o8WGVla2RydGB5ZEBkQkIqUkpWeVlLZnpPfgp6dFBsMnxkSH5DPXVoIXhveUNA
V2E0bjVtIWo1P35eND1hbH03MD52aHZUX35qJV9YOCRoemBqPDhsRWhAaDJ0SSoKekBUQjJFYSRA
M080WlE4Z1JBWTA2Jjh6amo8JmIraz5yQnlgRzQjWlRYZFd0VncwSWBBTmx5fnE2d2NUTlomSyVp
CnpGV3Rxe3V1VHNIO1l+PWg5bFhnSmVudVU9MTN5bnVASzl5ck58TkJgVkF2cms/aj1tVzhpX3t6
eWZ9d1JrTyY0Sgp6Xm81V1pDclY4UTM7eUF8eiE8JlJVQURpVXF6UktVSjZyQEJWSmtfMShSPU1y
I01TVF51dD5vX24lTSNuQl9MQmsKenhOZHJvM0JVWTtsbWJgQThJcHA0XzdpUmIyUXQ8WW47VHVr
V0IleUBTQStrRzlzQl47YGRNVVQ8U2VuYzNORWNUCnomKyMxeXJ4KSlaZjFIck9PK2EmaEgqV35H
en4/PUIjTjIoQ2lpWmAxeG9oaEQtM0poNGpRUVc4JnZveWBVb31hcAp6NlA8TDVKPlBPfVdPekpy
SGFAU0N2SGllaXt6KWw8eWZ6Z194b2hGaUslczhLdz1AXmFIcGwjI3lOJDRrdE51QC0Kem1GZTtl
ZXVzQVcmb2BDT1FSc1l+eXcwbD5fQV5kdGdGUHM+NUlHZ1E/ISEmPlZVM3FNU3RneTcpJV5UJXdw
cVFYCnpxTlktWnotXjAjK1RyUCVHc1N4SjxLPTBAKl9Ya0d4PTVHc284ayVkVik0QHlNXkhAJjVX
dSNQMH1BIXozMExJOwp6PHklVWgpfkppYUNYTGMyU3J0ZTgmNjU/ZnJreWgwR2ZGZVBYSWlXfCk0
M09+eyEwX0RlKUItJlNqZ0dZd1UpaDQKemloQ2h6UWZIUT5mfG0mem9laiVZWi1gT2h5bVB8b0hf
Zn5WRWlIWllNUVJSNkJzd1NsMjhSRlY8fXJwX0B4JGs8Cno3UllqOFVDbG4rISM5VnpqKSRyb2JJ
TG51bXIqM2ctMmJZe2lhSzB+Q3tmbjJRcFQ3OV4yNFhvR310Sn5oQVgpQAp6TTwwWX5hdTFFI0M4
THtLQz5ZZS0+bmgjNGhRN2BrM1JWZUo+KTZvVDdpSWtYJiMmKkZtbTEyQmRtRGRHQjJ1UjkKelFw
PUFeTVYrNmxAZWU5eTJ1YiRNNVN9RWYjKyZpRWhEO24mSE1RK2pDYkNaYU57VnI+em9xK1MhKDZt
bXBGQ0RqCnpnSyNkKEU5Pi0qP195byljRkFZOWY8TXZOT2tfU0lDPCFvYlA+U3khTXkjVnNiWk11
P2dnRnB5YGlLOWFLU20kVAp6PG0hQ3RfNVh6VEs9dGtOTDImfEk0Zml5K0FVYXlnPjNjKjJWP1RB
TWZyZHNpJl8/UlVNPiNBNl5ubjg1eTdlPXgKendlP2M+VUhpR0poVFp1enhCNnB5MHJwJm9adTgk
eVpVSWV2NXRFPlpORmd7bTVhdENoVVo1QEY+e3Z6M3RGT0hlCnoyYnVEWnZCbk9mNTl0X2lNczYt
fFQwMWA+aUYtO3VPcTxeVFNXVU9WPlc3YVhAMkJ0WDNIelUqOGR7YXcjMGE7Ngp6Q14lWXRmMU0m
NXcxRUV0JURna01BWWFhWSpUTHJqNnllJlB5MnVzeUN2M2A3YjwkbmQ/I3EqaFN5e3pgdWBNPDsK
enoqRi1WSlBTZkpAI1IxVzBWdTA1MXU4Kmd8SjkwTjFpd1lzM1I0ITFsN1Y+ISNubDhBRzVyRE9P
MntVeCUqO1JMCnplUjIzWC0/djZMUSgldzhWazxFYjVmfHRFa0ZiYkhveVZgcHNhVnZyNFhXMTlw
WTxGNW18dGQmWUZ6cXA7e2dqWgp6YkZ9Q2dTd0tfPCYkVW1CaCF+RG84ayh7PFc1Sm94N1c9JmI4
TWU3V2kxVDF8Tmx1UStaY1RsQ0BVTV5ldCFIVnwKemhuV049Qis1VyMtNzNmeDFlNiFAPiVJKEM2
NyE9cDg4PzdRekpTdC1sQnNxMDRJdDw2JipsZHF6IWlTOSpgNz9SCnpYfFh4aVJmREYpZkw3Ukgj
aURWVW5OTEFNTDBRQEFuanl1amYmemU2JlFTQ19FbjRGOXpKMHF8KEVGLXwtPTIlUgp6MUteUEph
Qld7LVI5VC1oUH1RJHF6QzNEWDdgbUU/d2UwKlQ3PCYlSDhlcEMtKX0/Y1FgfkthfCo0NzFkVUB5
PFMKeiRtQmk7ODJtVVhOdUduQSRWVlU1RDdiPSRMQk9rTlViP2lyLUljMm1YTClQJXR7eztxOCRk
MSRHJkN7X3NJTX4+CnpQNjkmSnNlLTRVSUAtJXBweThQOTE9ejRBSmBjN1FVe05GcHhAJkV6YjY9
Py11X3E3NlMxMlZ3P2ZBNUk9emUwSwp6XllgXzAzaUZncmctfDtISGBwX096SC1RUTFoaCN8OXlB
UERXTVNqUGxPQyNuS2ZiPX1yeWlWVit7S2YkRT9xSiQKendQfWV5ZEozfklhPTMlYVM+fmBxdWVG
MUNJMDIye0F4QmRMO3Y3SmxUcjBnZF9hMCk0NzdiWUFffmhqTGhpbTt1CnowJDE5QkRiN3F2Oyhz
Rzt3RSMqMTZkO1F1NEl5OGloP2ZlI3dLVDM4bkQ0aW8lbmt+ekh2SCRHRFFWPE4tfjlUQQp6NDxE
dzhPdjAySGVHcnY8eGQ4Q0tIVWQlRDApcVY3dFFDMVgkO3xicioqfVIzQVhTNEZ7a19udkFqfHlj
N2gwRXsKeiYyazJHbVRzMlBaWm4lemJ3e01uNj1xdyY5QU4qTFVfJXZnRVh2bC00dkxoMmdwK3sy
JCYmVDMtZGRpM0dAXlgjCnpQeGNmNndjUEppWSpQM2dOSyhrfD54Jn4rY3VaWEwqbGVxZ0opRSk5
PEsqT2dgMFElTWZlY3R+S1Q0OFBSMEtHeAp6P1J7Vjh2aUJtQzUxPWk3Z1VnPC0xPik7aitnOWM8
ejVgUkIkTntIZ083TVFeZyk9ZWZgfUlKJVh4PDFNQVUwUCEKelJucDtXOSZYPndVKjlfTWV0SXpT
JE8oU2teeSgxdTlgTjA8TWFAfTJvPXZ5UWpHWHNod3oraWFsNFJBc3gkUXhrCnohZWJza2RJVzQ3
JXxUaFpOciVCfDUxXzYweT9hV1AxVnhyNXUlVHQwTispKSFqM01ncXUlOFJWLX55SksqQCVUXgp6
YEk3fmwjU01EXyo0RWEoekxnMXVKeGEpRz1MXzBBLXhaJm9fWXhseno8OXs2Z2QrK15wODNycz55
R3YydV5nWUEKekVSY3lmXmcwWWVoU3gjZVkkI1dUZjtOV2FZeF4lLVNZI3c4MylKNHgrZDtiSUM8
VU8/ZnNSJFU+JDs1OXtMamhwCnpAbzNRcTd+PUYlSHlnXnAqfX1CcTAoengrTl5Jdm5oJTxZSHQk
Xjh8QE9KT0VLZVVwO3ErN2QjSkdxVTJmM0deNgp6Z35ld1F3emt2OUFpOHpzfEQoeUI7bDB2Snpu
M29PbGA3KlZURkVFX2l3dWdyT05GO0pWSGdTPXZLLUEwTFolRmEKekYkc0JoVDxiZ2o/dHdHKkFy
PDNySkpGdnkzKVl8fWo+cUQ9VDxkd3tfeEQjOWxMMTVocCpLTDR1b1hHQXpsdjNVCnpVcSl+cXBn
N2VWKHUjZm1mTikoJXs8fDd1Pm9ae3llX3N5e150N0AkcCZRb0JfbmM4UEhiNz4/b2loKiY5TmM3
egp6KHheJHglRjElOUZnXjBeSjthaSFpPzh7PjhjaDchUXhOQnY+clp+bXtgO3RJKD19OH1Ye34q
Qz8jQSRLdjlDaXcKej0+PFooczZLNTg+JmwzSlBsZC1najVXblBUPT1iXntKUkZFaS0hWjNCRCFG
Ryt8bz5maGxUPnh7UWZ2X0FweigjCnpUOHVfQDhXLWk/TiVzTDtzaiElTl47eSorNjhxbyVNOHgm
TVJNWXYmeUFCd19SKT9PUE04TGl3eFEmRGJeZGtzYwp6aj9+SHI3ZCYhO2taNmBSbT89QXI+JkQt
aXV6Jnxze1o/K2ctYWs+YTtLJSlkMF4lMk5tSih1T1ZrQVMqYi1YNTgKekE5dFEjKEg4ZEVVckZ4
Z3pyYnReV1dxPDhuWnI8ZXs0d15+ezQtaSFVSmYxXilvXkFQb1NOTW9nbGA9RiU5U2ZYCnpLfVNe
WV9lOz8/QDByTFZwLVRUZkBCWTZ1UCtkUTI1dm99I2VBfVlLa047KDAjUkdMRmlpM0c0eTl4NVFl
KGohXgp6OE1JYGF5elFEVTZQR3dDVEZ7dW00bHIhJV9lWWNKTVNXKENBYipsS2BCIT84dU42WV5i
QEhKV2lwUEY/QEclOXUKenVES1FVR1FAcThCd00qKnl+YCtjXk98P24lMXRaZEJOKF4qUj5rQzx6
NmltNFZRN3ZISj1EPT56OUcqUktSekpsCno8QXl+IXN6byokeDF2eENqdnVsMSQ2ciNhaFk/Iyk5
WFN0WE9eI0tLIzt3UiU1fmxAWDJVUHtQZkFLS1Y9JlZTKwp6cXQxQE9eMXQjfDhlaEElOFc3KjE5
NDRvWjsqbTghTDBRaFN5aTtHUz9ENXU+YENFVChBWl98QSleY2hUI1RoRF8KekdyI3NFVldnZyZA
OyY8I0p7byhpeGkkN01uRjJnXkImVHlBKCZ6M2g3OF5tOHNwamY7Wip6TU4mcmNpakRRPm55CnpJ
RSF3UUR+cGFnZFRoLSFlIXlkcjlMIXozIUMwZVkhak9DZERpWXxzNktBNk14MztiYyhtPG9hYUZ0
dXUpRVFvRAp6a1A+cFc1T21VaUJEbk8/UHpgUnFxaHo+aFdDUnJkNEZFckdrUl4xdzRHfGhHcG0j
aHhOflg/KUgmJUk1Z0RpKlAKej1qWD5AMCsoOV5wclFtcExWNnpuLUM3IWh7Kj53JEZFcVZINUxL
SjlLNDQxMytCYHYmWVBMUlZwX3xRNGRFbVh4CnpJaUk7N09UZFlQS254V3RsU1RaJiUjZ2g7RDhX
Q01yYXllaEx0c1U2ZyNJVEdxPyFIR2B+TF82T35vUCt1MFNfSQp6d34lODZSUENuVEF9WldyO1hU
an4xZWljRGNFfmtrRGt0aTIwTDYlMW5ORWckTVJ4VygqRDVXJVAxT0o+YVQ7c34KenhZaHNIMnVL
NVVLO1lDVndJb3w7KzFjKy1kIVZAZmtCVW16UkJtfEJqfn13T3QmZX5Qa3FXKz1ld1hyfDZDai08
CnpNfj0qTnVDMStzaj9RZVJfWTs8SDFObHVfVDBYPigqJW9MJHg3d3gxY2xkQm1YYWEjMFV1NHhW
NEJhX3cmfm1pOAp6PkskZkNMR3VZVGRGfCZSXihrckV7RkU3S0pZbkk5REpqJFB4QWlZR1lnfnFR
Rj0lfV9WOG9JUTd5XmNhPylmJTgKejd5eThkUEs5WTw/a2Z+Snt5I3tlb2shQVhFPE1rNnBhYVhn
OzFIVVluV09rLTBrYTBRb09PVl9fUzh9cjRKdUFxCnpYPSRhfiRiJFUjVyRffnZYTnpEWFFIYFU3
cmNybHgrZX5JIT01Jlo2NyhQRCNBUEEyZFZ6cXglQUk7TTRheyh8Ngp6cHNNMXBQdTM7Z2leQ1Mw
aFJCQ1dwWElkNmMxO2hsRHpsKGA1R1BgRFluTk12MDh6KHpEKGRXbUc+fUFycUFAU04KekNZUkR+
X25aZWcyeUo7YTg0Ny1jakQ0YDc7NSFFbU1ZUyhwcClSNWh3OWlLS3tPaEJqdT1EV1okKFVmPTl4
dzxaCnpDWiNzZT1tbmo1NyktU3k1UmFQTkAzSkFOT3tVLVoqPWxuUjtEUEEmOGRWKENBeWE0JXZL
YVghIW04IXp4ZVNlRgp6XjteSHdwYys+YzV6KUVrUW9wWSQ/fDF6KmdwaSt6LSsmJmo0OExudDEy
eXppPntvJDw4YkNCe3N8TSlrPSQtOzwKeigjKzA9UmhzTz1WJXxHZTA2KnNRP1p4R1d5fHJTdW5o
RG1EeUhlOH4zWDgmbWc3KG07dil3fTkhQ2B4dGlvRnteCnpPdkMwRlUyKWRAT1Rrdj9jai0pKlc3
PlRjdThLTSEwX1ptPD1lPjFfSGVqS3E3JCN0NnRle2czK0YzTStFRDEhKgp6K3dHMU9Nbio9aUZk
WUM2SmpPKHIpeWxYTW5LSnB5IXZ5cDxmVkt6ZGxlTlBONnVQJDdSKDBZSkR5MCgmX1M2Z34Kek5n
JHM2YDlMUSYyKWd6Ujl3QEdTO0NzbXslSCZnKFp9PCgzamM/bDdicFhyO2xoNUZubXpTWGNzKWE1
eVlkVDdGCnplTV9RJTdYSXAkRTQralI/Z1o+ez12WnJud1FZZHJTbWtFYlU5cXxIUlpGWjZFR1ZG
dHNnMSlPd1YqQHA5fV5GZwp6ck9PV2srX0FQZTY0SFZQYSVVLUBLblE0I1dkV0slYyE/NCNwdm1v
MHlFenNJTHxWXkVafXpfUiNsXilINndKSk4KemtVeDV1MVptKmtUJFBfaFFKQGh7LVowNmhebWps
MzFmRD1fZDFhO2RncTtRKDNMIyVXSW9KVl4rVUx2WWl4MHZrCnpDTVBEdTVtZEdldTxgcDhSVT1T
JU5OWT5XUTQxTyprZVc4eyoqPlVvVlEpZmNMUn13WGtNfDZtamZVeG1WMCE3bAp6YU9UQVJGUFhz
bF9qSTAoS0pBWEktbE9gT3NULSo+Z1Y9WVolSz98aVc9NHpMKG0qLXJDRHwkLXpFaDImIWNKO3QK
ek4yOFN2VE8oOWhAXytmTz0yNi1HWntHb0x1S0RtXiRSJCRjYTQ1byNxR2VWQWtQKkZpUitBSEgm
czBvPEMxamltCno8Sko4OUE3M2Fxbm8pJnpDMTQtMk9rNzcoYXc3Ki1RNXJeJXFFeG9Gd3V9bE0h
XyNXcVZaNSMlQjUzIWUqJD40MAp6YXxyNjFGaDstV0tZXjZTPzd0eDgzJHJZODBwej49PDJ0Mnkq
ZmFSQkZaa1EzRGkpKiotMktSOV9KZCVwWXFBKnEKek45eHt4dHBkRmdtd0RUa0teWitJYEZIaXZu
JVByWigxdnc5PTZiQDQhQjJMQzt3JnFwVTt3WT07VmFiR0t9eEUzCno/d1oqeno2U21zPjtaJEha
VCZVckZXI19SN1hVQGo2QTJuVVU1RnZqc09GJCNOXzN1WTFRUT9xN2ROIVBBQDN+Kwp6WGRFPCEo
YyYzVUtPN3Qheig/c3I0M1dlMCtpU0NVJShKfF9lWj40JT5Gb0lNWnxjbyVnY2ZSMm5zOGhGJHVY
eiYKeiY/azgoKkYwe0FDU3Y3dDEhRUB7clVhNlpjVV5GSXtYN1FiUC05YGFmLTBROSNKfV9MZyZo
dD5xcXYqUk50ekpHCnpMan1EUWB4Ym8xPlJPXm0hcFdxfWNOPVI3bGgxZCpXeV5pVTJDJl8oSklV
P1pRYVpQX3gzSytVdmFeRkxVSG9Vagp6U089KDtFVShOd2Y+TGppWnRjWW8hIXRUI3g9dExXJkFW
N2kqSWp7aGcqdlVASSZ5SU9aNmckNzNeaG1lWW40Vl4KemEqQ0NnJHtkS1Z6bWhtKCVHPzgqJXdA
VWxacVp3KEdFZGpnQChnWnt2WnxWOUIlY2FmamQhMzRfMFNtZzxzdTdoCno5R0IpSHt6X0YjQl5t
NTVSNU5EUD1NaCU9KSU4OGBnREIpd2pRTDViUWo1WH1jVHNXbHkpY0EoT3RMbX1GfT8xJAp6YldW
cCR5UVA1UzdNYU5eWjYjZVRoc0M5MUxXUWFSX1pucTFwUjM+U2l9TjltWXd3PlkyYF5RMmspTEwr
ZTVsaE0KenFXP3slTGpnND4tdDNpJWVXWnNSajR5TFgmYHpYND8oaWIkdlBhKDtFVFd5M2kxMFJM
TVl3Ryk5SGFhVDlBKVhLCmp8M0NFRnwzfk5rVz1PdGU9QVV6JGgxQnJCQXN7I25VRypaPll2S1A1
YHl7PWAKCmxpdGVyYWwgNjI1MQp6Y21ZKmVYRWE9MHhFQDNlQXhaPyVxa1YqazhlTkU5Q1E2aHNo
IVNPcEl6JChKaCkobnhMPzE/ckU9cUpHUUhMLVEKem96YXNhPk9IeWwqWnB6VWUlSEl0UXtIRXZB
QTdCWDBQQ3EhUTd9YDBLcC1rajRPSWdXaHlWe2YhZWxATFdWWXdWCnoxdVRSJStVbHlIbzlNKWBa
Vj40SExycW0+cXFuKHhjX0JsV0wob0MmI1U5NFdiMEFSdUtNTUg/SWRAQz54YkA/JAp6WihRPXB3
O3Erb2o0MCZObi0/WE83TTdjNF4lUntZcmomKnQhdEF+Jj9vZHcpZ0BHU15oJWwoVz02dnxQekk1
LTQKem4hcUVqOGJxNDgrQDxYJF93WVYlJk53PkQ0d2MweWhoOT0+JmwqMVVReHJTTkBfb0owUEBF
KWBzQlZaMndXQkQoCnojalEhJm9xcDxpKklNNWVTdWZ1al9vKnV+T1l+eHYmOCZ5Rl80MDQ5OyZ0
YShiay09X258KnY4LXFkVSFUZUkpOwp6X0AmX1BrI2oxQy17LX1ibWw3SFZUa2sjS2ooMUF3MyNa
QGR4PU0+JDg/cj12Q3dmOGVuUiRNWCojMFhqO0o7YjYKelF0QDtzYVZoPE8jUWdDXlVAYSQ/RHBQ
Jkc9d0RBKF5fQ09HNEhkZyRDJU9iUkt1ViU+TiEpPXZWanFAI1hqazg0CnpiUV8/JV9gbjNKSXFm
eG1uUU9CVjRxczd5YSFHYjReTXMqeEZxXm5YV0ZVNChePDhGUCo+U0lGI0s4LXJHQiozRAp6eUw3
fjl3Qi1hJSNeclpQTCYrbi1UNz8wSSp1MmtVJWU5KSNKfVpBSHchMGxreTwhKSQkUXY+YFJnZHEj
bGwtRl8KemdVJWhxfEhsPkAwTmNyLURTKktDUWVPVHJoaDtRQTh8bCk+JnBhb1l6azl2VDk9SlIx
N1BKY2lEZS12clNgTm0pCnotJE5YUHtPens3NX5XNmxecyhnb1p4aWRqTlVMenViYk88WHBGRXx6
ZioxSW93Q0AkJWN3Z3BXdWxqRF9aKzh8JAp6XyNncVNFdEE2czshPnphY0s7U2MhQnJ5UCloQzcx
YkY5JTdzV0MpKjlxRDx5aDg0bF42ZiVDeDllS1NxN2AjQDIKem1pdyN5ZE0mIUJZIWAoQHVIQ2Ix
MzR+eEJjfG9Td2xaKSYye0h2S24jUz9fWTN6fmZ1TjBgJEJeaHBSTk5WX0Y5Cno4b3R3YEtJP3lR
YE1iKT5zQlVwdm00RnNZRXVvdW42X25nTSVJMGJXY35gb0RoRWg2dyVJPzBSME81U3ZEaFFQdAp6
c2t4elokUGV7Tzg7PTR8UkNfaztVMiFvaDg/RkhAaVdBciVZPS1oTyFmZG9fRl5mXig8UkU8Vkkw
MVJOSH5jdm4Kej1yV0QmeUdlTGZ5ZWpfXjdJWkM7V095U1MtalJrR1ZLYntrez11QTF3QU91LWwl
Y2FFQCN9SDEqS2cpKlcmOE0/CnpyRGMqemI8cSllcFh3Z18rUEVSVVF1ISpeKXhnM2ooczQ1Ylkz
aUxNckgpYWxhdDRiV1Q3U3MjTTBMXnhlXkZrKAp6dzl+SUhfaGEoKldWZVhQYXlpYHtSbWB2X0Bv
UHczSV5MN0NKcXx2MmNgNHFvdU87KyZDP15ab1JrfUR7SzxOSloKejJaT1leRlZEU3VZdldxQFhA
c2t+PWFiI29UcjszVXpjI0xjKlhDPmY7TUd0JilDeERUNWx+KFp2fiRhRGdufVJNCnojP3NmYyhg
dTYpWipUPVAoTHdhVFJTTyFSX08qVGxDUGA2YWM1fjttdEYmSDJ4MGdfR2xpLV5WO1Q9emhFRCFv
Owp6LUN4WnpSTVlgKXhnPCN1VlB2VXlfPUx5WHhRdTZeaCgqZmRoPlhyaXhgNGRAOGZ0JGR3MDNJ
KXNpaGQjJGJ8ejAKemBJQDdnOClgTTA7M2kka2l4a0tHQTM5NnZBU1RiNiV1THBAO1U+U0whc0w/
ZS00Nk9LSCFGY284Xy1iO2xrPjFZCnpfeXghPDBqNngxKG16TFg9bz97VlckR29TR3ZVdmowcERL
SyRHNmdoZFA/QGZXQn0/O1Y2PDd+ezNPKD1oWWl4dQp6Wjhsd0QoUndMZVFES2ZsVWtQKlp2fGQ2
eTZKRU4mMF5rfHxvMml7R2JQJHpQR24yMEhna0pSSEF2I14zNTg+eUAKenVMMGtHQzRvYD1pMlpE
YTZeME5zTWUkfVBDRnVhU25zVUFkaVcrVk1iRmBtamFCXkJvJih1dWZPVHpXIyZGP21mCnpANVZN
Wj9gd141NEFINmkrfHpUUmFzPzlFMUVoKmN7bGJQT3s/UCFGbWMrcUxvfj8xe2xWTERgb2twcU1T
Wl5Sfgp6R0x8KDJoaXIhQ0F+QUhWP1IpeENiXkd4UTdtNDUwPSleMWwxMDBxIzBJPCYtWnFBcjIq
P0l8WUYjeSlHdU5BfHYKenJZazUqJkRVSmtvQio4QjQlO2wwKyN7PyopMUtWe3RvUk1jP0U3R3dB
ZzR4PlIxdk50Y2I/ZkYkbXxeVzlCej52CnpeUVB1fnE9T2hidT4reDU/YmkxOUQ9ITxOUFB9YmtU
TW59ZitwZlQxUGxqXlRkP3RWfjxiZzRXc0BySnxpVHc8Ugp6Q2F7MVhxP3c2YjQzSV8maGclPjw5
WX1mI1RQPklfSHE8N19EQ3ZfVilyUGF4VWw2YDtKPEd1NHlwKD1sVnUtfkkKent8JTZqMF5+XmB6
QzIlVkFGSEpZPkcwdVlgb2BKfSU9JjxjUiZWKW5rMHtqQUxIZldBd1Bad3FBdXtGVnc8dnZ1CnpA
YEMjPXZrYjNubWVQTWRTY35WbXhUU31LLXZAWl4xN2s+Jl9ebDJwQW18YE93KmlwZ1p0WDIzaFp7
WUgmKGo4Rwp6WjNCUUQwTU9tRmMjYUVpVTwjTTlIWkRwKVgpSWlCQUVtJDNaXl5lJXg0JUo8LXxM
e3ZSKXl+fiF6MSRNbllrM3wKeiklcXBVOF9fIyV1fUI9RD8hdj4oIT83KSNufW1NUEhNR3xkS05K
UXxaRmIoaj4mXzErS0V5cXozVU5IQHV3KHArCnokY3MxPW8lXi0pV2tBdSFnQ3pxO0lZWCFhWFE9
SiRnfVYjeEF9RGJiPV5vPz10MVclNUoyVEtDQz0+NGExQFNqYwp6SGxpbSYzbShlPCpqOV8payFe
LVJpfk9oSzxEdnopRktaX0ZxLXNqZ1Z5NjwhcyNRXj8lc0ZqYk00Q29SZTU9cU8KenBVIVlsYnw2
RjVsc21KPUFGR2wkdW9lMlRNPkIrc2hDa3dhPDRBUnc8bnZBVTZzVmo5WXFwOUw8QF98czV6UV5J
CnpCUEUhYkQ1MiZ2WCkqc0FJS1ZGJD9oe0ZydioyRVNKSURGVmNGU2xeZlN+QSgoa2YwK0BjUSgt
dWFvUGUkbXxYeAp6ZFZlOGFsOCljbk1mN0NsPGo8JWxEezM4bHIhME9XQjhUPVhPYXN5a3Y8eH1a
IXVKaDBmOzNNUU00RkFPVkl0Xy0KemlDVkMtSyV8eSZ8OHheTThJTj4lJXkje2o7U3JgQy1lZldE
LU87dXE3P3J+NGs4Nk8lRE1aKWMmWWRQRjg7XjY/CnpyWWhUJTMrLW4leUdPIVRwK2tETTJKJDxz
QjUxfEA7T2V0ajVVQXNKalZGZW5yPmJoYnhYY19RMDRfKTIqfStqWQp6SUZFUS1lUSNyQmY7NUlk
U0F1PjwrNU91QmJzMXFwVGswNiNxc3d1Uk8/T2VPKVRvdEx3big9cjRkKDIpPVdPWUMKejRNN1VY
TmF1Rih2dFgjIyZibFErVUAtN2I4KWZBI2BITW10RXJMV144amReUD9+MFgpKHR3JF9MVzRXaXdF
IStYCnpXVEI1X0dvMiZwJlhxKTM9bUlIVzI4b2krKVBLam5zSkdqeG5qWE1uLSR8PjxTb1NPOXho
NylBenhxZkN7YFQ1bAp6bnI3R3xoYHgrN3hROE87SE9kfXJebyFYaDgyVTlQR3t5dGMkZ29hKkQq
OGY2emBDc0U8Nld3QT9hPSZYVyojY2YKemUkX0FBJllAdGZ5PW9efmhEdSMxTCM0S0Rha1ZSR2Bo
flQjblpBeEF7KkI9eUtWMkNSVmR3Xk08YSohUFNvOEJ1CnphRnlWdD5hZXpBPlI2eDRWKC1zNXYo
VmdzVnckIWJhYmk9Qz1kQCtSP3RJfVR3SzE0dGYydFFaeH5UVXk5TXtjdwp6R3JlSnMlQkU7TWs4
Y3VgdkNxVH1laW1iMktjKjQ4RWx0TXJtYz9kZ1ZHISVQWW5AN01ifUJiS0xueHwpLXl2KGMKekAz
MjkmQ2F2d3Y8WmBUeFpyYz43eSUrUDJWJEgqJHpOelo+e0RSWkhqU1pBa2V8P0lfe1UzK2wkPnhP
TD8rTlJFCnpgVSltPWJ9TThwWDlST0pMeDRAdWBeKHJlMD8mS3E4PU0+T1VNRnwjeW5aRmowfWh3
O3M5dXZQeEVCOHlXP0J2MAp6UkBRa2VVejh2Iyp+a3cjNyNBczU+QFNJUCFwPyokcEFgU0JwUmtT
cCkkMiE0VX41UUl1KGBMcFJ2I0t5Oy1HKUwKem1QKCRKUWxeanF7e0hVaihfdCElbSZkfiMlRHRq
fClfYT5YQypeR0RuaCZYSkYjP3JkWCtTP28kQEB6PyFjVkRxCnpmeURNNiRlckhOckVgOzVzQDl9
ZSgjI1o2YzkzYmxjJExZSTRxVU9hNDhSVXJVMm9wX0EhKG1ZaTYxZlFxOWNQIQp6SUV9ST5falAz
ZGZ9Mj5eayFkWUFRKilNPWhhdyQmTzstejMrLWdPaVpqciYyOUh2SWEoKEBjNERxPVROI3oqaDwK
ejZARTc8UVhGdGBaUVN8blM0ezllSThWcXZROExQaGo5ZFN4JD5DV2hLM1ozI1ZeT3IpZFMhbWxF
JkxUPEslOzE1CnotdlQlPCg2KCZEdGN5RjZrQGg3QG9rY305YkgwezU2ZGIpbFJOMDxyQit3QzRt
bj1gbVQ2ZCFVc0V1MGIkVmlEbwp6Z2hSK3FGKmJoJUhWfFYtQUBaUWxVTD8qRXo3YS1tYDhhQU1T
VXw+bFNBITlzJmwkLVdgd0NAKDImTkx+UEArdWsKempOMXlPeDh5aDxUe2lYeDckfTQ2NTRkR0dB
e2lyc1FLdDs3TnhpcH4qKWg+RWNRalVyMyledWomcSslVFE+VG81Cno/aUNYbW9GVFMoV2QqK3gy
d2F3VUMrQyN7R3tNZ25Na21ZeDhidX5vYCVPLU9yWGE9I2J3VWYhPXMjbkBfezlQPQp6ZTEmRXsl
bTJ7ZG9La2ApfERsSmJNLUBLJkxtVGJidV5hd0ZiSXNZYUw7ZS1hYjlNI0t7dVEoe0QxOUQpNTI8
Mz8Kel5zIUQwRll3UkUrXll8ZUxqISFwenhzIzNzQmpvUygjMiVrdj1pZC0hc21yNShBRTh7QkNM
PUJlRig/fGp4Xj1FCnpRXj1HQiVXaGl1WCE4UmRJaHVkaGBqPUhwU0kqdHQ1R0dEKmRDUjRYP2Ve
aW1yRG0qdj09K0o8TV8mI258QWJmZwp6WHZEY2dhI1FCPW8oJFZGO2w4SVhUKWJZVHZCSXhZU217
YDFAQ0EqRSZEKWR5Snt8b2s4ZzBtKnVgcUx5e1E0Z0wKenlfKlJ7d0tEYjBMRDZ0YnFBbF56RD1E
YT1jVHZ4VnsoMl9EcHo+Z1VCR0s9P3ElWSlUdmVQOWg/Pm9+MitEYWkqCnptQTtvM3tyX3E+UXVj
UT9jcFEjd2plVlI5X2UpbSN5QDViQENUcj8oR3lqJj5ySk5JRWlJeXw5QER9IyslSDdJfgp6Uns/
SjdZeV5pPWwoKXJTUj9ScldUVU9qPmFtJUpQYHpfU0MrbTsrQDJDUENTd2Y7JnY8bGEldyVROW5D
RG4xSDcKelQkUXRXTnh2ZGJIcmcqTklFaUMxIzhkWl5COzYtaTRhKnFmd216XlBZfTNBQG9VSiQ9
QDU8YzhBRCVCYW8qUipfCnptcV8hZjx7P0NGcGNFRyRLUG8zYDZlR18wQzFyez5hRTwjdGc/fEw9
MyFPVDYmdW83NF9KcyE2cHN4en48VWRDUwp6RUR6e3NVQkZyITtxem5EeV9OZzNwNnFOTmVvUFk3
PkQ7dDUyJGFncTxCITJUYXVQPCVKZGRPfCh7NkFMITYlOzwKejRqdFBgPmVUdm1lQXpXcHM0a0t3
IzlKMGA2JUYqPSVfUDZSRSVHPnBIQj8+bW9TbkJzS1Ukbl5jI29BOD5fOyFoCno9IzkzdWk8Vk8r
PS05MD1WRWBwfHxCKkJmRlFlNEpldnJGfXdzPi1gcmcrdkpEbG5nZFdJNz1PRXVYfFEodClCMgp6
MCotZll0Xj5ETilVWjdZZW4lX151WUJEYzApSTtnNEB9JilBYCtNRXl5T09mbW9JZD0zRE9pcCkp
NUMrc3dNdUcKej0tMjdAdjRKOTBLYGd8QFhvYk8jXkkwcHFXPX1xPmx2S2Vpe1dxdTcyKDk7bUV0
QF9EUjlROVYtcS1JdztvPGMpCnpldG0mJmFUb0JsZTVgLWQ2MS19blZFcXRlTHswcz0mYGdjR1R+
YnV4RmtLMllFQyVIfCMmWCFCWCs3KTZeOShSRQp6JFB8JCpIOX1ESE5nYnM5amc1PVVISXlnbkZW
Q15EYUtaP2woSiFzZDQja3J1IXpEMlZKKXV8UHtObkc2RWdqfkkKenMhO294KClhV2olVmAqZTso
PFd2X0o+c0ozfWQwKkQ2Rz9OXlJzPXJsaldzc3ghKU1hPGdXRTZCRHBMSVJYKnQ9CnptMksyUXJN
OyVOZU9ERy1tfiEzZEY3Z0soNHVfPWc/fXcrY1FyZV5FaEdDby02WXVUcFJSTD0xbioxYEowOXch
Twp6SUJwaGorUFhQUD8oTEZXPX1wa30xLTw/MGJ1NHY8PTB6YzE+U2MrZjxYQH01Zz9RZmghRD91
YiF1d0BwMk9eSTEKenVeODlPRHlqKlMzRmI5dE0kfTJzVCE2SH47SjIzM3d4NXUyS1IjO0VNMCh5
ZE5UKzNacCNGaVJsbzReazd1KF83CnooYl5wZWVKa1ZrKiNYU1hnRT1LdDFEfigtJT9kQm87QyMq
Jnhwd0h3enZwSHZtJDg9cjVufnVVSjlFJHE/Z0luJAp6V1A+cjxfQGdtX0h7Tz0mQHppZzwyZ0I8
SGcyb2EqemRpRVh3Jj5gN1puIXxpREJ0K1JWbmxlTmJKUHB8YWI7dX0KekxYbn10TSloSXxrckxN
QGsrMCY8cEJsbGxKfClDbCt7UFdkamQ+K215Ml58dVNvdC1sKzMtbXl6fUNxM1NyZ0hXCnp8R1k9
U3JrKDB3Y3c3VV9Ub3VsekduY1MkYnVFV310MlooY0s1OSM0NHcmMnp7Jl9QQ09XMGRWcVEtaUBq
cjRZOAp6b25naClEcT9JTz0+P1JTXn1VTkY4ZCo/LTNrPkp+SGpTR2l6emxqNz8lPVhKdWBCZj5Z
R15nUTk/VjA9ZGkjNkwKenUlX3ZfZU5fVENqJj4mUl42M0VPKml7ZlopZVYrWmI5SmkkY1E+OFM3
I18ydWIhfnlkM2N7TS1iLXYkezJLJHtrCnpVWDw3MygwVDNCRX5iQGNVTGhnWnV9Zi1tWCoqdXF3
MCpGZEpkM3s7Qys0fCRBLU1neHtEbDlISFIwQ358MzVHSwp6VHN6d1l1bTVreSg9ayEjKjU7fjlV
O1pfbD1FS0BJckVsdUIrazlHQCtHa2x3SGtheFp2M2hSXz1fPkRsUz41UmUKemlaRUZYd0d7RyZA
OXV5c0B2KSE7NjF2S3pKKEQwXnloQEg/UH02d19hZVltZUB+OEYrZXA/VUpDbmojMig2NkRzCnoo
bWImbXNwXmhvZ3FlUzwjRX10O1BaOWt5Vnl1WHp3PjMrRnMwYXQ9elUrPmN4KyVjfkNocEtGTSZn
OEZaZDhGaQp6KHMzRTt0SGI0Q2o1bWQpUlE7dChHaG1qQGUpPTx6eklWJGR5O1ozJj8+SGpPanVm
UD9QTlJnalZ6dkp5eH1DIUUKel5JUlI7dXdwUmZZTmxATyVvPzNmQ297VjB6OFUpUThHSXshUiE8
PF9fPDc2ZnJMcGtFN2I5eip0IyNQLUd2TGdICnpLVys5V2JpS0p5SCl1bXhudjYzU0R7K2RfWSs5
dWUqNX5tZ2EjWn1sMEZHNXBBSlImb3EqVVFsTT9hb0JzcVFBWAp6e156KmtgNmZBJmYwNik3cys4
MzFFaXNnJHo2R00rT3clSWRYYmhsNXcyMmRAMlV2U0dZaT02YTJZaTtrRWRnX1cKenFVUTFscjFo
PEhgeDtXMitCczFMK2cpV3FfO2tKVEBxa0VLTlJGWWlqMD9ZRERkak91bDE+YHFibn5reHYkZVFX
CnomRkNpUzxFSmBJdW5jUzZEOU5hRTNzSUJQbzt3KDlIViR0LXMrSyE2TVJeN214dFFVckJSVysl
eU8/eURTXz4tcAp6VG1QSDNQKylocGlMWHhPUks7ayZ5aSh+K18lQnRKWExVUDZIQ0EjYVdkcDYh
by1GaXkqfmRNYFlWZ2swUkAhKSYKejJrPm5wJUJIKUZjWHUtUCsrNUEkOG03fUZFfWgyQ1A0Q1cj
RUBTPGQyRiVMTSMwY1hOOVU+b1BXLWxOfTxiY2BRCnpOY0ljSWk2aXBfPzBtbk17ZVJGMFBhOTgp
PnprfnF0NXpHam58M1Q3dntKPmdqSDVEJlchYE0yVGtNeW8xaiRKKQp6SlVrWHdnJEpTcTEjc21s
aS1uKVI2Km47ISVTPiNoKUI2fD0mclpaayk/NWsydUZ8Mj90NDF2ekZuI20qbjJ6SF4KekNac0ZR
c1d6VmNAZU44QF4oKHZtTnRaN3FjSVBaIyhLcEpPd0RRRG9iLUdEKXAkUldueHlwanBSUW17cHBe
SWdmCnpIX0A3M2l8dHxSSGc4QXhrODxyTyY2fERyYCtvJnA9aTEzRkgyZF5DbVV+KiUjO2BFVClf
TEh6SmBebjJtO3Y9dgp6WD1HakdrJjRWanV+ZmFVYTlld00qVSQkfFdXJWlPXj9efWVDeH5jZkUw
aSR2I35sPEAjLTxzY19RPWpfR29yQUQKendXbihlRl9Ad2t2JCFEOUl1eXFLdEp4PFZNd2xIclJv
ZTd2Pk9iNFR6MUxjcVdEdmdFV2JmaVFUc349a2VWNkZ4CnpyU1pHJDhjOF9IKX5GUWZyNztXeHpx
S3AqMGQhTlhPWjk/LW95ZmdOVThDaTdARUFPS142a21kNTF0QWNjSz0yXgp6UEw+YmZqdHUjNyNU
Mn0qNGZAOUdLRD5YOy1oSzdlRHopO1lFRTshTGRjMiVfUjZfd3pFdSEhVVVBM1l8amNNSkoKeiFC
KUlHLXQ5Zyp7aHF3OCYpNUV5bC05bVE/Q0owdUp7RnY9eTcyc31lbnlnVC1waW1sYiptTGBrI0ZI
blpeWnBWCnoyZ3RsRmpzQ2N5WVpPI0prNSVDej5ibzgoSDZeNVpnWlA3K0RUbDV6SStpRz1acU1x
eFBYcT5rVVRtPl91ZCh0IQp6dWhedVY/ZDJucDxCP1p+XmNKdXNjVStaUFU1bEJCRntjPjh4eTV4
YjZZMz89eFkoMlMye21+fk83OHVvdWRHZ2oKekhNZit5SH18cjtQQVFgcktLRjxIdSNnaCY5NWEp
QkZYeGxrJWRMez9eKFQzfE1VZEJAJSRpNCV0eyQpPFQpPjx8CnprVz1JJWRrQDtjRmspQ1Q9K0h3
YUp0YXdrdl8pXllyWCh7UnwxfGJCdzw5Y25LQyNHYUdvTFZMWFI2ZV9JTmFifgp6X0c8cGdaRj4h
KzArKG17bD9xZnVDVWc5SGhGWDhDaFdyKklDQHFjYlZRTH52cl8+Mzd7VzQ1X3o1fCgrLSl3KW0K
ek1tYEJFcGRyIWI1NGlRKWI2SFlVWFFGblNjYH0tWHREci1OQjhOTVVSKHQjTCY0LWliO2EzZk1V
RGA/X28zNGFDCnomSDx7c3BfVVZpcy1hNyotZCFgaWcmRjlAaHxtPn1oP1RFemVxO3owdj4qdWo8
bFZDIUJ5ISghWWBQWnJjPCRQIQp6cykhVntrUTEkbklxWko7RzMxdmN7ZGpwUlBgKXRaTF45ZEJ2
LUBmeGgyXk9tOVI7Mj0mViZUOCFGJXQpTEBMc0sKellyUkFGdkdmQlEmJTJZT2VtVS1rKChQcXl8
RWpte1RGam8hUUdrUDY1bVErV2dGSTU2QXZzQmhHS0U0QVB3cWB1CnpuX2R3eUJiJl4hKyFrXyoh
M2ItX3BZPztKNkdfcFBZfD8hKCNmZl9OVlVYUTxfajloPHRjSH4yQiROb1B6eSgrRwp6fDY1aUIx
TS1zc0JJcz5XZ2ImbEBiJSVuSU5YZzx6SHVWJkFoZz9URE1aPi08PTBlfjdgbXpwKkUpbHlseWY2
PCgKejMjQzFkNHRjMD1tO2R0VUN3NzZNX1gjI01nNTM3fjlfYEF7QUh4QCs0O0Z8YzhsYmtJKTkr
UHhzYXhBI0N0b1ZNCllObyZrPk8pMWQpYC1gQ1lUdS0oM25SVkZ6MER+PUN5WmBfSQoKLS0gCjEu
Ny4zLjQKCg==
--0015175cad9a0d9b5604b4e2c9dd--


From MAILER-DAEMON Sun Dec 25 14:30:08 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Retlo-0000SG-Rx
	for mharc-guile-devel@gnu.org; Sun, 25 Dec 2011 14:30:08 -0500
Received: from eggs.gnu.org ([140.186.70.92]:44162)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RepdT-0007M5-P1
	for guile-devel@gnu.org; Sun, 25 Dec 2011 10:05:16 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <noah549@gmail.com>) id 1RepdS-000464-L2
	for guile-devel@gnu.org; Sun, 25 Dec 2011 10:05:15 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:40336)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <noah549@gmail.com>)
	id 1RepdS-00045z-Ho; Sun, 25 Dec 2011 10:05:14 -0500
Received: by iacb35 with SMTP id b35so18797172iac.0
	for <multiple recipients>; Sun, 25 Dec 2011 07:05:13 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:sender:in-reply-to:references:date
	:x-google-sender-auth:message-id:subject:from:to:cc:content-type
	:content-transfer-encoding;
	bh=AM3ptjbbNqrvMFR7Q8buCC9De+dV2s/zdHuzJ2vD2EI=;
	b=OGoc9B8ET08uaniAUrM20kr2CJbzZ2U9CHHfueC/wthIDqfRAbafoSdEQNV+joytvW
	AYlnjhaSuwhZBqS3N8uY3Bsk/C7qGKponXKIGFGrEdJD6R9lt8F98YkG1k8dpRwYP6BG
	yhI0IcmMvBA+rqytfU8unb33qqQvOw/D9rhyw=
MIME-Version: 1.0
Received: by 10.42.175.134 with SMTP id ba6mr21690704icb.23.1324825513541;
	Sun, 25 Dec 2011 07:05:13 -0800 (PST)
Sender: noah549@gmail.com
Received: by 10.43.51.132 with HTTP; Sun, 25 Dec 2011 07:05:13 -0800 (PST)
In-Reply-To: <87ipldh29m.fsf@gnu.org>
References: <E1Rb2fT-00087o-2c@vcs.savannah.gnu.org> <87ipldh29m.fsf@gnu.org>
Date: Sun, 25 Dec 2011 10:05:13 -0500
X-Google-Sender-Auth: P8382MHEdP4NU8psO9Nzy6ChX8s
Message-ID: <CA+U71=PiVeMzVDLvCvA1j2FJLmByOHLY1RJjVexKKsUAs7cqaQ@mail.gmail.com>
Subject: Re: [Guile-commits] GNU Guile branch, wip-compiler,
	updated. v2.1.0-139-gf8a333e
From: Noah Lavine <nlavine@haverford.edu>
To: =?ISO-8859-1?Q?Ludovic_Court=E8s?= <ludo@gnu.org>
Content-Type: text/plain; charset=windows-1252
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
X-Mailman-Approved-At: Sun, 25 Dec 2011 14:30:06 -0500
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Sun, 25 Dec 2011 15:05:16 -0000

Hello,

Sorry it's been so long since my last reply. I've been somewhat busy
around the holidays, but I hope to work more soon.

> Also, what about =93vset=94 or just =93set=94 instead of =93value-set=94?

Yes, probably a good idea.

>> + =A0 =A0 =A0 =A0 =A0 =A0 =A0(set! (a-verify-exps ret)
>> + =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0(map (lambda (x) (rec ret x env=
)) args))
>> + =A0 =A0 =A0 =A0 =A0 =A0 =A0ret))
>
> Please privilege a functional style, as much as possible (in some cases
> we lack the tools to do better, so that=92s fine.)

I don't think there's a functional way to do this, although I could be
wrong. What I want to do is make a structure where the child tree
nodes are linked to their parents. I can't get the address of the
parent until after I allocate it, so I allocate it with an empty list
of children, then use its address to make the list of children that I
want.

Another approach would be to make the list of children before
allocating the parent, but then I would have to go back and fix up
their 'parent' pointers. So I think either way I'm stuck doing some
mutation.

>> +(pass-if "value-set-can-be-anything?"
>> + =A0 =A0 =A0 =A0 (value-set-can-be-anything? anything))
>
> In Emacs you can (put 'pass-if 'scheme-indent-function 1) to get the
> =93right=94 indentation.

Ah, thanks. Done.

Noah


From MAILER-DAEMON Tue Dec 27 01:24:50 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RfQSw-0000CX-4N
	for mharc-guile-devel@gnu.org; Tue, 27 Dec 2011 01:24:50 -0500
Received: from eggs.gnu.org ([140.186.70.92]:49311)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RfQSt-0000BN-Ho
	for guile-devel@gnu.org; Tue, 27 Dec 2011 01:24:48 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RfQSs-0000Sl-GF
	for guile-devel@gnu.org; Tue, 27 Dec 2011 01:24:47 -0500
Received: from mail-vw0-f41.google.com ([209.85.212.41]:59306)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RfQSs-0000SY-CE
	for guile-devel@gnu.org; Tue, 27 Dec 2011 01:24:46 -0500
Received: by vbbfn1 with SMTP id fn1so10560215vbb.0
	for <guile-devel@gnu.org>; Mon, 26 Dec 2011 22:24:45 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:date:message-id:subject:from:to:content-type;
	bh=tyq04mqdJ6G8hkhF+lbT4a4u0SFkbww7oV+NbzsTG3o=;
	b=VzyT3TsHDwVq5L1oxygUJugd+eUWK45s+sx8r0fJDx6t312/hobuhp4pPVU1HvtpOI
	GLUBzy8RL/BXAjYmsj/EKr019QlHz0B/OEZF+4LvovzV6PEkQjpkQBdbqAZ5N52xeE4G
	Mijxh5UKYxPzZfuvk9LaoS7RvzNYTtk3HrymM=
MIME-Version: 1.0
Received: by 10.52.26.14 with SMTP id h14mr12987160vdg.132.1324967085660; Mon,
	26 Dec 2011 22:24:45 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Mon, 26 Dec 2011 22:24:45 -0800 (PST)
Date: Tue, 27 Dec 2011 14:24:45 +0800
Message-ID: <CAPjoZofResK1J6e9jxKqazX8zSBmk6f7A2s6tfzNcARPJEpq=w@mail.gmail.com>
Subject: ADD type-of
From: Nala Ginrut <nalaginrut@gmail.com>
To: guile-devel <guile-devel@gnu.org>
Content-Type: multipart/mixed; boundary=20cf307cffa67ad84604b50cf04f
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.212.41
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 27 Dec 2011 06:24:48 -0000

--20cf307cffa67ad84604b50cf04f
Content-Type: multipart/alternative; boundary=20cf307cffa67ad84104b50cf04d

--20cf307cffa67ad84104b50cf04d
Content-Type: text/plain; charset=UTF-8

A newbie Guiler asked me if there's something like "typeof" as "type" in
Python or "typeof" in JS.
I can't remember there's such a thing. But I think it'll provide
some convenient for a newbie to learn Guile.
Here's my patch.
What you guys think?

--20cf307cffa67ad84104b50cf04d
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

A newbie Guiler asked me if there&#39;s something like &quot;typeof&quot; a=
s &quot;type&quot; in Python or &quot;typeof&quot; in JS.<div>I can&#39;t r=
emember there&#39;s such a thing. But I think it&#39;ll provide some=C2=A0c=
onvenient=C2=A0for a newbie to learn Guile.</div>
<div>Here&#39;s my patch.</div><div>What you guys think?</div>

--20cf307cffa67ad84104b50cf04d--
--20cf307cffa67ad84604b50cf04f
Content-Type: text/x-patch; charset=US-ASCII; name="0002-ADD-type-of-to-goops.scm.patch"
Content-Disposition: attachment; 
	filename="0002-ADD-type-of-to-goops.scm.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gwoj5hbl0

RnJvbSA0NTE4YThlMDVjMDI3ODk1ZTJlMmYzNDEyNzMzMjZiNTIwMjU5NjM2IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBOYWxhR2lucnV0IDxOYWxhR2lucnV0QGdtYWlsLmNvbT4KRGF0
ZTogVHVlLCAyNyBEZWMgMjAxMSAxNDoxOTozOSArMDgwMApTdWJqZWN0OiBbUEFUQ0ggMi8yXSBB
REQgdHlwZS1vZiB0byBnb29wcy5zY20KCi0tLQogbW9kdWxlL29vcC9nb29wcy5zY20gfCAgIDEz
ICsrKysrKysrKysrKy0KIDEgZmlsZXMgY2hhbmdlZCwgMTIgaW5zZXJ0aW9ucygrKSwgMSBkZWxl
dGlvbnMoLSkKCmRpZmYgLS1naXQgYS9tb2R1bGUvb29wL2dvb3BzLnNjbSBiL21vZHVsZS9vb3Av
Z29vcHMuc2NtCmluZGV4IGU0NDI0ZjMuLmQ5ZWI1ODMgMTAwNjQ0Ci0tLSBhL21vZHVsZS9vb3Av
Z29vcHMuc2NtCisrKyBiL21vZHVsZS9vb3AvZ29vcHMuc2NtCkBAIC03Miw3ICs3Miw3IEBACiAJ
ICAgbWV0aG9kLXNwZWNpYWxpemVycyBtZXRob2QtZm9ybWFscwogCSAgIHByaW1pdGl2ZS1nZW5l
cmljLWdlbmVyaWMgZW5hYmxlLXByaW1pdGl2ZS1nZW5lcmljIQogCSAgIG1ldGhvZC1wcm9jZWR1
cmUgYWNjZXNzb3ItbWV0aG9kLXNsb3QtZGVmaW5pdGlvbgotCSAgIHNsb3QtZXhpc3RzPyBtYWtl
IGZpbmQtbWV0aG9kIGdldC1rZXl3b3JkKQorCSAgIHNsb3QtZXhpc3RzPyBtYWtlIGZpbmQtbWV0
aG9kIGdldC1rZXl3b3JkIHR5cGUtb2YpCiAgIDpuby1iYWNrdHJhY2UpCiAKIChkZWZpbmUgKmdv
b3BzLW1vZHVsZSogKGN1cnJlbnQtbW9kdWxlKSkKQEAgLTE2NTQsNiArMTY1NCwxNyBAQAogICAo
bGlzdDJzZXQgKG1hcGFwcGVuZCBjbGFzcy1kaXJlY3QtbWV0aG9kcwogCQkgICAgICAgKGNvbnMg
YyAoY2xhc3Mtc3ViY2xhc3NlcyBjKSkpKSkKIAorKGRlZmluZSAodHlwZS1vZiB4KQorICAoY29u
ZCAKKyAgICgoaXMtYT8geCA8dW5rbm93bj4pICc8dW5kZWZpbmVkPikKKyAgICgobnVsbD8geCkg
JzxvYmplY3Q+KQorICAgKChpcy1hPyB4IDxib29sZWFuPikgJzxib29sZWFuPikKKyAgICgoaXMt
YT8geCA8aW50ZWdlcj4pICc8aW50ZWdlcj4pCisgICAoKGlzLWE/IHggPHN0cmluZz4pICc8c3Ry
aW5nPikKKyAgICgoaXMtYT8geCA8cHJvY2VkdXJlPikgJzxmdW5jdGlvbj4pCisgICAoKGlzLWE/
IHggPG9iamVjdD4pICc8b2JqZWN0PikKKyAgIChlbHNlICc8c2NtPikpKQorCiA7OzsKIDs7OyB7
RmluYWwgaW5pdGlhbGl6YXRpb259CiA7OzsKLS0gCjEuNy4wLjQKCg==
--20cf307cffa67ad84604b50cf04f--


From MAILER-DAEMON Tue Dec 27 01:25:57 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RfQU1-0000QD-FZ
	for mharc-guile-devel@gnu.org; Tue, 27 Dec 2011 01:25:57 -0500
Received: from eggs.gnu.org ([140.186.70.92]:49635)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RfQTz-0000Q6-KM
	for guile-devel@gnu.org; Tue, 27 Dec 2011 01:25:56 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RfQTy-0000is-Gm
	for guile-devel@gnu.org; Tue, 27 Dec 2011 01:25:55 -0500
Received: from mail-vw0-f41.google.com ([209.85.212.41]:46743)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RfQTy-0000io-DI
	for guile-devel@gnu.org; Tue, 27 Dec 2011 01:25:54 -0500
Received: by vbbfn1 with SMTP id fn1so10560631vbb.0
	for <guile-devel@gnu.org>; Mon, 26 Dec 2011 22:25:54 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:content-type; bh=Qx2+oLfkPNIi1bDSdDqngGJq+4pHLaxAFarp7HrFJBo=;
	b=J37FRdwCVZJp8uJLX/kiAnvK8Ol5bh0ELYzYMI4pKir6wq4A3lUW1j0Bhlzhal5585
	/mySN3dv3BvSnFJOG1mz0koVWhieKmEuL/xKjPM4UDQ35UAubBqrThu1NlGpDtnWoOZb
	UPrwbu9i+A/u31TLynTYVsl+8FRiWkDbVK9ag=
MIME-Version: 1.0
Received: by 10.52.26.14 with SMTP id h14mr12988185vdg.132.1324967154051; Mon,
	26 Dec 2011 22:25:54 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Mon, 26 Dec 2011 22:25:54 -0800 (PST)
In-Reply-To: <CAPjoZofResK1J6e9jxKqazX8zSBmk6f7A2s6tfzNcARPJEpq=w@mail.gmail.com>
References: <CAPjoZofResK1J6e9jxKqazX8zSBmk6f7A2s6tfzNcARPJEpq=w@mail.gmail.com>
Date: Tue, 27 Dec 2011 14:25:54 +0800
Message-ID: <CAPjoZoe2bZS+n6s7roTR1APMmNaxxAifYzPE4=RMwwoONeMQeA@mail.gmail.com>
Subject: Re: ADD type-of
From: Nala Ginrut <nalaginrut@gmail.com>
To: guile-devel <guile-devel@gnu.org>
Content-Type: multipart/mixed; boundary=20cf307cffa68e68cf04b50cf4d8
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.212.41
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 27 Dec 2011 06:25:56 -0000

--20cf307cffa68e68cf04b50cf4d8
Content-Type: multipart/alternative; boundary=20cf307cffa68e68cb04b50cf4d6

--20cf307cffa68e68cb04b50cf4d6
Content-Type: text/plain; charset=UTF-8

Sorry, missed another one.

On Tue, Dec 27, 2011 at 2:24 PM, Nala Ginrut <nalaginrut@gmail.com> wrote:

> A newbie Guiler asked me if there's something like "typeof" as "type" in
> Python or "typeof" in JS.
> I can't remember there's such a thing. But I think it'll provide
> some convenient for a newbie to learn Guile.
> Here's my patch.
> What you guys think?
>

--20cf307cffa68e68cb04b50cf4d6
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Sorry, missed another one.<br><br><div class=3D"gmail_quote">On Tue, Dec 27=
, 2011 at 2:24 PM, Nala Ginrut <span dir=3D"ltr">&lt;<a href=3D"mailto:nala=
ginrut@gmail.com">nalaginrut@gmail.com</a>&gt;</span> wrote:<br><blockquote=
 class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc soli=
d;padding-left:1ex">
A newbie Guiler asked me if there&#39;s something like &quot;typeof&quot; a=
s &quot;type&quot; in Python or &quot;typeof&quot; in JS.<div>I can&#39;t r=
emember there&#39;s such a thing. But I think it&#39;ll provide some=C2=A0c=
onvenient=C2=A0for a newbie to learn Guile.</div>

<div>Here&#39;s my patch.</div><div>What you guys think?</div>
</blockquote></div><br>

--20cf307cffa68e68cb04b50cf4d6--
--20cf307cffa68e68cf04b50cf4d8
Content-Type: text/x-patch; charset=US-ASCII; name="0001-ADD-type-of-to-boot-9.scm.patch"
Content-Disposition: attachment; 
	filename="0001-ADD-type-of-to-boot-9.scm.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gwoj84ul1

RnJvbSA2MDc1YWQ0MTRiOGMxMWExNzY0N2JlZWY0NmQ5ZTJkYWQzZjNlMTEwIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBOYWxhR2lucnV0IDxOYWxhR2lucnV0QGdtYWlsLmNvbT4KRGF0
ZTogVHVlLCAyNyBEZWMgMjAxMSAxNDoxODo0OSArMDgwMApTdWJqZWN0OiBbUEFUQ0ggMS8yXSBB
REQgdHlwZS1vZiB0byBib290LTkuc2NtCgotLS0KIG1vZHVsZS9pY2UtOS9ib290LTkuc2NtIHwg
ICAxMCArKysrKysrKysrCiAxIGZpbGVzIGNoYW5nZWQsIDEwIGluc2VydGlvbnMoKyksIDAgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvbW9kdWxlL2ljZS05L2Jvb3QtOS5zY20gYi9tb2R1bGUv
aWNlLTkvYm9vdC05LnNjbQppbmRleCAwM2RhZDliLi40M2ZjZTFjIDEwMDY0NAotLS0gYS9tb2R1
bGUvaWNlLTkvYm9vdC05LnNjbQorKysgYi9tb2R1bGUvaWNlLTkvYm9vdC05LnNjbQpAQCAtMzg1
MSw0ICszODUxLDE0IEBAIG1vZHVsZSAnKGljZS05IHEpICcobWFrZS1xIHEtbGVuZ3RoKSl9LiIK
IDs7IGAtV3VudXNlZC10b3BsZXZlbCcgd2FybmluZyB3b3JrcyBhcyBleHBlY3RlZC4KIChldmFs
LXdoZW4gKGNvbXBpbGUpIChzZXQtY3VycmVudC1tb2R1bGUgdGhlLXJvb3QtbW9kdWxlKSkKIAor
KGRlZmluZSAodHlwZS1vZiB4KQorICAoY29uZCAKKyAgICgoZXE/IHggKnVuZGVmaW5lZCopICc8
dW5kZWZpbmVkPikKKyAgICgobnVsbD8geCkgJzxvYmplY3Q+KQorICAgKChib29sZWFuPyB4KSAn
PGJvb2xlYW4+KQorICAgKChudW1iZXI/IHgpICc8bnVtYmVyPikKKyAgICgoc3RyaW5nPyB4KSAn
PHN0cmluZz4pCisgICAoKHByb2NlZHVyZT8geCkgJzxmdW5jdGlvbj4pCisgICAoZWxzZSAnPHNj
bT4pKSkKKyAgICAgICAgCiA7OzsgYm9vdC05LnNjbSBlbmRzIGhlcmUKLS0gCjEuNy4wLjQKCg==
--20cf307cffa68e68cf04b50cf4d8--


From MAILER-DAEMON Tue Dec 27 02:17:41 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RfRI5-0003TH-BM
	for mharc-guile-devel@gnu.org; Tue, 27 Dec 2011 02:17:41 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59539)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RfRI3-0003T8-6S
	for guile-devel@gnu.org; Tue, 27 Dec 2011 02:17:40 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RfRI2-0001Cf-AL
	for guile-devel@gnu.org; Tue, 27 Dec 2011 02:17:39 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:58218)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RfRI2-0001CN-5i
	for guile-devel@gnu.org; Tue, 27 Dec 2011 02:17:38 -0500
Received: by iacb35 with SMTP id b35so21414926iac.0
	for <guile-devel@gnu.org>; Mon, 26 Dec 2011 23:17:36 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type:content-transfer-encoding;
	bh=R7LC54plbGXy0vsNLPRVTBJ27fIlk+EawYDibmZ6vxY=;
	b=romwmsEriQk6GLeeVWQP0uKHJN6jh5ewMPtFjre9+lqggycXIp+XXD0qlj9+l8GGbn
	UI8F0kiTpcOCxtPY0MgQGXgfVPWGGSSgI2QcQc6KFM3lTNNt6KyzCaX9Hs763X19NZ7c
	9/WBnYLH6HPE4F61bpGI+uyN7zLulRga9l60Q=
MIME-Version: 1.0
Received: by 10.50.47.228 with SMTP id g4mr29762157ign.14.1324970256462; Mon,
	26 Dec 2011 23:17:36 -0800 (PST)
Received: by 10.231.48.68 with HTTP; Mon, 26 Dec 2011 23:17:36 -0800 (PST)
In-Reply-To: <CAPjoZofResK1J6e9jxKqazX8zSBmk6f7A2s6tfzNcARPJEpq=w@mail.gmail.com>
References: <CAPjoZofResK1J6e9jxKqazX8zSBmk6f7A2s6tfzNcARPJEpq=w@mail.gmail.com>
Date: Tue, 27 Dec 2011 15:17:36 +0800
Message-ID: <CAN3veRcXEc64dsT4WtzQszAGXOYPXeXPzpa-fjONsaqvNr+b6Q@mail.gmail.com>
Subject: Re: ADD type-of
From: Daniel Hartwig <mandyke@gmail.com>
To: Nala Ginrut <nalaginrut@gmail.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 27 Dec 2011 07:17:40 -0000

On 27 December 2011 14:24, Nala Ginrut <nalaginrut@gmail.com> wrote:
> A newbie Guiler asked me if there's something like "typeof" as "type" in
> Python or "typeof" in JS.
> I can't remember there's such a thing. But I think it'll provide
> some=A0convenient=A0for a newbie to learn Guile.
> Here's my patch.
> What you guys think?

GOOPS has `class-of'[1] and `class-name':

scheme@(guile-user)> (use-modules (oop goops))
scheme@(guile-user)> (class-of 12)
$1 =3D #<<class> <integer> 99bef78>
scheme@(guile-user)> (class-name $1)
$2 =3D <integer>


[1] http://www.gnu.org/software/guile/manual/html_node/Instances.html


From MAILER-DAEMON Tue Dec 27 02:29:54 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RfRTu-0004Nn-CF
	for mharc-guile-devel@gnu.org; Tue, 27 Dec 2011 02:29:54 -0500
Received: from eggs.gnu.org ([140.186.70.92]:35058)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RfRTq-0004JU-S6
	for guile-devel@gnu.org; Tue, 27 Dec 2011 02:29:51 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RfRTp-0003Fi-Ie
	for guile-devel@gnu.org; Tue, 27 Dec 2011 02:29:50 -0500
Received: from mail-vw0-f41.google.com ([209.85.212.41]:36232)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RfRTp-0003Fa-D0
	for guile-devel@gnu.org; Tue, 27 Dec 2011 02:29:49 -0500
Received: by vbbfn1 with SMTP id fn1so10585232vbb.0
	for <guile-devel@gnu.org>; Mon, 26 Dec 2011 23:29:48 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=Ft7WDU9LWLs/kvHopdeZD6X+2dSVLntWcntyLEtV4sg=;
	b=adi4wkQDAX8wc7LgSBqcyKswdQQBe64HPGoNO/9eZkmF9hbCZMy+ZUFfpvbJ72bSb6
	mtDKRwQIt0D0u2TXqJXJVOb5Zvr+HTx+fBCkZl2HxNWNG0qkbRBhMsZ3JRmsvXOmewSn
	Q9CBi4zjVwCoB9YhhTkr8Ch2333OcyfJ4oLF4=
MIME-Version: 1.0
Received: by 10.52.24.35 with SMTP id r3mr12306067vdf.81.1324970988837; Mon,
	26 Dec 2011 23:29:48 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Mon, 26 Dec 2011 23:29:48 -0800 (PST)
In-Reply-To: <CAN3veRcXEc64dsT4WtzQszAGXOYPXeXPzpa-fjONsaqvNr+b6Q@mail.gmail.com>
References: <CAPjoZofResK1J6e9jxKqazX8zSBmk6f7A2s6tfzNcARPJEpq=w@mail.gmail.com>
	<CAN3veRcXEc64dsT4WtzQszAGXOYPXeXPzpa-fjONsaqvNr+b6Q@mail.gmail.com>
Date: Tue, 27 Dec 2011 15:29:48 +0800
Message-ID: <CAPjoZoeQn+mg4Mg5vn5veMfeWyMHedPZEj9OuuDDwhgex6fYYw@mail.gmail.com>
Subject: Re: ADD type-of
From: Nala Ginrut <nalaginrut@gmail.com>
To: Daniel Hartwig <mandyke@gmail.com>
Content-Type: multipart/alternative; boundary=20cf307c9b00209c0204b50dd91c
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.212.41
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Tue, 27 Dec 2011 07:29:51 -0000

--20cf307c9b00209c0204b50dd91c
Content-Type: text/plain; charset=UTF-8

hi Daniel, thanks for reminding me.
So the patch for GOOPS is redundant.

On Tue, Dec 27, 2011 at 3:17 PM, Daniel Hartwig <mandyke@gmail.com> wrote:

> On 27 December 2011 14:24, Nala Ginrut <nalaginrut@gmail.com> wrote:
> > A newbie Guiler asked me if there's something like "typeof" as "type" in
> > Python or "typeof" in JS.
> > I can't remember there's such a thing. But I think it'll provide
> > some convenient for a newbie to learn Guile.
> > Here's my patch.
> > What you guys think?
>
> GOOPS has `class-of'[1] and `class-name':
>
> scheme@(guile-user)> (use-modules (oop goops))
> scheme@(guile-user)> (class-of 12)
> $1 = #<<class> <integer> 99bef78>
> scheme@(guile-user)> (class-name $1)
> $2 = <integer>
>
>
> [1] http://www.gnu.org/software/guile/manual/html_node/Instances.html
>

--20cf307c9b00209c0204b50dd91c
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

hi Daniel, thanks for reminding me.<div>So the patch for GOOPS is=C2=A0redu=
ndant.</div><div><br><div class=3D"gmail_quote">On Tue, Dec 27, 2011 at 3:1=
7 PM, Daniel Hartwig <span dir=3D"ltr">&lt;<a href=3D"mailto:mandyke@gmail.=
com">mandyke@gmail.com</a>&gt;</span> wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex"><div class=3D"HOEnZb"><div class=3D"h5">On 2=
7 December 2011 14:24, Nala Ginrut &lt;<a href=3D"mailto:nalaginrut@gmail.c=
om">nalaginrut@gmail.com</a>&gt; wrote:<br>

&gt; A newbie Guiler asked me if there&#39;s something like &quot;typeof&qu=
ot; as &quot;type&quot; in<br>
&gt; Python or &quot;typeof&quot; in JS.<br>
&gt; I can&#39;t remember there&#39;s such a thing. But I think it&#39;ll p=
rovide<br>
&gt; some=C2=A0convenient=C2=A0for a newbie to learn Guile.<br>
&gt; Here&#39;s my patch.<br>
&gt; What you guys think?<br>
<br>
</div></div>GOOPS has `class-of&#39;[1] and `class-name&#39;:<br>
<br>
scheme@(guile-user)&gt; (use-modules (oop goops))<br>
scheme@(guile-user)&gt; (class-of 12)<br>
$1 =3D #&lt;&lt;class&gt; &lt;integer&gt; 99bef78&gt;<br>
scheme@(guile-user)&gt; (class-name $1)<br>
$2 =3D &lt;integer&gt;<br>
<br>
<br>
[1] <a href=3D"http://www.gnu.org/software/guile/manual/html_node/Instances=
.html" target=3D"_blank">http://www.gnu.org/software/guile/manual/html_node=
/Instances.html</a><br>
</blockquote></div><br></div>

--20cf307c9b00209c0204b50dd91c--


From MAILER-DAEMON Thu Dec 29 04:32:10 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgCLK-0007TM-MO
	for mharc-guile-devel@gnu.org; Thu, 29 Dec 2011 04:32:10 -0500
Received: from eggs.gnu.org ([140.186.70.92]:52128)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgCLH-0007Sq-Jv
	for guile-devel@gnu.org; Thu, 29 Dec 2011 04:32:08 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgCLG-00004z-IA
	for guile-devel@gnu.org; Thu, 29 Dec 2011 04:32:07 -0500
Received: from mail-vw0-f41.google.com ([209.85.212.41]:37086)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgCLG-00004u-9F
	for guile-devel@gnu.org; Thu, 29 Dec 2011 04:32:06 -0500
Received: by vbbfn1 with SMTP id fn1so12095228vbb.0
	for <guile-devel@gnu.org>; Thu, 29 Dec 2011 01:32:05 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:date:message-id:subject:from:to:content-type;
	bh=SUsoFsmJWb4r0PmMcdNHSQf33V9VKWrclGzsbJi8lFk=;
	b=RFQhYM9N+lpMcfzqR7OfJxHeMN4BkI8b/wvEVQDSbKmb5SzG+yORQTle9yb/n6fuFi
	P7fh1XgES1XPC7ZJTCMOOvoZhVQl4lMpW2Q8yIXnjnbnuDr5VoFIueRPw2yuUQMdCApw
	+uxWXx0o3nQo18EzUTzilc7TtJEbvUwi+odIQ=
MIME-Version: 1.0
Received: by 10.52.99.231 with SMTP id et7mr16535695vdb.114.1325151125416;
	Thu, 29 Dec 2011 01:32:05 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Thu, 29 Dec 2011 01:32:05 -0800 (PST)
Date: Thu, 29 Dec 2011 17:32:05 +0800
Message-ID: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
Subject: [PATCH] add regexp-split
From: Nala Ginrut <nalaginrut@gmail.com>
To: guile-devel <guile-devel@gnu.org>
Content-Type: multipart/mixed; boundary=bcaec50161b71aa9ed04b537ca11
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.212.41
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 29 Dec 2011 09:32:08 -0000

--bcaec50161b71aa9ed04b537ca11
Content-Type: multipart/alternative; boundary=bcaec50161b71aa9ea04b537ca0f

--bcaec50161b71aa9ea04b537ca0f
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

hi guilers!
It seems like there's no "regexp-split" procedure in Guile.
What we have is "string-split" which accepted Char only.
So I wrote one for myself.

------python code-----
>>> import re
>>> re.split("([^0-9])", "123+456*/")
[=E2=80=99123=E2=80=99, =E2=80=99+=E2=80=99, =E2=80=99456=E2=80=99, =E2=80=
=99*=E2=80=99, =E2=80=99=E2=80=99, =E2=80=99/=E2=80=99, =E2=80=99=E2=80=99]
--------code end-------

The Guile version:

----------guile code-------
(regexp-split "([^0-9])"  "123+456*/")
=3D=3D>("123" "+" "456" "*" "" "/" "")
----------code end--------

Anyone interested in it?

--bcaec50161b71aa9ea04b537ca0f
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

hi guilers!<div>It seems like there&#39;s no &quot;regexp-split&quot; proce=
dure in Guile.</div><div>What we have is &quot;string-split&quot; which acc=
epted Char only.</div><div>So I wrote one for myself.</div><div><br></div>
<div>------python code-----</div><div>&gt;&gt;&gt; import re</div><div><div=
>&gt;&gt;&gt; re.split(&quot;([^0-9])&quot;, &quot;123+456*/&quot;)</div><d=
iv>[=E2=80=99123=E2=80=99, =E2=80=99+=E2=80=99, =E2=80=99456=E2=80=99, =E2=
=80=99*=E2=80=99, =E2=80=99=E2=80=99, =E2=80=99/=E2=80=99, =E2=80=99=E2=80=
=99]</div></div><div>--------code end-------</div>
<div><br></div><div>The Guile version:</div><div><br></div><div>----------g=
uile code-------</div><div>(regexp-split=C2=A0&quot;([^0-9])&quot; =C2=A0&q=
uot;123+456*/&quot;)</div><div>=3D=3D&gt;(&quot;123&quot; &quot;+&quot; &qu=
ot;456&quot; &quot;*&quot; &quot;&quot; &quot;/&quot; &quot;&quot;)</div>
<div>----------code end--------</div><div><br></div><div>Anyone interested =
in it?</div><div><br></div>

--bcaec50161b71aa9ea04b537ca0f--
--bcaec50161b71aa9ed04b537ca11
Content-Type: text/x-patch; charset=US-ASCII; name="0001-ADD-regexp-split.patch"
Content-Disposition: attachment; filename="0001-ADD-regexp-split.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gwrko6cj0

RnJvbSBlYjBiYjgwYzg2Yzk1Mzk3MTJiNzhjZjg5MDJkMjMwZTBjNGU3NzhlIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBOYWxhR2lucnV0IDxOYWxhR2lucnV0QGdtYWlsLmNvbT4KRGF0
ZTogVGh1LCAyOSBEZWMgMjAxMSAxNzoyNTowMyArMDgwMApTdWJqZWN0OiBbUEFUQ0hdIEFERCBy
ZWdleHAtc3BsaXQKCi0tLQogbW9kdWxlL2ljZS05L3JlZ2V4LnNjbSB8ICAgMjMgKysrKysrKysr
KysrKysrKysrKysrKy0KIDEgZmlsZXMgY2hhbmdlZCwgMjIgaW5zZXJ0aW9ucygrKSwgMSBkZWxl
dGlvbnMoLSkKCmRpZmYgLS1naXQgYS9tb2R1bGUvaWNlLTkvcmVnZXguc2NtIGIvbW9kdWxlL2lj
ZS05L3JlZ2V4LnNjbQppbmRleCBmN2I5NGI3Li41YTkwYzY3IDEwMDY0NAotLS0gYS9tb2R1bGUv
aWNlLTkvcmVnZXguc2NtCisrKyBiL21vZHVsZS9pY2UtOS9yZWdleC5zY20KQEAgLTQxLDcgKzQx
LDcgQEAKICAgIzpleHBvcnQgKG1hdGNoOmNvdW50IG1hdGNoOnN0cmluZyBtYXRjaDpwcmVmaXgg
bWF0Y2g6c3VmZml4CiAgICAgICAgICAgIHJlZ2V4cC1tYXRjaD8gcmVnZXhwLXF1b3RlIG1hdGNo
OnN0YXJ0IG1hdGNoOmVuZCBtYXRjaDpzdWJzdHJpbmcKICAgICAgICAgICAgc3RyaW5nLW1hdGNo
IHJlZ2V4cC1zdWJzdGl0dXRlIGZvbGQtbWF0Y2hlcyBsaXN0LW1hdGNoZXMKLSAgICAgICAgICAg
cmVnZXhwLXN1YnN0aXR1dGUvZ2xvYmFsKSkKKyAgICAgICAgICAgcmVnZXhwLXN1YnN0aXR1dGUv
Z2xvYmFsIHJlZ2V4cC1zcGxpdCkpCiAKIDs7IFJlZmVyZW5jZXM6CiA7OwpAQCAtMjI2LDMgKzIy
NiwyNCBAQAogICAgICAgICAgICAgICAgICAgICAgICAgKGJlZ2luCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgIChkby1pdGVtIChjYXIgaXRlbXMpKSA7IFRoaXMgaXMgbm90LgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAobmV4dC1pdGVtIChjZHIgaXRlbXMpKSkpKSkpKSkpKQorICAgICAg
ICAgICAgICAgICAgICAgICAgICAKKyhkZWZpbmUgcmVnZXhwLXNwbGl0CisgIChsYW1iZGEgKHJl
Z2V4IHN0cikKKyAgICAobGV0KiAoW2xlbiAoc3RyaW5nLWxlbmd0aCBzdHIpXQorCSAgIFtyZXQg
KGZvbGQtbWF0Y2hlcyAKKwkJIHJlZ2V4IHN0ciAobGlzdCAnKCkgMCAwICcoIiIpKQorCQkgKGxh
bWJkYSAobSBwcmV2KQorCQkgICAobGV0KiAoW2xsIChjYXIgcHJldildCisJCQkgIFtjb3VudCAo
MSsgKGNhZHIgcHJldikpXQorCQkJICBbc3RhcnQgKGNhZGRyIHByZXYpXQorCQkJICBbdGFpbCAo
bWF0Y2g6c3VmZml4IG0pXQorCQkJICBbZW5kIChtYXRjaDpzdGFydCBtKV0KKwkJCSAgW3MgKHN0
cmluZy1jb3B5IHN0ciBzdGFydCBlbmQpXQorCQkJICApCisJCSAgICAgKGxpc3QgYCgsQGxsICxz
ICwobWF0Y2g6c3Vic3RyaW5nIG0pKSAKKwkJCSAgIGNvdW50IChtYXRjaDplbmQgbSkgdGFpbCkK
KwkJICAgICApKSldIDs7IGVuZCBmb2xkLW1hdGNoZXMKKwkgICApIDs7IGVuZCBsZXQqCisgICAg
ICBgKCxAKGNhciByZXQpICwoY2FkZGRyIHJldCkpCisgICAgICApKSkKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCi0tIAoxLjcuMC40Cgo=
--bcaec50161b71aa9ed04b537ca11--


From MAILER-DAEMON Thu Dec 29 04:46:59 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgCZf-00010o-48
	for mharc-guile-devel@gnu.org; Thu, 29 Dec 2011 04:46:59 -0500
Received: from eggs.gnu.org ([140.186.70.92]:51614)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgCZd-00010e-5O
	for guile-devel@gnu.org; Thu, 29 Dec 2011 04:46:58 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgCZb-0002Xr-Ol
	for guile-devel@gnu.org; Thu, 29 Dec 2011 04:46:57 -0500
Received: from mail-vw0-f41.google.com ([209.85.212.41]:41062)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgCZb-0002Xg-It
	for guile-devel@gnu.org; Thu, 29 Dec 2011 04:46:55 -0500
Received: by vbbfn1 with SMTP id fn1so12103632vbb.0
	for <guile-devel@gnu.org>; Thu, 29 Dec 2011 01:46:54 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:content-type; bh=/wSrMtvsEPDT5+pP11yTXPzJSmzwP3Yt3433jnyNO+A=;
	b=xZUam3+HI2waYEJJvjP4wlT1d3wS00eajPq6JXn4iD9Jvk/5l7sqqtGajkr0fKSdO0
	wvrGWSWgzxjqO0eWlvpsbFeAxRr+GgL6oNDq5HzGpx31oy3/dMZWHQtD+xTm3cVn3Vcv
	EM3CUU1jI2TPmdx+QUc9TC7W6Z32JjEZKX6IQ=
MIME-Version: 1.0
Received: by 10.52.19.206 with SMTP id h14mr6543190vde.131.1325152014792; Thu,
	29 Dec 2011 01:46:54 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Thu, 29 Dec 2011 01:46:54 -0800 (PST)
In-Reply-To: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
Date: Thu, 29 Dec 2011 17:46:54 +0800
Message-ID: <CAPjoZofnZUKwxR2pVuGEaMPP1Gdht_yHA52nUcX57RsuC0RTUw@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Nala Ginrut <nalaginrut@gmail.com>
To: guile-devel <guile-devel@gnu.org>
Content-Type: multipart/mixed; boundary=20cf307d06ce1d75d304b537ff60
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.212.41
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 29 Dec 2011 09:46:58 -0000

--20cf307d06ce1d75d304b537ff60
Content-Type: multipart/alternative; boundary=20cf307d06ce1d75cf04b537ff5e

--20cf307d06ce1d75cf04b537ff5e
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Sorry, there's a typo.
Here it is.

On Thu, Dec 29, 2011 at 5:32 PM, Nala Ginrut <nalaginrut@gmail.com> wrote:

> hi guilers!
> It seems like there's no "regexp-split" procedure in Guile.
> What we have is "string-split" which accepted Char only.
> So I wrote one for myself.
>
> ------python code-----
> >>> import re
> >>> re.split("([^0-9])", "123+456*/")
> [=E2=80=99123=E2=80=99, =E2=80=99+=E2=80=99, =E2=80=99456=E2=80=99, =E2=
=80=99*=E2=80=99, =E2=80=99=E2=80=99, =E2=80=99/=E2=80=99, =E2=80=99=E2=80=
=99]
> --------code end-------
>
> The Guile version:
>
> ----------guile code-------
> (regexp-split "([^0-9])"  "123+456*/")
> =3D=3D>("123" "+" "456" "*" "" "/" "")
> ----------code end--------
>
> Anyone interested in it?
>
>

--20cf307d06ce1d75cf04b537ff5e
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Sorry, there&#39;s a typo.<div>Here it is.<br><br><div class=3D"gmail_quote=
">On Thu, Dec 29, 2011 at 5:32 PM, Nala Ginrut <span dir=3D"ltr">&lt;<a hre=
f=3D"mailto:nalaginrut@gmail.com">nalaginrut@gmail.com</a>&gt;</span> wrote=
:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">hi guilers!<div>It seems like there&#39;s no=
 &quot;regexp-split&quot; procedure in Guile.</div><div>What we have is &qu=
ot;string-split&quot; which accepted Char only.</div>
<div>So I wrote one for myself.</div><div><br></div>
<div>------python code-----</div><div>&gt;&gt;&gt; import re</div><div><div=
>&gt;&gt;&gt; re.split(&quot;([^0-9])&quot;, &quot;123+456*/&quot;)</div><d=
iv>[=E2=80=99123=E2=80=99, =E2=80=99+=E2=80=99, =E2=80=99456=E2=80=99, =E2=
=80=99*=E2=80=99, =E2=80=99=E2=80=99, =E2=80=99/=E2=80=99, =E2=80=99=E2=80=
=99]</div></div><div>--------code end-------</div>

<div><br></div><div>The Guile version:</div><div><br></div><div>----------g=
uile code-------</div><div>(regexp-split=C2=A0&quot;([^0-9])&quot; =C2=A0&q=
uot;123+456*/&quot;)</div><div>=3D=3D&gt;(&quot;123&quot; &quot;+&quot; &qu=
ot;456&quot; &quot;*&quot; &quot;&quot; &quot;/&quot; &quot;&quot;)</div>

<div>----------code end--------</div><div><br></div><div>Anyone interested =
in it?</div><div><br></div>
</blockquote></div><br></div>

--20cf307d06ce1d75cf04b537ff5e--
--20cf307d06ce1d75d304b537ff60
Content-Type: text/x-patch; charset=US-ASCII; name="0001-ADD-regexp-split.patch"
Content-Disposition: attachment; filename="0001-ADD-regexp-split.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gwrl9tgg1

RnJvbSA3ZWNkOWNmYmI5N2I0MzZlZDk0MTdmNDk2MmJjMDQyNjRiY2RiNWU0IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBOYWxhR2lucnV0IDxOYWxhR2lucnV0QGdtYWlsLmNvbT4KRGF0
ZTogVGh1LCAyOSBEZWMgMjAxMSAxNzo0NTo0MyArMDgwMApTdWJqZWN0OiBbUEFUQ0hdIEFERCBy
ZWdleHAtc3BsaXQKCi0tLQogbW9kdWxlL2ljZS05L3JlZ2V4LnNjbSB8ICAgMjIgKysrKysrKysr
KysrKysrKysrKysrLQogMSBmaWxlcyBjaGFuZ2VkLCAyMSBpbnNlcnRpb25zKCspLCAxIGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL21vZHVsZS9pY2UtOS9yZWdleC5zY20gYi9tb2R1bGUvaWNl
LTkvcmVnZXguc2NtCmluZGV4IGY3Yjk0YjcuLjJhYjI4ZGUgMTAwNjQ0Ci0tLSBhL21vZHVsZS9p
Y2UtOS9yZWdleC5zY20KKysrIGIvbW9kdWxlL2ljZS05L3JlZ2V4LnNjbQpAQCAtNDEsNyArNDEs
NyBAQAogICAjOmV4cG9ydCAobWF0Y2g6Y291bnQgbWF0Y2g6c3RyaW5nIG1hdGNoOnByZWZpeCBt
YXRjaDpzdWZmaXgKICAgICAgICAgICAgcmVnZXhwLW1hdGNoPyByZWdleHAtcXVvdGUgbWF0Y2g6
c3RhcnQgbWF0Y2g6ZW5kIG1hdGNoOnN1YnN0cmluZwogICAgICAgICAgICBzdHJpbmctbWF0Y2gg
cmVnZXhwLXN1YnN0aXR1dGUgZm9sZC1tYXRjaGVzIGxpc3QtbWF0Y2hlcwotICAgICAgICAgICBy
ZWdleHAtc3Vic3RpdHV0ZS9nbG9iYWwpKQorICAgICAgICAgICByZWdleHAtc3Vic3RpdHV0ZS9n
bG9iYWwgcmVnZXhwLXNwbGl0KSkKIAogOzsgUmVmZXJlbmNlczoKIDs7CkBAIC0yMjYsMyArMjI2
LDIzIEBACiAgICAgICAgICAgICAgICAgICAgICAgICAoYmVnaW4KICAgICAgICAgICAgICAgICAg
ICAgICAgICAgKGRvLWl0ZW0gKGNhciBpdGVtcykpIDsgVGhpcyBpcyBub3QuCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgIChuZXh0LWl0ZW0gKGNkciBpdGVtcykpKSkpKSkpKSkpCisgICAgICAg
ICAgICAgICAgICAgICAgICAgIAorKGRlZmluZSByZWdleHAtc3BsaXQKKyAgKGxhbWJkYSAocmVn
ZXggc3RyKQorICAgIChsZXQqIChbcmV0IChmb2xkLW1hdGNoZXMgCisJCSByZWdleCBzdHIgKGxp
c3QgJygpIDAgMCAnKCIiKSkKKwkJIChsYW1iZGEgKG0gcHJldikKKwkJICAgKGxldCogKFtsbCAo
Y2FyIHByZXYpXQorCQkJICBbY291bnQgKDErIChjYWRyIHByZXYpKV0KKwkJCSAgW3N0YXJ0IChj
YWRkciBwcmV2KV0KKwkJCSAgW3RhaWwgKG1hdGNoOnN1ZmZpeCBtKV0KKwkJCSAgW2VuZCAobWF0
Y2g6c3RhcnQgbSldCisJCQkgIFtzIChzdHJpbmctY29weSBzdHIgc3RhcnQgZW5kKV0KKwkJCSAg
KQorCQkgICAgIChsaXN0IGAoLEBsbCAscyAsKG1hdGNoOnN1YnN0cmluZyBtKSkgCisJCQkgICBj
b3VudCAobWF0Y2g6ZW5kIG0pIHRhaWwpCisJCSAgICAgKSkpXSA7OyBlbmQgZm9sZC1tYXRjaGVz
CisJICAgKSA7OyBlbmQgbGV0KgorICAgICAgYCgsQChjYXIgcmV0KSAsKGNhZGRkciByZXQpKQor
ICAgICAgKSkpCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAotLSAKMS43LjAuNAoK
--20cf307d06ce1d75d304b537ff60--


From MAILER-DAEMON Thu Dec 29 05:20:53 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgD6T-0003s0-3t
	for mharc-guile-devel@gnu.org; Thu, 29 Dec 2011 05:20:53 -0500
Received: from eggs.gnu.org ([140.186.70.92]:33426)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgD6R-0003rn-6l
	for guile-devel@gnu.org; Thu, 29 Dec 2011 05:20:52 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgD6Q-0000J5-14
	for guile-devel@gnu.org; Thu, 29 Dec 2011 05:20:51 -0500
Received: from mail-vx0-f169.google.com ([209.85.220.169]:64085)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgD6P-0000Iz-Qm
	for guile-devel@gnu.org; Thu, 29 Dec 2011 05:20:49 -0500
Received: by vcge1 with SMTP id e1so11076586vcg.0
	for <guile-devel@gnu.org>; Thu, 29 Dec 2011 02:20:49 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:content-type; bh=2mhHlHotvm4JeXKU7w4ZTAxggvoNba3wJYRLqaoLAfs=;
	b=IeVCWoMMS9Q9i/eLqkEht2ombK9e1NzPEDzsYb64Fyw5ZGuxovum8kHgtuQer9J0ck
	zO15x2huUDinYitJY22877wh6it5SeqSGe+SYx8j1uN2nIdqO2+ZXX5nd4tMvB5tI8aD
	86pI5G50QChaqkSxxZt42vRyXmNu9qbnbzsVM=
MIME-Version: 1.0
Received: by 10.220.231.9 with SMTP id jo9mr20131654vcb.59.1325154049343; Thu,
	29 Dec 2011 02:20:49 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Thu, 29 Dec 2011 02:20:49 -0800 (PST)
In-Reply-To: <CAPjoZofnZUKwxR2pVuGEaMPP1Gdht_yHA52nUcX57RsuC0RTUw@mail.gmail.com>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<CAPjoZofnZUKwxR2pVuGEaMPP1Gdht_yHA52nUcX57RsuC0RTUw@mail.gmail.com>
Date: Thu, 29 Dec 2011 18:20:49 +0800
Message-ID: <CAPjoZocvsHVD=sXJ3zoRpVHQnGS1sksLhYFbr2iqeaUi3q09VA@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Nala Ginrut <nalaginrut@gmail.com>
To: guile-devel <guile-devel@gnu.org>
Content-Type: multipart/mixed; boundary=14dae9cc968862411e04b538785c
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.220.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 29 Dec 2011 10:20:52 -0000

--14dae9cc968862411e04b538785c
Content-Type: multipart/alternative; boundary=14dae9cc968862411a04b538785a

--14dae9cc968862411a04b538785a
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Hmm... think I've deleted all the things for debug.

On Thu, Dec 29, 2011 at 5:46 PM, Nala Ginrut <nalaginrut@gmail.com> wrote:

> Sorry, there's a typo.
> Here it is.
>
>
> On Thu, Dec 29, 2011 at 5:32 PM, Nala Ginrut <nalaginrut@gmail.com> wrote=
:
>
>> hi guilers!
>> It seems like there's no "regexp-split" procedure in Guile.
>> What we have is "string-split" which accepted Char only.
>> So I wrote one for myself.
>>
>> ------python code-----
>> >>> import re
>> >>> re.split("([^0-9])", "123+456*/")
>> [=E2=80=99123=E2=80=99, =E2=80=99+=E2=80=99, =E2=80=99456=E2=80=99, =E2=
=80=99*=E2=80=99, =E2=80=99=E2=80=99, =E2=80=99/=E2=80=99, =E2=80=99=E2=80=
=99]
>> --------code end-------
>>
>> The Guile version:
>>
>> ----------guile code-------
>> (regexp-split "([^0-9])"  "123+456*/")
>> =3D=3D>("123" "+" "456" "*" "" "/" "")
>> ----------code end--------
>>
>> Anyone interested in it?
>>
>>
>

--14dae9cc968862411a04b538785a
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div>Hmm... think I&#39;ve deleted all the things for debug.</div><br><div =
class=3D"gmail_quote">On Thu, Dec 29, 2011 at 5:46 PM, Nala Ginrut <span di=
r=3D"ltr">&lt;<a href=3D"mailto:nalaginrut@gmail.com">nalaginrut@gmail.com<=
/a>&gt;</span> wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">Sorry, there&#39;s a typo.<div>Here it is.<d=
iv><div class=3D"h5"><br><br><div class=3D"gmail_quote">On Thu, Dec 29, 201=
1 at 5:32 PM, Nala Ginrut <span dir=3D"ltr">&lt;<a href=3D"mailto:nalaginru=
t@gmail.com" target=3D"_blank">nalaginrut@gmail.com</a>&gt;</span> wrote:<b=
r>

<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">hi guilers!<div>It seems like there&#39;s no=
 &quot;regexp-split&quot; procedure in Guile.</div><div>What we have is &qu=
ot;string-split&quot; which accepted Char only.</div>

<div>So I wrote one for myself.</div><div><br></div>
<div>------python code-----</div><div>&gt;&gt;&gt; import re</div><div><div=
>&gt;&gt;&gt; re.split(&quot;([^0-9])&quot;, &quot;123+456*/&quot;)</div><d=
iv>[=E2=80=99123=E2=80=99, =E2=80=99+=E2=80=99, =E2=80=99456=E2=80=99, =E2=
=80=99*=E2=80=99, =E2=80=99=E2=80=99, =E2=80=99/=E2=80=99, =E2=80=99=E2=80=
=99]</div></div><div>--------code end-------</div>


<div><br></div><div>The Guile version:</div><div><br></div><div>----------g=
uile code-------</div><div>(regexp-split=C2=A0&quot;([^0-9])&quot; =C2=A0&q=
uot;123+456*/&quot;)</div><div>=3D=3D&gt;(&quot;123&quot; &quot;+&quot; &qu=
ot;456&quot; &quot;*&quot; &quot;&quot; &quot;/&quot; &quot;&quot;)</div>


<div>----------code end--------</div><div><br></div><div>Anyone interested =
in it?</div><div><br></div>
</blockquote></div><br></div></div></div>
</blockquote></div><br>

--14dae9cc968862411a04b538785a--
--14dae9cc968862411e04b538785c
Content-Type: text/x-patch; charset=US-ASCII; name="0001-ADD-regexp-split.patch"
Content-Disposition: attachment; filename="0001-ADD-regexp-split.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gwrmhsjw1

RnJvbSAzOTE1NWExZGRlYmQ0ZGEwY2QxM2E0YmNhZTkzMzk1ZjM5NzY1YzBlIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBOYWxhR2lucnV0IDxOYWxhR2lucnV0QGdtYWlsLmNvbT4KRGF0
ZTogVGh1LCAyOSBEZWMgMjAxMSAxODoxOTowMCArMDgwMApTdWJqZWN0OiBbUEFUQ0hdIEFERCBy
ZWdleHAtc3BsaXQKCi0tLQogbW9kdWxlL2ljZS05L3JlZ2V4LnNjbSB8ICAgMjAgKysrKysrKysr
KysrKysrKysrKy0KIDEgZmlsZXMgY2hhbmdlZCwgMTkgaW5zZXJ0aW9ucygrKSwgMSBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS9tb2R1bGUvaWNlLTkvcmVnZXguc2NtIGIvbW9kdWxlL2ljZS05
L3JlZ2V4LnNjbQppbmRleCBmN2I5NGI3Li4yODc3NDE5IDEwMDY0NAotLS0gYS9tb2R1bGUvaWNl
LTkvcmVnZXguc2NtCisrKyBiL21vZHVsZS9pY2UtOS9yZWdleC5zY20KQEAgLTQxLDcgKzQxLDcg
QEAKICAgIzpleHBvcnQgKG1hdGNoOmNvdW50IG1hdGNoOnN0cmluZyBtYXRjaDpwcmVmaXggbWF0
Y2g6c3VmZml4CiAgICAgICAgICAgIHJlZ2V4cC1tYXRjaD8gcmVnZXhwLXF1b3RlIG1hdGNoOnN0
YXJ0IG1hdGNoOmVuZCBtYXRjaDpzdWJzdHJpbmcKICAgICAgICAgICAgc3RyaW5nLW1hdGNoIHJl
Z2V4cC1zdWJzdGl0dXRlIGZvbGQtbWF0Y2hlcyBsaXN0LW1hdGNoZXMKLSAgICAgICAgICAgcmVn
ZXhwLXN1YnN0aXR1dGUvZ2xvYmFsKSkKKyAgICAgICAgICAgcmVnZXhwLXN1YnN0aXR1dGUvZ2xv
YmFsIHJlZ2V4cC1zcGxpdCkpCiAKIDs7IFJlZmVyZW5jZXM6CiA7OwpAQCAtMjI2LDMgKzIyNiwy
MSBAQAogICAgICAgICAgICAgICAgICAgICAgICAgKGJlZ2luCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgIChkby1pdGVtIChjYXIgaXRlbXMpKSA7IFRoaXMgaXMgbm90LgogICAgICAgICAgICAg
ICAgICAgICAgICAgICAobmV4dC1pdGVtIChjZHIgaXRlbXMpKSkpKSkpKSkpKQorICAgICAgICAg
ICAgICAgICAgICAgICAgICAKKyhkZWZpbmUgcmVnZXhwLXNwbGl0CisgIChsYW1iZGEgKHJlZ2V4
IHN0cikKKyAgICAobGV0IChbcmV0IChmb2xkLW1hdGNoZXMgCisJCXJlZ2V4IHN0ciAobGlzdCAn
KCkgMCAnKCIiKSkKKwkJKGxhbWJkYSAobSBwcmV2KQorCQkgIChsZXQqIChbbGwgKGNhciBwcmV2
KV0KKwkJCSBbc3RhcnQgKGNhZHIgcHJldildCisJCQkgW3RhaWwgKG1hdGNoOnN1ZmZpeCBtKV0K
KwkJCSBbZW5kIChtYXRjaDpzdGFydCBtKV0KKwkJCSBbcyAoc3RyaW5nLWNvcHkgc3RyIHN0YXJ0
IGVuZCldCisJCQkgKQorCQkgICAgKGxpc3QgYCgsQGxsICxzICwobWF0Y2g6c3Vic3RyaW5nIG0p
KSAKKwkJCSAgKG1hdGNoOmVuZCBtKSB0YWlsKQorCQkgICAgKSkpXSkKKyAgICAgIGAoLEAoY2Fy
IHJldCkgLChjYWRkciByZXQpKQorICAgICAgKSkpCisgICAgICAgICAgICAgICAgICAgICAgICAg
IAotLSAKMS43LjAuNAoK
--14dae9cc968862411e04b538785c--


From MAILER-DAEMON Thu Dec 29 08:58:31 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgGV5-0000Tr-57
	for mharc-guile-devel@gnu.org; Thu, 29 Dec 2011 08:58:31 -0500
Received: from eggs.gnu.org ([140.186.70.92]:47867)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgGV0-0000Ou-8p
	for guile-devel@gnu.org; Thu, 29 Dec 2011 08:58:27 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgGUy-0006Po-K0
	for guile-devel@gnu.org; Thu, 29 Dec 2011 08:58:26 -0500
Received: from mail-vx0-f169.google.com ([209.85.220.169]:40733)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgGUy-0006Pk-FM
	for guile-devel@gnu.org; Thu, 29 Dec 2011 08:58:24 -0500
Received: by vcge1 with SMTP id e1so11210109vcg.0
	for <guile-devel@gnu.org>; Thu, 29 Dec 2011 05:58:23 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:content-type; bh=c9oqUniekji7i7/S0OxMWSjlyVNoxjhClH+f/tL5vfc=;
	b=gp5wDG8MsZM3eweBtgbLymBavIgfYa2m9CW0AxWWiRsS5057EEfxGlDLujk0MV3S1M
	e4GShTuV5i+IKZJ0sG6UIh9SRcoNZy8Rn4+mtTShbJNd27/IIl0cjceBDV9uKoKDzV8I
	0cik+5/nnWlJ/1LKHwGTdN59/232m4/rVxv1Y=
MIME-Version: 1.0
Received: by 10.220.106.207 with SMTP id y15mr20439676vco.69.1325167103756;
	Thu, 29 Dec 2011 05:58:23 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Thu, 29 Dec 2011 05:58:23 -0800 (PST)
In-Reply-To: <CAPjoZocvsHVD=sXJ3zoRpVHQnGS1sksLhYFbr2iqeaUi3q09VA@mail.gmail.com>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<CAPjoZofnZUKwxR2pVuGEaMPP1Gdht_yHA52nUcX57RsuC0RTUw@mail.gmail.com>
	<CAPjoZocvsHVD=sXJ3zoRpVHQnGS1sksLhYFbr2iqeaUi3q09VA@mail.gmail.com>
Date: Thu, 29 Dec 2011 21:58:23 +0800
Message-ID: <CAPjoZoc6DtTkWX01CStQev7BFxC3CNHdjeCKbqaMRSDeagmmew@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Nala Ginrut <nalaginrut@gmail.com>
To: guile-devel <guile-devel@gnu.org>
Content-Type: multipart/mixed; boundary=f46d0434beee7cc9f804b53b82f6
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.220.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Thu, 29 Dec 2011 13:58:27 -0000

--f46d0434beee7cc9f804b53b82f6
Content-Type: multipart/alternative; boundary=f46d0434beee7cc9f404b53b82f4

--f46d0434beee7cc9f404b53b82f4
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Well, that's my fourth commit for this patch.
The reason is cky emphasized that the "real lisper" never use square
bracket. Anyway, I confess
square bracket is just my own style. So I think must make this patch
according to all Guilers' taste  if I want this patch to be helpful.
Four times for one patch. oh GOD...

On Thu, Dec 29, 2011 at 6:20 PM, Nala Ginrut <nalaginrut@gmail.com> wrote:

> Hmm... think I've deleted all the things for debug.
>
> On Thu, Dec 29, 2011 at 5:46 PM, Nala Ginrut <nalaginrut@gmail.com> wrote=
:
>
>> Sorry, there's a typo.
>> Here it is.
>>
>>
>> On Thu, Dec 29, 2011 at 5:32 PM, Nala Ginrut <nalaginrut@gmail.com>wrote=
:
>>
>>> hi guilers!
>>> It seems like there's no "regexp-split" procedure in Guile.
>>> What we have is "string-split" which accepted Char only.
>>> So I wrote one for myself.
>>>
>>> ------python code-----
>>> >>> import re
>>> >>> re.split("([^0-9])", "123+456*/")
>>> [=E2=80=99123=E2=80=99, =E2=80=99+=E2=80=99, =E2=80=99456=E2=80=99, =E2=
=80=99*=E2=80=99, =E2=80=99=E2=80=99, =E2=80=99/=E2=80=99, =E2=80=99=E2=80=
=99]
>>> --------code end-------
>>>
>>> The Guile version:
>>>
>>> ----------guile code-------
>>> (regexp-split "([^0-9])"  "123+456*/")
>>> =3D=3D>("123" "+" "456" "*" "" "/" "")
>>> ----------code end--------
>>>
>>> Anyone interested in it?
>>>
>>>
>>
>

--f46d0434beee7cc9f404b53b82f4
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Well, that&#39;s my fourth commit for this patch.<div>The reason is cky=C2=
=A0emphasized that the &quot;real lisper&quot; never use square bracket. An=
yway, I confess</div><div>square bracket is just my own style. So I think m=
ust make this patch according to all Guilers&#39; taste =C2=A0if I want=C2=
=A0this patch to be helpful.</div>
<div>Four times for one patch. oh GOD...<br><br><div class=3D"gmail_quote">=
On Thu, Dec 29, 2011 at 6:20 PM, Nala Ginrut <span dir=3D"ltr">&lt;<a href=
=3D"mailto:nalaginrut@gmail.com">nalaginrut@gmail.com</a>&gt;</span> wrote:=
<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex"><div>Hmm... think I&#39;ve deleted all the t=
hings for debug.</div><div class=3D"HOEnZb"><div class=3D"h5"><br><div clas=
s=3D"gmail_quote">
On Thu, Dec 29, 2011 at 5:46 PM, Nala Ginrut <span dir=3D"ltr">&lt;<a href=
=3D"mailto:nalaginrut@gmail.com" target=3D"_blank">nalaginrut@gmail.com</a>=
&gt;</span> wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">Sorry, there&#39;s a typo.<div>Here it is.<d=
iv><div><br><br><div class=3D"gmail_quote">On Thu, Dec 29, 2011 at 5:32 PM,=
 Nala Ginrut <span dir=3D"ltr">&lt;<a href=3D"mailto:nalaginrut@gmail.com" =
target=3D"_blank">nalaginrut@gmail.com</a>&gt;</span> wrote:<br>


<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">hi guilers!<div>It seems like there&#39;s no=
 &quot;regexp-split&quot; procedure in Guile.</div><div>What we have is &qu=
ot;string-split&quot; which accepted Char only.</div>


<div>So I wrote one for myself.</div><div><br></div>
<div>------python code-----</div><div>&gt;&gt;&gt; import re</div><div><div=
>&gt;&gt;&gt; re.split(&quot;([^0-9])&quot;, &quot;123+456*/&quot;)</div><d=
iv>[=E2=80=99123=E2=80=99, =E2=80=99+=E2=80=99, =E2=80=99456=E2=80=99, =E2=
=80=99*=E2=80=99, =E2=80=99=E2=80=99, =E2=80=99/=E2=80=99, =E2=80=99=E2=80=
=99]</div></div><div>--------code end-------</div>



<div><br></div><div>The Guile version:</div><div><br></div><div>----------g=
uile code-------</div><div>(regexp-split=C2=A0&quot;([^0-9])&quot; =C2=A0&q=
uot;123+456*/&quot;)</div><div>=3D=3D&gt;(&quot;123&quot; &quot;+&quot; &qu=
ot;456&quot; &quot;*&quot; &quot;&quot; &quot;/&quot; &quot;&quot;)</div>



<div>----------code end--------</div><div><br></div><div>Anyone interested =
in it?</div><div><br></div>
</blockquote></div><br></div></div></div>
</blockquote></div><br>
</div></div></blockquote></div><br></div>

--f46d0434beee7cc9f404b53b82f4--
--f46d0434beee7cc9f804b53b82f6
Content-Type: text/x-patch; charset=US-ASCII; name="0001-ADD-regexp-split.patch"
Content-Disposition: attachment; filename="0001-ADD-regexp-split.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gwru9lvs1

RnJvbSAzOTE1NWExZGRlYmQ0ZGEwY2QxM2E0YmNhZTkzMzk1ZjM5NzY1YzBlIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBOYWxhR2lucnV0IDxOYWxhR2lucnV0QGdtYWlsLmNvbT4KRGF0
ZTogVGh1LCAyOSBEZWMgMjAxMSAxODoxOTowMCArMDgwMApTdWJqZWN0OiBbUEFUQ0hdIEFERCBy
ZWdleHAtc3BsaXQKCi0tLQogbW9kdWxlL2ljZS05L3JlZ2V4LnNjbSB8ICAgMjAgKysrKysrKysr
KysrKysrKysrKy0KIDEgZmlsZXMgY2hhbmdlZCwgMTkgaW5zZXJ0aW9ucygrKSwgMSBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS9tb2R1bGUvaWNlLTkvcmVnZXguc2NtIGIvbW9kdWxlL2ljZS05
L3JlZ2V4LnNjbQppbmRleCBmN2I5NGI3Li4yODc3NDE5IDEwMDY0NAotLS0gYS9tb2R1bGUvaWNl
LTkvcmVnZXguc2NtCisrKyBiL21vZHVsZS9pY2UtOS9yZWdleC5zY20KQEAgLTQxLDcgKzQxLDcg
QEAKICAgIzpleHBvcnQgKG1hdGNoOmNvdW50IG1hdGNoOnN0cmluZyBtYXRjaDpwcmVmaXggbWF0
Y2g6c3VmZml4CiAgICAgICAgICAgIHJlZ2V4cC1tYXRjaD8gcmVnZXhwLXF1b3RlIG1hdGNoOnN0
YXJ0IG1hdGNoOmVuZCBtYXRjaDpzdWJzdHJpbmcKICAgICAgICAgICAgc3RyaW5nLW1hdGNoIHJl
Z2V4cC1zdWJzdGl0dXRlIGZvbGQtbWF0Y2hlcyBsaXN0LW1hdGNoZXMKLSAgICAgICAgICAgcmVn
ZXhwLXN1YnN0aXR1dGUvZ2xvYmFsKSkKKyAgICAgICAgICAgcmVnZXhwLXN1YnN0aXR1dGUvZ2xv
YmFsIHJlZ2V4cC1zcGxpdCkpCiAKIDs7IFJlZmVyZW5jZXM6CiA7OwpAQCAtMjI2LDMgKzIyNiwy
MSBAQAogICAgICAgICAgICAgICAgICAgICAgICAgKGJlZ2luCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgIChkby1pdGVtIChjYXIgaXRlbXMpKSA7IFRoaXMgaXMgbm90LgogICAgICAgICAgICAg
ICAgICAgICAgICAgICAobmV4dC1pdGVtIChjZHIgaXRlbXMpKSkpKSkpKSkpKQorICAgICAgICAg
ICAgICAgICAgICAgICAgICAKKyhkZWZpbmUgcmVnZXhwLXNwbGl0CisgIChsYW1iZGEgKHJlZ2V4
IHN0cikKKyAgICAobGV0ICgocmV0IChmb2xkLW1hdGNoZXMgCisJCXJlZ2V4IHN0ciAobGlzdCAn
KCkgMCAnKCIiKSkKKwkJKGxhbWJkYSAobSBwcmV2KQorCQkgIChsZXQqICgobGwgKGNhciBwcmV2
KSkKKwkJCSAoc3RhcnQgKGNhZHIgcHJldikpCisJCQkgKHRhaWwgKG1hdGNoOnN1ZmZpeCBtKSkK
KwkJCSAoZW5kIChtYXRjaDpzdGFydCBtKSkKKwkJCSAocyAoc3RyaW5nLWNvcHkgc3RyIHN0YXJ0
IGVuZCkpCisJCQkgKQorCQkgICAgKGxpc3QgYCgsQGxsICxzICwobWF0Y2g6c3Vic3RyaW5nIG0p
KSAKKwkJCSAgKG1hdGNoOmVuZCBtKSB0YWlsKQorCQkgICAgKSkpKSkKKyAgICAgIGAoLEAoY2Fy
IHJldCkgLChjYWRkciByZXQpKQorICAgICAgKSkpCisgICAgICAgICAgICAgICAgICAgICAgICAg
IAotLSAKMS43LjAuNAoK
--f46d0434beee7cc9f804b53b82f6--


From MAILER-DAEMON Fri Dec 30 00:34:19 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgV6h-0004MH-Na
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 00:34:19 -0500
Received: from eggs.gnu.org ([140.186.70.92]:42696)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgV6e-0004MA-JL
	for guile-devel@gnu.org; Fri, 30 Dec 2011 00:34:17 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgV6d-0005Y8-Ao
	for guile-devel@gnu.org; Fri, 30 Dec 2011 00:34:16 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:40074)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgV6d-0005Xv-6y
	for guile-devel@gnu.org; Fri, 30 Dec 2011 00:34:15 -0500
Received: by iacb35 with SMTP id b35so26919630iac.0
	for <guile-devel@gnu.org>; Thu, 29 Dec 2011 21:34:14 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type:content-transfer-encoding;
	bh=MgNAnELnjVxC1tOJOH6DaIQ7czvirxOHvsBTxm2cUMo=;
	b=oRv59mUXlUhZ2gfpKwEE+wZdyASIbUY/MgKZs7d/+NR/CiQKySu+GgfoIZ8/tJoa0i
	UrXHYNxW2Xyjciw2eF+ifwq4OM2Tk6a1EsZmB4OddmYltYlReZ4EVE9QGC4389pMKm7H
	6l1izgurzFC1pMxrV6rCZB5aUVy6K26rYhC+0=
MIME-Version: 1.0
Received: by 10.50.47.228 with SMTP id g4mr44648223ign.14.1325223252372; Thu,
	29 Dec 2011 21:34:12 -0800 (PST)
Received: by 10.231.48.68 with HTTP; Thu, 29 Dec 2011 21:34:12 -0800 (PST)
In-Reply-To: <CAPjoZoc6DtTkWX01CStQev7BFxC3CNHdjeCKbqaMRSDeagmmew@mail.gmail.com>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<CAPjoZofnZUKwxR2pVuGEaMPP1Gdht_yHA52nUcX57RsuC0RTUw@mail.gmail.com>
	<CAPjoZocvsHVD=sXJ3zoRpVHQnGS1sksLhYFbr2iqeaUi3q09VA@mail.gmail.com>
	<CAPjoZoc6DtTkWX01CStQev7BFxC3CNHdjeCKbqaMRSDeagmmew@mail.gmail.com>
Date: Fri, 30 Dec 2011 13:34:12 +0800
Message-ID: <CAN3veRfLDYBPeyPd+Ljqy5F3fpdWGOmc0ZtUtsZB=YKytey-VA@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Daniel Hartwig <mandyke@gmail.com>
To: Nala Ginrut <nalaginrut@gmail.com>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 05:34:17 -0000

Hello

>>> On Thu, Dec 29, 2011 at 5:32 PM, Nala Ginrut <nalaginrut@gmail.com>
>>> wrote:
>>>>
>>>> hi guilers!
>>>> It seems like there's no "regexp-split" procedure in Guile.
>>>> What we have is "string-split" which accepted Char only.
>>>> So I wrote one for myself.
>>>>
>>>> ------python code-----
>>>> >>> import re
>>>> >>> re.split("([^0-9])", "123+456*/")
>>>> [=E2=80=99123=E2=80=99, =E2=80=99+=E2=80=99, =E2=80=99456=E2=80=99, =
=E2=80=99*=E2=80=99, =E2=80=99=E2=80=99, =E2=80=99/=E2=80=99, =E2=80=99=E2=
=80=99]
>>>> --------code end-------
>>>>
>>>> The Guile version:
>>>>
>>>> ----------guile code-------
>>>> (regexp-split=C2=A0"([^0-9])" =C2=A0"123+456*/")
>>>> =3D=3D>("123" "+" "456" "*" "" "/" "")
>>>> ----------code end--------
>>>>
>>>> Anyone interested in it?
>>>>

Nice work!  I have a couple of comments :-)


The matched pattern/deliminator is included in the output:

scheme@(guile-user)> (regexp-split "(\\W+)" "Words, words, words.")
$21 =3D ("Words" ", " "words" ", " "words" "." "")
scheme@(guile-user)> (regexp-split "\\W+" "Words, words, words.")
$22 =3D ("Words" ", " "words" ", " "words" "." "")

However, a user is not always interested in the deliminator.  Consider
the example given for string-split:

scheme@(guile-user)> (string-split "root:x:0:0:root:/root:/bin/bash" #\:)
$23 =3D ("root" "x" "0" "0" "root" "/root" "/bin/bash")

This behaviour can be obtained with list-matches on the complement of
REGEXP.

scheme@(guile-user)> (map match:substring
                          (list-matches "\\w+" "Words, words, words."))
$24 =3D ("Words" "words" "words")

I would like to see your version support the Python semantics [1]:

> If capturing parentheses are used in pattern, then the text of
> all groups in the pattern are also returned as part of the resulting
> list.
[...]
> >>> re.split('\W+', 'Words, words, words.')
> ['Words', 'words', 'words', '']
> >>> re.split('(\W+)', 'Words, words, words.')
> ['Words', ', ', 'words', ', ', 'words', '.', '']

>>> re.split('((,)?\W+?)', 'Words, words, words.')
['Words', ', ', ',', 'words', ', ', ',', 'words', '.', None, '']


For the sake of consistency with the rest of the module perhaps
support the `flags' option (just pass it to fold-matches) and use the
same variable names, etc.:

(define* (regexp-split regexp string #:optional (flags 0))
  ...

instead of:

(define regexp-split
  (lambda (regex str)
  ...


Also, to me the name seems unintuitive -- it is STR being split, not
RE -- perhaps this can be folded in to the existing string-split
function.


A nice patch none-the-less!


[1] http://docs.python.org/library/re.html#re.split


From MAILER-DAEMON Fri Dec 30 03:47:05 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgY7F-0008VK-HY
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 03:47:05 -0500
Received: from eggs.gnu.org ([140.186.70.92]:49612)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgY76-0008Rd-Bs
	for guile-devel@gnu.org; Fri, 30 Dec 2011 03:47:03 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgY74-00078A-AU
	for guile-devel@gnu.org; Fri, 30 Dec 2011 03:46:56 -0500
Received: from mail-vw0-f41.google.com ([209.85.212.41]:51948)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgY73-00077n-Rd
	for guile-devel@gnu.org; Fri, 30 Dec 2011 03:46:54 -0500
Received: by vbbfn1 with SMTP id fn1so12804330vbb.0
	for <guile-devel@gnu.org>; Fri, 30 Dec 2011 00:46:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=XN6d1ASBIivnc0sISGaADocogfEaUGYLrAa7OlFxWM4=;
	b=sUBNZBGIAgUZ3ZmMx3kelw40f726ylREBsSQBP2ThJpNebFdU2qV0VAUnKjUSvCWVL
	wm6+oq3Uhg1sZt0G8pAHr0WdKsHx6dfrcAVtZpNhZ1W9O83xG45/GlIua0J+KYltQiRf
	Nh/GBX8Ag+kW4zvOTSRzedLfE+jFzjeYcAZqo=
MIME-Version: 1.0
Received: by 10.52.99.231 with SMTP id et7mr18421924vdb.114.1325234813107;
	Fri, 30 Dec 2011 00:46:53 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Fri, 30 Dec 2011 00:46:53 -0800 (PST)
In-Reply-To: <CAN3veRfLDYBPeyPd+Ljqy5F3fpdWGOmc0ZtUtsZB=YKytey-VA@mail.gmail.com>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<CAPjoZofnZUKwxR2pVuGEaMPP1Gdht_yHA52nUcX57RsuC0RTUw@mail.gmail.com>
	<CAPjoZocvsHVD=sXJ3zoRpVHQnGS1sksLhYFbr2iqeaUi3q09VA@mail.gmail.com>
	<CAPjoZoc6DtTkWX01CStQev7BFxC3CNHdjeCKbqaMRSDeagmmew@mail.gmail.com>
	<CAN3veRfLDYBPeyPd+Ljqy5F3fpdWGOmc0ZtUtsZB=YKytey-VA@mail.gmail.com>
Date: Fri, 30 Dec 2011 16:46:53 +0800
Message-ID: <CAPjoZocWvMqnoNmhtLbYREKR=QRPtr7zr6p+FXLh2X+hjQcPoA@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Nala Ginrut <nalaginrut@gmail.com>
To: Daniel Hartwig <mandyke@gmail.com>
Content-Type: multipart/alternative; boundary=bcaec50161b7477d5e04b54b466b
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.212.41
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 08:47:03 -0000

--bcaec50161b7477d5e04b54b466b
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

hi Daniel! Very glad to see your reply.
1. I also think the order: (regexp str) is strange. But it's according to
python version.
And I think the 'string-match' also put regexp before str. Anyway, that's
an easy mend.
2. I think it's a little different to implement a flag as python version.
Since "ignorecase" flag must
be passed to make-regexp. So we can't use fold-matches.
Hmm...let me see what I can do...

On Fri, Dec 30, 2011 at 1:34 PM, Daniel Hartwig <mandyke@gmail.com> wrote:

> Hello
>
> >>> On Thu, Dec 29, 2011 at 5:32 PM, Nala Ginrut <nalaginrut@gmail.com>
> >>> wrote:
> >>>>
> >>>> hi guilers!
> >>>> It seems like there's no "regexp-split" procedure in Guile.
> >>>> What we have is "string-split" which accepted Char only.
> >>>> So I wrote one for myself.
> >>>>
> >>>> ------python code-----
> >>>> >>> import re
> >>>> >>> re.split("([^0-9])", "123+456*/")
> >>>> [=E2=80=99123=E2=80=99, =E2=80=99+=E2=80=99, =E2=80=99456=E2=80=99, =
=E2=80=99*=E2=80=99, =E2=80=99=E2=80=99, =E2=80=99/=E2=80=99, =E2=80=99=E2=
=80=99]
> >>>> --------code end-------
> >>>>
> >>>> The Guile version:
> >>>>
> >>>> ----------guile code-------
> >>>> (regexp-split "([^0-9])"  "123+456*/")
> >>>> =3D=3D>("123" "+" "456" "*" "" "/" "")
> >>>> ----------code end--------
> >>>>
> >>>> Anyone interested in it?
> >>>>
>
> Nice work!  I have a couple of comments :-)
>
>
> The matched pattern/deliminator is included in the output:
>
> scheme@(guile-user)> (regexp-split "(\\W+)" "Words, words, words.")
> $21 =3D ("Words" ", " "words" ", " "words" "." "")
> scheme@(guile-user)> (regexp-split "\\W+" "Words, words, words.")
> $22 =3D ("Words" ", " "words" ", " "words" "." "")
>
> However, a user is not always interested in the deliminator.  Consider
> the example given for string-split:
>
> scheme@(guile-user)> (string-split "root:x:0:0:root:/root:/bin/bash" #\:)
> $23 =3D ("root" "x" "0" "0" "root" "/root" "/bin/bash")
>
> This behaviour can be obtained with list-matches on the complement of
> REGEXP.
>
> scheme@(guile-user)> (map match:substring
>                          (list-matches "\\w+" "Words, words, words."))
> $24 =3D ("Words" "words" "words")
>
> I would like to see your version support the Python semantics [1]:
>
> > If capturing parentheses are used in pattern, then the text of
> > all groups in the pattern are also returned as part of the resulting
> > list.
> [...]
> > >>> re.split('\W+', 'Words, words, words.')
> > ['Words', 'words', 'words', '']
> > >>> re.split('(\W+)', 'Words, words, words.')
> > ['Words', ', ', 'words', ', ', 'words', '.', '']
>
> >>> re.split('((,)?\W+?)', 'Words, words, words.')
> ['Words', ', ', ',', 'words', ', ', ',', 'words', '.', None, '']
>
>
> For the sake of consistency with the rest of the module perhaps
> support the `flags' option (just pass it to fold-matches) and use the
> same variable names, etc.:
>
> (define* (regexp-split regexp string #:optional (flags 0))
>  ...
>
> instead of:
>
> (define regexp-split
>  (lambda (regex str)
>  ...
>
>
> Also, to me the name seems unintuitive -- it is STR being split, not
> RE -- perhaps this can be folded in to the existing string-split
> function.
>
>
> A nice patch none-the-less!
>
>
> [1] http://docs.python.org/library/re.html#re.split
>

--bcaec50161b7477d5e04b54b466b
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

hi Daniel! Very glad to see your reply.<div>1. I also think the order: (reg=
exp str) is strange. But it&#39;s according to python version.</div><div>An=
d I think the &#39;string-match&#39; also put regexp before str. Anyway, th=
at&#39;s an easy mend.</div>
<div>2. I think it&#39;s a little different to implement a flag as python v=
ersion. Since &quot;ignorecase&quot; flag must</div><div>be passed to make-=
regexp. So we can&#39;t use fold-matches.=C2=A0</div><div>Hmm...let me see =
what I can do... =C2=A0</div>
<div><br><div class=3D"gmail_quote">On Fri, Dec 30, 2011 at 1:34 PM, Daniel=
 Hartwig <span dir=3D"ltr">&lt;<a href=3D"mailto:mandyke@gmail.com">mandyke=
@gmail.com</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=
=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
Hello<br>
<div class=3D"im"><br>
&gt;&gt;&gt; On Thu, Dec 29, 2011 at 5:32 PM, Nala Ginrut &lt;<a href=3D"ma=
ilto:nalaginrut@gmail.com">nalaginrut@gmail.com</a>&gt;<br>
&gt;&gt;&gt; wrote:<br>
&gt;&gt;&gt;&gt;<br>
&gt;&gt;&gt;&gt; hi guilers!<br>
&gt;&gt;&gt;&gt; It seems like there&#39;s no &quot;regexp-split&quot; proc=
edure in Guile.<br>
&gt;&gt;&gt;&gt; What we have is &quot;string-split&quot; which accepted Ch=
ar only.<br>
&gt;&gt;&gt;&gt; So I wrote one for myself.<br>
&gt;&gt;&gt;&gt;<br>
&gt;&gt;&gt;&gt; ------python code-----<br>
&gt;&gt;&gt;&gt; &gt;&gt;&gt; import re<br>
&gt;&gt;&gt;&gt; &gt;&gt;&gt; re.split(&quot;([^0-9])&quot;, &quot;123+456*=
/&quot;)<br>
&gt;&gt;&gt;&gt; [=E2=80=99123=E2=80=99, =E2=80=99+=E2=80=99, =E2=80=99456=
=E2=80=99, =E2=80=99*=E2=80=99, =E2=80=99=E2=80=99, =E2=80=99/=E2=80=99, =
=E2=80=99=E2=80=99]<br>
&gt;&gt;&gt;&gt; --------code end-------<br>
&gt;&gt;&gt;&gt;<br>
&gt;&gt;&gt;&gt; The Guile version:<br>
&gt;&gt;&gt;&gt;<br>
&gt;&gt;&gt;&gt; ----------guile code-------<br>
&gt;&gt;&gt;&gt; (regexp-split=C2=A0&quot;([^0-9])&quot; =C2=A0&quot;123+45=
6*/&quot;)<br>
&gt;&gt;&gt;&gt; =3D=3D&gt;(&quot;123&quot; &quot;+&quot; &quot;456&quot; &=
quot;*&quot; &quot;&quot; &quot;/&quot; &quot;&quot;)<br>
&gt;&gt;&gt;&gt; ----------code end--------<br>
&gt;&gt;&gt;&gt;<br>
&gt;&gt;&gt;&gt; Anyone interested in it?<br>
&gt;&gt;&gt;&gt;<br>
<br>
</div>Nice work! =C2=A0I have a couple of comments :-)<br>
<br>
<br>
The matched pattern/deliminator is included in the output:<br>
<br>
scheme@(guile-user)&gt; (regexp-split &quot;(\\W+)&quot; &quot;Words, words=
, words.&quot;)<br>
$21 =3D (&quot;Words&quot; &quot;, &quot; &quot;words&quot; &quot;, &quot; =
&quot;words&quot; &quot;.&quot; &quot;&quot;)<br>
scheme@(guile-user)&gt; (regexp-split &quot;\\W+&quot; &quot;Words, words, =
words.&quot;)<br>
$22 =3D (&quot;Words&quot; &quot;, &quot; &quot;words&quot; &quot;, &quot; =
&quot;words&quot; &quot;.&quot; &quot;&quot;)<br>
<br>
However, a user is not always interested in the deliminator. =C2=A0Consider=
<br>
the example given for string-split:<br>
<br>
scheme@(guile-user)&gt; (string-split &quot;root:x:0:0:root:/root:/bin/bash=
&quot; #\:)<br>
$23 =3D (&quot;root&quot; &quot;x&quot; &quot;0&quot; &quot;0&quot; &quot;r=
oot&quot; &quot;/root&quot; &quot;/bin/bash&quot;)<br>
<br>
This behaviour can be obtained with list-matches on the complement of<br>
REGEXP.<br>
<br>
scheme@(guile-user)&gt; (map match:substring<br>
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0(list-matches &quot;\\w+&quot; &quot;Words, words, words.&=
quot;))<br>
$24 =3D (&quot;Words&quot; &quot;words&quot; &quot;words&quot;)<br>
<br>
I would like to see your version support the Python semantics [1]:<br>
<br>
&gt; If capturing parentheses are used in pattern, then the text of<br>
&gt; all groups in the pattern are also returned as part of the resulting<b=
r>
&gt; list.<br>
[...]<br>
&gt; &gt;&gt;&gt; re.split(&#39;\W+&#39;, &#39;Words, words, words.&#39;)<b=
r>
&gt; [&#39;Words&#39;, &#39;words&#39;, &#39;words&#39;, &#39;&#39;]<br>
&gt; &gt;&gt;&gt; re.split(&#39;(\W+)&#39;, &#39;Words, words, words.&#39;)=
<br>
&gt; [&#39;Words&#39;, &#39;, &#39;, &#39;words&#39;, &#39;, &#39;, &#39;wo=
rds&#39;, &#39;.&#39;, &#39;&#39;]<br>
<br>
&gt;&gt;&gt; re.split(&#39;((,)?\W+?)&#39;, &#39;Words, words, words.&#39;)=
<br>
[&#39;Words&#39;, &#39;, &#39;, &#39;,&#39;, &#39;words&#39;, &#39;, &#39;,=
 &#39;,&#39;, &#39;words&#39;, &#39;.&#39;, None, &#39;&#39;]<br>
<br>
<br>
For the sake of consistency with the rest of the module perhaps<br>
support the `flags&#39; option (just pass it to fold-matches) and use the<b=
r>
same variable names, etc.:<br>
<br>
(define* (regexp-split regexp string #:optional (flags 0))<br>
 =C2=A0...<br>
<br>
instead of:<br>
<br>
(define regexp-split<br>
 =C2=A0(lambda (regex str)<br>
 =C2=A0...<br>
<br>
<br>
Also, to me the name seems unintuitive -- it is STR being split, not<br>
RE -- perhaps this can be folded in to the existing string-split<br>
function.<br>
<br>
<br>
A nice patch none-the-less!<br>
<br>
<br>
[1] <a href=3D"http://docs.python.org/library/re.html#re.split" target=3D"_=
blank">http://docs.python.org/library/re.html#re.split</a><br>
</blockquote></div><br></div>

--bcaec50161b7477d5e04b54b466b--


From MAILER-DAEMON Fri Dec 30 04:05:26 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgYP0-00027z-1S
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 04:05:26 -0500
Received: from eggs.gnu.org ([140.186.70.92]:48037)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgYOx-00027r-CN
	for guile-devel@gnu.org; Fri, 30 Dec 2011 04:05:24 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgYOv-0002M1-H2
	for guile-devel@gnu.org; Fri, 30 Dec 2011 04:05:23 -0500
Received: from mail-vx0-f169.google.com ([209.85.220.169]:46201)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1RgYOv-0002Lx-Az
	for guile-devel@gnu.org; Fri, 30 Dec 2011 04:05:21 -0500
Received: by vcge1 with SMTP id e1so11775802vcg.0
	for <guile-devel@gnu.org>; Fri, 30 Dec 2011 01:05:21 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=QEmF57K06CIWlMxMdWs5rfmLDwGVIRl4HiTMituCwyA=;
	b=fS4zKYtTt6rvdG6kWl8rIKccmIIu0Odt0u/h4c3FzUYVhMMr7w1J4Vx5jXiA1ZZKyC
	FJXqFTYxcyuZmbHsYW583xROsZ3MbzylhiSms4jDO+wYbDNRXEl9RsXxkmgK+Ro7055z
	2PSVGP6VSLzGNXjzspm0jJLqczsmGEEa+zki8=
MIME-Version: 1.0
Received: by 10.220.106.207 with SMTP id y15mr22274025vco.69.1325235920894;
	Fri, 30 Dec 2011 01:05:20 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Fri, 30 Dec 2011 01:05:20 -0800 (PST)
In-Reply-To: <CAPjoZocWvMqnoNmhtLbYREKR=QRPtr7zr6p+FXLh2X+hjQcPoA@mail.gmail.com>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<CAPjoZofnZUKwxR2pVuGEaMPP1Gdht_yHA52nUcX57RsuC0RTUw@mail.gmail.com>
	<CAPjoZocvsHVD=sXJ3zoRpVHQnGS1sksLhYFbr2iqeaUi3q09VA@mail.gmail.com>
	<CAPjoZoc6DtTkWX01CStQev7BFxC3CNHdjeCKbqaMRSDeagmmew@mail.gmail.com>
	<CAN3veRfLDYBPeyPd+Ljqy5F3fpdWGOmc0ZtUtsZB=YKytey-VA@mail.gmail.com>
	<CAPjoZocWvMqnoNmhtLbYREKR=QRPtr7zr6p+FXLh2X+hjQcPoA@mail.gmail.com>
Date: Fri, 30 Dec 2011 17:05:20 +0800
Message-ID: <CAPjoZocbECb4sbNnepj7n0G2ZFNu6t3rHkGn3o704Umi8bvH+A@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Nala Ginrut <nalaginrut@gmail.com>
To: Daniel Hartwig <mandyke@gmail.com>
Content-Type: multipart/alternative; boundary=f46d0434beee4efa4404b54b888d
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.220.169
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 09:05:24 -0000

--f46d0434beee4efa4404b54b888d
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Well, I realized it's a mistake. We can use fold-matches anyway.

On Fri, Dec 30, 2011 at 4:46 PM, Nala Ginrut <nalaginrut@gmail.com> wrote:

> hi Daniel! Very glad to see your reply.
> 1. I also think the order: (regexp str) is strange. But it's according to
> python version.
> And I think the 'string-match' also put regexp before str. Anyway, that's
> an easy mend.
> 2. I think it's a little different to implement a flag as python version.
> Since "ignorecase" flag must
> be passed to make-regexp. So we can't use fold-matches.
> Hmm...let me see what I can do...
>
> On Fri, Dec 30, 2011 at 1:34 PM, Daniel Hartwig <mandyke@gmail.com> wrote=
:
>
>> Hello
>>
>> >>> On Thu, Dec 29, 2011 at 5:32 PM, Nala Ginrut <nalaginrut@gmail.com>
>> >>> wrote:
>> >>>>
>> >>>> hi guilers!
>> >>>> It seems like there's no "regexp-split" procedure in Guile.
>> >>>> What we have is "string-split" which accepted Char only.
>> >>>> So I wrote one for myself.
>> >>>>
>> >>>> ------python code-----
>> >>>> >>> import re
>> >>>> >>> re.split("([^0-9])", "123+456*/")
>> >>>> [=E2=80=99123=E2=80=99, =E2=80=99+=E2=80=99, =E2=80=99456=E2=80=99,=
 =E2=80=99*=E2=80=99, =E2=80=99=E2=80=99, =E2=80=99/=E2=80=99, =E2=80=99=E2=
=80=99]
>> >>>> --------code end-------
>> >>>>
>> >>>> The Guile version:
>> >>>>
>> >>>> ----------guile code-------
>> >>>> (regexp-split "([^0-9])"  "123+456*/")
>> >>>> =3D=3D>("123" "+" "456" "*" "" "/" "")
>> >>>> ----------code end--------
>> >>>>
>> >>>> Anyone interested in it?
>> >>>>
>>
>> Nice work!  I have a couple of comments :-)
>>
>>
>> The matched pattern/deliminator is included in the output:
>>
>> scheme@(guile-user)> (regexp-split "(\\W+)" "Words, words, words.")
>> $21 =3D ("Words" ", " "words" ", " "words" "." "")
>> scheme@(guile-user)> (regexp-split "\\W+" "Words, words, words.")
>> $22 =3D ("Words" ", " "words" ", " "words" "." "")
>>
>> However, a user is not always interested in the deliminator.  Consider
>> the example given for string-split:
>>
>> scheme@(guile-user)> (string-split "root:x:0:0:root:/root:/bin/bash" #\:=
)
>> $23 =3D ("root" "x" "0" "0" "root" "/root" "/bin/bash")
>>
>> This behaviour can be obtained with list-matches on the complement of
>> REGEXP.
>>
>> scheme@(guile-user)> (map match:substring
>>                          (list-matches "\\w+" "Words, words, words."))
>> $24 =3D ("Words" "words" "words")
>>
>> I would like to see your version support the Python semantics [1]:
>>
>> > If capturing parentheses are used in pattern, then the text of
>> > all groups in the pattern are also returned as part of the resulting
>> > list.
>> [...]
>> > >>> re.split('\W+', 'Words, words, words.')
>> > ['Words', 'words', 'words', '']
>> > >>> re.split('(\W+)', 'Words, words, words.')
>> > ['Words', ', ', 'words', ', ', 'words', '.', '']
>>
>> >>> re.split('((,)?\W+?)', 'Words, words, words.')
>> ['Words', ', ', ',', 'words', ', ', ',', 'words', '.', None, '']
>>
>>
>> For the sake of consistency with the rest of the module perhaps
>> support the `flags' option (just pass it to fold-matches) and use the
>> same variable names, etc.:
>>
>> (define* (regexp-split regexp string #:optional (flags 0))
>>  ...
>>
>> instead of:
>>
>> (define regexp-split
>>  (lambda (regex str)
>>  ...
>>
>>
>> Also, to me the name seems unintuitive -- it is STR being split, not
>> RE -- perhaps this can be folded in to the existing string-split
>> function.
>>
>>
>> A nice patch none-the-less!
>>
>>
>> [1] http://docs.python.org/library/re.html#re.split
>>
>
>

--f46d0434beee4efa4404b54b888d
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Well, I realized it&#39;s a mistake. We can use fold-matches anyway.<br><br=
><div class=3D"gmail_quote">On Fri, Dec 30, 2011 at 4:46 PM, Nala Ginrut <s=
pan dir=3D"ltr">&lt;<a href=3D"mailto:nalaginrut@gmail.com">nalaginrut@gmai=
l.com</a>&gt;</span> wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">hi Daniel! Very glad to see your reply.<div>=
1. I also think the order: (regexp str) is strange. But it&#39;s according =
to python version.</div>
<div>And I think the &#39;string-match&#39; also put regexp before str. Any=
way, that&#39;s an easy mend.</div>
<div>2. I think it&#39;s a little different to implement a flag as python v=
ersion. Since &quot;ignorecase&quot; flag must</div><div>be passed to make-=
regexp. So we can&#39;t use fold-matches.=C2=A0</div><div>Hmm...let me see =
what I can do... =C2=A0</div>
<div class=3D"HOEnZb"><div class=3D"h5">
<div><br><div class=3D"gmail_quote">On Fri, Dec 30, 2011 at 1:34 PM, Daniel=
 Hartwig <span dir=3D"ltr">&lt;<a href=3D"mailto:mandyke@gmail.com" target=
=3D"_blank">mandyke@gmail.com</a>&gt;</span> wrote:<br><blockquote class=3D=
"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding=
-left:1ex">

Hello<br>
<div><br>
&gt;&gt;&gt; On Thu, Dec 29, 2011 at 5:32 PM, Nala Ginrut &lt;<a href=3D"ma=
ilto:nalaginrut@gmail.com" target=3D"_blank">nalaginrut@gmail.com</a>&gt;<b=
r>
&gt;&gt;&gt; wrote:<br>
&gt;&gt;&gt;&gt;<br>
&gt;&gt;&gt;&gt; hi guilers!<br>
&gt;&gt;&gt;&gt; It seems like there&#39;s no &quot;regexp-split&quot; proc=
edure in Guile.<br>
&gt;&gt;&gt;&gt; What we have is &quot;string-split&quot; which accepted Ch=
ar only.<br>
&gt;&gt;&gt;&gt; So I wrote one for myself.<br>
&gt;&gt;&gt;&gt;<br>
&gt;&gt;&gt;&gt; ------python code-----<br>
&gt;&gt;&gt;&gt; &gt;&gt;&gt; import re<br>
&gt;&gt;&gt;&gt; &gt;&gt;&gt; re.split(&quot;([^0-9])&quot;, &quot;123+456*=
/&quot;)<br>
&gt;&gt;&gt;&gt; [=E2=80=99123=E2=80=99, =E2=80=99+=E2=80=99, =E2=80=99456=
=E2=80=99, =E2=80=99*=E2=80=99, =E2=80=99=E2=80=99, =E2=80=99/=E2=80=99, =
=E2=80=99=E2=80=99]<br>
&gt;&gt;&gt;&gt; --------code end-------<br>
&gt;&gt;&gt;&gt;<br>
&gt;&gt;&gt;&gt; The Guile version:<br>
&gt;&gt;&gt;&gt;<br>
&gt;&gt;&gt;&gt; ----------guile code-------<br>
&gt;&gt;&gt;&gt; (regexp-split=C2=A0&quot;([^0-9])&quot; =C2=A0&quot;123+45=
6*/&quot;)<br>
&gt;&gt;&gt;&gt; =3D=3D&gt;(&quot;123&quot; &quot;+&quot; &quot;456&quot; &=
quot;*&quot; &quot;&quot; &quot;/&quot; &quot;&quot;)<br>
&gt;&gt;&gt;&gt; ----------code end--------<br>
&gt;&gt;&gt;&gt;<br>
&gt;&gt;&gt;&gt; Anyone interested in it?<br>
&gt;&gt;&gt;&gt;<br>
<br>
</div>Nice work! =C2=A0I have a couple of comments :-)<br>
<br>
<br>
The matched pattern/deliminator is included in the output:<br>
<br>
scheme@(guile-user)&gt; (regexp-split &quot;(\\W+)&quot; &quot;Words, words=
, words.&quot;)<br>
$21 =3D (&quot;Words&quot; &quot;, &quot; &quot;words&quot; &quot;, &quot; =
&quot;words&quot; &quot;.&quot; &quot;&quot;)<br>
scheme@(guile-user)&gt; (regexp-split &quot;\\W+&quot; &quot;Words, words, =
words.&quot;)<br>
$22 =3D (&quot;Words&quot; &quot;, &quot; &quot;words&quot; &quot;, &quot; =
&quot;words&quot; &quot;.&quot; &quot;&quot;)<br>
<br>
However, a user is not always interested in the deliminator. =C2=A0Consider=
<br>
the example given for string-split:<br>
<br>
scheme@(guile-user)&gt; (string-split &quot;root:x:0:0:root:/root:/bin/bash=
&quot; #\:)<br>
$23 =3D (&quot;root&quot; &quot;x&quot; &quot;0&quot; &quot;0&quot; &quot;r=
oot&quot; &quot;/root&quot; &quot;/bin/bash&quot;)<br>
<br>
This behaviour can be obtained with list-matches on the complement of<br>
REGEXP.<br>
<br>
scheme@(guile-user)&gt; (map match:substring<br>
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0(list-matches &quot;\\w+&quot; &quot;Words, words, words.&=
quot;))<br>
$24 =3D (&quot;Words&quot; &quot;words&quot; &quot;words&quot;)<br>
<br>
I would like to see your version support the Python semantics [1]:<br>
<br>
&gt; If capturing parentheses are used in pattern, then the text of<br>
&gt; all groups in the pattern are also returned as part of the resulting<b=
r>
&gt; list.<br>
[...]<br>
&gt; &gt;&gt;&gt; re.split(&#39;\W+&#39;, &#39;Words, words, words.&#39;)<b=
r>
&gt; [&#39;Words&#39;, &#39;words&#39;, &#39;words&#39;, &#39;&#39;]<br>
&gt; &gt;&gt;&gt; re.split(&#39;(\W+)&#39;, &#39;Words, words, words.&#39;)=
<br>
&gt; [&#39;Words&#39;, &#39;, &#39;, &#39;words&#39;, &#39;, &#39;, &#39;wo=
rds&#39;, &#39;.&#39;, &#39;&#39;]<br>
<br>
&gt;&gt;&gt; re.split(&#39;((,)?\W+?)&#39;, &#39;Words, words, words.&#39;)=
<br>
[&#39;Words&#39;, &#39;, &#39;, &#39;,&#39;, &#39;words&#39;, &#39;, &#39;,=
 &#39;,&#39;, &#39;words&#39;, &#39;.&#39;, None, &#39;&#39;]<br>
<br>
<br>
For the sake of consistency with the rest of the module perhaps<br>
support the `flags&#39; option (just pass it to fold-matches) and use the<b=
r>
same variable names, etc.:<br>
<br>
(define* (regexp-split regexp string #:optional (flags 0))<br>
 =C2=A0...<br>
<br>
instead of:<br>
<br>
(define regexp-split<br>
 =C2=A0(lambda (regex str)<br>
 =C2=A0...<br>
<br>
<br>
Also, to me the name seems unintuitive -- it is STR being split, not<br>
RE -- perhaps this can be folded in to the existing string-split<br>
function.<br>
<br>
<br>
A nice patch none-the-less!<br>
<br>
<br>
[1] <a href=3D"http://docs.python.org/library/re.html#re.split" target=3D"_=
blank">http://docs.python.org/library/re.html#re.split</a><br>
</blockquote></div><br></div>
</div></div></blockquote></div><br>

--f46d0434beee4efa4404b54b888d--


From MAILER-DAEMON Fri Dec 30 04:42:21 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgYyj-0002cH-MY
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 04:42:21 -0500
Received: from eggs.gnu.org ([140.186.70.92]:38415)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgYyg-0002b2-Op
	for guile-devel@gnu.org; Fri, 30 Dec 2011 04:42:19 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgYyf-00081Q-Iu
	for guile-devel@gnu.org; Fri, 30 Dec 2011 04:42:18 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:44165)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgYyf-00081M-Fp
	for guile-devel@gnu.org; Fri, 30 Dec 2011 04:42:17 -0500
Received: by iacb35 with SMTP id b35so27263961iac.0
	for <guile-devel@gnu.org>; Fri, 30 Dec 2011 01:42:16 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:content-type:content-transfer-encoding;
	bh=SueMmKB4uxEboKy5HrCtwsQTCcpQzUJF50CRn9qvSPU=;
	b=sts2j2MplvDDjI2wy+iFL+Q4BS4Tj2c4zo7DQZeoziflTkx+/hfSSzBqUhy5o4fpto
	AIihfDTm8RzKWZzwZUsrrlsAe44IJnWOLA003OvcCyxmGb22OGFOv8u92d6wxU5MyfzQ
	XXeaYtjIIjgf536qXw8efig45+DciIFfcIlE8=
MIME-Version: 1.0
Received: by 10.50.47.228 with SMTP id g4mr45378799ign.14.1325238136727; Fri,
	30 Dec 2011 01:42:16 -0800 (PST)
Received: by 10.231.48.68 with HTTP; Fri, 30 Dec 2011 01:42:16 -0800 (PST)
In-Reply-To: <CAN3veRdFQyOthFTSLE7v9x3_A4HTPX99DSmDx26dBkeyy=MTDQ@mail.gmail.com>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<CAPjoZofnZUKwxR2pVuGEaMPP1Gdht_yHA52nUcX57RsuC0RTUw@mail.gmail.com>
	<CAPjoZocvsHVD=sXJ3zoRpVHQnGS1sksLhYFbr2iqeaUi3q09VA@mail.gmail.com>
	<CAPjoZoc6DtTkWX01CStQev7BFxC3CNHdjeCKbqaMRSDeagmmew@mail.gmail.com>
	<CAN3veRfLDYBPeyPd+Ljqy5F3fpdWGOmc0ZtUtsZB=YKytey-VA@mail.gmail.com>
	<CAPjoZocWvMqnoNmhtLbYREKR=QRPtr7zr6p+FXLh2X+hjQcPoA@mail.gmail.com>
	<CAN3veRdFQyOthFTSLE7v9x3_A4HTPX99DSmDx26dBkeyy=MTDQ@mail.gmail.com>
Date: Fri, 30 Dec 2011 17:42:16 +0800
Message-ID: <CAN3veRfRK7YN9YKrkJyg52T763f1fP3F6n0dTZ7+U9BX5O8HHw@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Daniel Hartwig <mandyke@gmail.com>
To: guile-devel@gnu.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 09:42:19 -0000

On 30 December 2011 16:46, Nala Ginrut <nalaginrut@gmail.com> wrote:
> hi Daniel! Very glad to see your reply.
> 1. I also think the order: (regexp str) is strange. But it's according to
> python version.
> And I think the 'string-match' also put regexp before str. Anyway, that's=
 an
> easy mend.

`regexp string' is also the same order as `list-matches' and
`fold-matches'. =C2=A0Probably best to keep it that way if this is in the
regex module.


>> I would like to see your version support the Python semantics [1]:
>>
>> > If capturing parentheses are used in pattern, then the text of
>> > all groups in the pattern are also returned as part of the resulting
>> > list.
>> [...]
>> > >>> re.split('\W+', 'Words, words, words.')
>> > ['Words', 'words', 'words', '']
>> > >>> re.split('(\W+)', 'Words, words, words.')
>> > ['Words', ', ', 'words', ', ', 'words', '.', '']
>>
>> >>> re.split('((,)?\W+?)', 'Words, words, words.')
>> ['Words', ', ', ',', 'words', ', ', ',', 'words', '.', None, '']

FYI this can be achieved by changing the inner part to:

=C2=A0 =C2=A0(let* ...
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 (s (substring string start end))
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 (groups (map (lambda (n) (match:substrin=
g m n))
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0(iota (1- (match:count m)) 1))))
=C2=A0 =C2=A0 =C2=A0(list `(,@ll ,s ,@groups) (match:end m) tail)))

Note: using srfi-1 iota


From MAILER-DAEMON Fri Dec 30 05:09:02 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgZOY-0007qu-DQ
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 05:09:02 -0500
Received: from eggs.gnu.org ([140.186.70.92]:39032)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <hkBst@gentoo.org>) id 1RgZOW-0007qY-IV
	for guile-devel@gnu.org; Fri, 30 Dec 2011 05:09:01 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <hkBst@gentoo.org>) id 1RgZOS-0003nO-Ci
	for guile-devel@gnu.org; Fri, 30 Dec 2011 05:09:00 -0500
Received: from smtp.gentoo.org ([140.211.166.183]:33590)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <hkBst@gentoo.org>) id 1RgZOS-0003nK-8N
	for guile-devel@gnu.org; Fri, 30 Dec 2011 05:08:56 -0500
Received: from [10.128.5.241] (unknown [79.170.210.172])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested) (Authenticated sender: hkbst)
	by smtp.gentoo.org (Postfix) with ESMTPSA id BA02D1B4005;
	Fri, 30 Dec 2011 10:08:53 +0000 (UTC)
Message-ID: <4EFD8F08.7070303@gentoo.org>
Date: Fri, 30 Dec 2011 11:14:32 +0100
From: Marijn <hkBst@gentoo.org>
User-Agent: Mozilla/5.0 (X11; Linux x86_64;
	rv:8.0) Gecko/20111117 Thunderbird/8.0
MIME-Version: 1.0
To: Nala Ginrut <nalaginrut@gmail.com>
Subject: Re: [PATCH] add regexp-split
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
In-Reply-To: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
X-Enigmail-Version: 1.3.3
Content-Type: text/plain; charset=windows-1252
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 140.211.166.183
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 10:09:01 -0000

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 29-12-11 10:32, Nala Ginrut wrote:
> hi guilers! It seems like there's no "regexp-split" procedure in
> Guile. What we have is "string-split" which accepted Char only. So
> I wrote one for myself.
>=20
> ------python code-----
>>>> import re re.split("([^0-9])", "123+456*/")
> [=92123=92, =92+=92, =92456=92, =92*=92, =92=92, =92/=92, =92=92] -----=
---code end-------
>=20
> The Guile version:
>=20
> ----------guile code------- (regexp-split "([^0-9])"  "123+456*/")=20
> =3D=3D>("123" "+" "456" "*" "" "/" "") ----------code end--------
>=20
> Anyone interested in it?

Hi there,

I think we're all happy that Guile is getting this support, however I
couldn't help but notice that the above results look a bit funny and
indeed are incompatible with racket's implementation:

> (regexp-split "([^0-9])" "123+456*/")
'("123" "456" "" "")

Apparently because their version doesn't support capturing groups in
this function. I've raised the issue with them as well, but there are
some doubts that it is useful/sane to support this. Perhaps other
schemes' regexp libraries should be compared as well. Their tests
would certainly be useful and may point out other incompatibilities
that no-one is aware of (as well as improve your code(!)).

Marijn
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.18 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk79jwgACgkQp/VmCx0OL2zCrgCgrCtBGvKaejnfceWj8RaBz+lm
lfMAoIrR0qr8IFKhFG4KGBevf1LQfoZv
=3D2x7Y
-----END PGP SIGNATURE-----


From MAILER-DAEMON Fri Dec 30 05:15:12 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgZUW-0008OS-Uu
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 05:15:12 -0500
Received: from eggs.gnu.org ([140.186.70.92]:44137)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <Debian-debbugs@debbugs.gnu.org>) id 1RgZUT-0008LM-C1
	for guile-devel@gnu.org; Fri, 30 Dec 2011 05:15:10 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <Debian-debbugs@debbugs.gnu.org>) id 1RgZUR-0004es-VW
	for guile-devel@gnu.org; Fri, 30 Dec 2011 05:15:09 -0500
Received: from debbugs.gnu.org ([140.186.70.43]:58326)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <Debian-debbugs@debbugs.gnu.org>)
	id 1RgZUR-0004ek-SC; Fri, 30 Dec 2011 05:15:07 -0500
Received: from Debian-debbugs by debbugs.gnu.org with local (Exim 4.69)
	(envelope-from <Debian-debbugs@debbugs.gnu.org>)
	id 1RgZXG-0007IP-Cj; Fri, 30 Dec 2011 05:18:02 -0500
X-Loop: help-debbugs@gnu.org
Subject: bug#10410: guile: uri module confused by domain names starting with
	numbers, ipv6 addresses
Resent-From: Daniel Hartwig <mandyke@gmail.com>
Original-Sender: debbugs-submit-bounces@debbugs.gnu.org
Resent-CC: guile-devel@gnu.org, bug-guile@gnu.org
Resent-Date: Fri, 30 Dec 2011 10:18:02 +0000
Resent-Message-ID: <handler.10410.B.132524027428029@debbugs.gnu.org>
Resent-Sender: help-debbugs@gnu.org
X-GNU-PR-Message: report 10410
X-GNU-PR-Package: guile
X-GNU-PR-Keywords: patch
To: 10410@debbugs.gnu.org
X-Debbugs-Original-To: submit@debbugs.gnu.org
X-Debbugs-Original-Xcc: guile-devel@gnu.org
Received: via spool by submit@debbugs.gnu.org id=B.132524027428029
	(code B ref -1); Fri, 30 Dec 2011 10:18:02 +0000
Received: (at submit) by debbugs.gnu.org; 30 Dec 2011 10:17:54 +0000
Received: from localhost ([127.0.0.1] helo=debbugs.gnu.org)
	by debbugs.gnu.org with esmtp (Exim 4.69)
	(envelope-from <debbugs-submit-bounces@debbugs.gnu.org>)
	id 1RgZX8-0007I1-GC
	for submit@debbugs.gnu.org; Fri, 30 Dec 2011 05:17:54 -0500
Received: from mail-iy0-f172.google.com ([209.85.210.172])
	by debbugs.gnu.org with esmtp (Exim 4.69)
	(envelope-from <mandyke@gmail.com>) id 1RgZX6-0007Hu-76
	for submit@debbugs.gnu.org; Fri, 30 Dec 2011 05:17:52 -0500
Received: by iabz21 with SMTP id z21so2986603iab.3
	for <submit@debbugs.gnu.org>; Fri, 30 Dec 2011 02:14:56 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:date:message-id:subject:from:to:content-type;
	bh=4ZvUfBUMDBrcSKz3XUmDrtQSiwcbjNUd7186Lth7Bl0=;
	b=HRW1G2LBRnvZhvfmVVBBwWxJnofyomkcxFxTMBHfLUl1mgmkRasgk4Qag0erk7Vdao
	wFs01iEJm6CH6hGa1s+qGz3CSNro/zNK8S+tDwV99Q10EfUQv5tzP8ibcp/3/EtJTpEp
	PHmUWMwRGQNt78Chm4pLK5JMJkkRquc3cep7k=
MIME-Version: 1.0
Received: by 10.50.156.138 with SMTP id we10mr25245428igb.10.1325240096627;
	Fri, 30 Dec 2011 02:14:56 -0800 (PST)
Received: by 10.231.48.68 with HTTP; Fri, 30 Dec 2011 02:14:56 -0800 (PST)
Date: Fri, 30 Dec 2011 18:14:56 +0800
Message-ID: <CAN3veRcjwKBRspH1JbWqYOLHeUF+8KmAE_fzcgOngYdddw0prQ@mail.gmail.com>
From: Daniel Hartwig <mandyke@gmail.com>
Content-Type: multipart/mixed; boundary=e89a8f234aad339a7204b54c81b8
X-BeenThere: debbugs-submit@debbugs.gnu.org
X-Mailman-Version: 2.1.11
Precedence: list
Sender: debbugs-submit-bounces@debbugs.gnu.org
Errors-To: debbugs-submit-bounces@debbugs.gnu.org
Resent-Date: Fri, 30 Dec 2011 05:18:02 -0500
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 140.186.70.43
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 10:15:10 -0000

--e89a8f234aad339a7204b54c81b8
Content-Type: text/plain; charset=UTF-8

Package: guile
Version: 2.0.3
Tags: patch
X-Debbugs-CC: guile-devel@gnu.org


Hello

I have noticed that the (web uri) module does not handle domain names
that start with numbers:

scheme@(guile-user)> (string->uri "http://123.com")
$1 = #f
scheme@(guile-user)> (build-uri 'http #:host "123.com")
web/uri.scm:85:6: In procedure build-uri:
web/uri.scm:85:6: Throw to key `uri-error' with args `("Expected valid
host: ~s" ("123.com"))'.


Also, `string->uri' does not handle ipv6 addresses:

scheme@(guile-user)> (string->uri "http://[2001:db8::1]")
$2 = #f


Attached patch implements support for domain names that start with
numbers by correcting the
regular expressions used by `valid-host?' as well as some related tests.

`string->uri' requires similar changes to support the ipv6 address
literals.  I'm yet to found a very elegant way to do this though it is
easy enough to simply butcher `authority-pat'.

--e89a8f234aad339a7204b54c81b8
Content-Type: text/x-patch; charset=US-ASCII; 
	name="0001-support-URIs-with-domain-names-starting-with-numbers.patch"
Content-Disposition: attachment; 
	filename="0001-support-URIs-with-domain-names-starting-with-numbers.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gwt1ikfq0

RnJvbSA5ZmNlZDM5NWI0YWZiNGUwMjI0MTRhNGI0NTFhNTBiMzFjZWFjZWRkIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBEYW5pZWwgSGFydHdpZyA8bWFuZHlrZUBnbWFpbC5jb20+CkRh
dGU6IEZyaSwgMzAgRGVjIDIwMTEgMTc6NDk6MzcgKzA4MDAKU3ViamVjdDogW1BBVENIXSBzdXBw
b3J0IFVSSXMgd2l0aCBkb21haW4gbmFtZXMgc3RhcnRpbmcgd2l0aCBudW1iZXJzCgoqIG1vZHVs
ZS93ZWIvdXJpLnNjbSAodmFsaWQtaG9zdD8pOiBGaXggcmVnZXhwIHRvIHN1cHBvcnQKZG9tYWlu
IG5hbWVzIHN0YXJ0aW5nIHdpdGggbnVtYmVycy4KKiB0ZXN0LXN1aXRlL3Rlc3RzL3dlYi11cmku
c2NtOiBBZGQgdGVzdHMgZm9yIGFib3ZlIGFuZApJUCBsaXRlcmFscy4KLS0tCiBtb2R1bGUvd2Vi
L3VyaS5zY20gICAgICAgICAgICB8ICAgIDQgKy0KIHRlc3Qtc3VpdGUvdGVzdHMvd2ViLXVyaS50
ZXN0IHwgICA0OSArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLQogMiBm
aWxlcyBjaGFuZ2VkLCA1MCBpbnNlcnRpb25zKCspLCAzIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdp
dCBhL21vZHVsZS93ZWIvdXJpLnNjbSBiL21vZHVsZS93ZWIvdXJpLnNjbQppbmRleCA2N2VjYmFl
Li5mZjEzODQ3IDEwMDY0NAotLS0gYS9tb2R1bGUvd2ViL3VyaS5zY20KKysrIGIvbW9kdWxlL3dl
Yi91cmkuc2NtCkBAIC04OSw5ICs4OSw5IEBAIGNvbnNpc3RlbmN5IGNoZWNrcyB0byBtYWtlIHN1
cmUgdGhhdCB0aGUgY29uc3RydWN0ZWQgVVJJIGlzIHZhbGlkLiIKIDs7IDM0OTApLCBhbmQgbm9u
LUFTQ0lJIGhvc3QgbmFtZXMuCiA7OwogKGRlZmluZSBpcHY0LXJlZ2V4cAotICAobWFrZS1yZWdl
eHAgIl4oWzAtOS5dKykiKSkKKyAgKG1ha2UtcmVnZXhwICJeKFswLTkuXSspJCIpKQogKGRlZmlu
ZSBpcHY2LXJlZ2V4cAotICAobWFrZS1yZWdleHAgIl5cXFsoWzAtOWEtZkEtRjpdKylcXF0rIikp
CisgIChtYWtlLXJlZ2V4cCAiXlxcWyhbMC05YS1mQS1GOl0rKVxcXSQiKSkKIChkZWZpbmUgZG9t
YWluLWxhYmVsLXJlZ2V4cAogICAobWFrZS1yZWdleHAgIl5bYS16QS1aMC05XShbYS16QS1aMC05
LV0qW2EtekEtWjAtOV0pPyQiKSkKIChkZWZpbmUgdG9wLWxhYmVsLXJlZ2V4cApkaWZmIC0tZ2l0
IGEvdGVzdC1zdWl0ZS90ZXN0cy93ZWItdXJpLnRlc3QgYi90ZXN0LXN1aXRlL3Rlc3RzL3dlYi11
cmkudGVzdAppbmRleCA5MTE4ZWVhLi40Zjg1OWUwIDEwMDY0NAotLS0gYS90ZXN0LXN1aXRlL3Rl
c3RzL3dlYi11cmkudGVzdAorKysgYi90ZXN0LXN1aXRlL3Rlc3RzL3dlYi11cmkudGVzdApAQCAt
OTAsNiArOTAsMTggQEAKICAgICAodXJpPT8gKGJ1aWxkLXVyaSAnaHR0cCAjOmhvc3QgImJhZC5o
b3N0LjEiICM6dmFsaWRhdGU/ICNmKQogICAgICAgICAgICAjOnNjaGVtZSAnaHR0cCAjOmhvc3Qg
ImJhZC5ob3N0LjEiICM6cGF0aCAiIikpCiAKKyAgKHBhc3MtaWYgImh0dHA6Ly8xLmdvb2QuaG9z
dCIKKyAgICAodXJpPT8gKGJ1aWxkLXVyaSAnaHR0cCAjOmhvc3QgIjEuZ29vZC5ob3N0IikKKyAg
ICAgICAgICAgIzpzY2hlbWUgJ2h0dHAgIzpob3N0ICIxLmdvb2QuaG9zdCIgIzpwYXRoICIiKSkK
KworICAocGFzcy1pZiAiaHR0cDovLzE5Mi4wLjIuMSIKKyAgICAodXJpPT8gKGJ1aWxkLXVyaSAn
aHR0cCAjOmhvc3QgIjE5Mi4wLjIuMSIpCisgICAgICAgICAgICM6c2NoZW1lICdodHRwICM6aG9z
dCAiMTkyLjAuMi4xIiAjOnBhdGggIiIpKQorCisgIChwYXNzLWlmICJodHRwOi8vWzIwMDE6ZGI4
OjoxXSIKKyAgICAodXJpPT8gKGJ1aWxkLXVyaSAnaHR0cCAjOmhvc3QgIlsyMDAxOmRiODo6MV0i
KQorICAgICAgICAgICAjOnNjaGVtZSAnaHR0cCAjOmhvc3QgIlsyMDAxOmRiODo6MV0iICM6cGF0
aCAiIikpCisKICAgKHBhc3MtaWYtdXJpLWV4Y2VwdGlvbiAiaHR0cDovL2Zvbzpub3QtYS1wb3J0
IgogICAgICAgICAgICAgICAgICAgICAgICAgICJFeHBlY3RlZC4qcG9ydCIKICAgICAgICAgICAg
ICAgICAgICAgICAgICAoYnVpbGQtdXJpICdodHRwICM6aG9zdCAiZm9vIiAjOnBvcnQgIm5vdC1h
LXBvcnQiKSkKQEAgLTEzNSw2ICsxNDcsMjUgQEAKICAgKHBhc3MtaWYgImh0dHA6Ly9iYWQuaG9z
dC4xIgogICAgIChub3QgKHN0cmluZy0+dXJpICJodHRwOi8vYmFkLmhvc3QuMSIpKSkKIAorICAo
cGFzcy1pZiAiaHR0cDovLzEuZ29vZC5ob3N0IgorICAgICh1cmk9PyAoc3RyaW5nLT51cmkgImh0
dHA6Ly8xLmdvb2QuaG9zdCIpCisgICAgICAgICAgICM6c2NoZW1lICdodHRwICM6aG9zdCAiMS5n
b29kLmhvc3QiICM6cGF0aCAiIikpCisKKyAgKHBhc3MtaWYgImh0dHA6Ly8xOTIuMC4yLjEiCisg
ICAgKHVyaT0/IChzdHJpbmctPnVyaSAiaHR0cDovLzE5Mi4wLjIuMSIpCisgICAgICAgICAgICM6
c2NoZW1lICdodHRwICM6aG9zdCAiMTkyLjAuMi4xIiAjOnBhdGggIiIpKQorCisgIChwYXNzLWlm
ICJodHRwOi8vWzIwMDE6ZGI4OjoxXSIKKyAgICAodXJpPT8gKHN0cmluZy0+dXJpICJodHRwOi8v
WzIwMDE6ZGI4OjoxXSIpCisgICAgICAgICAgICM6c2NoZW1lICdodHRwICM6aG9zdCAiWzIwMDE6
ZGI4OjoxXSIgIzpwYXRoICIiKSkKKworICAocGFzcy1pZiAiaHR0cDovL1syMDAxOmRiODo6MV06
ODAiCisgICAgKHVyaT0/IChzdHJpbmctPnVyaSAiaHR0cDovL1syMDAxOmRiODo6MV0iKQorICAg
ICAgICAgICAjOnNjaGVtZSAnaHR0cAorICAgICAgICAgICAjOmhvc3QgIlsyMDAxOmRiODo6MV0i
CisgICAgICAgICAgICM6cG9ydCA4MAorICAgICAgICAgICAjOnBhdGggIiIpKQorCiAgIChwYXNz
LWlmICJodHRwOi8vZm9vOiIKICAgICAodXJpPT8gKHN0cmluZy0+dXJpICJodHRwOi8vZm9vOiIp
CiAgICAgICAgICAgICM6c2NoZW1lICdodHRwICM6aG9zdCAiZm9vIiAjOnBhdGggIiIpKQpAQCAt
MTg0LDYgKzIxNSwxOCBAQAogICAgIChlcXVhbD8gImZ0cDovL2Zvb0BiYXI6MjIvYmF6IgogICAg
ICAgICAgICAgKHVyaS0+c3RyaW5nIChzdHJpbmctPnVyaSAiZnRwOi8vZm9vQGJhcjoyMi9iYXoi
KSkpKQogICAKKyAgKHBhc3MtaWYgImh0dHA6Ly8xOTIuMC4yLjEiCisgICAgKGVxdWFsPyAiaHR0
cDovLzE5Mi4wLjIuMSIKKyAgICAgICAgICAgICh1cmktPnN0cmluZyAoc3RyaW5nLT51cmkgImh0
dHA6Ly8xOTIuMC4yLjEiKSkpKQorCisgIChwYXNzLWlmICJodHRwOi8vWzIwMDE6ZGI4OjoxXSIK
KyAgICAoZXF1YWw/ICJodHRwOi8vWzIwMDE6ZGI4OjoxXSIKKyAgICAgICAgICAgICh1cmktPnN0
cmluZyAoc3RyaW5nLT51cmkgImh0dHA6Ly9bMjAwMTpkYjg6OjFdIikpKSkKKworICAocGFzcy1p
ZiAiaHR0cDovL1syMDAxOmRiODo6MV06ODAiCisgICAgKGVxdWFsPyAiaHR0cDovL1syMDAxOmRi
ODo6MV06ODAiCisgICAgICAgICAgICh1cmktPnN0cmluZyAoc3RyaW5nLT51cmkgImh0dHA6Ly9b
MjAwMTpkYjg6OjFdOjgwIikpKSkKKwogICAocGFzcy1pZiAiaHR0cDovL2ZvbzoiCiAgICAgKGVx
dWFsPyAiaHR0cDovL2ZvbyIKICAgICAgICAgICAgICh1cmktPnN0cmluZyAoc3RyaW5nLT51cmkg
Imh0dHA6Ly9mb286IikpKSkKQEAgLTE5Myw3ICsyMzYsMTEgQEAKICAgICAgICAgICAgICh1cmkt
PnN0cmluZyAoc3RyaW5nLT51cmkgImh0dHA6Ly9mb286LyIpKSkpKQogCiAod2l0aC10ZXN0LXBy
ZWZpeCAiZGVjb2RlIgotICAocGFzcy1pZiAoZXF1YWw/ICJmb28gYmFyIiAodXJpLWRlY29kZSAi
Zm9vJTIwYmFyIikpKSkKKyAgKHBhc3MtaWYgImZvbyUyMGJhciIKKyAgICAoZXF1YWw/ICJmb28g
YmFyIiAodXJpLWRlY29kZSAiZm9vJTIwYmFyIikpKQorCisgIChwYXNzLWlmICJmb28rYmFyIgor
ICAgIChlcXVhbD8gImZvbyBiYXIiICh1cmktZGVjb2RlICJmb28rYmFyIikpKSkKIAogKHdpdGgt
dGVzdC1wcmVmaXggImVuY29kZSIKICAgKHBhc3MtaWYgKGVxdWFsPyAiZm9vJTIwYmFyIiAodXJp
LWVuY29kZSAiZm9vIGJhciIpKSkpCi0tIAoxLjcuNS40Cgo=
--e89a8f234aad339a7204b54c81b8--




From MAILER-DAEMON Fri Dec 30 05:57:03 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rga91-0000rF-O6
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 05:57:03 -0500
Received: from eggs.gnu.org ([140.186.70.92]:43989)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rga8y-0000oC-Je
	for guile-devel@gnu.org; Fri, 30 Dec 2011 05:57:01 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rga8x-0004Hl-7a
	for guile-devel@gnu.org; Fri, 30 Dec 2011 05:57:00 -0500
Received: from mail-vw0-f41.google.com ([209.85.212.41]:40616)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rga8x-0004Hg-3A
	for guile-devel@gnu.org; Fri, 30 Dec 2011 05:56:59 -0500
Received: by vbbfn1 with SMTP id fn1so12863710vbb.0
	for <guile-devel@gnu.org>; Fri, 30 Dec 2011 02:56:58 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=oO+PaT6snnd9z9pc9HXhNFHT9NsB5IrcZAwAzB7yHFQ=;
	b=R+WWuaWg9b20rDNgS9RiySJ+yJgsfJ1RkgpOM8gCjvwGCQvgd0c/GAD8pFpwyriVxB
	hpuukuaGsOtHGl5JMp7EwWqL6unojjmTfzK6mp+JZN0+hUq1WCH+Q+sjJKiMoaqNltNV
	usD5gTYX2wjocxyTvEUph9nekmaSj9iVp6sOc=
MIME-Version: 1.0
Received: by 10.52.172.196 with SMTP id be4mr18491788vdc.80.1325242617937;
	Fri, 30 Dec 2011 02:56:57 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Fri, 30 Dec 2011 02:56:57 -0800 (PST)
In-Reply-To: <4EFD8F08.7070303@gentoo.org>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<4EFD8F08.7070303@gentoo.org>
Date: Fri, 30 Dec 2011 18:56:57 +0800
Message-ID: <CAPjoZoft2sC3J2bkekACGymBa4Bux-SARHO9VZ6FN0OsroY3aQ@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Nala Ginrut <nalaginrut@gmail.com>
To: Marijn <hkBst@gentoo.org>
Content-Type: multipart/alternative; boundary=bcaec51ba3f37bc08b04b54d17d2
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.212.41
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 10:57:02 -0000

--bcaec51ba3f37bc08b04b54d17d2
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Hmm, interesting!
I must confess I'm not familiar with Racket, but I think the aim of Guile
contains practicality.
So I think regex-lib of Guile does this at least.
Anyway, I believe an implementation should do its best to provide any
useful mechanism for the user. Or it won't be popular anymore.
When I talk about "useful", I mean "it brings the user convenient", not
"the developer think it's useful".
Just my mumble, no any offense.
Thank you for telling us this issue. ;-)

On Fri, Dec 30, 2011 at 6:14 PM, Marijn <hkBst@gentoo.org> wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> On 29-12-11 10:32, Nala Ginrut wrote:
> > hi guilers! It seems like there's no "regexp-split" procedure in
> > Guile. What we have is "string-split" which accepted Char only. So
> > I wrote one for myself.
> >
> > ------python code-----
> >>>> import re re.split("([^0-9])", "123+456*/")
> > [=E2=80=99123=E2=80=99, =E2=80=99+=E2=80=99, =E2=80=99456=E2=80=99, =E2=
=80=99*=E2=80=99, =E2=80=99=E2=80=99, =E2=80=99/=E2=80=99, =E2=80=99=E2=80=
=99] --------code end-------
> >
> > The Guile version:
> >
> > ----------guile code------- (regexp-split "([^0-9])"  "123+456*/")
> > =3D=3D>("123" "+" "456" "*" "" "/" "") ----------code end--------
> >
> > Anyone interested in it?
>
> Hi there,
>
> I think we're all happy that Guile is getting this support, however I
> couldn't help but notice that the above results look a bit funny and
> indeed are incompatible with racket's implementation:
>
> > (regexp-split "([^0-9])" "123+456*/")
> '("123" "456" "" "")
>
> Apparently because their version doesn't support capturing groups in
> this function. I've raised the issue with them as well, but there are
> some doubts that it is useful/sane to support this. Perhaps other
> schemes' regexp libraries should be compared as well. Their tests
> would certainly be useful and may point out other incompatibilities
> that no-one is aware of (as well as improve your code(!)).
>
> Marijn
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v2.0.18 (GNU/Linux)
> Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
>
> iEYEARECAAYFAk79jwgACgkQp/VmCx0OL2zCrgCgrCtBGvKaejnfceWj8RaBz+lm
> lfMAoIrR0qr8IFKhFG4KGBevf1LQfoZv
> =3D2x7Y
> -----END PGP SIGNATURE-----
>

--bcaec51ba3f37bc08b04b54d17d2
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Hmm, interesting!<div>I must confess I&#39;m not familiar with Racket, but =
I think the aim of Guile contains=C2=A0practicality.</div><div>So I think r=
egex-lib of Guile does this at least.</div><div>Anyway, I believe an implem=
entation should do its best to provide any useful mechanism for the user. O=
r it won&#39;t be popular anymore.</div>
<div>When I talk about &quot;useful&quot;, I mean &quot;it brings the user =
convenient&quot;, not &quot;the developer think it&#39;s useful&quot;.</div=
><div>Just my mumble, no any offense.<br>Thank you for telling us this issu=
e. ;-)<br>
<br><div class=3D"gmail_quote">On Fri, Dec 30, 2011 at 6:14 PM, Marijn <spa=
n dir=3D"ltr">&lt;<a href=3D"mailto:hkBst@gentoo.org">hkBst@gentoo.org</a>&=
gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 =
0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
-----BEGIN PGP SIGNED MESSAGE-----<br>
Hash: SHA1<br>
<div><div class=3D"h5"><br>
On 29-12-11 10:32, Nala Ginrut wrote:<br>
&gt; hi guilers! It seems like there&#39;s no &quot;regexp-split&quot; proc=
edure in<br>
&gt; Guile. What we have is &quot;string-split&quot; which accepted Char on=
ly. So<br>
&gt; I wrote one for myself.<br>
&gt;<br>
&gt; ------python code-----<br>
&gt;&gt;&gt;&gt; import re re.split(&quot;([^0-9])&quot;, &quot;123+456*/&q=
uot;)<br>
&gt; [=E2=80=99123=E2=80=99, =E2=80=99+=E2=80=99, =E2=80=99456=E2=80=99, =
=E2=80=99*=E2=80=99, =E2=80=99=E2=80=99, =E2=80=99/=E2=80=99, =E2=80=99=E2=
=80=99] --------code end-------<br>
&gt;<br>
&gt; The Guile version:<br>
&gt;<br>
&gt; ----------guile code------- (regexp-split &quot;([^0-9])&quot; =C2=A0&=
quot;123+456*/&quot;)<br>
&gt; =3D=3D&gt;(&quot;123&quot; &quot;+&quot; &quot;456&quot; &quot;*&quot;=
 &quot;&quot; &quot;/&quot; &quot;&quot;) ----------code end--------<br>
&gt;<br>
&gt; Anyone interested in it?<br>
<br>
</div></div>Hi there,<br>
<br>
I think we&#39;re all happy that Guile is getting this support, however I<b=
r>
couldn&#39;t help but notice that the above results look a bit funny and<br=
>
indeed are incompatible with racket&#39;s implementation:<br>
<div class=3D"im"><br>
&gt; (regexp-split &quot;([^0-9])&quot; &quot;123+456*/&quot;)<br>
</div>&#39;(&quot;123&quot; &quot;456&quot; &quot;&quot; &quot;&quot;)<br>
<br>
Apparently because their version doesn&#39;t support capturing groups in<br=
>
this function. I&#39;ve raised the issue with them as well, but there are<b=
r>
some doubts that it is useful/sane to support this. Perhaps other<br>
schemes&#39; regexp libraries should be compared as well. Their tests<br>
would certainly be useful and may point out other incompatibilities<br>
that no-one is aware of (as well as improve your code(!)).<br>
<br>
Marijn<br>
-----BEGIN PGP SIGNATURE-----<br>
Version: GnuPG v2.0.18 (GNU/Linux)<br>
Comment: Using GnuPG with Mozilla - <a href=3D"http://enigmail.mozdev.org/"=
 target=3D"_blank">http://enigmail.mozdev.org/</a><br>
<br>
iEYEARECAAYFAk79jwgACgkQp/VmCx0OL2zCrgCgrCtBGvKaejnfceWj8RaBz+lm<br>
lfMAoIrR0qr8IFKhFG4KGBevf1LQfoZv<br>
=3D2x7Y<br>
-----END PGP SIGNATURE-----<br>
</blockquote></div><br></div>

--bcaec51ba3f37bc08b04b54d17d2--


From MAILER-DAEMON Fri Dec 30 06:40:16 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rgaoq-00089r-KW
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 06:40:16 -0500
Received: from eggs.gnu.org ([140.186.70.92]:48843)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rgaom-00086v-Mw
	for guile-devel@gnu.org; Fri, 30 Dec 2011 06:40:13 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rgaol-0002hx-Ex
	for guile-devel@gnu.org; Fri, 30 Dec 2011 06:40:12 -0500
Received: from mail-vw0-f41.google.com ([209.85.212.41]:64168)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rgaol-0002hr-AI
	for guile-devel@gnu.org; Fri, 30 Dec 2011 06:40:11 -0500
Received: by vbbfn1 with SMTP id fn1so12886392vbb.0
	for <guile-devel@gnu.org>; Fri, 30 Dec 2011 03:40:10 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=dY8la7C20Fo/aXoMQUIHk0MyfrnWL4y7MIS6utEe1Hw=;
	b=GxQ5czc8CRqnxYzMUHuqLp6X53pQQrC1m3tvhN9BvYgvXDclAA+b81Pz3bqjdHdSzr
	iCX0XXLt661iekZByk7Sk8IMRSYGx48iXmxcr6gPUPbsqBGUT7dqtRkjcY3qvMuloLw1
	QJkHj7QLO6UtMRspqMxWsteqzZqSiBoTvcygc=
MIME-Version: 1.0
Received: by 10.52.19.206 with SMTP id h14mr8601521vde.131.1325245210774; Fri,
	30 Dec 2011 03:40:10 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Fri, 30 Dec 2011 03:40:10 -0800 (PST)
In-Reply-To: <CAN3veRfRK7YN9YKrkJyg52T763f1fP3F6n0dTZ7+U9BX5O8HHw@mail.gmail.com>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<CAPjoZofnZUKwxR2pVuGEaMPP1Gdht_yHA52nUcX57RsuC0RTUw@mail.gmail.com>
	<CAPjoZocvsHVD=sXJ3zoRpVHQnGS1sksLhYFbr2iqeaUi3q09VA@mail.gmail.com>
	<CAPjoZoc6DtTkWX01CStQev7BFxC3CNHdjeCKbqaMRSDeagmmew@mail.gmail.com>
	<CAN3veRfLDYBPeyPd+Ljqy5F3fpdWGOmc0ZtUtsZB=YKytey-VA@mail.gmail.com>
	<CAPjoZocWvMqnoNmhtLbYREKR=QRPtr7zr6p+FXLh2X+hjQcPoA@mail.gmail.com>
	<CAN3veRdFQyOthFTSLE7v9x3_A4HTPX99DSmDx26dBkeyy=MTDQ@mail.gmail.com>
	<CAN3veRfRK7YN9YKrkJyg52T763f1fP3F6n0dTZ7+U9BX5O8HHw@mail.gmail.com>
Date: Fri, 30 Dec 2011 19:40:10 +0800
Message-ID: <CAPjoZodsG-zF00gZVL2OOApwJu+Roz-u2MPMJibRkpiXpDbFRw@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Nala Ginrut <nalaginrut@gmail.com>
To: Daniel Hartwig <mandyke@gmail.com>
Content-Type: multipart/mixed; boundary=20cf307d06ce074adf04b54db2fc
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.212.41
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 11:40:13 -0000

--20cf307d06ce074adf04b54db2fc
Content-Type: multipart/alternative; boundary=20cf307d06ce074adc04b54db2fa

--20cf307d06ce074adc04b54db2fa
Content-Type: text/plain; charset=UTF-8

Great! It's better now.
Here's the brand new patch~

On Fri, Dec 30, 2011 at 5:42 PM, Daniel Hartwig <mandyke@gmail.com> wrote:

> On 30 December 2011 16:46, Nala Ginrut <nalaginrut@gmail.com> wrote:
> > hi Daniel! Very glad to see your reply.
> > 1. I also think the order: (regexp str) is strange. But it's according to
> > python version.
> > And I think the 'string-match' also put regexp before str. Anyway,
> that's an
> > easy mend.
>
> `regexp string' is also the same order as `list-matches' and
> `fold-matches'.  Probably best to keep it that way if this is in the
> regex module.
>
>
> >> I would like to see your version support the Python semantics [1]:
> >>
> >> > If capturing parentheses are used in pattern, then the text of
> >> > all groups in the pattern are also returned as part of the resulting
> >> > list.
> >> [...]
> >> > >>> re.split('\W+', 'Words, words, words.')
> >> > ['Words', 'words', 'words', '']
> >> > >>> re.split('(\W+)', 'Words, words, words.')
> >> > ['Words', ', ', 'words', ', ', 'words', '.', '']
> >>
> >> >>> re.split('((,)?\W+?)', 'Words, words, words.')
> >> ['Words', ', ', ',', 'words', ', ', ',', 'words', '.', None, '']
>
> FYI this can be achieved by changing the inner part to:
>
>    (let* ...
>           (s (substring string start end))
>           (groups (map (lambda (n) (match:substring m n))
>                        (iota (1- (match:count m)) 1))))
>      (list `(,@ll ,s ,@groups) (match:end m) tail)))
>
> Note: using srfi-1 iota
>
>

--20cf307d06ce074adc04b54db2fa
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Great! It&#39;s better now.<div>Here&#39;s the brand new patch~<br><br><div=
 class=3D"gmail_quote">On Fri, Dec 30, 2011 at 5:42 PM, Daniel Hartwig <spa=
n dir=3D"ltr">&lt;<a href=3D"mailto:mandyke@gmail.com">mandyke@gmail.com</a=
>&gt;</span> wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex"><div class=3D"HOEnZb"><div class=3D"h5">On 3=
0 December 2011 16:46, Nala Ginrut &lt;<a href=3D"mailto:nalaginrut@gmail.c=
om">nalaginrut@gmail.com</a>&gt; wrote:<br>

&gt; hi Daniel! Very glad to see your reply.<br>
&gt; 1. I also think the order: (regexp str) is strange. But it&#39;s accor=
ding to<br>
&gt; python version.<br>
&gt; And I think the &#39;string-match&#39; also put regexp before str. Any=
way, that&#39;s an<br>
&gt; easy mend.<br>
<br>
`regexp string&#39; is also the same order as `list-matches&#39; and<br>
`fold-matches&#39;. =C2=A0Probably best to keep it that way if this is in t=
he<br>
regex module.<br>
<br>
<br>
&gt;&gt; I would like to see your version support the Python semantics [1]:=
<br>
&gt;&gt;<br>
&gt;&gt; &gt; If capturing parentheses are used in pattern, then the text o=
f<br>
&gt;&gt; &gt; all groups in the pattern are also returned as part of the re=
sulting<br>
&gt;&gt; &gt; list.<br>
&gt;&gt; [...]<br>
&gt;&gt; &gt; &gt;&gt;&gt; re.split(&#39;\W+&#39;, &#39;Words, words, words=
.&#39;)<br>
&gt;&gt; &gt; [&#39;Words&#39;, &#39;words&#39;, &#39;words&#39;, &#39;&#39=
;]<br>
&gt;&gt; &gt; &gt;&gt;&gt; re.split(&#39;(\W+)&#39;, &#39;Words, words, wor=
ds.&#39;)<br>
&gt;&gt; &gt; [&#39;Words&#39;, &#39;, &#39;, &#39;words&#39;, &#39;, &#39;=
, &#39;words&#39;, &#39;.&#39;, &#39;&#39;]<br>
&gt;&gt;<br>
&gt;&gt; &gt;&gt;&gt; re.split(&#39;((,)?\W+?)&#39;, &#39;Words, words, wor=
ds.&#39;)<br>
&gt;&gt; [&#39;Words&#39;, &#39;, &#39;, &#39;,&#39;, &#39;words&#39;, &#39=
;, &#39;, &#39;,&#39;, &#39;words&#39;, &#39;.&#39;, None, &#39;&#39;]<br>
<br>
FYI this can be achieved by changing the inner part to:<br>
<br>
=C2=A0 =C2=A0(let* ...<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 (s (substring string start end))<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 (groups (map (lambda (n) (match:substrin=
g m n))<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0(iota (1- (match:count m)) 1))))<br>
=C2=A0 =C2=A0 =C2=A0(list `(,@ll ,s ,@groups) (match:end m) tail)))<br>
<br>
Note: using srfi-1 iota<br>
<br>
</div></div></blockquote></div><br></div>

--20cf307d06ce074adc04b54db2fa--
--20cf307d06ce074adf04b54db2fc
Content-Type: text/x-patch; charset=US-ASCII; name="0001-ADD-regexp-split.patch"
Content-Disposition: attachment; filename="0001-ADD-regexp-split.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gwt4ryde0

RnJvbSBiNzM4YThiODkwZjQxYmY2ODRjMDU1NmNhNzlhZjJkN2MxNGI2ZGY1IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBOYWxhR2lucnV0IDxOYWxhR2lucnV0QGdtYWlsLmNvbT4KRGF0
ZTogRnJpLCAzMCBEZWMgMjAxMSAxOTozODozOCArMDgwMApTdWJqZWN0OiBbUEFUQ0hdIEFERCBy
ZWdleHAtc3BsaXQKCi0tLQogbW9kdWxlL2ljZS05L3JlZ2V4LnNjbSB8ICAgMTggKysrKysrKysr
KysrKysrKystCiAxIGZpbGVzIGNoYW5nZWQsIDE3IGluc2VydGlvbnMoKyksIDEgZGVsZXRpb25z
KC0pCgpkaWZmIC0tZ2l0IGEvbW9kdWxlL2ljZS05L3JlZ2V4LnNjbSBiL21vZHVsZS9pY2UtOS9y
ZWdleC5zY20KaW5kZXggZjdiOTRiNy4uYjVmNjE0OSAxMDA2NDQKLS0tIGEvbW9kdWxlL2ljZS05
L3JlZ2V4LnNjbQorKysgYi9tb2R1bGUvaWNlLTkvcmVnZXguc2NtCkBAIC00MSw3ICs0MSw3IEBA
CiAgICM6ZXhwb3J0IChtYXRjaDpjb3VudCBtYXRjaDpzdHJpbmcgbWF0Y2g6cHJlZml4IG1hdGNo
OnN1ZmZpeAogICAgICAgICAgICByZWdleHAtbWF0Y2g/IHJlZ2V4cC1xdW90ZSBtYXRjaDpzdGFy
dCBtYXRjaDplbmQgbWF0Y2g6c3Vic3RyaW5nCiAgICAgICAgICAgIHN0cmluZy1tYXRjaCByZWdl
eHAtc3Vic3RpdHV0ZSBmb2xkLW1hdGNoZXMgbGlzdC1tYXRjaGVzCi0gICAgICAgICAgIHJlZ2V4
cC1zdWJzdGl0dXRlL2dsb2JhbCkpCisgICAgICAgICAgIHJlZ2V4cC1zdWJzdGl0dXRlL2dsb2Jh
bCByZWdleHAtc3BsaXQpKQogCiA7OyBSZWZlcmVuY2VzOgogOzsKQEAgLTIyNiwzICsyMjYsMTkg
QEAKICAgICAgICAgICAgICAgICAgICAgICAgIChiZWdpbgogICAgICAgICAgICAgICAgICAgICAg
ICAgICAoZG8taXRlbSAoY2FyIGl0ZW1zKSkgOyBUaGlzIGlzIG5vdC4KICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKG5leHQtaXRlbSAoY2RyIGl0ZW1zKSkpKSkpKSkpKSkKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgCisoZGVmaW5lKiAocmVnZXhwLXNwbGl0IHJlZ2V4IHN0ciAjOm9wdGlv
bmFsIChmbGFncyAwKSkKKyAgKGxldCAoKHJldCAoZm9sZC1tYXRjaGVzIAorCSAgICAgIHJlZ2V4
IHN0ciAobGlzdCAnKCkgMCAnKCIiKSkKKwkgICAgICAobGFtYmRhIChtIHByZXYpCisJCShsZXQq
ICgobGwgKGNhciBwcmV2KSkKKwkJICAgICAgIChzdGFydCAoY2FkciBwcmV2KSkKKwkJICAgICAg
ICh0YWlsIChtYXRjaDpzdWZmaXggbSkpCisJCSAgICAgICAoZW5kIChtYXRjaDpzdGFydCBtKSkK
KwkJICAgICAgIChzIChzdWJzdHJpbmcvc2hhcmVkIHN0ciBzdGFydCBlbmQpKQorCQkgICAgICAg
KGdyb3VwcyAobWFwIChsYW1iZGEgKG4pIChtYXRjaDpzdWJzdHJpbmcgbSBuKSkKKwkJCQkgICAg
KGlvdGEgKDEtIChtYXRjaDpjb3VudCBtKSkpKSkpCisJCSAgKGxpc3QgYCgsQGxsICxzICxAZ3Jv
dXBzKSAobWF0Y2g6ZW5kIG0pIHRhaWwpKSkKKwkgICAgICBmbGFncykpKQorICAgIGAoLEAoY2Fy
IHJldCkgLChjYWRkciByZXQpKSkpCisKLS0gCjEuNy4wLjQKCg==
--20cf307d06ce074adf04b54db2fc--


From MAILER-DAEMON Fri Dec 30 06:43:00 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgarU-0008Nd-5b
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 06:43:00 -0500
Received: from eggs.gnu.org ([140.186.70.92]:49309)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <hkBst@gentoo.org>) id 1RgarR-0008NR-Km
	for guile-devel@gnu.org; Fri, 30 Dec 2011 06:42:58 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <hkBst@gentoo.org>) id 1RgarQ-0002v3-G9
	for guile-devel@gnu.org; Fri, 30 Dec 2011 06:42:57 -0500
Received: from smtp.gentoo.org ([140.211.166.183]:37686)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <hkBst@gentoo.org>) id 1RgarQ-0002uu-9J
	for guile-devel@gnu.org; Fri, 30 Dec 2011 06:42:56 -0500
Received: from [10.128.5.241] (unknown [79.170.210.172])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested) (Authenticated sender: hkbst)
	by smtp.gentoo.org (Postfix) with ESMTPSA id C97F21B401B;
	Fri, 30 Dec 2011 11:42:54 +0000 (UTC)
Message-ID: <4EFDA50F.1070704@gentoo.org>
Date: Fri, 30 Dec 2011 12:48:31 +0100
From: Marijn <hkBst@gentoo.org>
User-Agent: Mozilla/5.0 (X11; Linux x86_64;
	rv:8.0) Gecko/20111117 Thunderbird/8.0
MIME-Version: 1.0
To: Nala Ginrut <nalaginrut@gmail.com>
Subject: Re: [PATCH] add regexp-split
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<4EFD8F08.7070303@gentoo.org>
	<CAPjoZoft2sC3J2bkekACGymBa4Bux-SARHO9VZ6FN0OsroY3aQ@mail.gmail.com>
In-Reply-To: <CAPjoZoft2sC3J2bkekACGymBa4Bux-SARHO9VZ6FN0OsroY3aQ@mail.gmail.com>
X-Enigmail-Version: 1.3.3
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 140.211.166.183
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 11:42:58 -0000

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 30-12-11 11:56, Nala Ginrut wrote:
> Hmm, interesting! I must confess I'm not familiar with Racket, but
> I think the aim of Guile contains practicality.

Not sure what you're trying to imply here or to which of my points
you're responding.

> So I think regex-lib of Guile does this at least. Anyway, I believe
> an implementation should do its best to provide any useful
> mechanism for the user. Or it won't be popular anymore. When I talk
> about "useful", I mean "it brings the user convenient", not "the
> developer think it's useful".

Idem ditto.

> Just my mumble, no any offense. Thank you for telling us this
> issue. ;-)

Marijn
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.18 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk79pQ8ACgkQp/VmCx0OL2wMewCgml8guLqLK2fx7NWHa1JQ7pQ9
wrIAoLkHJnNF8nkWWMM4EKkyBEyffZEQ
=1IRy
-----END PGP SIGNATURE-----


From MAILER-DAEMON Fri Dec 30 06:47:22 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rgavi-0001aD-53
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 06:47:22 -0500
Received: from eggs.gnu.org ([140.186.70.92]:50728)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rgavf-0001a6-Tt
	for guile-devel@gnu.org; Fri, 30 Dec 2011 06:47:20 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rgave-0003qR-G2
	for guile-devel@gnu.org; Fri, 30 Dec 2011 06:47:19 -0500
Received: from mail-vx0-f169.google.com ([209.85.220.169]:50351)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rgave-0003qN-BP
	for guile-devel@gnu.org; Fri, 30 Dec 2011 06:47:18 -0500
Received: by vcge1 with SMTP id e1so11852177vcg.0
	for <guile-devel@gnu.org>; Fri, 30 Dec 2011 03:47:17 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=KQjB4pxj9uiiXpaadsFjMC9zFvf4erPoW79jrfCPAmI=;
	b=gANRAD3F2HGX7h/Xa7Qwi9cRznYhWNlFgTHUMEONnBnn1TWGdKAdOg1kbAQCUGuHHQ
	LgWwYWSkVSecNRBhz9iEMojlmR5HsBoTxFn40C8rqdi/Sv9Dki6YMtnWE9snGzMDT6C9
	OCnZRTsGokGHowk+SKVJB2Je3Y4LAsq6GSaZ0=
MIME-Version: 1.0
Received: by 10.220.147.134 with SMTP id l6mr8292106vcv.49.1325245637834; Fri,
	30 Dec 2011 03:47:17 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Fri, 30 Dec 2011 03:47:17 -0800 (PST)
In-Reply-To: <CAPjoZodsG-zF00gZVL2OOApwJu+Roz-u2MPMJibRkpiXpDbFRw@mail.gmail.com>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<CAPjoZofnZUKwxR2pVuGEaMPP1Gdht_yHA52nUcX57RsuC0RTUw@mail.gmail.com>
	<CAPjoZocvsHVD=sXJ3zoRpVHQnGS1sksLhYFbr2iqeaUi3q09VA@mail.gmail.com>
	<CAPjoZoc6DtTkWX01CStQev7BFxC3CNHdjeCKbqaMRSDeagmmew@mail.gmail.com>
	<CAN3veRfLDYBPeyPd+Ljqy5F3fpdWGOmc0ZtUtsZB=YKytey-VA@mail.gmail.com>
	<CAPjoZocWvMqnoNmhtLbYREKR=QRPtr7zr6p+FXLh2X+hjQcPoA@mail.gmail.com>
	<CAN3veRdFQyOthFTSLE7v9x3_A4HTPX99DSmDx26dBkeyy=MTDQ@mail.gmail.com>
	<CAN3veRfRK7YN9YKrkJyg52T763f1fP3F6n0dTZ7+U9BX5O8HHw@mail.gmail.com>
	<CAPjoZodsG-zF00gZVL2OOApwJu+Roz-u2MPMJibRkpiXpDbFRw@mail.gmail.com>
Date: Fri, 30 Dec 2011 19:47:17 +0800
Message-ID: <CAPjoZofzCdFbjwfEnhu_Q0qSYnMivmoPwk3xHJ-xPHBSvKo55Q@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Nala Ginrut <nalaginrut@gmail.com>
To: Daniel Hartwig <mandyke@gmail.com>
Content-Type: multipart/mixed; boundary=bcaec54ee65e7bb97904b54dcb58
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.220.169
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 11:47:21 -0000

--bcaec54ee65e7bb97904b54dcb58
Content-Type: multipart/alternative; boundary=bcaec54ee65e7bb97604b54dcb56

--bcaec54ee65e7bb97604b54dcb56
Content-Type: text/plain; charset=UTF-8

Forget to load (srfi-1 iota) ,again...

On Fri, Dec 30, 2011 at 7:40 PM, Nala Ginrut <nalaginrut@gmail.com> wrote:

> Great! It's better now.
> Here's the brand new patch~
>
>
> On Fri, Dec 30, 2011 at 5:42 PM, Daniel Hartwig <mandyke@gmail.com> wrote:
>
>> On 30 December 2011 16:46, Nala Ginrut <nalaginrut@gmail.com> wrote:
>> > hi Daniel! Very glad to see your reply.
>> > 1. I also think the order: (regexp str) is strange. But it's according
>> to
>> > python version.
>> > And I think the 'string-match' also put regexp before str. Anyway,
>> that's an
>> > easy mend.
>>
>> `regexp string' is also the same order as `list-matches' and
>> `fold-matches'.  Probably best to keep it that way if this is in the
>> regex module.
>>
>>
>> >> I would like to see your version support the Python semantics [1]:
>> >>
>> >> > If capturing parentheses are used in pattern, then the text of
>> >> > all groups in the pattern are also returned as part of the resulting
>> >> > list.
>> >> [...]
>> >> > >>> re.split('\W+', 'Words, words, words.')
>> >> > ['Words', 'words', 'words', '']
>> >> > >>> re.split('(\W+)', 'Words, words, words.')
>> >> > ['Words', ', ', 'words', ', ', 'words', '.', '']
>> >>
>> >> >>> re.split('((,)?\W+?)', 'Words, words, words.')
>> >> ['Words', ', ', ',', 'words', ', ', ',', 'words', '.', None, '']
>>
>> FYI this can be achieved by changing the inner part to:
>>
>>    (let* ...
>>           (s (substring string start end))
>>           (groups (map (lambda (n) (match:substring m n))
>>                        (iota (1- (match:count m)) 1))))
>>      (list `(,@ll ,s ,@groups) (match:end m) tail)))
>>
>> Note: using srfi-1 iota
>>
>>
>

--bcaec54ee65e7bb97604b54dcb56
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Forget to load (srfi-1 iota) ,again...<br><br><div class=3D"gmail_quote">On=
 Fri, Dec 30, 2011 at 7:40 PM, Nala Ginrut <span dir=3D"ltr">&lt;<a href=3D=
"mailto:nalaginrut@gmail.com">nalaginrut@gmail.com</a>&gt;</span> wrote:<br=
><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1=
px #ccc solid;padding-left:1ex">
Great! It&#39;s better now.<div>Here&#39;s the brand new patch~<div><div cl=
ass=3D"h5"><br><br><div class=3D"gmail_quote">On Fri, Dec 30, 2011 at 5:42 =
PM, Daniel Hartwig <span dir=3D"ltr">&lt;<a href=3D"mailto:mandyke@gmail.co=
m" target=3D"_blank">mandyke@gmail.com</a>&gt;</span> wrote:<br>

<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex"><div><div>On 30 December 2011 16:46, Nala Gi=
nrut &lt;<a href=3D"mailto:nalaginrut@gmail.com" target=3D"_blank">nalaginr=
ut@gmail.com</a>&gt; wrote:<br>


&gt; hi Daniel! Very glad to see your reply.<br>
&gt; 1. I also think the order: (regexp str) is strange. But it&#39;s accor=
ding to<br>
&gt; python version.<br>
&gt; And I think the &#39;string-match&#39; also put regexp before str. Any=
way, that&#39;s an<br>
&gt; easy mend.<br>
<br>
`regexp string&#39; is also the same order as `list-matches&#39; and<br>
`fold-matches&#39;. =C2=A0Probably best to keep it that way if this is in t=
he<br>
regex module.<br>
<br>
<br>
&gt;&gt; I would like to see your version support the Python semantics [1]:=
<br>
&gt;&gt;<br>
&gt;&gt; &gt; If capturing parentheses are used in pattern, then the text o=
f<br>
&gt;&gt; &gt; all groups in the pattern are also returned as part of the re=
sulting<br>
&gt;&gt; &gt; list.<br>
&gt;&gt; [...]<br>
&gt;&gt; &gt; &gt;&gt;&gt; re.split(&#39;\W+&#39;, &#39;Words, words, words=
.&#39;)<br>
&gt;&gt; &gt; [&#39;Words&#39;, &#39;words&#39;, &#39;words&#39;, &#39;&#39=
;]<br>
&gt;&gt; &gt; &gt;&gt;&gt; re.split(&#39;(\W+)&#39;, &#39;Words, words, wor=
ds.&#39;)<br>
&gt;&gt; &gt; [&#39;Words&#39;, &#39;, &#39;, &#39;words&#39;, &#39;, &#39;=
, &#39;words&#39;, &#39;.&#39;, &#39;&#39;]<br>
&gt;&gt;<br>
&gt;&gt; &gt;&gt;&gt; re.split(&#39;((,)?\W+?)&#39;, &#39;Words, words, wor=
ds.&#39;)<br>
&gt;&gt; [&#39;Words&#39;, &#39;, &#39;, &#39;,&#39;, &#39;words&#39;, &#39=
;, &#39;, &#39;,&#39;, &#39;words&#39;, &#39;.&#39;, None, &#39;&#39;]<br>
<br>
FYI this can be achieved by changing the inner part to:<br>
<br>
=C2=A0 =C2=A0(let* ...<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 (s (substring string start end))<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 (groups (map (lambda (n) (match:substrin=
g m n))<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0(iota (1- (match:count m)) 1))))<br>
=C2=A0 =C2=A0 =C2=A0(list `(,@ll ,s ,@groups) (match:end m) tail)))<br>
<br>
Note: using srfi-1 iota<br>
<br>
</div></div></blockquote></div><br></div></div></div>
</blockquote></div><br>

--bcaec54ee65e7bb97604b54dcb56--
--bcaec54ee65e7bb97904b54dcb58
Content-Type: text/x-patch; charset=US-ASCII; name="0001-ADD-regexp-split.patch"
Content-Disposition: attachment; filename="0001-ADD-regexp-split.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gwt5147w1

RnJvbSAyN2FhODVkNTY3NjZkMTUyZWNlZDIxY2QwZDI5MTVjNzBhOTlkY2M3IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBOYWxhR2lucnV0IDxOYWxhR2lucnV0QGdtYWlsLmNvbT4KRGF0
ZTogRnJpLCAzMCBEZWMgMjAxMSAxOTo0NjowMSArMDgwMApTdWJqZWN0OiBbUEFUQ0hdIEFERCBy
ZWdleHAtc3BsaXQKCi0tLQogbW9kdWxlL2ljZS05L3JlZ2V4LnNjbSB8ICAgMTkgKysrKysrKysr
KysrKysrKysrLQogMSBmaWxlcyBjaGFuZ2VkLCAxOCBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL21vZHVsZS9pY2UtOS9yZWdleC5zY20gYi9tb2R1bGUvaWNlLTkv
cmVnZXguc2NtCmluZGV4IGY3Yjk0YjcuLmU5YjAxZWEgMTAwNjQ0Ci0tLSBhL21vZHVsZS9pY2Ut
OS9yZWdleC5zY20KKysrIGIvbW9kdWxlL2ljZS05L3JlZ2V4LnNjbQpAQCAtMzgsMTAgKzM4LDEx
IEBACiA7Ozs7IFBPU0lYIHJlZ2V4IHN1cHBvcnQgZnVuY3Rpb25zLgogCiAoZGVmaW5lLW1vZHVs
ZSAoaWNlLTkgcmVnZXgpCisgICM6YXV0b2xvYWQgKHNyZmkgc3JmaS0xKSAoaW90YSkKICAgIzpl
eHBvcnQgKG1hdGNoOmNvdW50IG1hdGNoOnN0cmluZyBtYXRjaDpwcmVmaXggbWF0Y2g6c3VmZml4
CiAgICAgICAgICAgIHJlZ2V4cC1tYXRjaD8gcmVnZXhwLXF1b3RlIG1hdGNoOnN0YXJ0IG1hdGNo
OmVuZCBtYXRjaDpzdWJzdHJpbmcKICAgICAgICAgICAgc3RyaW5nLW1hdGNoIHJlZ2V4cC1zdWJz
dGl0dXRlIGZvbGQtbWF0Y2hlcyBsaXN0LW1hdGNoZXMKLSAgICAgICAgICAgcmVnZXhwLXN1YnN0
aXR1dGUvZ2xvYmFsKSkKKyAgICAgICAgICAgcmVnZXhwLXN1YnN0aXR1dGUvZ2xvYmFsIHJlZ2V4
cC1zcGxpdCkpCiAKIDs7IFJlZmVyZW5jZXM6CiA7OwpAQCAtMjI2LDMgKzIyNywxOSBAQAogICAg
ICAgICAgICAgICAgICAgICAgICAgKGJlZ2luCiAgICAgICAgICAgICAgICAgICAgICAgICAgIChk
by1pdGVtIChjYXIgaXRlbXMpKSA7IFRoaXMgaXMgbm90LgogICAgICAgICAgICAgICAgICAgICAg
ICAgICAobmV4dC1pdGVtIChjZHIgaXRlbXMpKSkpKSkpKSkpKQorICAgICAgICAgICAgICAgICAg
ICAgICAgICAKKyhkZWZpbmUqIChyZWdleHAtc3BsaXQgcmVnZXggc3RyICM6b3B0aW9uYWwgKGZs
YWdzIDApKQorICAobGV0ICgocmV0IChmb2xkLW1hdGNoZXMgCisJICAgICAgcmVnZXggc3RyIChs
aXN0ICcoKSAwICcoIiIpKQorCSAgICAgIChsYW1iZGEgKG0gcHJldikKKwkJKGxldCogKChsbCAo
Y2FyIHByZXYpKQorCQkgICAgICAgKHN0YXJ0IChjYWRyIHByZXYpKQorCQkgICAgICAgKHRhaWwg
KG1hdGNoOnN1ZmZpeCBtKSkKKwkJICAgICAgIChlbmQgKG1hdGNoOnN0YXJ0IG0pKQorCQkgICAg
ICAgKHMgKHN1YnN0cmluZy9zaGFyZWQgc3RyIHN0YXJ0IGVuZCkpCisJCSAgICAgICAoZ3JvdXBz
IChtYXAgKGxhbWJkYSAobikgKG1hdGNoOnN1YnN0cmluZyBtIG4pKQorCQkJCSAgICAoaW90YSAo
MS0gKG1hdGNoOmNvdW50IG0pKSkpKSkKKwkJICAobGlzdCBgKCxAbGwgLHMgLEBncm91cHMpICht
YXRjaDplbmQgbSkgdGFpbCkpKQorCSAgICAgIGZsYWdzKSkpCisgICAgYCgsQChjYXIgcmV0KSAs
KGNhZGRyIHJldCkpKSkKKwotLSAKMS43LjAuNAoK
--bcaec54ee65e7bb97904b54dcb58--


From MAILER-DAEMON Fri Dec 30 06:53:01 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rgb1B-0002Xm-Ki
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 06:53:01 -0500
Received: from eggs.gnu.org ([140.186.70.92]:54826)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rgb18-0002Xg-Rk
	for guile-devel@gnu.org; Fri, 30 Dec 2011 06:52:59 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rgb17-0004hM-BF
	for guile-devel@gnu.org; Fri, 30 Dec 2011 06:52:58 -0500
Received: from mail-vx0-f169.google.com ([209.85.220.169]:42378)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rgb17-0004hH-7E
	for guile-devel@gnu.org; Fri, 30 Dec 2011 06:52:57 -0500
Received: by vcge1 with SMTP id e1so11854992vcg.0
	for <guile-devel@gnu.org>; Fri, 30 Dec 2011 03:52:56 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=WxpuIVMehyEt3jJxcYbSxj9cdHom7D0ZYX0CiwiXPAk=;
	b=dC0YBQMc7BomJIXzRTfWF82+nVb7aERvYnUOAPVod31vwGxeyfRcwESJuQOWGyankh
	/Vit7ugiemID97jnuwKBve/B2jZFLmI892SYatLk33WGxutziaQvIza+Otefi2JTRL/m
	Q7qZr2OHnX9WBcoCsRthJ9WMwWhaZUk6kXEJU=
MIME-Version: 1.0
Received: by 10.220.147.134 with SMTP id l6mr8300132vcv.49.1325245976773; Fri,
	30 Dec 2011 03:52:56 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Fri, 30 Dec 2011 03:52:56 -0800 (PST)
In-Reply-To: <4EFDA50F.1070704@gentoo.org>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<4EFD8F08.7070303@gentoo.org>
	<CAPjoZoft2sC3J2bkekACGymBa4Bux-SARHO9VZ6FN0OsroY3aQ@mail.gmail.com>
	<4EFDA50F.1070704@gentoo.org>
Date: Fri, 30 Dec 2011 19:52:56 +0800
Message-ID: <CAPjoZofz9jhirNDRMHaNAiNo9-6Fnoj70kH1LHdX5WxQ3dZw_A@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Nala Ginrut <nalaginrut@gmail.com>
To: Marijn <hkBst@gentoo.org>
Content-Type: multipart/alternative; boundary=bcaec54ee65eaf852d04b54ddff9
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.220.169
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 11:53:00 -0000

--bcaec54ee65eaf852d04b54ddff9
Content-Type: text/plain; charset=UTF-8

I just expressed "I think group capturing is useful and someone didn't
think that's true".
If this is not what your last mail mean, I think it's better to ignore it.

On Fri, Dec 30, 2011 at 7:48 PM, Marijn <hkBst@gentoo.org> wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> On 30-12-11 11:56, Nala Ginrut wrote:
> > Hmm, interesting! I must confess I'm not familiar with Racket, but
> > I think the aim of Guile contains practicality.
>
> Not sure what you're trying to imply here or to which of my points
> you're responding.
>
> > So I think regex-lib of Guile does this at least. Anyway, I believe
> > an implementation should do its best to provide any useful
> > mechanism for the user. Or it won't be popular anymore. When I talk
> > about "useful", I mean "it brings the user convenient", not "the
> > developer think it's useful".
>
> Idem ditto.
>
> > Just my mumble, no any offense. Thank you for telling us this
> > issue. ;-)
>
> Marijn
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v2.0.18 (GNU/Linux)
> Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
>
> iEYEARECAAYFAk79pQ8ACgkQp/VmCx0OL2wMewCgml8guLqLK2fx7NWHa1JQ7pQ9
> wrIAoLkHJnNF8nkWWMM4EKkyBEyffZEQ
> =1IRy
> -----END PGP SIGNATURE-----
>

--bcaec54ee65eaf852d04b54ddff9
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

I just expressed &quot;I think group capturing is useful and someone didn&#=
39;t think that&#39;s true&quot;.<div>If this is not what your last mail me=
an, I think it&#39;s better to ignore it.=C2=A0<br><br><div class=3D"gmail_=
quote">
On Fri, Dec 30, 2011 at 7:48 PM, Marijn <span dir=3D"ltr">&lt;<a href=3D"ma=
ilto:hkBst@gentoo.org">hkBst@gentoo.org</a>&gt;</span> wrote:<br><blockquot=
e class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc sol=
id;padding-left:1ex">
<div class=3D"im">-----BEGIN PGP SIGNED MESSAGE-----<br>
Hash: SHA1<br>
<br>
</div><div class=3D"im">On 30-12-11 11:56, Nala Ginrut wrote:<br>
&gt; Hmm, interesting! I must confess I&#39;m not familiar with Racket, but=
<br>
&gt; I think the aim of Guile contains practicality.<br>
<br>
</div>Not sure what you&#39;re trying to imply here or to which of my point=
s<br>
you&#39;re responding.<br>
<div class=3D"im"><br>
&gt; So I think regex-lib of Guile does this at least. Anyway, I believe<br=
>
&gt; an implementation should do its best to provide any useful<br>
&gt; mechanism for the user. Or it won&#39;t be popular anymore. When I tal=
k<br>
&gt; about &quot;useful&quot;, I mean &quot;it brings the user convenient&q=
uot;, not &quot;the<br>
&gt; developer think it&#39;s useful&quot;.<br>
<br>
</div>Idem ditto.<br>
<div class=3D"im"><br>
&gt; Just my mumble, no any offense. Thank you for telling us this<br>
&gt; issue. ;-)<br>
<br>
</div><div class=3D"im">Marijn<br>
-----BEGIN PGP SIGNATURE-----<br>
Version: GnuPG v2.0.18 (GNU/Linux)<br>
Comment: Using GnuPG with Mozilla - <a href=3D"http://enigmail.mozdev.org/"=
 target=3D"_blank">http://enigmail.mozdev.org/</a><br>
<br>
</div>iEYEARECAAYFAk79pQ8ACgkQp/VmCx0OL2wMewCgml8guLqLK2fx7NWHa1JQ7pQ9<br>
wrIAoLkHJnNF8nkWWMM4EKkyBEyffZEQ<br>
=3D1IRy<br>
-----END PGP SIGNATURE-----<br>
</blockquote></div><br></div>

--bcaec54ee65eaf852d04b54ddff9--


From MAILER-DAEMON Fri Dec 30 08:03:14 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rgc78-00045s-Gu
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 08:03:14 -0500
Received: from eggs.gnu.org ([140.186.70.92]:48485)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <neil@ossau.homelinux.net>) id 1Rgc75-00045M-Mo
	for guile-devel@gnu.org; Fri, 30 Dec 2011 08:03:12 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <neil@ossau.homelinux.net>) id 1Rgc74-0008LC-JJ
	for guile-devel@gnu.org; Fri, 30 Dec 2011 08:03:11 -0500
Received: from out1.ip01ir2.opaltelecom.net ([62.24.128.237]:58791)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <neil@ossau.homelinux.net>) id 1Rgc74-0008K6-EE
	for guile-devel@gnu.org; Fri, 30 Dec 2011 08:03:10 -0500
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: Av0EAPG1/U5OkRO5/2dsb2JhbABDrE6BBoFyAQEEATocIwULCAMhJQ8BBA0YJBOHegIGtgyMDwSfcYdF
X-IronPort-AV: E=Sophos;i="4.71,432,1320624000"; d="scan'208";a="375963216"
Received: from host-78-145-19-185.as13285.net (HELO arudy) ([78.145.19.185])
	by out1.ip01ir2.opaltelecom.net with ESMTP; 30 Dec 2011 13:03:07 +0000
Received: from neil-laptop.ossau.uklinux.net.ossau.homelinux.net
	(host-78-145-19-185.as13285.net [78.145.19.185])
	by arudy (Postfix) with ESMTPA id 25AF03801B;
	Fri, 30 Dec 2011 13:03:06 +0000 (GMT)
From: Neil Jerram <neil@ossau.homelinux.net>
To: Nala Ginrut <nalaginrut@gmail.com>
Subject: Re: [PATCH] add regexp-split
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
Date: Fri, 30 Dec 2011 13:03:05 +0000
In-Reply-To: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	(Nala Ginrut's message of "Thu, 29 Dec 2011 17:32:05 +0800")
Message-ID: <8762gyjjp2.fsf@neil-laptop.ossau.uklinux.net>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 62.24.128.237
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 13:03:13 -0000

Nala Ginrut <nalaginrut@gmail.com> writes:

> hi guilers!
> It seems like there's no "regexp-split" procedure in Guile.
> What we have is "string-split" which accepted Char only.
> So I wrote one for myself.

We've had this topic before, and it only needs a search for
"regex-split guile" to find it:
http://old.nabble.com/regex-split-for-Guile-td31093245.html.

       Neil


From MAILER-DAEMON Fri Dec 30 08:17:58 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgcLO-00065g-MF
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 08:17:58 -0500
Received: from eggs.gnu.org ([140.186.70.92]:36998)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <hkBst@gentoo.org>) id 1RgcLM-00065a-5d
	for guile-devel@gnu.org; Fri, 30 Dec 2011 08:17:56 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <hkBst@gentoo.org>) id 1RgcLK-0002jX-Uo
	for guile-devel@gnu.org; Fri, 30 Dec 2011 08:17:56 -0500
Received: from smtp.gentoo.org ([140.211.166.183]:41709)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <hkBst@gentoo.org>) id 1RgcLK-0002jR-Mi
	for guile-devel@gnu.org; Fri, 30 Dec 2011 08:17:54 -0500
Received: from [10.128.5.241] (unknown [79.170.210.172])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested) (Authenticated sender: hkbst)
	by smtp.gentoo.org (Postfix) with ESMTPSA id 846901B4004;
	Fri, 30 Dec 2011 13:17:51 +0000 (UTC)
Message-ID: <4EFDBB56.7020004@gentoo.org>
Date: Fri, 30 Dec 2011 14:23:34 +0100
From: Marijn <hkBst@gentoo.org>
User-Agent: Mozilla/5.0 (X11; Linux x86_64;
	rv:8.0) Gecko/20111117 Thunderbird/8.0
MIME-Version: 1.0
To: Nala Ginrut <nalaginrut@gmail.com>
Subject: Re: [PATCH] add regexp-split
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<4EFD8F08.7070303@gentoo.org>
	<CAPjoZoft2sC3J2bkekACGymBa4Bux-SARHO9VZ6FN0OsroY3aQ@mail.gmail.com>
	<4EFDA50F.1070704@gentoo.org>
	<CAPjoZofz9jhirNDRMHaNAiNo9-6Fnoj70kH1LHdX5WxQ3dZw_A@mail.gmail.com>
In-Reply-To: <CAPjoZofz9jhirNDRMHaNAiNo9-6Fnoj70kH1LHdX5WxQ3dZw_A@mail.gmail.com>
X-Enigmail-Version: 1.3.3
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 140.211.166.183
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 13:17:57 -0000

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 30-12-11 12:52, Nala Ginrut wrote:
> I just expressed "I think group capturing is useful and someone 
> didn't think that's true". If this is not what your last mail
> mean, I think it's better to ignore it.

Group capturing is useful, but the question is whether it is useful in
the context of regexp-split. Maybe it is, maybe it isn't. Racket seems
to be doing it differently than python, so I think that constitutes
reason to look more closely. Certainly guile should follow racket over
python, everything else being equal, but usually everything isn't
equal if only one has a look and I'm saying that we should look at
least at other schemes for inspiration.
If you're so convinced that python is doing it right here and should
be followed, then perhaps you can give some examples of how capturing
groups are useful in a function that is supposed to split strings at
regexps.

Another data point:

[14:17] <hkBst> what does chicken return for (irregex-split "([^0-9])"
 "123+456*/")  ?
[14:18] <sjamaan> ("123" "456")

Looks like chicken doesn't do capturing groups in their version, but
they don't have the empty matches either. How about that...

Surely by now you can see that it's worth discussing over the
semantics of regexp-split.

Marijn



-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.18 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk79u1YACgkQp/VmCx0OL2xpYACgpYuguKw4ju0GsX3ApqrZtjXF
ppsAn2wv0B8sNiSgtULA1TIFjiXh2Pdn
=C8E4
-----END PGP SIGNATURE-----


From MAILER-DAEMON Fri Dec 30 09:57:18 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgdtW-0004nF-Gz
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 09:57:18 -0500
Received: from eggs.gnu.org ([140.186.70.92]:38569)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgdtU-0004n5-5k
	for guile-devel@gnu.org; Fri, 30 Dec 2011 09:57:17 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgdtS-0001KI-Up
	for guile-devel@gnu.org; Fri, 30 Dec 2011 09:57:16 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:42210)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgdtS-0001KB-Qz
	for guile-devel@gnu.org; Fri, 30 Dec 2011 09:57:14 -0500
Received: by iacb35 with SMTP id b35so27696891iac.0
	for <guile-devel@gnu.org>; Fri, 30 Dec 2011 06:57:14 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type:content-transfer-encoding;
	bh=opX9ocCOFa8gLNBnfm9EQT8sd+3lLJ8VBkMWgqSm4Sc=;
	b=JqB8cQiilGIlG+Oq9svZvUZSN4MuP9QONgszdLKkiCmdutTyMlyjnDeOQmMOWwxbKy
	91OnQ+XEWRNvdE/ppoHesslujAPfVETDpEP7PzF5uUOSjAe4CmYioxXF0Q8114ZKpeMs
	tjljhbIUb5QMxPXft8dlRVvIyp6nFBkH9JK0Q=
MIME-Version: 1.0
Received: by 10.50.88.129 with SMTP id bg1mr46794634igb.10.1325257034167; Fri,
	30 Dec 2011 06:57:14 -0800 (PST)
Received: by 10.231.48.68 with HTTP; Fri, 30 Dec 2011 06:57:14 -0800 (PST)
In-Reply-To: <4EFDBB56.7020004@gentoo.org>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<4EFD8F08.7070303@gentoo.org>
	<CAPjoZoft2sC3J2bkekACGymBa4Bux-SARHO9VZ6FN0OsroY3aQ@mail.gmail.com>
	<4EFDA50F.1070704@gentoo.org>
	<CAPjoZofz9jhirNDRMHaNAiNo9-6Fnoj70kH1LHdX5WxQ3dZw_A@mail.gmail.com>
	<4EFDBB56.7020004@gentoo.org>
Date: Fri, 30 Dec 2011 22:57:14 +0800
Message-ID: <CAN3veRfqfoFQ_14mZgkTziURj_PddXRy35UqB_640RcBmmTaow@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Daniel Hartwig <mandyke@gmail.com>
To: Marijn <hkBst@gentoo.org>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 14:57:17 -0000

On 30 December 2011 21:23, Marijn <hkBst@gentoo.org> wrote:
> Group capturing is useful, but the question is whether it is useful in
> the context of regexp-split. Maybe it is, maybe it isn't. Racket seems
> to be doing it differently than python, so I think that constitutes
> reason to look more closely. Certainly guile should follow racket over
> python, everything else being equal, but usually everything isn't
> equal if only one has a look and I'm saying that we should look at
> least at other schemes for inspiration.
> If you're so convinced that python is doing it right here and should
> be followed, then perhaps you can give some examples of how capturing
> groups are useful in a function that is supposed to split strings at
> regexps.

Having the *option* to return the captured groups in `regexp-split' is
certainly useful -- consider implementing a parser [1].  If the
captured groups are not desired, then simply omit the grouping parens
from the expression.

[1] http://80.68.89.23/2003/Oct/26/reSplit/

>
> Another data point:
>
> [14:17] <hkBst> what does chicken return for (irregex-split "([^0-9])"
> =C2=A0"123+456*/") =C2=A0?
> [14:18] <sjamaan> ("123" "456")
>
> Looks like chicken doesn't do capturing groups in their version, but
> they don't have the empty matches either. How about that...

For tokenizing I think you want to keep any empty strings, otherwise
you lose track of which `field' you are in (consider /etc/passwd
entries).  This also matches the existing behaviour of `string-split'.


From MAILER-DAEMON Fri Dec 30 10:12:38 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rge8M-0006Vr-3c
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 10:12:38 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59458)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rge8J-0006Vc-VI
	for guile-devel@gnu.org; Fri, 30 Dec 2011 10:12:37 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rge8I-00042D-Pg
	for guile-devel@gnu.org; Fri, 30 Dec 2011 10:12:35 -0500
Received: from mail-vx0-f169.google.com ([209.85.220.169]:63908)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rge8I-000429-M0
	for guile-devel@gnu.org; Fri, 30 Dec 2011 10:12:34 -0500
Received: by vcge1 with SMTP id e1so11967943vcg.0
	for <guile-devel@gnu.org>; Fri, 30 Dec 2011 07:12:34 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=ikDYms0bjF1GKE3mPFQWzNzmVsLEkqguRGjBV63AaVM=;
	b=I8jbT7lqCDVrTSD9REiy9SCvgaKcPP0e5eCqcuXtgFFRLWu73mYXbb2UL6rnxIFJ4M
	2O9pw+zPH5589HJQAse+NJ05PeKL+G3ZpEDYbjnPcFSIVJJkyKJMchudGNxNRuLMq/1C
	2k37rEi7PeUzn88GAg8hGE5DYN3ei8R9tzbkk=
MIME-Version: 1.0
Received: by 10.220.147.134 with SMTP id l6mr8583244vcv.49.1325257954177; Fri,
	30 Dec 2011 07:12:34 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Fri, 30 Dec 2011 07:12:34 -0800 (PST)
In-Reply-To: <8762gyjjp2.fsf@neil-laptop.ossau.uklinux.net>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<8762gyjjp2.fsf@neil-laptop.ossau.uklinux.net>
Date: Fri, 30 Dec 2011 23:12:34 +0800
Message-ID: <CAPjoZocSkvGAcO_Njvn8BDXqehP=RtCkF9EnqBmgrUXpcVC6hw@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Nala Ginrut <nalaginrut@gmail.com>
To: Neil Jerram <neil@ossau.homelinux.net>
Content-Type: multipart/alternative; boundary=bcaec54ee65e9832f804b550a958
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.220.169
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 15:12:37 -0000

--bcaec54ee65e9832f804b550a958
Content-Type: text/plain; charset=UTF-8

Well, I see.
So the previous discussion didn't make this proc put into Guile?
Now that so many people interested in this topic.

On Fri, Dec 30, 2011 at 9:03 PM, Neil Jerram <neil@ossau.homelinux.net>wrote:

> Nala Ginrut <nalaginrut@gmail.com> writes:
>
> > hi guilers!
> > It seems like there's no "regexp-split" procedure in Guile.
> > What we have is "string-split" which accepted Char only.
> > So I wrote one for myself.
>
> We've had this topic before, and it only needs a search for
> "regex-split guile" to find it:
> http://old.nabble.com/regex-split-for-Guile-td31093245.html.
>
>       Neil
>

--bcaec54ee65e9832f804b550a958
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Well, I see.<div>So the previous=C2=A0discussion didn&#39;t make this proc =
put into Guile?</div><div>Now that so many people interested in this topic.=
=C2=A0</div><div><br><div class=3D"gmail_quote">On Fri, Dec 30, 2011 at 9:0=
3 PM, Neil Jerram <span dir=3D"ltr">&lt;<a href=3D"mailto:neil@ossau.homeli=
nux.net">neil@ossau.homelinux.net</a>&gt;</span> wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex"><div class=3D"im">Nala Ginrut &lt;<a href=3D=
"mailto:nalaginrut@gmail.com">nalaginrut@gmail.com</a>&gt; writes:<br>
<br>
&gt; hi guilers!<br>
&gt; It seems like there&#39;s no &quot;regexp-split&quot; procedure in Gui=
le.<br>
&gt; What we have is &quot;string-split&quot; which accepted Char only.<br>
&gt; So I wrote one for myself.<br>
<br>
</div>We&#39;ve had this topic before, and it only needs a search for<br>
&quot;regex-split guile&quot; to find it:<br>
<a href=3D"http://old.nabble.com/regex-split-for-Guile-td31093245.html" tar=
get=3D"_blank">http://old.nabble.com/regex-split-for-Guile-td31093245.html<=
/a>.<br>
<span class=3D"HOEnZb"><font color=3D"#888888"><br>
 =C2=A0 =C2=A0 =C2=A0 Neil<br>
</font></span></blockquote></div><br></div>

--bcaec54ee65e9832f804b550a958--


From MAILER-DAEMON Fri Dec 30 10:23:20 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgeIi-0007uP-TY
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 10:23:20 -0500
Received: from eggs.gnu.org ([140.186.70.92]:46924)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgeIh-0007u7-4Z
	for guile-devel@gnu.org; Fri, 30 Dec 2011 10:23:19 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgeIf-0005ay-Pg
	for guile-devel@gnu.org; Fri, 30 Dec 2011 10:23:19 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:59710)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgeIf-0005as-LL
	for guile-devel@gnu.org; Fri, 30 Dec 2011 10:23:17 -0500
Received: by iacb35 with SMTP id b35so27730657iac.0
	for <guile-devel@gnu.org>; Fri, 30 Dec 2011 07:23:17 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=onDKhM4C7ZW6d3zp/NuTvXNUofYIbVe7vxKusZIefV4=;
	b=T/MP1mSBk44S3ZqgVOryoDAdDQh2UqBXvvGq6K3xFY0IpaT3mZ3c4OUqJgQ/3VPRqH
	LcFMyDdh3vp9LhjDQa1g7VqlWRU7VOj364/7jC8T5WJvYuIR7/fWtZpFWcOoKRtDK28q
	kb/S4EQorl0Jwk6gXIOK+uKLMUxoc0HWq7cOI=
MIME-Version: 1.0
Received: by 10.42.29.1 with SMTP id p1mr47669974icc.40.1325258596930; Fri, 30
	Dec 2011 07:23:16 -0800 (PST)
Received: by 10.231.48.68 with HTTP; Fri, 30 Dec 2011 07:23:16 -0800 (PST)
In-Reply-To: <CAPjoZofzCdFbjwfEnhu_Q0qSYnMivmoPwk3xHJ-xPHBSvKo55Q@mail.gmail.com>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<CAPjoZofnZUKwxR2pVuGEaMPP1Gdht_yHA52nUcX57RsuC0RTUw@mail.gmail.com>
	<CAPjoZocvsHVD=sXJ3zoRpVHQnGS1sksLhYFbr2iqeaUi3q09VA@mail.gmail.com>
	<CAPjoZoc6DtTkWX01CStQev7BFxC3CNHdjeCKbqaMRSDeagmmew@mail.gmail.com>
	<CAN3veRfLDYBPeyPd+Ljqy5F3fpdWGOmc0ZtUtsZB=YKytey-VA@mail.gmail.com>
	<CAPjoZocWvMqnoNmhtLbYREKR=QRPtr7zr6p+FXLh2X+hjQcPoA@mail.gmail.com>
	<CAN3veRdFQyOthFTSLE7v9x3_A4HTPX99DSmDx26dBkeyy=MTDQ@mail.gmail.com>
	<CAN3veRfRK7YN9YKrkJyg52T763f1fP3F6n0dTZ7+U9BX5O8HHw@mail.gmail.com>
	<CAPjoZodsG-zF00gZVL2OOApwJu+Roz-u2MPMJibRkpiXpDbFRw@mail.gmail.com>
	<CAPjoZofzCdFbjwfEnhu_Q0qSYnMivmoPwk3xHJ-xPHBSvKo55Q@mail.gmail.com>
Date: Fri, 30 Dec 2011 23:23:16 +0800
Message-ID: <CAN3veRfX2x-WxFdO6Q-veJPOO_G2FwTdqqvN_LuQyYpVFqiy7A@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Daniel Hartwig <mandyke@gmail.com>
To: Nala Ginrut <nalaginrut@gmail.com>
Content-Type: text/plain; charset=UTF-8
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 15:23:19 -0000

On 30 December 2011 19:47, Nala Ginrut <nalaginrut@gmail.com> wrote:
> Forget to load (srfi-1 iota) ,again...
>
>
> On Fri, Dec 30, 2011 at 7:40 PM, Nala Ginrut <nalaginrut@gmail.com> wrote:
>>
>> Great! It's better now.
>> Here's the brand new patch~

I notice that this does not handle the case where there are no matches:

scheme@(guile-user)> (regexp-split "[^0-9]" "123")
$26 = ((""))


  (let ((ret (fold-matches
              regex str (list '() 0 '(""))

becomes:

  (let ((ret (fold-matches
	      regex str (list '() 0 str)

and the result:

scheme@(guile-user)> (regexp-split "[^0-9]" "123")
$28 = ("123")
scheme@(guile-user)> (string-split "123" #\!)
$29 = ("123")


I also note that you are using `substring/shared' when I think you are
after `substring'.  Both of these are efficient and use shared memory
when they can, but there is a difference.


From MAILER-DAEMON Fri Dec 30 10:33:25 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgeST-0001MX-1B
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 10:33:25 -0500
Received: from eggs.gnu.org ([140.186.70.92]:60337)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgeSQ-0001MM-98
	for guile-devel@gnu.org; Fri, 30 Dec 2011 10:33:23 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgeSP-0007Fz-24
	for guile-devel@gnu.org; Fri, 30 Dec 2011 10:33:22 -0500
Received: from mail-tul01m020-f169.google.com ([209.85.214.169]:47479)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgeSO-0007Fv-VJ
	for guile-devel@gnu.org; Fri, 30 Dec 2011 10:33:21 -0500
Received: by obcwo8 with SMTP id wo8so12521336obc.0
	for <guile-devel@gnu.org>; Fri, 30 Dec 2011 07:33:20 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=Sx1vxIUu2FwFfWRZ8j1tx9+hGLohgtnQtI3R9xXOZ0o=;
	b=Y51J5g+EyGumAzDq1AuCLofFQ6n61oSAAW/E5jJqEKzOX4H8TTM2Jzn/v0SXct+lRv
	0iAN4XHL6fRBRZ7JpKJzVPE+gWag2ZbpH6iqRHMVnplDR1l05+xHW7Fql2XTT+ClXtXj
	F+afyXnbRA8/4hBeTlPU64nHOmKIwEKmjzZ+w=
MIME-Version: 1.0
Received: by 10.50.190.196 with SMTP id gs4mr46938455igc.14.1325259200218;
	Fri, 30 Dec 2011 07:33:20 -0800 (PST)
Received: by 10.231.48.68 with HTTP; Fri, 30 Dec 2011 07:33:20 -0800 (PST)
In-Reply-To: <8762gyjjp2.fsf@neil-laptop.ossau.uklinux.net>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<8762gyjjp2.fsf@neil-laptop.ossau.uklinux.net>
Date: Fri, 30 Dec 2011 23:33:20 +0800
Message-ID: <CAN3veRfbyfYgTeEcaBESdkrtAaaKqLCwNuqjq8GOONojzUOtZg@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Daniel Hartwig <mandyke@gmail.com>
To: Neil Jerram <neil@ossau.homelinux.net>
Content-Type: text/plain; charset=UTF-8
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.214.169
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 15:33:23 -0000

On 30 December 2011 21:03, Neil Jerram <neil@ossau.homelinux.net> wrote:
> Nala Ginrut <nalaginrut@gmail.com> writes:
>
>> hi guilers!
>> It seems like there's no "regexp-split" procedure in Guile.
>> What we have is "string-split" which accepted Char only.
>> So I wrote one for myself.
>
> We've had this topic before, and it only needs a search for
> "regex-split guile" to find it:
> http://old.nabble.com/regex-split-for-Guile-td31093245.html.
>

Good to see that there is continuing interest in this feature.

IMO, the implementation here is more elegant and readable for it's use
of `fold-matches'.  The first implementation from the thread you
mention effectively rolls it's own version of `fold-matches' over the
result of `list-matches' (which is implemented using `fold-matches'
!).


From MAILER-DAEMON Fri Dec 30 10:58:28 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rgeqi-0008DW-0h
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 10:58:28 -0500
Received: from eggs.gnu.org ([140.186.70.92]:55230)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rgeqf-0008D0-Qb
	for guile-devel@gnu.org; Fri, 30 Dec 2011 10:58:26 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rgeqe-0003A1-ID
	for guile-devel@gnu.org; Fri, 30 Dec 2011 10:58:25 -0500
Received: from mail-vx0-f169.google.com ([209.85.220.169]:39501)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rgeqe-00039v-6L
	for guile-devel@gnu.org; Fri, 30 Dec 2011 10:58:24 -0500
Received: by vcge1 with SMTP id e1so11996345vcg.0
	for <guile-devel@gnu.org>; Fri, 30 Dec 2011 07:58:23 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=ZWIfWu5NxJJU38FLQaFAgU+/wHYOcCe9JckJ+XdKI4k=;
	b=YH0JftqzwNzP97XGIQNNDEpKl9uoiJw2jq1OGlQt4iMh1Kxl/P3Tn/ymXqD5jK7G2P
	hqSjjqOO/vAmfaRw5s1Yky0ajOs+EiTzZQa5r1FP7009VhJYkJ45vPQRrNsYJtI7eGPL
	vs+idcQq16Cl9VU35ukR1alWrgaHRxtUVl3i0=
MIME-Version: 1.0
Received: by 10.220.147.134 with SMTP id l6mr8648859vcv.49.1325260703650; Fri,
	30 Dec 2011 07:58:23 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Fri, 30 Dec 2011 07:58:23 -0800 (PST)
In-Reply-To: <CAN3veRfbyfYgTeEcaBESdkrtAaaKqLCwNuqjq8GOONojzUOtZg@mail.gmail.com>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<8762gyjjp2.fsf@neil-laptop.ossau.uklinux.net>
	<CAN3veRfbyfYgTeEcaBESdkrtAaaKqLCwNuqjq8GOONojzUOtZg@mail.gmail.com>
Date: Fri, 30 Dec 2011 23:58:23 +0800
Message-ID: <CAPjoZoeZrt2RAvPrhkBE6xOg3sDg3gzdf0u11NH=itxHk_qp4w@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Nala Ginrut <nalaginrut@gmail.com>
To: Daniel Hartwig <mandyke@gmail.com>
Content-Type: multipart/alternative; boundary=bcaec54ee65e79d2e804b5514d7c
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.220.169
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 15:58:26 -0000

--bcaec54ee65e79d2e804b5514d7c
Content-Type: text/plain; charset=UTF-8

Now that we have previous thread on this topic, I think it's no need to
format a patch.

Maybe this will solve the problem:
(define* (regexp-split regex str #:optional (flags 0))
  (let ((ret (fold-matches
      regex str (list '() 0 str)
      (lambda (m prev)
(let* ((ll (car prev))
       (start (cadr prev))
       (tail (match:suffix m))
       (end (match:start m))
       (s (substring/shared str start end))
       (groups (map (lambda (n) (match:substring m n))
    (iota (1- (match:count m))))))
  (list `(,@ll ,s ,@groups) (match:end m) tail)))
      flags)))
    `(,@(car ret) ,(caddr ret))))


On Fri, Dec 30, 2011 at 11:33 PM, Daniel Hartwig <mandyke@gmail.com> wrote:

> On 30 December 2011 21:03, Neil Jerram <neil@ossau.homelinux.net> wrote:
> > Nala Ginrut <nalaginrut@gmail.com> writes:
> >
> >> hi guilers!
> >> It seems like there's no "regexp-split" procedure in Guile.
> >> What we have is "string-split" which accepted Char only.
> >> So I wrote one for myself.
> >
> > We've had this topic before, and it only needs a search for
> > "regex-split guile" to find it:
> > http://old.nabble.com/regex-split-for-Guile-td31093245.html.
> >
>
> Good to see that there is continuing interest in this feature.
>
> IMO, the implementation here is more elegant and readable for it's use
> of `fold-matches'.  The first implementation from the thread you
> mention effectively rolls it's own version of `fold-matches' over the
> result of `list-matches' (which is implemented using `fold-matches'
> !).
>

--bcaec54ee65e79d2e804b5514d7c
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Now that we have previous thread on this topic, I think it&#39;s no need to=
 format a patch.<div><br><div>Maybe this will solve the problem:</div><div>=
<div>(define* (regexp-split regex str #:optional (flags 0))</div><div>=C2=
=A0 (let ((ret (fold-matches=C2=A0</div>
<div><span class=3D"Apple-tab-span" style=3D"white-space:pre">	</span> =C2=
=A0 =C2=A0 =C2=A0regex str (list &#39;() 0 str)</div><div><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre">	</span> =C2=A0 =C2=A0 =C2=A0(lambd=
a (m prev)</div><div><span class=3D"Apple-tab-span" style=3D"white-space:pr=
e">		</span>(let* ((ll (car prev))</div>
<div><span class=3D"Apple-tab-span" style=3D"white-space:pre">		</span> =C2=
=A0 =C2=A0 =C2=A0 (start (cadr prev))</div><div><span class=3D"Apple-tab-sp=
an" style=3D"white-space:pre">		</span> =C2=A0 =C2=A0 =C2=A0 (tail (match:s=
uffix m))</div><div><span class=3D"Apple-tab-span" style=3D"white-space:pre=
">		</span> =C2=A0 =C2=A0 =C2=A0 (end (match:start m))</div>
<div><span class=3D"Apple-tab-span" style=3D"white-space:pre">		</span> =C2=
=A0 =C2=A0 =C2=A0 (s (substring/shared str start end))</div><div><span clas=
s=3D"Apple-tab-span" style=3D"white-space:pre">		</span> =C2=A0 =C2=A0 =C2=
=A0 (groups (map (lambda (n) (match:substring m n))</div>
<div><span class=3D"Apple-tab-span" style=3D"white-space:pre">				</span> =
=C2=A0 =C2=A0(iota (1- (match:count m))))))</div><div><span class=3D"Apple-=
tab-span" style=3D"white-space:pre">		</span> =C2=A0(list `(,@ll ,s ,@group=
s) (match:end m) tail)))</div>
<div><span class=3D"Apple-tab-span" style=3D"white-space:pre">	</span> =C2=
=A0 =C2=A0 =C2=A0flags)))</div><div>=C2=A0 =C2=A0 `(,@(car ret) ,(caddr ret=
))))</div><div><br></div><br><div class=3D"gmail_quote">On Fri, Dec 30, 201=
1 at 11:33 PM, Daniel Hartwig <span dir=3D"ltr">&lt;<a href=3D"mailto:mandy=
ke@gmail.com">mandyke@gmail.com</a>&gt;</span> wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex"><div class=3D"HOEnZb"><div class=3D"h5">On 3=
0 December 2011 21:03, Neil Jerram &lt;<a href=3D"mailto:neil@ossau.homelin=
ux.net">neil@ossau.homelinux.net</a>&gt; wrote:<br>

&gt; Nala Ginrut &lt;<a href=3D"mailto:nalaginrut@gmail.com">nalaginrut@gma=
il.com</a>&gt; writes:<br>
&gt;<br>
&gt;&gt; hi guilers!<br>
&gt;&gt; It seems like there&#39;s no &quot;regexp-split&quot; procedure in=
 Guile.<br>
&gt;&gt; What we have is &quot;string-split&quot; which accepted Char only.=
<br>
&gt;&gt; So I wrote one for myself.<br>
&gt;<br>
&gt; We&#39;ve had this topic before, and it only needs a search for<br>
&gt; &quot;regex-split guile&quot; to find it:<br>
&gt; <a href=3D"http://old.nabble.com/regex-split-for-Guile-td31093245.html=
" target=3D"_blank">http://old.nabble.com/regex-split-for-Guile-td31093245.=
html</a>.<br>
&gt;<br>
<br>
</div></div>Good to see that there is continuing interest in this feature.<=
br>
<br>
IMO, the implementation here is more elegant and readable for it&#39;s use<=
br>
of `fold-matches&#39;. =C2=A0The first implementation from the thread you<b=
r>
mention effectively rolls it&#39;s own version of `fold-matches&#39; over t=
he<br>
result of `list-matches&#39; (which is implemented using `fold-matches&#39;=
<br>
!).<br>
</blockquote></div><br></div></div>

--bcaec54ee65e79d2e804b5514d7c--


From MAILER-DAEMON Fri Dec 30 11:26:45 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgfI5-0005Bj-3b
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 11:26:45 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59322)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <neil@ossau.homelinux.net>) id 1RgfI2-0005Bd-QW
	for guile-devel@gnu.org; Fri, 30 Dec 2011 11:26:43 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <neil@ossau.homelinux.net>) id 1RgfHy-00077o-OZ
	for guile-devel@gnu.org; Fri, 30 Dec 2011 11:26:42 -0500
Received: from out1.ip01ir2.opaltelecom.net ([62.24.128.237]:57946)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <neil@ossau.homelinux.net>) id 1RgfHy-00077c-Ik
	for guile-devel@gnu.org; Fri, 30 Dec 2011 11:26:38 -0500
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: Av8EABzl/U5OkRO5/2dsb2JhbABDhQ+nQYEGgXIBAQQBIzMcBwULCAMaAgUhAgIPAQQNGCQTh3oCpEmRS4EviUqBFgSfcYdF
X-IronPort-AV: E=Sophos;i="4.71,432,1320624000"; d="scan'208";a="375975961"
Received: from host-78-145-19-185.as13285.net (HELO arudy) ([78.145.19.185])
	by out1.ip01ir2.opaltelecom.net with ESMTP; 30 Dec 2011 16:26:36 +0000
Received: from neil-laptop.ossau.uklinux.net.ossau.homelinux.net
	(host-78-145-19-185.as13285.net [78.145.19.185])
	by arudy (Postfix) with ESMTPA id 6DEE43801B;
	Fri, 30 Dec 2011 16:26:35 +0000 (GMT)
From: Neil Jerram <neil@ossau.homelinux.net>
To: Nala Ginrut <nalaginrut@gmail.com>
Subject: Re: [PATCH] add regexp-split
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<8762gyjjp2.fsf@neil-laptop.ossau.uklinux.net>
	<CAPjoZocSkvGAcO_Njvn8BDXqehP=RtCkF9EnqBmgrUXpcVC6hw@mail.gmail.com>
Date: Fri, 30 Dec 2011 16:26:34 +0000
In-Reply-To: <CAPjoZocSkvGAcO_Njvn8BDXqehP=RtCkF9EnqBmgrUXpcVC6hw@mail.gmail.com>
	(Nala Ginrut's message of "Fri, 30 Dec 2011 23:12:34 +0800")
Message-ID: <87sjk2gh51.fsf@neil-laptop.ossau.uklinux.net>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.3 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 62.24.128.237
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 16:26:43 -0000

Nala Ginrut <nalaginrut@gmail.com> writes:

> Well, I see.
> So the previous=C2=A0discussion didn't make this proc put into Guile?
> Now that so many people interested in this topic.=C2=A0

I'm afraid I can't recall what happened following that thread.

What feels important to me, though, is the elegance of the overall API.
There are already _some_ regex-related APIs in the core Guile library
(ice-9 regex) and I would guess that there are many many possible
variations of these and other string + regex processing APIs that one
might propose.  Also we've now demonstrated that regex-split can be
implemented, on top of the existing library, with only a few lines of
code.  Therefore I'd say (speaking only as an observer) that you need to
make a case for how your regex-split beautifully complements what's
already there in (ice-9 regex), or alternatively for replacing (ice-9
regex) with a more beautiful set of operations including regex-split.

Alternatively^2, you could package regex-split outside the core library,
as a test case for the guild hall.  Then it doesn't need to be justified
in relation to (ice-9 regex), it can just be a convenient module that
provides a more Python-like API.

Regards,
     Neil


From MAILER-DAEMON Fri Dec 30 11:27:59 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1RgfJH-0005HY-8n
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 11:27:59 -0500
Received: from eggs.gnu.org ([140.186.70.92]:59443)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgfJD-0005GM-Hq
	for guile-devel@gnu.org; Fri, 30 Dec 2011 11:27:56 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgfJC-0007Bx-5q
	for guile-devel@gnu.org; Fri, 30 Dec 2011 11:27:55 -0500
Received: from mail-iy0-f169.google.com ([209.85.210.169]:44422)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <mandyke@gmail.com>) id 1RgfJB-0007Bt-UG
	for guile-devel@gnu.org; Fri, 30 Dec 2011 11:27:54 -0500
Received: by iacb35 with SMTP id b35so27812392iac.0
	for <guile-devel@gnu.org>; Fri, 30 Dec 2011 08:27:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=JE46rLeQnnAMh5LvdSbkOmiaGwnTGhqnw+N1A7er2ss=;
	b=rDZ4k4RNcHnlJldunNeR/2+vcNFTy+zYJ97cE+02iDuFemjyqRhSKVhsXjmNLEwLIS
	VjJMyf+M7Zag5RONd/u/vkCmju54cFV/wxGh1QxMU19RhoA/uRvVnAKnr53QGnC0wfCN
	KTrVvDQPpJYW2tLaTZYA2Nt6GPeH2M6Fe6h7U=
MIME-Version: 1.0
Received: by 10.50.214.36 with SMTP id nx4mr14745776igc.14.1325262473106; Fri,
	30 Dec 2011 08:27:53 -0800 (PST)
Received: by 10.231.48.68 with HTTP; Fri, 30 Dec 2011 08:27:53 -0800 (PST)
In-Reply-To: <CAN3veRcjwKBRspH1JbWqYOLHeUF+8KmAE_fzcgOngYdddw0prQ@mail.gmail.com>
References: <CAN3veRcjwKBRspH1JbWqYOLHeUF+8KmAE_fzcgOngYdddw0prQ@mail.gmail.com>
Date: Sat, 31 Dec 2011 00:27:53 +0800
Message-ID: <CAN3veRfvm5K+ycbE6Fof-QULvNoH25tdeNYvre0Lq2kAVkw1PA@mail.gmail.com>
Subject: Re: bug#10410: guile: uri module confused by domain names starting
	with numbers, ipv6 addresses
From: Daniel Hartwig <mandyke@gmail.com>
To: 10410@debbugs.gnu.org
Content-Type: multipart/mixed; boundary=14dae93404fbf193e904b551b61a
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.210.169
Cc: guile-devel@gnu.org
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 16:27:56 -0000

--14dae93404fbf193e904b551b61a
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On 30 December 2011 18:14, Daniel Hartwig <mandyke@gmail.com> wrote:
>
> `string->uri' requires similar changes to support the ipv6 address
> literals. =C2=A0I'm yet to found a very elegant way to do this though it =
is
> easy enough to simply butcher `authority-pat'.

So the issue was really with `parse-authority'.

The attached patch cleans this up with support for IPv6 (including
dotted-quad notation), fixes some typos in the tests, and adds new
tests.

With both patches applied the web-uri.test now passes for all tests
and I can finally do:

scheme@(guile-user)> (string->uri "http://[::ffff:192.0.2.1]/foo")
$2 =3D #<<uri> scheme: http userinfo: #f host: "[::ffff:192.0.2.1]"
port: #f path: "/foo" query: #f fragment: #f>
scheme@(guile-user)> (string->uri "http://123.com")
$3 =3D #<<uri> scheme: http userinfo: #f host: "123.com" port: #f path:
"" query: #f fragment: #f>

--14dae93404fbf193e904b551b61a
Content-Type: text/x-patch; charset=US-ASCII; name="0002-enhance-IPv6-support.patch"
Content-Disposition: attachment; filename="0002-enhance-IPv6-support.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gwtet69z1

RnJvbSBiODM5YWE5MDljNjFlZjJlZTY4ZWE2NTJlNmUwMDk1YWZjM2YyZjI0IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBEYW5pZWwgSGFydHdpZyA8bWFuZHlrZUBnbWFpbC5jb20+CkRh
dGU6IFNhdCwgMzEgRGVjIDIwMTEgMDA6MTY6NDIgKzA4MDAKU3ViamVjdDogW1BBVENIIDIvMl0g
ZW5oYW5jZSBJUHY2IHN1cHBvcnQKCiogbW9kdWxlL3dlYi91cmkuc2NtICh2YWxpZC1ob3N0Pyk6
IFN1cHBvcnQgZG90dGVkLXF1YWQgbm90YXRpb24KICBpbiBJUHY2IGFkZHJlc3Nlcy4KICAocGFy
c2UtYXV0aG9yaXR5KTogU3VwcG9ydCBJUHY2IGxpdGVyYWxzLgoqIHRlc3Qtc3VpdGUvdGVzdHMv
d2ViLXVyaS50ZXN0OiBBZGQgYW5kIGZpeCB0ZXN0cy4KLS0tCiBtb2R1bGUvd2ViL3VyaS5zY20g
ICAgICAgICAgICB8ICAgIDQgKystLQogdGVzdC1zdWl0ZS90ZXN0cy93ZWItdXJpLnRlc3QgfCAg
IDE2ICsrKysrKysrKysrKy0tLS0KIDIgZmlsZXMgY2hhbmdlZCwgMTQgaW5zZXJ0aW9ucygrKSwg
NiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9tb2R1bGUvd2ViL3VyaS5zY20gYi9tb2R1bGUv
d2ViL3VyaS5zY20KaW5kZXggZmYxMzg0Ny4uYjhhNjk1MSAxMDA2NDQKLS0tIGEvbW9kdWxlL3dl
Yi91cmkuc2NtCisrKyBiL21vZHVsZS93ZWIvdXJpLnNjbQpAQCAtOTEsNyArOTEsNyBAQCBjb25z
aXN0ZW5jeSBjaGVja3MgdG8gbWFrZSBzdXJlIHRoYXQgdGhlIGNvbnN0cnVjdGVkIFVSSSBpcyB2
YWxpZC4iCiAoZGVmaW5lIGlwdjQtcmVnZXhwCiAgIChtYWtlLXJlZ2V4cCAiXihbMC05Ll0rKSQi
KSkKIChkZWZpbmUgaXB2Ni1yZWdleHAKLSAgKG1ha2UtcmVnZXhwICJeXFxbKFswLTlhLWZBLUY6
XSspXFxdJCIpKQorICAobWFrZS1yZWdleHAgIl5cXFsoWzAtOWEtZkEtRjouXSspXFxdJCIpKQog
KGRlZmluZSBkb21haW4tbGFiZWwtcmVnZXhwCiAgIChtYWtlLXJlZ2V4cCAiXlthLXpBLVowLTld
KFthLXpBLVowLTktXSpbYS16QS1aMC05XSk/JCIpKQogKGRlZmluZSB0b3AtbGFiZWwtcmVnZXhw
CkBAIC0xMTYsNyArMTE2LDcgQEAgY29uc2lzdGVuY3kgY2hlY2tzIHRvIG1ha2Ugc3VyZSB0aGF0
IHRoZSBjb25zdHJ1Y3RlZCBVUkkgaXMgdmFsaWQuIgogKGRlZmluZSB1c2VyaW5mby1wYXQKICAg
IlthLXpBLVowLTlfLiF+KicoKTs6Jj0rJCwtXSsiKQogKGRlZmluZSBob3N0LXBhdAotICAiW2Et
ekEtWjAtOS4tXSsiKQorICAiW2EtekEtWjAtOS4tXSt8XFxbWzAtOWEtRkEtRjouXStcXF0iKQog
KGRlZmluZSBwb3J0LXBhdAogICAiWzAtOV0qIikKIChkZWZpbmUgYXV0aG9yaXR5LXJlZ2V4cApk
aWZmIC0tZ2l0IGEvdGVzdC1zdWl0ZS90ZXN0cy93ZWItdXJpLnRlc3QgYi90ZXN0LXN1aXRlL3Rl
c3RzL3dlYi11cmkudGVzdAppbmRleCA0Zjg1OWUwLi5jZDZhOTQ0IDEwMDY0NAotLS0gYS90ZXN0
LXN1aXRlL3Rlc3RzL3dlYi11cmkudGVzdAorKysgYi90ZXN0LXN1aXRlL3Rlc3RzL3dlYi11cmku
dGVzdApAQCAtMTAyLDYgKzEwMiwxMCBAQAogICAgICh1cmk9PyAoYnVpbGQtdXJpICdodHRwICM6
aG9zdCAiWzIwMDE6ZGI4OjoxXSIpCiAgICAgICAgICAgICM6c2NoZW1lICdodHRwICM6aG9zdCAi
WzIwMDE6ZGI4OjoxXSIgIzpwYXRoICIiKSkKIAorICAocGFzcy1pZiAiaHR0cDovL1s6OmZmZmY6
MTkyLjAuMi4xXSIKKyAgICAodXJpPT8gKGJ1aWxkLXVyaSAnaHR0cCAjOmhvc3QgIls6OmZmZmY6
MTkyLjAuMi4xXSIpCisgICAgICAgICAgICM6c2NoZW1lICdodHRwICM6aG9zdCAiWzo6ZmZmZjox
OTIuMC4yLjFdIiAjOnBhdGggIiIpKQorCiAgIChwYXNzLWlmLXVyaS1leGNlcHRpb24gImh0dHA6
Ly9mb286bm90LWEtcG9ydCIKICAgICAgICAgICAgICAgICAgICAgICAgICAiRXhwZWN0ZWQuKnBv
cnQiCiAgICAgICAgICAgICAgICAgICAgICAgICAgKGJ1aWxkLXVyaSAnaHR0cCAjOmhvc3QgImZv
byIgIzpwb3J0ICJub3QtYS1wb3J0IikpCkBAIC0xNjAsMTIgKzE2NCwxNiBAQAogICAgICAgICAg
ICAjOnNjaGVtZSAnaHR0cCAjOmhvc3QgIlsyMDAxOmRiODo6MV0iICM6cGF0aCAiIikpCiAKICAg
KHBhc3MtaWYgImh0dHA6Ly9bMjAwMTpkYjg6OjFdOjgwIgotICAgICh1cmk9PyAoc3RyaW5nLT51
cmkgImh0dHA6Ly9bMjAwMTpkYjg6OjFdIikKKyAgICAodXJpPT8gKHN0cmluZy0+dXJpICJodHRw
Oi8vWzIwMDE6ZGI4OjoxXTo4MCIpCiAgICAgICAgICAgICM6c2NoZW1lICdodHRwCiAgICAgICAg
ICAgICM6aG9zdCAiWzIwMDE6ZGI4OjoxXSIKICAgICAgICAgICAgIzpwb3J0IDgwCiAgICAgICAg
ICAgICM6cGF0aCAiIikpCiAKKyAgKHBhc3MtaWYgImh0dHA6Ly9bOjpmZmZmOjE5Mi4wLjIuMV0i
CisgICAgKHVyaT0/IChzdHJpbmctPnVyaSAiaHR0cDovL1s6OmZmZmY6MTkyLjAuMi4xXSIpCisg
ICAgICAgICAgICM6c2NoZW1lICdodHRwICM6aG9zdCAiWzo6ZmZmZjoxOTIuMC4yLjFdIiAjOnBh
dGggIiIpKQorCiAgIChwYXNzLWlmICJodHRwOi8vZm9vOiIKICAgICAodXJpPT8gKHN0cmluZy0+
dXJpICJodHRwOi8vZm9vOiIpCiAgICAgICAgICAgICM6c2NoZW1lICdodHRwICM6aG9zdCAiZm9v
IiAjOnBhdGggIiIpKQpAQCAtMjIzLDkgKzIzMSw5IEBACiAgICAgKGVxdWFsPyAiaHR0cDovL1sy
MDAxOmRiODo6MV0iCiAgICAgICAgICAgICAodXJpLT5zdHJpbmcgKHN0cmluZy0+dXJpICJodHRw
Oi8vWzIwMDE6ZGI4OjoxXSIpKSkpCiAKLSAgKHBhc3MtaWYgImh0dHA6Ly9bMjAwMTpkYjg6OjFd
OjgwIgotICAgIChlcXVhbD8gImh0dHA6Ly9bMjAwMTpkYjg6OjFdOjgwIgotICAgICAgICAgICAo
dXJpLT5zdHJpbmcgKHN0cmluZy0+dXJpICJodHRwOi8vWzIwMDE6ZGI4OjoxXTo4MCIpKSkpCisg
IChwYXNzLWlmICJodHRwOi8vWzo6ZmZmZjoxOTIuMC4yLjFdIgorICAgIChlcXVhbD8gImh0dHA6
Ly9bOjpmZmZmOjE5Mi4wLjIuMV0iCisgICAgICAgICAgICAodXJpLT5zdHJpbmcgKHN0cmluZy0+
dXJpICJodHRwOi8vWzo6ZmZmZjoxOTIuMC4yLjFdIikpKSkKIAogICAocGFzcy1pZiAiaHR0cDov
L2ZvbzoiCiAgICAgKGVxdWFsPyAiaHR0cDovL2ZvbyIKLS0gCjEuNy41LjQKCg==
--14dae93404fbf193e904b551b61a--


From MAILER-DAEMON Fri Dec 30 11:46:04 2011
Received: from list by lists.gnu.org with archive (Exim 4.71)
	id 1Rgfam-0007kj-Pw
	for mharc-guile-devel@gnu.org; Fri, 30 Dec 2011 11:46:04 -0500
Received: from eggs.gnu.org ([140.186.70.92]:49948)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rgfak-0007k2-Lp
	for guile-devel@gnu.org; Fri, 30 Dec 2011 11:46:03 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rgfaj-0001MZ-FR
	for guile-devel@gnu.org; Fri, 30 Dec 2011 11:46:02 -0500
Received: from mail-vw0-f41.google.com ([209.85.212.41]:34459)
	by eggs.gnu.org with esmtp (Exim 4.71)
	(envelope-from <nalaginrut@gmail.com>) id 1Rgfaj-0001MT-5S
	for guile-devel@gnu.org; Fri, 30 Dec 2011 11:46:01 -0500
Received: by vbbfn1 with SMTP id fn1so13060442vbb.0
	for <guile-devel@gnu.org>; Fri, 30 Dec 2011 08:46:00 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;
	h=mime-version:in-reply-to:references:date:message-id:subject:from:to
	:cc:content-type;
	bh=6KkAWhqMtLnlTi4/awn5COx4BMGjT+VgaDY+KUHRQZs=;
	b=OG8zItn8ueNXiBSkw+gWLsQkHFVm4a39D0fniGWIfD3JMbuE8owaZ3eTQbNdtcVZ3B
	H5XDvFgduitDLkrKJHrRX8DZWLcRayJYpZxZq7bDVc2nh7Rrpo/rQqJ5gDQKwQ2mxvpY
	FMHY2iZqpwW39njtuvDkdQnVdiYfqtVWV3jvo=
MIME-Version: 1.0
Received: by 10.52.19.206 with SMTP id h14mr8956185vde.131.1325263560463; Fri,
	30 Dec 2011 08:46:00 -0800 (PST)
Received: by 10.52.183.194 with HTTP; Fri, 30 Dec 2011 08:46:00 -0800 (PST)
In-Reply-To: <87sjk2gh51.fsf@neil-laptop.ossau.uklinux.net>
References: <CAPjoZocdjvUhSyNVpSECtpQE57TvLLdzMCMYXvd-4xuA4=WuNw@mail.gmail.com>
	<8762gyjjp2.fsf@neil-laptop.ossau.uklinux.net>
	<CAPjoZocSkvGAcO_Njvn8BDXqehP=RtCkF9EnqBmgrUXpcVC6hw@mail.gmail.com>
	<87sjk2gh51.fsf@neil-laptop.ossau.uklinux.net>
Date: Sat, 31 Dec 2011 00:46:00 +0800
Message-ID: <CAPjoZoet=Xrdp2e8VzFS0+Rh3=nzfX3CQEVayBibdOu5vf11CQ@mail.gmail.com>
Subject: Re: [PATCH] add regexp-split
From: Nala Ginrut <nalaginrut@gmail.com>
To: Neil Jerram <neil@ossau.homelinux.net>
Content-Type: multipart/alternative; boundary=20cf307d06cec1538404b551f7a9
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.6 (newer, 2)
X-Received-From: 209.85.212.41
Cc: guile-devel <guile-devel@gnu.org>
X-BeenThere: guile-devel@gnu.org
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: "Developers list for Guile,
	the GNU extensibility library" <guile-devel.gnu.org>
List-Unsubscribe: <https://lists.gnu.org/mailman/options/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=unsubscribe>
List-Archive: <http://lists.gnu.org/archive/html/guile-devel>
List-Post: <mailto:guile-devel@gnu.org>
List-Help: <mailto:guile-devel-request@gnu.org?subject=help>
List-Subscribe: <https://lists.gnu.org/mailman/listinfo/guile-devel>,
	<mailto:guile-devel-request@gnu.org?subject=subscribe>
X-List-Received-Date: Fri, 30 Dec 2011 16:46:03 -0000

--20cf307d06cec1538404b551f7a9
Content-Type: text/plain; charset=UTF-8

OK, I'll put this proc in my own lib since there's no regexp-lib but a
regexp-core in Guile. Anyway, it's almost completed now. One may copy the
final version if needed.

On Sat, Dec 31, 2011 at 12:26 AM, Neil Jerram <neil@ossau.homelinux.net>wrote:

> Nala Ginrut <nalaginrut@gmail.com> writes:
>
> > Well, I see.
> > So the previous discussion didn't make this proc put into Guile?
> > Now that so many people interested in this topic.
>
> I'm afraid I can't recall what happened following that thread.
>
> What feels important to me, though, is the elegance of the overall API.
> There are already _some_ regex-related APIs in the core Guile library
> (ice-9 regex) and I would guess that there are many many possible
> variations of these and other string + regex processing APIs that one
> might propose.  Also we've now demonstrated that regex-split can be
> implemented, on top of the existing library, with only a few lines of
> code.  Therefore I'd say (speaking only as an observer) that you need to
> make a case for how your regex-split beautifully complements what's
> already there in (ice-9 regex), or alternatively for replacing (ice-9
> regex) with a more beautiful set of operations including regex-split.
>
> Alternatively^2, you could package regex-split outside the core library,
> as a test case for the guild hall.  Then it doesn't need to be justified
> in relation to (ice-9 regex), it can just be a convenient module that
> provides a more Python-like API.
>
> Regards,
>     Neil
>

--20cf307d06cec1538404b551f7a9
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

OK, I&#39;ll put this proc in my own lib since there&#39;s no regexp-lib bu=
t a regexp-core in Guile. Anyway, it&#39;s almost completed now. One may co=
py the final version if needed.<br><br><div class=3D"gmail_quote">On Sat, D=
ec 31, 2011 at 12:26 AM, Neil Jerram <span dir=3D"ltr">&lt;<a href=3D"mailt=
o:neil@ossau.homelinux.net">neil@ossau.homelinux.net</a>&gt;</span> wrote:<=
br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex"><div class=3D"im">Nala Ginrut &lt;<a href=3D=
"mailto:nalaginrut@gmail.com">nalaginrut@gmail.com</a>&gt; writes:<br>
<br>
&gt; Well, I see.<br>
&gt; So the previous=C2=A0discussion didn&#39;t make this proc put into Gui=
le?<br>
&gt; Now that so many people interested in this topic.=C2=A0<br>
<br>
</div>I&#39;m afraid I can&#39;t recall what happened following that thread=
.<br>
<br>
What feels important to me, though, is the elegance of the overall API.<br>
There are already _some_ regex-related APIs in the core Guile library<br>
(ice-9 regex) and I would guess that there are many many possible<br>
variations of these and other string + regex processing APIs that one<br>
might propose. =C2=A0Also we&#39;ve now demonstrated that regex-split can b=
e<br>
implemented, on top of the existing library, with only a few lines of<br>
code. =C2=A0Therefore I&#39;d say (speaking only as an observer) that you n=
eed to<br>
make a case for how your regex-split beautifully complements what&#39;s<br>
already there in (ice-9 regex), or alternatively for replacing (ice-9<br>
regex) with a more beautiful set of operations including regex-split.<br>
<br>
Alternatively^2, you could package regex-split outside the core library,<br=
>
as a test case for the guild hall. =C2=A0Then it doesn&#39;t need to be jus=
tified<br>
in relation to (ice-9 regex), it can just be a convenient module that<br>
provides a more Python-like API.<br>
<br>
Regards,<br>
 =C2=A0 =C2=A0 Neil<br>
</blockquote></div><br>

--20cf307d06cec1538404b551f7a9--


